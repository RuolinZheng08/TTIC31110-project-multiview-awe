2020-06-07 14:51:50,080: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-07 14:51:50,559: Using 1 GPU(s)
2020-06-07 14:51:50,560: Machine: 0 / 1
2020-06-07 14:51:50,586: Hyperparam tuning-------------------
2020-06-07 14:51:50,586: optim_lr: 0.001
2020-06-07 14:51:50,586: dropout (for both): 0.4
2020-06-07 14:51:50,586: margin: 0.4
2020-06-07 14:51:50,586: ------------------------------------
2020-06-07 14:51:50,648: Calling main function: multiview_trainer.train
2020-06-07 14:51:50,648: Using config file: train_config.json
2020-06-07 14:51:50,648: Using module at multiview_trainer.train
2020-06-07 14:52:01,681: Using module at multiview_vocab.MultiViewVocab
2020-06-07 14:52:01,762: Building vocab_data from config
2020-06-07 14:52:02,159:  >> min_count= 0
2020-06-07 14:52:02,160:  >> # words= 34323 (# removed= 0)
2020-06-07 14:52:02,160:  >> # subwords= 45
2020-06-07 14:52:02,160:     [laughter]= 1
2020-06-07 14:52:02,160:     [noise]= 2
2020-06-07 14:52:02,160:     [vocalized-noise]= 3
2020-06-07 14:52:02,160:     aa= 4
2020-06-07 14:52:02,160:     ae= 5
2020-06-07 14:52:02,161:     ah= 6
2020-06-07 14:52:02,161:     ao= 7
2020-06-07 14:52:02,161:     aw= 8
2020-06-07 14:52:02,161:     ax= 9
2020-06-07 14:52:02,161:     ay= 10
2020-06-07 14:52:02,161:     b= 11
2020-06-07 14:52:02,161:     ch= 12
2020-06-07 14:52:02,161:     d= 13
2020-06-07 14:52:02,161:     dh= 14
2020-06-07 14:52:02,161:     eh= 15
2020-06-07 14:52:02,162:     el= 16
2020-06-07 14:52:02,162:     en= 17
2020-06-07 14:52:02,162:     er= 18
2020-06-07 14:52:02,162:     ey= 19
2020-06-07 14:52:02,162:     f= 20
2020-06-07 14:52:02,162:     g= 21
2020-06-07 14:52:02,162:     hh= 22
2020-06-07 14:52:02,162:     ih= 23
2020-06-07 14:52:02,162:     iy= 24
2020-06-07 14:52:02,162:     jh= 25
2020-06-07 14:52:02,163:     k= 26
2020-06-07 14:52:02,163:     l= 27
2020-06-07 14:52:02,163:     m= 28
2020-06-07 14:52:02,163:     n= 29
2020-06-07 14:52:02,163:     ng= 30
2020-06-07 14:52:02,163:     ow= 31
2020-06-07 14:52:02,163:     oy= 32
2020-06-07 14:52:02,163:     p= 33
2020-06-07 14:52:02,163:     r= 34
2020-06-07 14:52:02,164:     s= 35
2020-06-07 14:52:02,164:     sh= 36
2020-06-07 14:52:02,164:     t= 37
2020-06-07 14:52:02,164:     th= 38
2020-06-07 14:52:02,164:     uh= 39
2020-06-07 14:52:02,164:     uw= 40
2020-06-07 14:52:02,164:     v= 41
2020-06-07 14:52:02,164:     w= 42
2020-06-07 14:52:02,164:     y= 43
2020-06-07 14:52:02,164:     z= 44
2020-06-07 14:52:02,165:     zh= 45
2020-06-07 14:52:02,182: Using module at data.batch_samplers.BatchSampler
2020-06-07 14:52:02,204: Building vocab_sampler from config
2020-06-07 14:52:02,204:  >> # examples= 34323
2020-06-07 14:52:02,204:  >> batch_size= 1000
2020-06-07 14:52:02,205:  >> shuffle= False
2020-06-07 14:52:02,214:  >> BatchSampler; 35 batches
2020-06-07 14:52:02,214: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 14:52:06,521: Building train_data from config
2020-06-07 14:52:15,435:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-07 14:52:15,437:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-07 14:52:15,437:  >> stack= False
2020-06-07 14:52:15,437:  >> seg_durs= (1, None)
2020-06-07 14:52:15,437:  >> # words= 9971 (# ignored= 0)
2020-06-07 14:52:15,437:  >> input_feat_dim= 108
2020-06-07 14:52:15,437:  >> input_num_subwords= 45
2020-06-07 14:52:15,437: Using module at data.batch_samplers.BatchSampler
2020-06-07 14:52:15,438: Building train_sampler from config
2020-06-07 14:52:15,438:  >> # examples= 9971
2020-06-07 14:52:15,438:  >> batch_size= 256
2020-06-07 14:52:15,438:  >> shuffle= True
2020-06-07 14:52:15,448:  >> BatchSampler; 39 batches
2020-06-07 14:52:15,448: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 14:52:15,448: Building dev_data from config
2020-06-07 14:52:25,625:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-07 14:52:25,626:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-07 14:52:25,626:  >> stack= False
2020-06-07 14:52:25,626:  >> seg_durs= (1, None)
2020-06-07 14:52:25,626:  >> # words= 10966 (# ignored= 0)
2020-06-07 14:52:25,626:  >> input_feat_dim= 108
2020-06-07 14:52:25,626:  >> input_num_subwords= 45
2020-06-07 14:52:25,627: Using module at data.batch_samplers.BatchSampler
2020-06-07 14:52:25,627: Building dev_sampler from config
2020-06-07 14:52:25,627:  >> # examples= 10966
2020-06-07 14:52:25,628:  >> batch_size= 256
2020-06-07 14:52:25,628:  >> shuffle= False
2020-06-07 14:52:25,630:  >> BatchSampler; 43 batches
2020-06-07 14:52:25,630: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 14:52:25,630: Building test_data from config
2020-06-07 14:52:34,492:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-07 14:52:34,494:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-07 14:52:34,494:  >> stack= False
2020-06-07 14:52:34,494:  >> seg_durs= (1, None)
2020-06-07 14:52:34,494:  >> # words= 11024 (# ignored= 0)
2020-06-07 14:52:34,494:  >> input_feat_dim= 108
2020-06-07 14:52:34,494:  >> input_num_subwords= 45
2020-06-07 14:52:34,495: Using module at data.batch_samplers.BatchSampler
2020-06-07 14:52:34,495: Building test_sampler from config
2020-06-07 14:52:34,495:  >> # examples= 11024
2020-06-07 14:52:34,495:  >> batch_size= 256
2020-06-07 14:52:34,496:  >> shuffle= False
2020-06-07 14:52:34,498:  >> BatchSampler; 44 batches
2020-06-07 14:52:34,498: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-07 14:52:34,943: Building loss from config
2020-06-07 14:52:34,944:  >> margin= 0.4
2020-06-07 14:52:34,944:  >> k= 16
2020-06-07 14:52:34,944:  >> min_k= 8
2020-06-07 14:52:34,945:  >> extra= 0
2020-06-07 14:52:34,945:  >> average= False
2020-06-07 14:52:34,945: Using module at metric.multiview_ap.MultiViewAP
2020-06-07 14:52:36,481: Building eval from config
2020-06-07 14:52:36,481:  >> acoustic_ap= True
2020-06-07 14:52:36,482:  >> crossview_ap= True
2020-06-07 14:52:36,482:  >> full_vocab= False
2020-06-07 14:52:36,482:  >> metric= crossview_ap
2020-06-07 14:52:36,482:  >> mode= max
2020-06-07 14:52:36,482: Using module at multiview_rnn.MultiViewRNN
2020-06-07 14:52:36,712: Building net from config
2020-06-07 14:52:36,714: view1:
2020-06-07 14:52:36,716:  >> cell= GRU
2020-06-07 14:52:36,716:  >> input_size= 108
2020-06-07 14:52:36,716:  >> hidden_size= 512
2020-06-07 14:52:36,717:  >> bidirectional= True
2020-06-07 14:52:36,717:  >> num_layers= 6
2020-06-07 14:52:36,717:  >> dropout between layers= 0.4
2020-06-07 14:52:37,070: view2:
2020-06-07 14:52:37,071:  >> cell= GRU
2020-06-07 14:52:37,071:  >> input_size= 64
2020-06-07 14:52:37,071:  >> hidden_size= 512
2020-06-07 14:52:37,071:  >> bidirectional= True
2020-06-07 14:52:37,071:  >> num_layers= 2
2020-06-07 14:52:37,071:  >> dropout between layers= 0.4
2020-06-07 14:52:37,072:  >> num input embeddings= 45
2020-06-07 14:52:46,571: Using module at optim.adam.Adam
2020-06-07 14:52:46,625: Building optim from config
2020-06-07 14:52:46,625:  >> lr= 0.001
2020-06-07 14:52:46,626:  >> betas= (0.9, 0.999)
2020-06-07 14:52:46,626:  >> eps= 1e-08
2020-06-07 14:52:46,626:  >> weight_decay= 0
2020-06-07 14:52:46,626:  >> amsgrad= False
2020-06-07 14:52:46,626:  >> min_lr= 1e-07
2020-06-07 14:52:46,628: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-07 14:52:46,816: Building sched from config
2020-06-07 14:52:46,817:  >> optim= Adam
2020-06-07 14:52:46,817:  >> decay lr by 0.1
2020-06-07 14:52:46,817:  >> eval_fn= MultiViewAP
2020-06-07 14:52:46,819:  >> patience=4
2020-06-07 14:52:46,819:  >> revert=True
2020-06-07 14:52:46,820: epoch=0.00 global_step=0 lr=0.001 start_iter=0
2020-06-07 14:52:46,820: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 14:54:54,783: 0) loss=0.504 grad_norm=51.17 num_segments=256 num_words=204
2020-06-07 14:56:51,081: 1) loss=0.493 grad_norm=46.04 num_segments=256 num_words=211
2020-06-07 14:58:40,531: 2) loss=0.515 grad_norm=68.04 num_segments=256 num_words=202
2020-06-07 15:00:20,822: 3) loss=0.476 grad_norm=43.04 num_segments=256 num_words=218
2020-06-07 15:01:53,548: 4) loss=0.484 grad_norm=55.96 num_segments=256 num_words=204
2020-06-07 15:03:17,363: 5) loss=0.473 grad_norm=67.83 num_segments=256 num_words=194
2020-06-07 15:04:32,174: 6) loss=0.474 grad_norm=59.91 num_segments=256 num_words=218
2020-06-07 15:05:38,856: 7) loss=0.469 grad_norm=53.25 num_segments=256 num_words=207
2020-06-07 15:06:47,009: 8) loss=0.479 grad_norm=48.21 num_segments=256 num_words=207
2020-06-07 15:07:54,066: 9) loss=0.471 grad_norm=41.84 num_segments=256 num_words=217
2020-06-07 15:09:00,053: 10) loss=0.465 grad_norm=43.66 num_segments=256 num_words=218
2020-06-07 15:10:06,203: 11) loss=0.461 grad_norm=41.29 num_segments=256 num_words=208
2020-06-07 15:11:13,337: 12) loss=0.459 grad_norm=40.71 num_segments=256 num_words=223
2020-06-07 15:12:20,630: 13) loss=0.457 grad_norm=36.59 num_segments=256 num_words=211
2020-06-07 15:13:28,414: 14) loss=0.447 grad_norm=38.86 num_segments=256 num_words=216
2020-06-07 15:14:35,263: 15) loss=0.446 grad_norm=46.62 num_segments=256 num_words=198
2020-06-07 15:15:43,212: 16) loss=0.442 grad_norm=46.69 num_segments=256 num_words=209
2020-06-07 15:16:50,876: 17) loss=0.464 grad_norm=44.51 num_segments=256 num_words=210
2020-06-07 15:17:58,490: 18) loss=0.441 grad_norm=42.60 num_segments=256 num_words=209
2020-06-07 15:19:03,638: 19) loss=0.436 grad_norm=35.04 num_segments=256 num_words=210
2020-06-07 15:20:09,853: 20) loss=0.429 grad_norm=33.68 num_segments=256 num_words=212
2020-06-07 15:21:15,810: 21) loss=0.431 grad_norm=31.84 num_segments=256 num_words=216
2020-06-07 15:22:21,968: 22) loss=0.504 grad_norm=45.62 num_segments=256 num_words=209
2020-06-07 15:23:28,176: 23) loss=0.427 grad_norm=34.84 num_segments=256 num_words=220
2020-06-07 15:24:36,029: 24) loss=0.422 grad_norm=34.55 num_segments=256 num_words=202
2020-06-07 15:25:44,014: 25) loss=0.417 grad_norm=33.62 num_segments=256 num_words=207
2020-06-07 15:26:51,335: 26) loss=0.418 grad_norm=37.06 num_segments=256 num_words=209
2020-06-07 15:27:58,813: 27) loss=0.407 grad_norm=38.44 num_segments=256 num_words=204
2020-06-07 15:29:06,508: 28) loss=0.413 grad_norm=33.93 num_segments=256 num_words=216
2020-06-07 15:30:13,916: 29) loss=0.435 grad_norm=40.27 num_segments=256 num_words=207
2020-06-07 15:31:20,333: 30) loss=0.425 grad_norm=33.14 num_segments=256 num_words=220
2020-06-07 15:32:27,919: 31) loss=0.427 grad_norm=38.03 num_segments=256 num_words=212
2020-06-07 15:33:34,609: 32) loss=0.394 grad_norm=43.05 num_segments=256 num_words=210
2020-06-07 15:34:41,782: 33) loss=0.402 grad_norm=43.81 num_segments=256 num_words=202
2020-06-07 15:35:48,832: 34) loss=0.395 grad_norm=48.80 num_segments=256 num_words=213
2020-06-07 15:36:55,278: 35) loss=0.393 grad_norm=45.94 num_segments=256 num_words=205
2020-06-07 15:38:00,520: 36) loss=0.398 grad_norm=57.03 num_segments=256 num_words=208
2020-06-07 15:39:06,041: 37) loss=0.401 grad_norm=54.53 num_segments=256 num_words=209
2020-06-07 15:40:05,059: 38) loss=0.399 grad_norm=44.88 num_segments=243 num_words=211
2020-06-07 15:40:05,078: epoch= 1.00
2020-06-07 15:40:05,078:  >> time to evaluate and save:
2020-06-07 15:40:05,153: saved save/MultiViewDataset_IndividualWords.39.pth
2020-06-07 15:40:05,155: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 15:40:05,157: saved MultiViewDataset_IndividualWords successfully
2020-06-07 15:40:07,476: saved save/MultiViewRNN.39.pth
2020-06-07 15:40:07,478: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 15:40:07,480: saved MultiViewRNN successfully
2020-06-07 15:40:11,695: saved save/Adam.39.pth
2020-06-07 15:40:11,698: most_recent linked save/Adam.most_recent.pth
2020-06-07 15:40:11,701: saved Adam successfully
2020-06-07 15:40:11,745: saved save/ReduceLROnPlateau.39.pth
2020-06-07 15:40:11,747: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 15:40:11,750: saved ReduceLROnPlateau successfully
2020-06-07 15:40:11,753: saved config successfully
2020-06-07 15:41:58,638:   >> crossview_ap=0.051 (10966 x 3921 pairs)
2020-06-07 15:43:05,221:   >> acoustic_ap=0.087 (10966 choose 2 pairs)
2020-06-07 15:43:05,224: best_so_far= 0.051 at 39
2020-06-07 15:43:05,228: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 15:43:05,230: saved MultiViewDataset_IndividualWords successfully
2020-06-07 15:43:05,231: best linked save/MultiViewRNN.best.pth
2020-06-07 15:43:05,233: saved MultiViewRNN successfully
2020-06-07 15:43:05,234: best linked save/Adam.best.pth
2020-06-07 15:43:05,236: saved Adam successfully
2020-06-07 15:43:05,237: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 15:43:05,239: saved ReduceLROnPlateau successfully
2020-06-07 15:43:05,268: epoch=1.00 global_step=39 lr=0.001 start_iter=0
2020-06-07 15:43:05,268: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 15:44:12,150: 0) loss=0.389 grad_norm=50.08 num_segments=256 num_words=218
2020-06-07 15:45:18,448: 1) loss=0.387 grad_norm=69.39 num_segments=256 num_words=212
2020-06-07 15:46:26,071: 2) loss=0.399 grad_norm=54.32 num_segments=256 num_words=209
2020-06-07 15:47:33,932: 3) loss=0.385 grad_norm=45.42 num_segments=256 num_words=211
2020-06-07 15:48:40,783: 4) loss=0.395 grad_norm=48.30 num_segments=256 num_words=215
2020-06-07 15:49:47,068: 5) loss=0.388 grad_norm=40.79 num_segments=256 num_words=213
2020-06-07 15:50:52,817: 6) loss=0.381 grad_norm=44.25 num_segments=256 num_words=216
2020-06-07 15:51:59,532: 7) loss=0.366 grad_norm=40.89 num_segments=256 num_words=203
2020-06-07 15:53:06,176: 8) loss=0.372 grad_norm=30.65 num_segments=256 num_words=218
2020-06-07 15:54:12,783: 9) loss=0.399 grad_norm=33.47 num_segments=256 num_words=212
2020-06-07 15:55:20,197: 10) loss=0.378 grad_norm=40.00 num_segments=256 num_words=208
2020-06-07 15:56:26,525: 11) loss=0.375 grad_norm=65.44 num_segments=256 num_words=213
2020-06-07 15:57:32,086: 12) loss=0.365 grad_norm=44.74 num_segments=256 num_words=218
2020-06-07 15:58:37,597: 13) loss=0.366 grad_norm=39.19 num_segments=256 num_words=208
2020-06-07 15:59:43,064: 14) loss=0.359 grad_norm=36.16 num_segments=256 num_words=213
2020-06-07 16:00:48,557: 15) loss=0.366 grad_norm=50.07 num_segments=256 num_words=200
2020-06-07 16:01:54,481: 16) loss=0.350 grad_norm=40.09 num_segments=256 num_words=208
2020-06-07 16:02:59,619: 17) loss=0.360 grad_norm=45.41 num_segments=256 num_words=210
2020-06-07 16:04:04,972: 18) loss=0.349 grad_norm=48.12 num_segments=256 num_words=200
2020-06-07 16:05:11,907: 19) loss=0.442 grad_norm=51.48 num_segments=256 num_words=221
2020-06-07 16:06:18,831: 20) loss=0.358 grad_norm=39.66 num_segments=256 num_words=209
2020-06-07 16:07:26,339: 21) loss=0.338 grad_norm=34.62 num_segments=256 num_words=203
2020-06-07 16:08:32,654: 22) loss=0.335 grad_norm=36.02 num_segments=256 num_words=210
2020-06-07 16:09:39,336: 23) loss=0.369 grad_norm=32.11 num_segments=256 num_words=222
2020-06-07 16:10:47,233: 24) loss=0.336 grad_norm=31.52 num_segments=256 num_words=215
2020-06-07 16:11:55,080: 25) loss=0.342 grad_norm=38.56 num_segments=256 num_words=205
2020-06-07 16:13:02,838: 26) loss=0.349 grad_norm=30.62 num_segments=256 num_words=215
2020-06-07 16:14:10,258: 27) loss=0.358 grad_norm=52.36 num_segments=256 num_words=213
2020-06-07 16:15:16,891: 28) loss=0.351 grad_norm=54.25 num_segments=256 num_words=214
2020-06-07 16:16:24,419: 29) loss=0.331 grad_norm=50.73 num_segments=256 num_words=205
2020-06-07 16:17:31,078: 30) loss=0.358 grad_norm=46.15 num_segments=256 num_words=209
2020-06-07 16:18:37,847: 31) loss=0.333 grad_norm=47.66 num_segments=256 num_words=209
2020-06-07 16:19:45,505: 32) loss=0.362 grad_norm=43.05 num_segments=256 num_words=200
2020-06-07 16:20:51,114: 33) loss=0.318 grad_norm=58.36 num_segments=256 num_words=201
2020-06-07 16:21:56,746: 34) loss=0.326 grad_norm=46.79 num_segments=256 num_words=211
2020-06-07 16:23:02,064: 35) loss=0.339 grad_norm=32.31 num_segments=256 num_words=206
2020-06-07 16:24:07,596: 36) loss=0.327 grad_norm=40.25 num_segments=256 num_words=210
2020-06-07 16:25:14,313: 37) loss=0.331 grad_norm=46.09 num_segments=256 num_words=204
2020-06-07 16:26:14,473: 38) loss=0.320 grad_norm=40.87 num_segments=243 num_words=196
2020-06-07 16:26:14,491: epoch= 2.00
2020-06-07 16:26:14,491:  >> time to evaluate and save:
2020-06-07 16:26:14,547: saved save/MultiViewDataset_IndividualWords.78.pth
2020-06-07 16:26:14,550: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 16:26:14,552: saved MultiViewDataset_IndividualWords successfully
2020-06-07 16:26:16,706: saved save/MultiViewRNN.78.pth
2020-06-07 16:26:16,708: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 16:26:16,717: saved MultiViewRNN successfully
2020-06-07 16:26:21,097: saved save/Adam.78.pth
2020-06-07 16:26:21,099: most_recent linked save/Adam.most_recent.pth
2020-06-07 16:26:21,107: saved Adam successfully
2020-06-07 16:26:21,139: saved save/ReduceLROnPlateau.78.pth
2020-06-07 16:26:21,144: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 16:26:21,147: saved ReduceLROnPlateau successfully
2020-06-07 16:26:21,212: saved config successfully
2020-06-07 16:28:02,471:   >> crossview_ap=0.164 (10966 x 3921 pairs)
2020-06-07 16:29:09,111:   >> acoustic_ap=0.202 (10966 choose 2 pairs)
2020-06-07 16:29:09,115: best_so_far= 0.164 at 78
2020-06-07 16:29:09,132: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 16:29:09,134: saved MultiViewDataset_IndividualWords successfully
2020-06-07 16:29:09,136: best linked save/MultiViewRNN.best.pth
2020-06-07 16:29:09,141: saved MultiViewRNN successfully
2020-06-07 16:29:09,143: best linked save/Adam.best.pth
2020-06-07 16:29:09,148: saved Adam successfully
2020-06-07 16:29:09,150: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 16:29:09,152: saved ReduceLROnPlateau successfully
2020-06-07 16:29:09,201: epoch=2.00 global_step=78 lr=0.001 start_iter=0
2020-06-07 16:29:09,201: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 16:30:16,984: 0) loss=0.316 grad_norm=42.28 num_segments=256 num_words=199
2020-06-07 16:31:23,018: 1) loss=0.311 grad_norm=35.99 num_segments=256 num_words=217
2020-06-07 16:32:30,815: 2) loss=0.314 grad_norm=56.78 num_segments=256 num_words=208
2020-06-07 16:33:36,863: 3) loss=0.304 grad_norm=54.98 num_segments=256 num_words=209
2020-06-07 16:34:42,216: 4) loss=0.315 grad_norm=34.99 num_segments=256 num_words=210
2020-06-07 16:35:47,721: 5) loss=0.311 grad_norm=33.60 num_segments=256 num_words=208
2020-06-07 16:36:53,417: 6) loss=0.320 grad_norm=47.92 num_segments=256 num_words=212
2020-06-07 16:37:59,383: 7) loss=0.313 grad_norm=36.49 num_segments=256 num_words=218
2020-06-07 16:39:06,034: 8) loss=0.308 grad_norm=37.15 num_segments=256 num_words=210
2020-06-07 16:40:13,953: 9) loss=0.307 grad_norm=29.12 num_segments=256 num_words=217
2020-06-07 16:41:19,937: 10) loss=0.295 grad_norm=38.32 num_segments=256 num_words=208
2020-06-07 16:42:26,120: 11) loss=0.290 grad_norm=42.39 num_segments=256 num_words=197
2020-06-07 16:43:32,218: 12) loss=0.304 grad_norm=45.72 num_segments=256 num_words=219
2020-06-07 16:44:37,914: 13) loss=0.293 grad_norm=49.06 num_segments=256 num_words=200
2020-06-07 16:45:44,676: 14) loss=0.300 grad_norm=45.90 num_segments=256 num_words=212
2020-06-07 16:46:51,996: 15) loss=0.298 grad_norm=41.77 num_segments=256 num_words=211
2020-06-07 16:47:58,943: 16) loss=0.310 grad_norm=37.00 num_segments=256 num_words=209
2020-06-07 16:49:05,756: 17) loss=0.402 grad_norm=37.58 num_segments=256 num_words=218
2020-06-07 16:50:13,470: 18) loss=0.302 grad_norm=40.83 num_segments=256 num_words=214
2020-06-07 16:51:20,817: 19) loss=0.300 grad_norm=39.58 num_segments=256 num_words=206
2020-06-07 16:52:28,266: 20) loss=0.284 grad_norm=31.02 num_segments=256 num_words=209
2020-06-07 16:53:34,585: 21) loss=0.290 grad_norm=40.07 num_segments=256 num_words=212
2020-06-07 16:54:39,976: 22) loss=0.288 grad_norm=52.05 num_segments=256 num_words=212
2020-06-07 16:55:46,802: 23) loss=0.282 grad_norm=31.76 num_segments=256 num_words=217
2020-06-07 16:56:52,820: 24) loss=0.290 grad_norm=33.39 num_segments=256 num_words=214
2020-06-07 16:57:59,527: 25) loss=0.283 grad_norm=40.24 num_segments=256 num_words=227
2020-06-07 16:59:04,925: 26) loss=0.296 grad_norm=29.32 num_segments=256 num_words=202
2020-06-07 17:00:10,197: 27) loss=0.280 grad_norm=34.31 num_segments=256 num_words=206
2020-06-07 17:01:15,664: 28) loss=0.278 grad_norm=28.98 num_segments=256 num_words=210
2020-06-07 17:02:22,440: 29) loss=0.270 grad_norm=35.61 num_segments=256 num_words=206
2020-06-07 17:03:30,368: 30) loss=0.282 grad_norm=34.56 num_segments=256 num_words=210
2020-06-07 17:04:38,716: 31) loss=0.303 grad_norm=31.96 num_segments=256 num_words=219
2020-06-07 17:05:44,633: 32) loss=0.275 grad_norm=34.85 num_segments=256 num_words=216
2020-06-07 17:06:52,316: 33) loss=0.274 grad_norm=43.78 num_segments=256 num_words=221
2020-06-07 17:07:58,984: 34) loss=0.269 grad_norm=27.52 num_segments=256 num_words=199
2020-06-07 17:09:04,465: 35) loss=0.267 grad_norm=37.08 num_segments=256 num_words=206
2020-06-07 17:10:10,178: 36) loss=0.279 grad_norm=39.36 num_segments=256 num_words=210
2020-06-07 17:11:15,783: 37) loss=0.293 grad_norm=33.72 num_segments=256 num_words=212
2020-06-07 17:12:14,798: 38) loss=0.284 grad_norm=38.49 num_segments=243 num_words=200
2020-06-07 17:12:14,817: epoch= 3.00
2020-06-07 17:12:14,817:  >> time to evaluate and save:
2020-06-07 17:12:14,883: saved save/MultiViewDataset_IndividualWords.117.pth
2020-06-07 17:12:14,886: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 17:12:14,888: saved MultiViewDataset_IndividualWords successfully
2020-06-07 17:12:17,184: saved save/MultiViewRNN.117.pth
2020-06-07 17:12:17,187: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 17:12:17,196: saved MultiViewRNN successfully
2020-06-07 17:12:21,217: saved save/Adam.117.pth
2020-06-07 17:12:21,220: most_recent linked save/Adam.most_recent.pth
2020-06-07 17:12:21,228: saved Adam successfully
2020-06-07 17:12:21,271: saved save/ReduceLROnPlateau.117.pth
2020-06-07 17:12:21,276: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 17:12:21,279: saved ReduceLROnPlateau successfully
2020-06-07 17:12:21,344: saved config successfully
2020-06-07 17:14:03,015:   >> crossview_ap=0.316 (10966 x 3921 pairs)
2020-06-07 17:15:09,463:   >> acoustic_ap=0.322 (10966 choose 2 pairs)
2020-06-07 17:15:09,467: best_so_far= 0.316 at 117
2020-06-07 17:15:09,473: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 17:15:09,475: saved MultiViewDataset_IndividualWords successfully
2020-06-07 17:15:09,477: best linked save/MultiViewRNN.best.pth
2020-06-07 17:15:09,484: saved MultiViewRNN successfully
2020-06-07 17:15:09,486: best linked save/Adam.best.pth
2020-06-07 17:15:09,492: saved Adam successfully
2020-06-07 17:15:09,494: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 17:15:09,496: saved ReduceLROnPlateau successfully
2020-06-07 17:15:09,547: epoch=3.00 global_step=117 lr=0.001 start_iter=0
2020-06-07 17:15:09,547: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 17:16:17,712: 0) loss=0.261 grad_norm=46.78 num_segments=256 num_words=203
2020-06-07 17:17:26,356: 1) loss=0.279 grad_norm=46.74 num_segments=256 num_words=215
2020-06-07 17:18:33,313: 2) loss=0.278 grad_norm=33.57 num_segments=256 num_words=209
2020-06-07 17:19:41,164: 3) loss=0.256 grad_norm=52.76 num_segments=256 num_words=209
2020-06-07 17:20:47,120: 4) loss=0.257 grad_norm=44.60 num_segments=256 num_words=209
2020-06-07 17:21:53,118: 5) loss=0.282 grad_norm=34.87 num_segments=256 num_words=210
2020-06-07 17:22:59,001: 6) loss=0.279 grad_norm=42.07 num_segments=256 num_words=207
2020-06-07 17:24:06,540: 7) loss=0.264 grad_norm=38.74 num_segments=256 num_words=223
2020-06-07 17:25:13,668: 8) loss=0.252 grad_norm=35.80 num_segments=256 num_words=212
2020-06-07 17:26:20,444: 9) loss=0.254 grad_norm=36.40 num_segments=256 num_words=214
2020-06-07 17:27:27,531: 10) loss=0.245 grad_norm=46.67 num_segments=256 num_words=212
2020-06-07 17:28:34,523: 11) loss=0.235 grad_norm=32.97 num_segments=256 num_words=211
2020-06-07 17:29:41,288: 12) loss=0.258 grad_norm=30.97 num_segments=256 num_words=206
2020-06-07 17:30:47,410: 13) loss=0.251 grad_norm=39.39 num_segments=256 num_words=219
2020-06-07 17:31:53,026: 14) loss=0.236 grad_norm=38.78 num_segments=256 num_words=212
2020-06-07 17:32:59,270: 15) loss=0.238 grad_norm=36.11 num_segments=256 num_words=205
2020-06-07 17:34:04,969: 16) loss=0.253 grad_norm=41.17 num_segments=256 num_words=211
2020-06-07 17:35:10,790: 17) loss=0.264 grad_norm=36.95 num_segments=256 num_words=210
2020-06-07 17:36:16,921: 18) loss=0.241 grad_norm=39.37 num_segments=256 num_words=218
2020-06-07 17:37:23,146: 19) loss=0.237 grad_norm=43.57 num_segments=256 num_words=207
2020-06-07 17:38:30,503: 20) loss=0.242 grad_norm=36.99 num_segments=256 num_words=208
2020-06-07 17:39:37,294: 21) loss=0.246 grad_norm=27.75 num_segments=256 num_words=213
2020-06-07 17:40:44,264: 22) loss=0.267 grad_norm=34.30 num_segments=256 num_words=207
2020-06-07 17:41:50,811: 23) loss=0.237 grad_norm=47.65 num_segments=256 num_words=214
2020-06-07 17:42:57,680: 24) loss=0.240 grad_norm=39.65 num_segments=256 num_words=212
2020-06-07 17:44:04,878: 25) loss=0.244 grad_norm=46.80 num_segments=256 num_words=212
2020-06-07 17:45:11,898: 26) loss=0.244 grad_norm=42.89 num_segments=256 num_words=210
2020-06-07 17:46:18,775: 27) loss=0.319 grad_norm=32.85 num_segments=256 num_words=209
2020-06-07 17:47:25,806: 28) loss=0.224 grad_norm=38.41 num_segments=256 num_words=213
2020-06-07 17:48:32,938: 29) loss=0.246 grad_norm=56.11 num_segments=256 num_words=218
2020-06-07 17:49:39,719: 30) loss=0.232 grad_norm=38.47 num_segments=256 num_words=199
2020-06-07 17:50:46,712: 31) loss=0.221 grad_norm=33.35 num_segments=256 num_words=202
2020-06-07 17:51:53,384: 32) loss=0.232 grad_norm=36.25 num_segments=256 num_words=210
2020-06-07 17:53:00,385: 33) loss=0.213 grad_norm=26.25 num_segments=256 num_words=213
2020-06-07 17:54:07,550: 34) loss=0.223 grad_norm=38.01 num_segments=256 num_words=208
2020-06-07 17:55:14,593: 35) loss=0.213 grad_norm=35.95 num_segments=256 num_words=203
2020-06-07 17:56:21,527: 36) loss=0.315 grad_norm=34.42 num_segments=256 num_words=213
2020-06-07 17:57:29,003: 37) loss=0.210 grad_norm=46.29 num_segments=256 num_words=195
2020-06-07 17:58:28,816: 38) loss=0.211 grad_norm=30.55 num_segments=243 num_words=203
2020-06-07 17:58:28,835: epoch= 4.00
2020-06-07 17:58:28,835:  >> time to evaluate and save:
2020-06-07 17:58:28,926: saved save/MultiViewDataset_IndividualWords.156.pth
2020-06-07 17:58:28,929: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 17:58:28,932: saved MultiViewDataset_IndividualWords successfully
2020-06-07 17:58:31,185: saved save/MultiViewRNN.156.pth
2020-06-07 17:58:34,710: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 17:58:34,720: saved MultiViewRNN successfully
2020-06-07 17:58:40,217: saved save/Adam.156.pth
2020-06-07 17:58:40,221: most_recent linked save/Adam.most_recent.pth
2020-06-07 17:58:40,229: saved Adam successfully
2020-06-07 17:58:40,281: saved save/ReduceLROnPlateau.156.pth
2020-06-07 17:58:40,330: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 17:58:40,333: saved ReduceLROnPlateau successfully
2020-06-07 17:58:40,337: saved config successfully
2020-06-07 18:00:23,767:   >> crossview_ap=0.448 (10966 x 3921 pairs)
2020-06-07 18:01:30,464:   >> acoustic_ap=0.465 (10966 choose 2 pairs)
2020-06-07 18:01:30,468: best_so_far= 0.448 at 156
2020-06-07 18:01:30,482: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 18:01:30,485: saved MultiViewDataset_IndividualWords successfully
2020-06-07 18:01:30,487: best linked save/MultiViewRNN.best.pth
2020-06-07 18:01:30,498: saved MultiViewRNN successfully
2020-06-07 18:01:30,500: best linked save/Adam.best.pth
2020-06-07 18:01:30,510: saved Adam successfully
2020-06-07 18:01:30,511: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 18:01:30,514: saved ReduceLROnPlateau successfully
2020-06-07 18:01:30,563: epoch=4.00 global_step=156 lr=0.001 start_iter=0
2020-06-07 18:01:30,563: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 18:02:37,500: 0) loss=0.213 grad_norm=32.51 num_segments=256 num_words=204
2020-06-07 18:03:44,307: 1) loss=0.226 grad_norm=28.38 num_segments=256 num_words=215
2020-06-07 18:04:52,139: 2) loss=0.238 grad_norm=43.91 num_segments=256 num_words=214
2020-06-07 18:06:00,192: 3) loss=0.216 grad_norm=28.91 num_segments=256 num_words=203
2020-06-07 18:07:07,298: 4) loss=0.204 grad_norm=29.15 num_segments=256 num_words=216
2020-06-07 18:08:14,094: 5) loss=0.226 grad_norm=51.24 num_segments=256 num_words=212
2020-06-07 18:09:21,216: 6) loss=0.211 grad_norm=38.68 num_segments=256 num_words=206
2020-06-07 18:10:27,149: 7) loss=0.198 grad_norm=35.81 num_segments=256 num_words=205
2020-06-07 18:11:34,812: 8) loss=0.208 grad_norm=28.27 num_segments=256 num_words=213
2020-06-07 18:12:41,931: 9) loss=0.227 grad_norm=35.61 num_segments=256 num_words=219
2020-06-07 18:13:48,839: 10) loss=0.210 grad_norm=33.93 num_segments=256 num_words=217
2020-06-07 18:14:54,737: 11) loss=0.202 grad_norm=29.44 num_segments=256 num_words=214
2020-06-07 18:16:01,445: 12) loss=0.202 grad_norm=32.39 num_segments=256 num_words=207
2020-06-07 18:17:07,834: 13) loss=0.199 grad_norm=25.69 num_segments=256 num_words=210
2020-06-07 18:18:15,290: 14) loss=0.206 grad_norm=33.84 num_segments=256 num_words=204
2020-06-07 18:19:22,621: 15) loss=0.201 grad_norm=27.81 num_segments=256 num_words=211
2020-06-07 18:20:29,228: 16) loss=0.194 grad_norm=30.96 num_segments=256 num_words=201
2020-06-07 18:21:35,875: 17) loss=0.209 grad_norm=28.35 num_segments=256 num_words=210
2020-06-07 18:22:42,999: 18) loss=0.200 grad_norm=32.76 num_segments=256 num_words=217
2020-06-07 18:23:49,717: 19) loss=0.198 grad_norm=29.79 num_segments=256 num_words=212
2020-06-07 18:24:56,871: 20) loss=0.174 grad_norm=28.37 num_segments=256 num_words=194
2020-06-07 18:26:03,905: 21) loss=0.185 grad_norm=37.10 num_segments=256 num_words=203
2020-06-07 18:27:11,781: 22) loss=0.218 grad_norm=42.42 num_segments=256 num_words=219
2020-06-07 18:28:17,766: 23) loss=0.193 grad_norm=26.62 num_segments=256 num_words=207
2020-06-07 18:29:23,581: 24) loss=0.196 grad_norm=24.38 num_segments=256 num_words=196
2020-06-07 18:30:29,958: 25) loss=0.199 grad_norm=26.11 num_segments=256 num_words=220
2020-06-07 18:31:36,042: 26) loss=0.218 grad_norm=27.51 num_segments=256 num_words=213
2020-06-07 18:32:42,951: 27) loss=0.187 grad_norm=34.33 num_segments=256 num_words=214
2020-06-07 18:33:50,486: 28) loss=0.187 grad_norm=27.05 num_segments=256 num_words=207
2020-06-07 18:34:57,005: 29) loss=0.226 grad_norm=33.53 num_segments=256 num_words=210
2020-06-07 18:36:03,475: 30) loss=0.207 grad_norm=24.98 num_segments=256 num_words=208
2020-06-07 18:37:10,934: 31) loss=0.236 grad_norm=47.17 num_segments=256 num_words=216
2020-06-07 18:38:17,313: 32) loss=0.193 grad_norm=32.85 num_segments=256 num_words=202
2020-06-07 18:39:23,809: 33) loss=0.243 grad_norm=47.02 num_segments=256 num_words=220
2020-06-07 18:40:30,804: 34) loss=0.188 grad_norm=40.82 num_segments=256 num_words=218
2020-06-07 18:41:36,806: 35) loss=0.198 grad_norm=32.90 num_segments=256 num_words=213
2020-06-07 18:42:43,690: 36) loss=0.186 grad_norm=45.35 num_segments=256 num_words=205
2020-06-07 18:43:50,852: 37) loss=0.189 grad_norm=34.40 num_segments=256 num_words=204
2020-06-07 18:44:52,691: 38) loss=0.206 grad_norm=27.47 num_segments=243 num_words=206
2020-06-07 18:44:52,711: epoch= 5.00
2020-06-07 18:44:52,711:  >> time to evaluate and save:
2020-06-07 18:44:52,824: saved save/MultiViewDataset_IndividualWords.195.pth
2020-06-07 18:44:52,880: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 18:44:52,895: saved MultiViewDataset_IndividualWords successfully
2020-06-07 18:44:55,085: saved save/MultiViewRNN.195.pth
2020-06-07 18:44:55,087: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 18:44:55,097: saved MultiViewRNN successfully
2020-06-07 18:44:59,555: saved save/Adam.195.pth
2020-06-07 18:44:59,559: most_recent linked save/Adam.most_recent.pth
2020-06-07 18:44:59,567: saved Adam successfully
2020-06-07 18:44:59,603: saved save/ReduceLROnPlateau.195.pth
2020-06-07 18:44:59,609: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 18:44:59,613: saved ReduceLROnPlateau successfully
2020-06-07 18:44:59,677: saved config successfully
2020-06-07 18:46:42,372:   >> crossview_ap=0.525 (10966 x 3921 pairs)
2020-06-07 18:47:48,814:   >> acoustic_ap=0.533 (10966 choose 2 pairs)
2020-06-07 18:47:48,818: best_so_far= 0.525 at 195
2020-06-07 18:47:48,831: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 18:47:48,834: saved MultiViewDataset_IndividualWords successfully
2020-06-07 18:47:48,836: best linked save/MultiViewRNN.best.pth
2020-06-07 18:47:48,848: saved MultiViewRNN successfully
2020-06-07 18:47:48,850: best linked save/Adam.best.pth
2020-06-07 18:47:48,860: saved Adam successfully
2020-06-07 18:47:48,862: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 18:47:48,865: saved ReduceLROnPlateau successfully
2020-06-07 18:47:48,987: epoch=5.00 global_step=195 lr=0.001 start_iter=0
2020-06-07 18:47:48,987: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 18:48:58,321: 0) loss=0.177 grad_norm=27.83 num_segments=256 num_words=208
2020-06-07 18:50:04,408: 1) loss=0.187 grad_norm=36.95 num_segments=256 num_words=212
2020-06-07 18:51:11,153: 2) loss=0.162 grad_norm=52.16 num_segments=256 num_words=209
2020-06-07 19:49:41,186: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-07 19:49:41,218: Using 1 GPU(s)
2020-06-07 19:49:41,219: Machine: 0 / 1
2020-06-07 19:49:41,240: Hyperparam tuning-------------------
2020-06-07 19:49:41,240: optim_lr: 0.001
2020-06-07 19:49:41,240: dropout (for both): 0.4
2020-06-07 19:49:41,240: margin: 0.4
2020-06-07 19:49:41,240: ------------------------------------
2020-06-07 19:49:41,242: Calling main function: multiview_trainer.train
2020-06-07 19:49:41,242: Using config file: train_config.json
2020-06-07 19:49:41,242: Using module at multiview_trainer.train
2020-06-07 19:49:41,662: Using module at multiview_vocab.MultiViewVocab
2020-06-07 19:49:41,810: Building vocab_data from config
2020-06-07 19:49:42,039:  >> min_count= 0
2020-06-07 19:49:42,040:  >> # words= 34323 (# removed= 0)
2020-06-07 19:49:42,040:  >> # subwords= 45
2020-06-07 19:49:42,040:     [laughter]= 1
2020-06-07 19:49:42,040:     [noise]= 2
2020-06-07 19:49:42,040:     [vocalized-noise]= 3
2020-06-07 19:49:42,040:     aa= 4
2020-06-07 19:49:42,040:     ae= 5
2020-06-07 19:49:42,040:     ah= 6
2020-06-07 19:49:42,040:     ao= 7
2020-06-07 19:49:42,040:     aw= 8
2020-06-07 19:49:42,040:     ax= 9
2020-06-07 19:49:42,040:     ay= 10
2020-06-07 19:49:42,041:     b= 11
2020-06-07 19:49:42,041:     ch= 12
2020-06-07 19:49:42,041:     d= 13
2020-06-07 19:49:42,041:     dh= 14
2020-06-07 19:49:42,041:     eh= 15
2020-06-07 19:49:42,041:     el= 16
2020-06-07 19:49:42,041:     en= 17
2020-06-07 19:49:42,041:     er= 18
2020-06-07 19:49:42,041:     ey= 19
2020-06-07 19:49:42,041:     f= 20
2020-06-07 19:49:42,041:     g= 21
2020-06-07 19:49:42,041:     hh= 22
2020-06-07 19:49:42,041:     ih= 23
2020-06-07 19:49:42,041:     iy= 24
2020-06-07 19:49:42,041:     jh= 25
2020-06-07 19:49:42,041:     k= 26
2020-06-07 19:49:42,042:     l= 27
2020-06-07 19:49:42,042:     m= 28
2020-06-07 19:49:42,042:     n= 29
2020-06-07 19:49:42,042:     ng= 30
2020-06-07 19:49:42,042:     ow= 31
2020-06-07 19:49:42,042:     oy= 32
2020-06-07 19:49:42,042:     p= 33
2020-06-07 19:49:42,042:     r= 34
2020-06-07 19:49:42,042:     s= 35
2020-06-07 19:49:42,042:     sh= 36
2020-06-07 19:49:42,042:     t= 37
2020-06-07 19:49:42,042:     th= 38
2020-06-07 19:49:42,042:     uh= 39
2020-06-07 19:49:42,042:     uw= 40
2020-06-07 19:49:42,042:     v= 41
2020-06-07 19:49:42,043:     w= 42
2020-06-07 19:49:42,043:     y= 43
2020-06-07 19:49:42,043:     z= 44
2020-06-07 19:49:42,043:     zh= 45
2020-06-07 19:49:42,054: Using module at data.batch_samplers.BatchSampler
2020-06-07 19:49:42,071: Building vocab_sampler from config
2020-06-07 19:49:42,072:  >> # examples= 34323
2020-06-07 19:49:42,072:  >> batch_size= 1000
2020-06-07 19:49:42,072:  >> shuffle= False
2020-06-07 19:49:42,078:  >> BatchSampler; 35 batches
2020-06-07 19:49:42,078: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 19:49:42,245: Building train_data from config
2020-06-07 19:49:49,738:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-07 19:49:49,739:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-07 19:49:49,739:  >> stack= False
2020-06-07 19:49:49,739:  >> seg_durs= (1, None)
2020-06-07 19:49:49,739:  >> # words= 9971 (# ignored= 0)
2020-06-07 19:49:49,739:  >> input_feat_dim= 108
2020-06-07 19:49:49,740:  >> input_num_subwords= 45
2020-06-07 19:49:49,740: Using module at data.batch_samplers.BatchSampler
2020-06-07 19:49:49,740: Building train_sampler from config
2020-06-07 19:49:49,741:  >> # examples= 9971
2020-06-07 19:49:49,741:  >> batch_size= 256
2020-06-07 19:49:49,741:  >> shuffle= True
2020-06-07 19:49:49,748:  >> BatchSampler; 39 batches
2020-06-07 19:49:49,748: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 19:49:49,748: Building dev_data from config
2020-06-07 19:49:58,389:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-07 19:49:58,390:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-07 19:49:58,390:  >> stack= False
2020-06-07 19:49:58,390:  >> seg_durs= (1, None)
2020-06-07 19:49:58,390:  >> # words= 10966 (# ignored= 0)
2020-06-07 19:49:58,390:  >> input_feat_dim= 108
2020-06-07 19:49:58,390:  >> input_num_subwords= 45
2020-06-07 19:49:58,390: Using module at data.batch_samplers.BatchSampler
2020-06-07 19:49:58,390: Building dev_sampler from config
2020-06-07 19:49:58,391:  >> # examples= 10966
2020-06-07 19:49:58,391:  >> batch_size= 256
2020-06-07 19:49:58,391:  >> shuffle= False
2020-06-07 19:49:58,393:  >> BatchSampler; 43 batches
2020-06-07 19:49:58,393: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 19:49:58,393: Building test_data from config
2020-06-07 19:50:05,832:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-07 19:50:05,833:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-07 19:50:05,833:  >> stack= False
2020-06-07 19:50:05,833:  >> seg_durs= (1, None)
2020-06-07 19:50:05,833:  >> # words= 11024 (# ignored= 0)
2020-06-07 19:50:05,833:  >> input_feat_dim= 108
2020-06-07 19:50:05,833:  >> input_num_subwords= 45
2020-06-07 19:50:05,833: Using module at data.batch_samplers.BatchSampler
2020-06-07 19:50:05,833: Building test_sampler from config
2020-06-07 19:50:05,834:  >> # examples= 11024
2020-06-07 19:50:05,834:  >> batch_size= 256
2020-06-07 19:50:05,834:  >> shuffle= False
2020-06-07 19:50:05,836:  >> BatchSampler; 44 batches
2020-06-07 19:50:05,836: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-07 19:50:05,950: Building loss from config
2020-06-07 19:50:05,951:  >> margin= 0.4
2020-06-07 19:50:05,951:  >> k= 16
2020-06-07 19:50:05,951:  >> min_k= 8
2020-06-07 19:50:05,951:  >> extra= 0
2020-06-07 19:50:05,951:  >> average= False
2020-06-07 19:50:05,951: Using module at metric.multiview_ap.MultiViewAP
2020-06-07 19:50:06,056: Building eval from config
2020-06-07 19:50:06,057:  >> acoustic_ap= True
2020-06-07 19:50:06,057:  >> crossview_ap= True
2020-06-07 19:50:06,057:  >> full_vocab= False
2020-06-07 19:50:06,057:  >> metric= crossview_ap
2020-06-07 19:50:06,057:  >> mode= max
2020-06-07 19:50:06,057: Using module at multiview_rnn.MultiViewRNN
2020-06-07 19:50:06,238: Building net from config
2020-06-07 19:50:06,239: view1:
2020-06-07 19:50:06,240:  >> cell= GRU
2020-06-07 19:50:06,240:  >> input_size= 108
2020-06-07 19:50:06,240:  >> hidden_size= 512
2020-06-07 19:50:06,240:  >> bidirectional= True
2020-06-07 19:50:06,240:  >> num_layers= 6
2020-06-07 19:50:06,240:  >> dropout between layers= 0.4
2020-06-07 19:50:06,454: view2:
2020-06-07 19:50:06,455:  >> cell= GRU
2020-06-07 19:50:06,455:  >> input_size= 64
2020-06-07 19:50:06,455:  >> hidden_size= 512
2020-06-07 19:50:06,455:  >> bidirectional= True
2020-06-07 19:50:06,455:  >> num_layers= 2
2020-06-07 19:50:06,455:  >> dropout between layers= 0.4
2020-06-07 19:50:06,455:  >> num input embeddings= 45
2020-06-07 19:50:09,841: Using module at optim.adam.Adam
2020-06-07 19:50:09,926: Building optim from config
2020-06-07 19:50:09,927:  >> lr= 0.001
2020-06-07 19:50:09,927:  >> betas= (0.9, 0.999)
2020-06-07 19:50:09,927:  >> eps= 1e-08
2020-06-07 19:50:09,927:  >> weight_decay= 0
2020-06-07 19:50:09,927:  >> amsgrad= False
2020-06-07 19:50:09,927:  >> min_lr= 1e-07
2020-06-07 19:50:09,929: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-07 19:50:10,153: Building sched from config
2020-06-07 19:50:10,153:  >> optim= Adam
2020-06-07 19:50:10,153:  >> decay lr by 0.1
2020-06-07 19:50:10,154:  >> eval_fn= MultiViewAP
2020-06-07 19:50:10,154:  >> patience=4
2020-06-07 19:50:10,154:  >> revert=True
2020-06-07 19:50:10,220: loaded save/MultiViewDataset_IndividualWords.195.pth
2020-06-07 19:50:10,220: note: relative to /home-nfs/ruolinzheng/obj0-phones-edit
2020-06-07 19:50:11,876: loaded save/MultiViewRNN.195.pth
2020-06-07 19:50:11,877: note: relative to /home-nfs/ruolinzheng/obj0-phones-edit
2020-06-07 19:50:15,016: loaded save/Adam.195.pth
2020-06-07 19:50:15,017: note: relative to /home-nfs/ruolinzheng/obj0-phones-edit
2020-06-07 19:50:15,042: loaded save/ReduceLROnPlateau.195.pth
2020-06-07 19:50:15,042: note: relative to /home-nfs/ruolinzheng/obj0-phones-edit
2020-06-07 19:50:15,042: epoch=5.00 global_step=195 lr=0.001 start_iter=0
2020-06-07 19:50:15,042: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 19:52:01,976: 0) loss=0.115 grad_norm=25.90 num_segments=256 num_words=208
2020-06-07 19:53:39,868: 1) loss=0.126 grad_norm=33.30 num_segments=256 num_words=212
2020-06-07 19:55:10,884: 2) loss=0.118 grad_norm=46.73 num_segments=256 num_words=209
2020-06-07 19:56:35,094: 3) loss=0.139 grad_norm=42.56 num_segments=256 num_words=206
2020-06-07 19:57:51,930: 4) loss=0.153 grad_norm=28.41 num_segments=256 num_words=209
2020-06-07 19:59:02,222: 5) loss=0.159 grad_norm=29.52 num_segments=256 num_words=214
2020-06-07 20:00:05,355: 6) loss=0.168 grad_norm=30.39 num_segments=256 num_words=209
2020-06-07 20:01:01,921: 7) loss=0.158 grad_norm=26.14 num_segments=256 num_words=212
2020-06-07 20:01:58,420: 8) loss=0.166 grad_norm=28.31 num_segments=256 num_words=198
2020-06-07 20:02:54,678: 9) loss=0.181 grad_norm=36.60 num_segments=256 num_words=210
2020-06-07 20:03:50,653: 10) loss=0.159 grad_norm=32.27 num_segments=256 num_words=205
2020-06-07 20:04:47,396: 11) loss=0.167 grad_norm=23.66 num_segments=256 num_words=217
2020-06-07 20:05:43,567: 12) loss=0.188 grad_norm=36.92 num_segments=256 num_words=221
2020-06-07 20:06:40,056: 13) loss=0.171 grad_norm=28.45 num_segments=256 num_words=212
2020-06-07 20:07:36,865: 14) loss=0.179 grad_norm=27.56 num_segments=256 num_words=207
2020-06-07 20:08:33,231: 15) loss=0.165 grad_norm=34.45 num_segments=256 num_words=205
2020-06-07 20:09:29,382: 16) loss=0.171 grad_norm=28.65 num_segments=256 num_words=210
2020-06-07 20:10:26,433: 17) loss=0.177 grad_norm=31.98 num_segments=256 num_words=203
2020-06-07 20:11:23,311: 18) loss=0.164 grad_norm=26.36 num_segments=256 num_words=206
2020-06-07 20:12:19,956: 19) loss=0.176 grad_norm=35.08 num_segments=256 num_words=211
2020-06-07 20:13:16,831: 20) loss=0.201 grad_norm=37.35 num_segments=256 num_words=209
2020-06-07 20:14:13,142: 21) loss=0.180 grad_norm=24.94 num_segments=256 num_words=202
2020-06-07 20:15:09,685: 22) loss=0.177 grad_norm=29.68 num_segments=256 num_words=210
2020-06-07 20:16:06,246: 23) loss=0.257 grad_norm=28.40 num_segments=256 num_words=216
2020-06-07 20:17:02,791: 24) loss=0.170 grad_norm=26.82 num_segments=256 num_words=206
2020-06-07 20:17:59,128: 25) loss=0.174 grad_norm=31.81 num_segments=256 num_words=216
2020-06-07 20:18:55,776: 26) loss=0.169 grad_norm=27.96 num_segments=256 num_words=210
2020-06-07 20:19:52,381: 27) loss=0.163 grad_norm=33.02 num_segments=256 num_words=208
2020-06-07 20:20:49,028: 28) loss=0.171 grad_norm=39.78 num_segments=256 num_words=210
2020-06-07 20:21:45,413: 29) loss=0.172 grad_norm=29.74 num_segments=256 num_words=213
2020-06-07 20:22:41,112: 30) loss=0.184 grad_norm=47.07 num_segments=256 num_words=212
2020-06-07 20:23:37,669: 31) loss=0.171 grad_norm=38.04 num_segments=256 num_words=209
2020-06-07 20:24:33,833: 32) loss=0.176 grad_norm=35.77 num_segments=256 num_words=219
2020-06-07 20:25:30,547: 33) loss=0.245 grad_norm=44.82 num_segments=256 num_words=203
2020-06-07 20:26:27,284: 34) loss=0.185 grad_norm=29.32 num_segments=256 num_words=215
2020-06-07 20:27:23,719: 35) loss=0.173 grad_norm=28.43 num_segments=256 num_words=214
2020-06-07 20:28:20,334: 36) loss=0.194 grad_norm=31.45 num_segments=256 num_words=212
2020-06-07 20:29:17,205: 37) loss=0.184 grad_norm=30.41 num_segments=256 num_words=208
2020-06-07 20:30:08,243: 38) loss=0.162 grad_norm=22.04 num_segments=243 num_words=205
2020-06-07 20:30:08,259: epoch= 6.00
2020-06-07 20:30:08,260:  >> time to evaluate and save:
2020-06-07 20:30:08,293: saved save/MultiViewDataset_IndividualWords.234.pth
2020-06-07 20:30:08,295: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 20:30:08,299: saved MultiViewDataset_IndividualWords successfully
2020-06-07 20:30:10,480: saved save/MultiViewRNN.234.pth
2020-06-07 20:30:10,481: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 20:30:11,101: saved MultiViewRNN successfully
2020-06-07 20:30:15,319: saved save/Adam.234.pth
2020-06-07 20:30:15,321: most_recent linked save/Adam.most_recent.pth
2020-06-07 20:30:15,851: saved Adam successfully
2020-06-07 20:30:15,853: saved save/ReduceLROnPlateau.234.pth
2020-06-07 20:30:15,872: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 20:30:15,876: saved ReduceLROnPlateau successfully
2020-06-07 20:30:15,880: saved config successfully
2020-06-07 20:31:45,913:   >> crossview_ap=0.583 (10966 x 3921 pairs)
2020-06-07 20:32:45,097:   >> acoustic_ap=0.597 (10966 choose 2 pairs)
2020-06-07 20:32:45,100: best_so_far= 0.583 at 234
2020-06-07 20:32:45,122: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 20:32:45,124: saved MultiViewDataset_IndividualWords successfully
2020-06-07 20:32:45,126: best linked save/MultiViewRNN.best.pth
2020-06-07 20:32:45,134: saved MultiViewRNN successfully
2020-06-07 20:32:45,135: best linked save/Adam.best.pth
2020-06-07 20:32:45,144: saved Adam successfully
2020-06-07 20:32:45,145: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 20:32:45,148: saved ReduceLROnPlateau successfully
2020-06-07 20:32:45,174: epoch=6.00 global_step=234 lr=0.001 start_iter=0
2020-06-07 20:32:45,174: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 20:33:42,383: 0) loss=0.145 grad_norm=41.20 num_segments=256 num_words=210
2020-06-07 20:34:38,937: 1) loss=0.154 grad_norm=30.82 num_segments=256 num_words=211
2020-06-07 20:35:35,655: 2) loss=0.176 grad_norm=25.72 num_segments=256 num_words=206
2020-06-07 20:36:32,234: 3) loss=0.176 grad_norm=32.30 num_segments=256 num_words=217
2020-06-07 20:37:29,219: 4) loss=0.153 grad_norm=47.23 num_segments=256 num_words=216
2020-06-07 20:38:26,128: 5) loss=0.153 grad_norm=30.00 num_segments=256 num_words=209
2020-06-07 20:39:22,266: 6) loss=0.156 grad_norm=27.41 num_segments=256 num_words=214
2020-06-07 20:40:18,733: 7) loss=0.151 grad_norm=37.69 num_segments=256 num_words=209
2020-06-07 20:41:15,527: 8) loss=0.157 grad_norm=24.25 num_segments=256 num_words=210
2020-06-07 20:42:11,789: 9) loss=0.162 grad_norm=31.00 num_segments=256 num_words=214
2020-06-07 20:43:08,451: 10) loss=0.146 grad_norm=28.36 num_segments=256 num_words=202
2020-06-07 20:44:05,160: 11) loss=0.138 grad_norm=22.58 num_segments=256 num_words=207
2020-06-07 20:45:01,625: 12) loss=0.147 grad_norm=20.37 num_segments=256 num_words=208
2020-06-07 20:45:58,162: 13) loss=0.148 grad_norm=29.01 num_segments=256 num_words=213
2020-06-07 20:46:54,806: 14) loss=0.140 grad_norm=23.86 num_segments=256 num_words=206
2020-06-07 20:47:51,080: 15) loss=0.146 grad_norm=28.99 num_segments=256 num_words=215
2020-06-07 20:48:46,842: 16) loss=0.150 grad_norm=36.81 num_segments=256 num_words=211
2020-06-07 20:49:42,415: 17) loss=0.151 grad_norm=34.12 num_segments=256 num_words=214
2020-06-07 20:50:37,984: 18) loss=0.170 grad_norm=27.49 num_segments=256 num_words=212
2020-06-07 20:51:33,557: 19) loss=0.168 grad_norm=29.87 num_segments=256 num_words=202
2020-06-07 20:52:27,855: 20) loss=0.170 grad_norm=28.52 num_segments=256 num_words=213
2020-06-07 20:53:22,457: 21) loss=0.137 grad_norm=22.54 num_segments=256 num_words=207
2020-06-07 20:54:18,886: 22) loss=0.142 grad_norm=26.70 num_segments=256 num_words=209
2020-06-07 20:55:15,385: 23) loss=0.154 grad_norm=31.49 num_segments=256 num_words=207
2020-06-07 20:56:12,017: 24) loss=0.165 grad_norm=34.37 num_segments=256 num_words=209
2020-06-07 20:57:08,843: 25) loss=0.139 grad_norm=29.02 num_segments=256 num_words=203
2020-06-07 20:58:04,843: 26) loss=0.140 grad_norm=30.68 num_segments=256 num_words=208
2020-06-07 20:59:01,479: 27) loss=0.150 grad_norm=24.76 num_segments=256 num_words=210
2020-06-07 20:59:57,719: 28) loss=0.130 grad_norm=25.15 num_segments=256 num_words=200
2020-06-07 21:00:54,528: 29) loss=0.154 grad_norm=36.39 num_segments=256 num_words=204
2020-06-07 21:01:50,803: 30) loss=0.143 grad_norm=32.40 num_segments=256 num_words=208
2020-06-07 21:02:47,265: 31) loss=0.153 grad_norm=28.62 num_segments=256 num_words=215
2020-06-07 21:03:43,902: 32) loss=0.164 grad_norm=27.55 num_segments=256 num_words=214
2020-06-07 21:04:40,452: 33) loss=0.157 grad_norm=32.18 num_segments=256 num_words=215
2020-06-07 21:05:36,919: 34) loss=0.151 grad_norm=28.27 num_segments=256 num_words=212
2020-06-07 21:06:33,546: 35) loss=0.142 grad_norm=32.91 num_segments=256 num_words=203
2020-06-07 21:07:29,952: 36) loss=0.171 grad_norm=28.08 num_segments=256 num_words=217
2020-06-07 21:08:26,674: 37) loss=0.159 grad_norm=28.58 num_segments=256 num_words=206
2020-06-07 21:09:16,808: 38) loss=0.146 grad_norm=27.50 num_segments=243 num_words=200
2020-06-07 21:09:16,828: epoch= 7.00
2020-06-07 21:09:16,828:  >> time to evaluate and save:
2020-06-07 21:09:16,986: saved save/MultiViewDataset_IndividualWords.273.pth
2020-06-07 21:09:16,988: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 21:09:17,000: removed save/MultiViewDataset_IndividualWords.39.pth
2020-06-07 21:09:17,000: saved MultiViewDataset_IndividualWords successfully
2020-06-07 21:09:19,165: saved save/MultiViewRNN.273.pth
2020-06-07 21:09:19,167: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 21:09:19,329: removed save/MultiViewRNN.39.pth
2020-06-07 21:09:19,330: saved MultiViewRNN successfully
2020-06-07 21:09:23,668: saved save/Adam.273.pth
2020-06-07 21:09:23,705: most_recent linked save/Adam.most_recent.pth
2020-06-07 21:09:23,840: removed save/Adam.39.pth
2020-06-07 21:09:23,840: saved Adam successfully
2020-06-07 21:09:23,913: saved save/ReduceLROnPlateau.273.pth
2020-06-07 21:09:23,915: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 21:09:23,918: saved ReduceLROnPlateau successfully
2020-06-07 21:09:23,921: saved config successfully
2020-06-07 21:10:44,816:   >> crossview_ap=0.587 (10966 x 3921 pairs)
2020-06-07 21:11:46,105:   >> acoustic_ap=0.600 (10966 choose 2 pairs)
2020-06-07 21:11:46,107: best_so_far= 0.587 at 273
2020-06-07 21:11:46,110: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 21:11:46,113: saved MultiViewDataset_IndividualWords successfully
2020-06-07 21:11:46,114: best linked save/MultiViewRNN.best.pth
2020-06-07 21:11:46,122: saved MultiViewRNN successfully
2020-06-07 21:11:46,124: best linked save/Adam.best.pth
2020-06-07 21:11:46,126: saved Adam successfully
2020-06-07 21:11:46,127: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 21:11:46,138: removed save/ReduceLROnPlateau.39.pth
2020-06-07 21:11:46,138: saved ReduceLROnPlateau successfully
2020-06-07 21:11:46,189: epoch=7.00 global_step=273 lr=0.001 start_iter=0
2020-06-07 21:11:46,189: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 21:12:42,591: 0) loss=0.131 grad_norm=25.28 num_segments=256 num_words=202
2020-06-07 21:13:36,822: 1) loss=0.136 grad_norm=23.45 num_segments=256 num_words=217
2020-06-07 21:14:30,879: 2) loss=0.131 grad_norm=19.72 num_segments=256 num_words=212
2020-06-07 21:15:26,699: 3) loss=0.134 grad_norm=35.46 num_segments=256 num_words=211
2020-06-07 21:16:20,841: 4) loss=0.137 grad_norm=28.18 num_segments=256 num_words=207
2020-06-07 21:17:15,204: 5) loss=0.138 grad_norm=27.67 num_segments=256 num_words=208
2020-06-07 21:18:07,918: 6) loss=0.125 grad_norm=26.12 num_segments=256 num_words=208
2020-06-07 21:19:01,584: 7) loss=0.122 grad_norm=31.39 num_segments=256 num_words=207
2020-06-07 21:19:54,369: 8) loss=0.129 grad_norm=21.67 num_segments=256 num_words=218
2020-06-07 21:20:47,742: 9) loss=0.134 grad_norm=37.50 num_segments=256 num_words=215
2020-06-07 21:21:41,086: 10) loss=0.136 grad_norm=35.71 num_segments=256 num_words=207
2020-06-07 21:22:34,284: 11) loss=0.143 grad_norm=24.27 num_segments=256 num_words=210
2020-06-07 21:23:27,419: 12) loss=0.128 grad_norm=30.66 num_segments=256 num_words=217
2020-06-07 21:24:20,872: 13) loss=0.138 grad_norm=32.13 num_segments=256 num_words=209
2020-06-07 21:25:13,845: 14) loss=0.131 grad_norm=29.93 num_segments=256 num_words=209
2020-06-07 21:26:06,538: 15) loss=0.138 grad_norm=40.48 num_segments=256 num_words=218
2020-06-07 21:26:59,586: 16) loss=0.121 grad_norm=27.39 num_segments=256 num_words=205
2020-06-07 21:27:52,363: 17) loss=0.130 grad_norm=24.59 num_segments=256 num_words=213
2020-06-07 21:28:45,582: 18) loss=0.126 grad_norm=24.60 num_segments=256 num_words=214
2020-06-07 21:29:39,004: 19) loss=0.134 grad_norm=36.13 num_segments=256 num_words=208
2020-06-07 21:30:32,450: 20) loss=0.200 grad_norm=27.53 num_segments=256 num_words=206
2020-06-07 21:31:26,062: 21) loss=0.144 grad_norm=26.93 num_segments=256 num_words=211
2020-06-07 21:32:19,343: 22) loss=0.131 grad_norm=26.04 num_segments=256 num_words=206
2020-06-07 21:33:12,835: 23) loss=0.143 grad_norm=29.25 num_segments=256 num_words=214
2020-06-07 21:34:06,745: 24) loss=0.157 grad_norm=30.22 num_segments=256 num_words=221
2020-06-07 21:35:00,134: 25) loss=0.202 grad_norm=20.57 num_segments=256 num_words=207
2020-06-07 21:35:53,277: 26) loss=0.137 grad_norm=30.08 num_segments=256 num_words=207
2020-06-07 21:36:46,609: 27) loss=0.136 grad_norm=28.10 num_segments=256 num_words=216
2020-06-07 21:37:39,322: 28) loss=0.135 grad_norm=23.40 num_segments=256 num_words=225
2020-06-07 21:38:32,535: 29) loss=0.141 grad_norm=25.59 num_segments=256 num_words=210
2020-06-07 21:39:25,783: 30) loss=0.124 grad_norm=27.26 num_segments=256 num_words=213
2020-06-07 21:40:18,522: 31) loss=0.130 grad_norm=33.40 num_segments=256 num_words=219
2020-06-07 21:41:12,099: 32) loss=0.136 grad_norm=20.72 num_segments=256 num_words=204
2020-06-07 21:42:05,271: 33) loss=0.127 grad_norm=24.97 num_segments=256 num_words=199
2020-06-07 21:42:58,121: 34) loss=0.149 grad_norm=27.05 num_segments=256 num_words=216
2020-06-07 21:43:52,103: 35) loss=0.125 grad_norm=21.59 num_segments=256 num_words=212
2020-06-07 21:44:45,418: 36) loss=0.126 grad_norm=28.51 num_segments=256 num_words=211
2020-06-07 21:45:38,856: 37) loss=0.136 grad_norm=30.25 num_segments=256 num_words=221
2020-06-07 21:46:26,763: 38) loss=0.139 grad_norm=29.88 num_segments=243 num_words=211
2020-06-07 21:46:26,778: epoch= 8.00
2020-06-07 21:46:26,778:  >> time to evaluate and save:
2020-06-07 21:46:26,868: saved save/MultiViewDataset_IndividualWords.312.pth
2020-06-07 21:46:26,870: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 21:46:26,881: removed save/MultiViewDataset_IndividualWords.78.pth
2020-06-07 21:46:26,881: saved MultiViewDataset_IndividualWords successfully
2020-06-07 21:46:29,067: saved save/MultiViewRNN.312.pth
2020-06-07 21:46:29,069: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 21:46:29,163: removed save/MultiViewRNN.78.pth
2020-06-07 21:46:29,163: saved MultiViewRNN successfully
2020-06-07 21:46:32,876: saved save/Adam.312.pth
2020-06-07 21:46:32,879: most_recent linked save/Adam.most_recent.pth
2020-06-07 21:46:32,946: removed save/Adam.78.pth
2020-06-07 21:46:32,946: saved Adam successfully
2020-06-07 21:46:32,996: saved save/ReduceLROnPlateau.312.pth
2020-06-07 21:46:33,019: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 21:46:33,023: removed save/ReduceLROnPlateau.78.pth
2020-06-07 21:46:33,024: saved ReduceLROnPlateau successfully
2020-06-07 21:46:33,026: saved config successfully
2020-06-07 21:47:54,011:   >> crossview_ap=0.613 (10966 x 3921 pairs)
2020-06-07 21:48:47,712:   >> acoustic_ap=0.624 (10966 choose 2 pairs)
2020-06-07 21:48:47,717: best_so_far= 0.613 at 312
2020-06-07 21:48:47,721: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 21:48:47,723: saved MultiViewDataset_IndividualWords successfully
2020-06-07 21:48:47,724: best linked save/MultiViewRNN.best.pth
2020-06-07 21:48:47,734: saved MultiViewRNN successfully
2020-06-07 21:48:47,736: best linked save/Adam.best.pth
2020-06-07 21:48:47,740: saved Adam successfully
2020-06-07 21:48:47,741: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 21:48:47,743: saved ReduceLROnPlateau successfully
2020-06-07 21:48:47,786: epoch=8.00 global_step=312 lr=0.001 start_iter=0
2020-06-07 21:48:47,787: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 21:49:42,265: 0) loss=0.129 grad_norm=23.67 num_segments=256 num_words=208
2020-06-07 21:50:35,703: 1) loss=0.113 grad_norm=20.07 num_segments=256 num_words=208
2020-06-07 21:51:28,788: 2) loss=0.128 grad_norm=26.99 num_segments=256 num_words=213
2020-06-07 21:52:23,317: 3) loss=0.139 grad_norm=17.52 num_segments=256 num_words=208
2020-06-07 21:53:16,512: 4) loss=0.125 grad_norm=31.19 num_segments=256 num_words=205
2020-06-07 21:54:10,797: 5) loss=0.128 grad_norm=23.81 num_segments=256 num_words=213
2020-06-07 21:55:03,716: 6) loss=0.141 grad_norm=22.73 num_segments=256 num_words=218
2020-06-07 21:55:56,616: 7) loss=0.134 grad_norm=21.76 num_segments=256 num_words=205
2020-06-07 21:56:50,127: 8) loss=0.109 grad_norm=24.31 num_segments=256 num_words=206
2020-06-07 21:57:43,592: 9) loss=0.119 grad_norm=27.43 num_segments=256 num_words=219
2020-06-07 21:58:37,222: 10) loss=0.112 grad_norm=22.56 num_segments=256 num_words=205
2020-06-07 21:59:30,368: 11) loss=0.127 grad_norm=34.59 num_segments=256 num_words=199
2020-06-07 22:00:23,583: 12) loss=0.153 grad_norm=33.58 num_segments=256 num_words=214
2020-06-07 22:01:16,898: 13) loss=0.126 grad_norm=25.98 num_segments=256 num_words=210
2020-06-07 22:02:10,416: 14) loss=0.117 grad_norm=28.23 num_segments=256 num_words=198
2020-06-07 22:03:03,721: 15) loss=0.124 grad_norm=27.11 num_segments=256 num_words=216
2020-06-07 22:03:57,227: 16) loss=0.125 grad_norm=26.74 num_segments=256 num_words=215
2020-06-07 22:04:50,729: 17) loss=0.143 grad_norm=22.39 num_segments=256 num_words=217
2020-06-07 22:05:44,131: 18) loss=0.122 grad_norm=22.69 num_segments=256 num_words=215
2020-06-07 22:06:37,789: 19) loss=0.122 grad_norm=21.49 num_segments=256 num_words=214
2020-06-07 22:07:30,798: 20) loss=0.187 grad_norm=22.99 num_segments=256 num_words=210
2020-06-07 22:08:23,683: 21) loss=0.159 grad_norm=26.35 num_segments=256 num_words=217
2020-06-07 22:09:16,961: 22) loss=0.121 grad_norm=22.63 num_segments=256 num_words=219
2020-06-07 22:10:10,582: 23) loss=0.138 grad_norm=28.70 num_segments=256 num_words=204
2020-06-07 22:11:03,404: 24) loss=0.158 grad_norm=28.90 num_segments=256 num_words=219
2020-06-07 22:11:56,657: 25) loss=0.134 grad_norm=21.70 num_segments=256 num_words=213
2020-06-07 22:12:50,115: 26) loss=0.125 grad_norm=30.18 num_segments=256 num_words=203
2020-06-07 22:13:43,774: 27) loss=0.138 grad_norm=23.27 num_segments=256 num_words=208
2020-06-07 22:14:37,190: 28) loss=0.119 grad_norm=33.24 num_segments=256 num_words=211
2020-06-07 22:15:30,416: 29) loss=0.122 grad_norm=17.45 num_segments=256 num_words=214
2020-06-07 22:16:23,687: 30) loss=0.122 grad_norm=23.54 num_segments=256 num_words=204
2020-06-07 22:17:17,153: 31) loss=0.118 grad_norm=29.65 num_segments=256 num_words=204
2020-06-07 22:18:10,244: 32) loss=0.126 grad_norm=22.85 num_segments=256 num_words=202
2020-06-07 22:19:03,933: 33) loss=0.115 grad_norm=22.17 num_segments=256 num_words=214
2020-06-07 22:19:57,183: 34) loss=0.137 grad_norm=38.90 num_segments=256 num_words=208
2020-06-07 22:20:50,678: 35) loss=0.200 grad_norm=26.99 num_segments=256 num_words=214
2020-06-07 22:21:43,814: 36) loss=0.118 grad_norm=41.60 num_segments=256 num_words=205
2020-06-07 22:22:36,736: 37) loss=0.108 grad_norm=28.90 num_segments=256 num_words=207
2020-06-07 22:23:24,965: 38) loss=0.210 grad_norm=33.34 num_segments=243 num_words=210
2020-06-07 22:23:24,981: epoch= 9.00
2020-06-07 22:23:24,981:  >> time to evaluate and save:
2020-06-07 22:23:25,431: saved save/MultiViewDataset_IndividualWords.351.pth
2020-06-07 22:23:25,433: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 22:23:25,503: removed save/MultiViewDataset_IndividualWords.117.pth
2020-06-07 22:23:25,503: saved MultiViewDataset_IndividualWords successfully
2020-06-07 22:23:27,737: saved save/MultiViewRNN.351.pth
2020-06-07 22:23:27,739: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 22:23:27,905: removed save/MultiViewRNN.117.pth
2020-06-07 22:23:27,905: saved MultiViewRNN successfully
2020-06-07 22:23:33,070: saved save/Adam.351.pth
2020-06-07 22:23:33,073: most_recent linked save/Adam.most_recent.pth
2020-06-07 22:23:33,290: removed save/Adam.117.pth
2020-06-07 22:23:33,291: saved Adam successfully
2020-06-07 22:23:33,357: saved save/ReduceLROnPlateau.351.pth
2020-06-07 22:23:33,358: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 22:23:33,366: removed save/ReduceLROnPlateau.117.pth
2020-06-07 22:23:33,366: saved ReduceLROnPlateau successfully
2020-06-07 22:23:33,397: saved config successfully
2020-06-07 22:24:58,035:   >> crossview_ap=0.636 (10966 x 3921 pairs)
2020-06-07 22:25:51,589:   >> acoustic_ap=0.677 (10966 choose 2 pairs)
2020-06-07 22:25:51,595: best_so_far= 0.636 at 351
2020-06-07 22:25:51,599: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 22:25:51,601: saved MultiViewDataset_IndividualWords successfully
2020-06-07 22:25:51,603: best linked save/MultiViewRNN.best.pth
2020-06-07 22:25:51,613: saved MultiViewRNN successfully
2020-06-07 22:25:51,615: best linked save/Adam.best.pth
2020-06-07 22:25:51,620: saved Adam successfully
2020-06-07 22:25:51,622: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 22:25:51,626: saved ReduceLROnPlateau successfully
2020-06-07 22:25:51,664: epoch=9.00 global_step=351 lr=0.001 start_iter=0
2020-06-07 22:25:51,664: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 22:26:45,163: 0) loss=0.145 grad_norm=25.54 num_segments=256 num_words=223
2020-06-07 22:27:38,406: 1) loss=0.114 grad_norm=28.11 num_segments=256 num_words=198
2020-06-07 22:28:31,225: 2) loss=0.118 grad_norm=22.88 num_segments=256 num_words=209
2020-06-07 22:29:24,439: 3) loss=0.118 grad_norm=39.21 num_segments=256 num_words=217
2020-06-07 22:30:18,069: 4) loss=0.105 grad_norm=21.88 num_segments=256 num_words=207
2020-06-07 22:31:11,314: 5) loss=0.108 grad_norm=16.04 num_segments=256 num_words=209
2020-06-07 22:32:04,686: 6) loss=0.115 grad_norm=20.53 num_segments=256 num_words=213
2020-06-07 22:32:57,343: 7) loss=0.128 grad_norm=29.18 num_segments=256 num_words=209
2020-06-07 22:33:50,636: 8) loss=0.119 grad_norm=17.77 num_segments=256 num_words=213
2020-06-07 22:34:44,211: 9) loss=0.131 grad_norm=27.82 num_segments=256 num_words=212
2020-06-07 22:35:37,712: 10) loss=0.119 grad_norm=23.80 num_segments=256 num_words=202
2020-06-07 22:36:31,301: 11) loss=0.108 grad_norm=18.70 num_segments=256 num_words=215
2020-06-07 22:37:24,195: 12) loss=0.115 grad_norm=22.62 num_segments=256 num_words=220
2020-06-07 22:38:17,393: 13) loss=0.114 grad_norm=29.54 num_segments=256 num_words=211
2020-06-07 22:39:10,983: 14) loss=0.108 grad_norm=17.74 num_segments=256 num_words=204
2020-06-07 22:40:04,381: 15) loss=0.113 grad_norm=19.73 num_segments=256 num_words=208
2020-06-07 22:40:56,892: 16) loss=0.115 grad_norm=23.49 num_segments=256 num_words=209
2020-06-07 22:41:50,076: 17) loss=0.100 grad_norm=25.71 num_segments=256 num_words=212
2020-06-07 22:42:43,445: 18) loss=0.113 grad_norm=24.91 num_segments=256 num_words=211
2020-06-07 22:43:36,930: 19) loss=0.126 grad_norm=28.06 num_segments=256 num_words=204
2020-06-07 22:44:30,067: 20) loss=0.183 grad_norm=29.03 num_segments=256 num_words=201
2020-06-07 22:45:23,225: 21) loss=0.121 grad_norm=16.13 num_segments=256 num_words=211
2020-06-07 22:46:16,257: 22) loss=0.123 grad_norm=21.23 num_segments=256 num_words=208
2020-06-07 22:47:09,087: 23) loss=0.105 grad_norm=17.16 num_segments=256 num_words=197
2020-06-07 22:48:01,850: 24) loss=0.107 grad_norm=21.27 num_segments=256 num_words=213
2020-06-07 22:48:55,556: 25) loss=0.112 grad_norm=16.84 num_segments=256 num_words=204
2020-06-07 22:49:48,968: 26) loss=0.111 grad_norm=19.98 num_segments=256 num_words=211
2020-06-07 22:50:42,420: 27) loss=0.108 grad_norm=30.10 num_segments=256 num_words=203
2020-06-07 22:51:35,393: 28) loss=0.102 grad_norm=25.77 num_segments=256 num_words=202
2020-06-07 22:52:27,778: 29) loss=0.111 grad_norm=30.07 num_segments=256 num_words=218
2020-06-07 22:53:20,683: 30) loss=0.123 grad_norm=22.56 num_segments=256 num_words=209
2020-06-07 22:54:14,018: 31) loss=0.108 grad_norm=19.09 num_segments=256 num_words=212
2020-06-07 22:55:07,968: 32) loss=0.109 grad_norm=19.80 num_segments=256 num_words=214
2020-06-07 22:56:02,298: 33) loss=0.127 grad_norm=24.75 num_segments=256 num_words=202
2020-06-07 22:56:55,825: 34) loss=0.125 grad_norm=21.30 num_segments=256 num_words=206
2020-06-08 18:31:19,163: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-08 18:31:19,170: Using CPU
2020-06-08 18:31:19,171: Machine: 0 / 1
2020-06-08 18:31:19,172: Hyperparam tuning-------------------
2020-06-08 18:31:19,172: optim_lr: 0.001
2020-06-08 18:31:19,172: dropout (for both): 0.4
2020-06-08 18:31:19,172: margin: 0.4
2020-06-08 18:31:19,172: ------------------------------------
2020-06-08 18:31:19,285: Calling main function: multiview_trainer.train
2020-06-08 18:31:19,286: Using config file: train_config.json
2020-06-08 18:31:19,286: Using module at multiview_trainer.train
2020-06-08 18:31:31,109: Using module at multiview_vocab.MultiViewVocab
2020-06-08 18:31:31,128: Building vocab_data from config
2020-06-08 18:31:31,533:  >> min_count= 0
2020-06-08 18:31:31,534:  >> # words= 34323 (# removed= 0)
2020-06-08 18:31:31,534:  >> # subwords= 45
2020-06-08 18:31:31,534:     [laughter]= 1
2020-06-08 18:31:31,534:     [noise]= 2
2020-06-08 18:31:31,534:     [vocalized-noise]= 3
2020-06-08 18:31:31,534:     aa= 4
2020-06-08 18:31:31,534:     ae= 5
2020-06-08 18:31:31,534:     ah= 6
2020-06-08 18:31:31,535:     ao= 7
2020-06-08 18:31:31,535:     aw= 8
2020-06-08 18:31:31,535:     ax= 9
2020-06-08 18:31:31,535:     ay= 10
2020-06-08 18:31:31,535:     b= 11
2020-06-08 18:31:31,535:     ch= 12
2020-06-08 18:31:31,535:     d= 13
2020-06-08 18:31:31,535:     dh= 14
2020-06-08 18:31:31,535:     eh= 15
2020-06-08 18:31:31,536:     el= 16
2020-06-08 18:31:31,536:     en= 17
2020-06-08 18:31:31,536:     er= 18
2020-06-08 18:31:31,536:     ey= 19
2020-06-08 18:31:31,536:     f= 20
2020-06-08 18:31:31,536:     g= 21
2020-06-08 18:31:31,536:     hh= 22
2020-06-08 18:31:31,536:     ih= 23
2020-06-08 18:31:31,536:     iy= 24
2020-06-08 18:31:31,536:     jh= 25
2020-06-08 18:31:31,536:     k= 26
2020-06-08 18:31:31,537:     l= 27
2020-06-08 18:31:31,537:     m= 28
2020-06-08 18:31:31,537:     n= 29
2020-06-08 18:31:31,537:     ng= 30
2020-06-08 18:31:31,537:     ow= 31
2020-06-08 18:31:31,537:     oy= 32
2020-06-08 18:31:31,537:     p= 33
2020-06-08 18:31:31,537:     r= 34
2020-06-08 18:31:31,537:     s= 35
2020-06-08 18:31:31,537:     sh= 36
2020-06-08 18:31:31,538:     t= 37
2020-06-08 18:31:31,538:     th= 38
2020-06-08 18:31:31,538:     uh= 39
2020-06-08 18:31:31,538:     uw= 40
2020-06-08 18:31:31,538:     v= 41
2020-06-08 18:31:31,538:     w= 42
2020-06-08 18:31:31,538:     y= 43
2020-06-08 18:31:31,538:     z= 44
2020-06-08 18:31:31,538:     zh= 45
2020-06-08 18:31:31,555: Using module at data.batch_samplers.BatchSampler
2020-06-08 18:31:31,561: Building vocab_sampler from config
2020-06-08 18:31:31,561:  >> # examples= 34323
2020-06-08 18:31:31,562:  >> batch_size= 1000
2020-06-08 18:31:31,562:  >> shuffle= False
2020-06-08 18:31:31,571:  >> BatchSampler; 35 batches
2020-06-08 18:31:31,571: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 18:31:34,860: Building train_data from config
2020-06-08 18:31:46,022:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-08 18:31:46,023:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-08 18:31:46,023:  >> stack= False
2020-06-08 18:31:46,023:  >> seg_durs= (1, None)
2020-06-08 18:31:46,023:  >> # words= 9971 (# ignored= 0)
2020-06-08 18:31:46,023:  >> input_feat_dim= 108
2020-06-08 18:31:46,023:  >> input_num_subwords= 45
2020-06-08 18:31:46,023: Using module at data.batch_samplers.BatchSampler
2020-06-08 18:31:46,023: Building train_sampler from config
2020-06-08 18:31:46,024:  >> # examples= 9971
2020-06-08 18:31:46,024:  >> batch_size= 256
2020-06-08 18:31:46,024:  >> shuffle= True
2020-06-08 18:31:46,036:  >> BatchSampler; 39 batches
2020-06-08 18:31:46,036: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 18:31:46,036: Building dev_data from config
2020-06-08 18:31:57,416:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-08 18:31:57,416:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-08 18:31:57,416:  >> stack= False
2020-06-08 18:31:57,416:  >> seg_durs= (1, None)
2020-06-08 18:31:57,416:  >> # words= 10966 (# ignored= 0)
2020-06-08 18:31:57,416:  >> input_feat_dim= 108
2020-06-08 18:31:57,417:  >> input_num_subwords= 45
2020-06-08 18:31:57,417: Using module at data.batch_samplers.BatchSampler
2020-06-08 18:31:57,417: Building dev_sampler from config
2020-06-08 18:31:57,417:  >> # examples= 10966
2020-06-08 18:31:57,418:  >> batch_size= 256
2020-06-08 18:31:57,418:  >> shuffle= False
2020-06-08 18:31:57,421:  >> BatchSampler; 43 batches
2020-06-08 18:31:57,421: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 18:31:57,421: Building test_data from config
2020-06-08 18:32:07,340:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-08 18:32:07,341:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-08 18:32:07,341:  >> stack= False
2020-06-08 18:32:07,341:  >> seg_durs= (1, None)
2020-06-08 18:32:07,341:  >> # words= 11024 (# ignored= 0)
2020-06-08 18:32:07,341:  >> input_feat_dim= 108
2020-06-08 18:32:07,341:  >> input_num_subwords= 45
2020-06-08 18:32:07,341: Using module at data.batch_samplers.BatchSampler
2020-06-08 18:32:07,341: Building test_sampler from config
2020-06-08 18:32:07,342:  >> # examples= 11024
2020-06-08 18:32:07,342:  >> batch_size= 256
2020-06-08 18:32:07,342:  >> shuffle= False
2020-06-08 18:32:07,345:  >> BatchSampler; 44 batches
2020-06-08 18:32:07,345: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-08 18:32:07,544: Building loss from config
2020-06-08 18:32:07,545:  >> margin= 0.4
2020-06-08 18:32:07,545:  >> k= 16
2020-06-08 18:32:07,545:  >> min_k= 8
2020-06-08 18:32:07,545:  >> extra= 0
2020-06-08 18:32:07,546:  >> average= False
2020-06-08 18:32:07,546: Using module at metric.multiview_ap.MultiViewAP
2020-06-08 18:32:09,483: Building eval from config
2020-06-08 18:32:09,484:  >> acoustic_ap= True
2020-06-08 18:32:09,484:  >> crossview_ap= True
2020-06-08 18:32:09,484:  >> full_vocab= False
2020-06-08 18:32:09,484:  >> metric= crossview_ap
2020-06-08 18:32:09,484:  >> mode= max
2020-06-08 18:32:09,484: Using module at multiview_rnn.MultiViewRNN
2020-06-08 18:32:09,524: Building net from config
2020-06-08 18:32:09,525: view1:
2020-06-08 18:32:09,527:  >> cell= GRU
2020-06-08 18:32:09,527:  >> input_size= 108
2020-06-08 18:32:09,527:  >> hidden_size= 512
2020-06-08 18:32:09,527:  >> bidirectional= True
2020-06-08 18:32:09,527:  >> num_layers= 6
2020-06-08 18:32:09,527:  >> dropout between layers= 0.4
2020-06-08 18:32:09,838: view2:
2020-06-08 18:32:09,839:  >> cell= GRU
2020-06-08 18:32:09,839:  >> input_size= 64
2020-06-08 18:32:09,839:  >> hidden_size= 512
2020-06-08 18:32:09,839:  >> bidirectional= True
2020-06-08 18:32:09,839:  >> num_layers= 2
2020-06-08 18:32:09,839:  >> dropout between layers= 0.4
2020-06-08 18:32:09,840:  >> num input embeddings= 45
2020-06-08 18:32:09,927: Using module at optim.adam.Adam
2020-06-08 18:32:09,938: Building optim from config
2020-06-08 18:32:09,938:  >> lr= 0.001
2020-06-08 18:32:09,939:  >> betas= (0.9, 0.999)
2020-06-08 18:32:09,939:  >> eps= 1e-08
2020-06-08 18:32:09,939:  >> weight_decay= 0
2020-06-08 18:32:09,939:  >> amsgrad= False
2020-06-08 18:32:09,939:  >> min_lr= 1e-07
2020-06-08 18:32:09,941: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-08 18:32:09,965: Building sched from config
2020-06-08 18:32:09,965:  >> optim= Adam
2020-06-08 18:32:09,965:  >> decay lr by 0.1
2020-06-08 18:32:09,965:  >> eval_fn= MultiViewAP
2020-06-08 18:32:09,967:  >> patience=4
2020-06-08 18:32:09,967:  >> revert=True
2020-06-08 18:32:09,967: epoch=0.00 global_step=0 lr=0.001 start_iter=0
2020-06-08 18:32:09,967: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-08 18:32:58,510:  >> margin_max= 0.5
2020-06-08 18:32:58,520:  >> threshold_max= 9
2020-06-08 18:46:44,847: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-08 18:46:44,999: Using 1 GPU(s)
2020-06-08 18:46:44,999: Machine: 0 / 1
2020-06-08 18:46:45,001: Hyperparam tuning-------------------
2020-06-08 18:46:45,001: optim_lr: 0.001
2020-06-08 18:46:45,001: dropout (for both): 0.4
2020-06-08 18:46:45,001: margin: 0.4
2020-06-08 18:46:45,001: ------------------------------------
2020-06-08 18:46:45,003: Calling main function: multiview_trainer.train
2020-06-08 18:46:45,003: Using config file: train_config.json
2020-06-08 18:46:45,003: Using module at multiview_trainer.train
2020-06-08 18:46:45,202: Using module at multiview_vocab.MultiViewVocab
2020-06-08 18:46:45,226: Building vocab_data from config
2020-06-08 18:49:04,541: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-08 18:49:04,724: Using 1 GPU(s)
2020-06-08 18:49:04,724: Machine: 0 / 1
2020-06-08 18:49:04,725: Hyperparam tuning-------------------
2020-06-08 18:49:04,725: optim_lr: 0.001
2020-06-08 18:49:04,725: dropout (for both): 0.4
2020-06-08 18:49:04,725: margin: 0.4
2020-06-08 18:49:04,725: ------------------------------------
2020-06-08 18:49:04,727: Calling main function: multiview_trainer.train
2020-06-08 18:49:04,727: Using config file: train_config.json
2020-06-08 18:49:04,727: Using module at multiview_trainer.train
2020-06-08 18:49:04,917: Using module at multiview_vocab.MultiViewVocab
2020-06-08 18:49:04,921: Building vocab_data from config
2020-06-08 18:50:07,714: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-08 18:50:07,894: Using 1 GPU(s)
2020-06-08 18:50:07,895: Machine: 0 / 1
2020-06-08 18:50:07,897: Hyperparam tuning-------------------
2020-06-08 18:50:07,897: optim_lr: 0.001
2020-06-08 18:50:07,897: dropout (for both): 0.4
2020-06-08 18:50:07,897: margin: 0.4
2020-06-08 18:50:07,897: ------------------------------------
2020-06-08 18:50:07,900: Calling main function: multiview_trainer.train
2020-06-08 18:50:07,900: Using config file: train_config.json
2020-06-08 18:50:07,900: Using module at multiview_trainer.train
2020-06-08 18:50:08,142: Using module at multiview_vocab.MultiViewVocab
2020-06-08 18:50:08,145: Building vocab_data from config
2020-06-08 18:50:08,452:  >> min_count= 0
2020-06-08 18:50:08,452:  >> # words= 34323 (# removed= 0)
2020-06-08 18:50:08,452:  >> # subwords= 38
2020-06-08 18:50:08,452:      = 1
2020-06-08 18:50:08,452:     '= 2
2020-06-08 18:50:08,452:     -= 3
2020-06-08 18:50:08,452:     .= 4
2020-06-08 18:50:08,452:     <= 5
2020-06-08 18:50:08,452:     >= 6
2020-06-08 18:50:08,452:     [= 7
2020-06-08 18:50:08,452:     [laughter]= 8
2020-06-08 18:50:08,452:     [noise]= 9
2020-06-08 18:50:08,452:     [vocalized-noise]= 10
2020-06-08 18:50:08,452:     ]= 11
2020-06-08 18:50:08,452:     _= 12
2020-06-08 18:50:08,453:     a= 13
2020-06-08 18:50:08,453:     b= 14
2020-06-08 18:50:08,453:     c= 15
2020-06-08 18:50:08,453:     d= 16
2020-06-08 18:50:08,453:     e= 17
2020-06-08 18:50:08,453:     f= 18
2020-06-08 18:50:08,453:     g= 19
2020-06-08 18:50:08,453:     h= 20
2020-06-08 18:50:08,453:     i= 21
2020-06-08 18:50:08,453:     j= 22
2020-06-08 18:50:08,453:     k= 23
2020-06-08 18:50:08,453:     l= 24
2020-06-08 18:50:08,453:     m= 25
2020-06-08 18:50:08,453:     n= 26
2020-06-08 18:50:08,453:     o= 27
2020-06-08 18:50:08,453:     p= 28
2020-06-08 18:50:08,453:     q= 29
2020-06-08 18:50:08,453:     r= 30
2020-06-08 18:50:08,453:     s= 31
2020-06-08 18:50:08,453:     t= 32
2020-06-08 18:50:08,453:     u= 33
2020-06-08 18:50:08,453:     v= 34
2020-06-08 18:50:08,453:     w= 35
2020-06-08 18:50:08,454:     x= 36
2020-06-08 18:50:08,454:     y= 37
2020-06-08 18:50:08,454:     z= 38
2020-06-08 18:50:08,468: Using module at data.batch_samplers.BatchSampler
2020-06-08 18:50:08,470: Building vocab_sampler from config
2020-06-08 18:50:08,470:  >> # examples= 34323
2020-06-08 18:50:08,470:  >> batch_size= 1000
2020-06-08 18:50:08,470:  >> shuffle= False
2020-06-08 18:50:08,477:  >> BatchSampler; 35 batches
2020-06-08 18:50:08,477: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 18:50:08,543: Building train_data from config
2020-06-08 18:50:14,013:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-08 18:50:14,014:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-08 18:50:14,014:  >> stack= False
2020-06-08 18:50:14,014:  >> seg_durs= (1, None)
2020-06-08 18:50:14,015:  >> # words= 9971 (# ignored= 0)
2020-06-08 18:50:14,015:  >> input_feat_dim= 108
2020-06-08 18:50:14,015:  >> input_num_subwords= 38
2020-06-08 18:50:14,015: Using module at data.batch_samplers.BatchSampler
2020-06-08 18:50:14,015: Building train_sampler from config
2020-06-08 18:50:14,015:  >> # examples= 9971
2020-06-08 18:50:14,016:  >> batch_size= 256
2020-06-08 18:50:14,016:  >> shuffle= True
2020-06-08 18:50:14,021:  >> BatchSampler; 39 batches
2020-06-08 18:50:14,022: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 18:50:14,022: Building dev_data from config
2020-06-08 18:50:20,086:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-08 18:50:20,087:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-08 18:50:20,087:  >> stack= False
2020-06-08 18:50:20,087:  >> seg_durs= (1, None)
2020-06-08 18:50:20,087:  >> # words= 10966 (# ignored= 0)
2020-06-08 18:50:20,087:  >> input_feat_dim= 108
2020-06-08 18:50:20,087:  >> input_num_subwords= 38
2020-06-08 18:50:20,087: Using module at data.batch_samplers.BatchSampler
2020-06-08 18:50:20,087: Building dev_sampler from config
2020-06-08 18:50:20,088:  >> # examples= 10966
2020-06-08 18:50:20,088:  >> batch_size= 256
2020-06-08 18:50:20,088:  >> shuffle= False
2020-06-08 18:50:20,090:  >> BatchSampler; 43 batches
2020-06-08 18:50:20,090: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 18:50:20,090: Building test_data from config
2020-06-08 18:50:25,354:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-08 18:50:25,354:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-08 18:50:25,354:  >> stack= False
2020-06-08 18:50:25,354:  >> seg_durs= (1, None)
2020-06-08 18:50:25,354:  >> # words= 11024 (# ignored= 0)
2020-06-08 18:50:25,354:  >> input_feat_dim= 108
2020-06-08 18:50:25,354:  >> input_num_subwords= 38
2020-06-08 18:50:25,355: Using module at data.batch_samplers.BatchSampler
2020-06-08 18:50:25,355: Building test_sampler from config
2020-06-08 18:50:25,355:  >> # examples= 11024
2020-06-08 18:50:25,355:  >> batch_size= 256
2020-06-08 18:50:25,355:  >> shuffle= False
2020-06-08 18:50:25,357:  >> BatchSampler; 44 batches
2020-06-08 18:50:25,357: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-08 18:50:25,400: Building loss from config
2020-06-08 18:50:25,400:  >> margin= 0.4
2020-06-08 18:50:25,400:  >> k= 16
2020-06-08 18:50:25,400:  >> min_k= 8
2020-06-08 18:50:25,400:  >> extra= 0
2020-06-08 18:50:25,401:  >> average= False
2020-06-08 18:50:25,401:  >> margin_max= 0.5
2020-06-08 18:50:25,401:  >> threshold_max= 9
2020-06-08 18:50:25,401:  >> using obj0
2020-06-08 18:50:25,401: Using module at metric.multiview_ap.MultiViewAP
2020-06-08 18:50:25,478: Building eval from config
2020-06-08 18:50:25,479:  >> acoustic_ap= True
2020-06-08 18:50:25,479:  >> crossview_ap= True
2020-06-08 18:50:25,479:  >> full_vocab= False
2020-06-08 18:50:25,479:  >> metric= crossview_ap
2020-06-08 18:50:25,479:  >> mode= max
2020-06-08 18:50:25,479: Using module at multiview_rnn.MultiViewRNN
2020-06-08 18:50:25,492: Building net from config
2020-06-08 18:50:25,494: view1:
2020-06-08 18:50:25,495:  >> cell= GRU
2020-06-08 18:50:25,495:  >> input_size= 108
2020-06-08 18:50:25,496:  >> hidden_size= 512
2020-06-08 18:50:25,496:  >> bidirectional= True
2020-06-08 18:50:25,496:  >> num_layers= 6
2020-06-08 18:50:25,496:  >> dropout between layers= 0.4
2020-06-08 18:50:25,764: view2:
2020-06-08 18:50:25,765:  >> cell= GRU
2020-06-08 18:50:25,765:  >> input_size= 64
2020-06-08 18:50:25,765:  >> hidden_size= 512
2020-06-08 18:50:25,765:  >> bidirectional= True
2020-06-08 18:50:25,765:  >> num_layers= 2
2020-06-08 18:50:25,765:  >> dropout between layers= 0.4
2020-06-08 18:50:25,765:  >> num input embeddings= 38
2020-06-08 18:50:29,038: Using module at optim.adam.Adam
2020-06-08 18:50:29,042: Building optim from config
2020-06-08 18:50:29,043:  >> lr= 0.001
2020-06-08 18:50:29,043:  >> betas= (0.9, 0.999)
2020-06-08 18:50:29,043:  >> eps= 1e-08
2020-06-08 18:50:29,043:  >> weight_decay= 0
2020-06-08 18:50:29,043:  >> amsgrad= False
2020-06-08 18:50:29,043:  >> min_lr= 1e-07
2020-06-08 18:50:29,044: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-08 18:50:29,058: Building sched from config
2020-06-08 18:50:29,058:  >> optim= Adam
2020-06-08 18:50:29,058:  >> decay lr by 0.1
2020-06-08 18:50:29,058:  >> eval_fn= MultiViewAP
2020-06-08 18:50:29,059:  >> patience=4
2020-06-08 18:50:29,059:  >> revert=True
2020-06-08 18:50:29,059: epoch=0.00 global_step=0 lr=0.001 start_iter=0
2020-06-08 18:50:29,059: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-08 18:52:04,051: 0) loss=0.842 grad_norm=54.08 num_segments=256 num_words=204
2020-06-08 18:53:24,268: 1) loss=0.730 grad_norm=49.66 num_segments=256 num_words=211
2020-06-08 18:54:44,111: 2) loss=0.744 grad_norm=67.05 num_segments=256 num_words=202
2020-06-08 18:55:52,176: 3) loss=0.736 grad_norm=55.84 num_segments=256 num_words=218
2020-06-08 18:56:57,278: 4) loss=0.944 grad_norm=60.13 num_segments=256 num_words=204
2020-06-08 18:57:55,921: 5) loss=0.779 grad_norm=91.01 num_segments=256 num_words=194
2020-06-08 18:58:56,767: 6) loss=0.690 grad_norm=61.29 num_segments=256 num_words=218
2020-06-08 18:59:43,300: 7) loss=0.734 grad_norm=46.56 num_segments=256 num_words=207
2020-06-08 19:00:31,267: 8) loss=0.924 grad_norm=47.49 num_segments=256 num_words=207
2020-06-08 19:01:16,556: 9) loss=0.811 grad_norm=46.56 num_segments=256 num_words=217
2020-06-08 19:02:05,194: 10) loss=0.913 grad_norm=37.19 num_segments=256 num_words=218
2020-06-08 19:02:50,164: 11) loss=0.689 grad_norm=64.02 num_segments=256 num_words=208
2020-06-08 19:03:35,345: 12) loss=0.708 grad_norm=49.27 num_segments=256 num_words=223
2020-06-08 19:04:20,421: 13) loss=1.024 grad_norm=45.47 num_segments=256 num_words=211
2020-06-08 19:05:21,293: 14) loss=0.652 grad_norm=45.30 num_segments=256 num_words=216
2020-06-08 19:06:17,313: 15) loss=0.766 grad_norm=49.46 num_segments=256 num_words=198
2020-06-08 19:07:14,061: 16) loss=0.748 grad_norm=41.01 num_segments=256 num_words=209
2020-06-08 19:08:11,292: 17) loss=1.041 grad_norm=42.02 num_segments=256 num_words=210
2020-06-08 19:09:04,111: 18) loss=0.752 grad_norm=43.17 num_segments=256 num_words=209
2020-06-08 19:10:05,992: 19) loss=0.920 grad_norm=40.17 num_segments=256 num_words=210
2020-06-08 19:11:02,339: 20) loss=0.676 grad_norm=41.08 num_segments=256 num_words=212
2020-06-08 19:11:51,664: 21) loss=0.863 grad_norm=51.17 num_segments=256 num_words=216
2020-06-08 19:12:36,904: 22) loss=0.756 grad_norm=50.49 num_segments=256 num_words=209
2020-06-08 19:13:22,675: 23) loss=0.785 grad_norm=30.26 num_segments=256 num_words=220
2020-06-08 19:14:14,892: 24) loss=0.783 grad_norm=46.75 num_segments=256 num_words=202
2020-06-08 19:15:00,344: 25) loss=0.642 grad_norm=39.03 num_segments=256 num_words=207
2020-06-08 19:15:45,558: 26) loss=0.657 grad_norm=50.43 num_segments=256 num_words=209
2020-06-08 19:16:30,833: 27) loss=0.602 grad_norm=45.81 num_segments=256 num_words=204
2020-06-08 19:17:16,324: 28) loss=0.645 grad_norm=41.92 num_segments=256 num_words=216
2020-06-08 19:18:01,650: 29) loss=0.660 grad_norm=40.74 num_segments=256 num_words=207
2020-06-08 19:18:46,956: 30) loss=0.933 grad_norm=42.05 num_segments=256 num_words=220
2020-06-08 19:19:40,828: 31) loss=0.688 grad_norm=37.40 num_segments=256 num_words=212
2020-06-08 19:20:26,025: 32) loss=0.578 grad_norm=43.27 num_segments=256 num_words=210
2020-06-08 19:21:11,352: 33) loss=0.759 grad_norm=34.84 num_segments=256 num_words=202
2020-06-08 19:21:56,704: 34) loss=0.738 grad_norm=43.44 num_segments=256 num_words=213
2020-06-08 19:22:41,957: 35) loss=0.746 grad_norm=35.20 num_segments=256 num_words=205
2020-06-08 19:23:27,293: 36) loss=0.619 grad_norm=41.10 num_segments=256 num_words=208
2020-06-08 19:24:12,646: 37) loss=0.730 grad_norm=41.81 num_segments=256 num_words=209
2020-06-08 19:24:53,744: 38) loss=0.687 grad_norm=51.26 num_segments=243 num_words=211
2020-06-08 19:24:53,752: epoch= 1.00
2020-06-08 19:24:53,752:  >> time to evaluate and save:
2020-06-08 19:24:53,775: saved save/MultiViewDataset_IndividualWords.39.pth
2020-06-08 19:24:53,776: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-08 19:24:53,777: saved MultiViewDataset_IndividualWords successfully
2020-06-08 19:24:54,210: saved save/MultiViewRNN.39.pth
2020-06-08 19:24:54,212: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-08 19:24:54,213: saved MultiViewRNN successfully
2020-06-08 19:24:55,146: saved save/Adam.39.pth
2020-06-08 19:24:55,147: most_recent linked save/Adam.most_recent.pth
2020-06-08 19:24:55,149: saved Adam successfully
2020-06-08 19:24:55,150: saved save/ReduceLROnPlateau.39.pth
2020-06-08 19:24:55,151: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-08 19:24:55,152: saved ReduceLROnPlateau successfully
2020-06-08 19:24:55,154: saved config successfully
2020-06-08 19:26:35,694:   >> crossview_ap=0.035 (10966 x 3921 pairs)
2020-06-08 19:27:41,439:   >> acoustic_ap=0.072 (10966 choose 2 pairs)
2020-06-08 19:27:41,442: best_so_far= 0.035 at 39
2020-06-08 19:27:41,445: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-08 19:27:41,446: saved MultiViewDataset_IndividualWords successfully
2020-06-08 19:27:41,447: best linked save/MultiViewRNN.best.pth
2020-06-08 19:27:41,448: saved MultiViewRNN successfully
2020-06-08 19:27:41,449: best linked save/Adam.best.pth
2020-06-08 19:27:41,450: saved Adam successfully
2020-06-08 19:27:41,451: best linked save/ReduceLROnPlateau.best.pth
2020-06-08 19:27:41,452: saved ReduceLROnPlateau successfully
2020-06-08 19:27:41,512: epoch=1.00 global_step=39 lr=0.001 start_iter=0
2020-06-08 19:27:41,512: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-08 19:28:29,313: 0) loss=0.675 grad_norm=35.83 num_segments=256 num_words=218
2020-06-08 19:29:27,047: 1) loss=0.790 grad_norm=35.35 num_segments=256 num_words=212
2020-06-08 19:30:12,380: 2) loss=0.641 grad_norm=37.25 num_segments=256 num_words=209
2020-06-08 19:30:57,665: 3) loss=0.702 grad_norm=37.38 num_segments=256 num_words=211
2020-06-08 19:31:43,027: 4) loss=0.823 grad_norm=41.48 num_segments=256 num_words=215
2020-06-08 19:32:28,323: 5) loss=0.742 grad_norm=42.05 num_segments=256 num_words=213
2020-06-08 19:33:13,779: 6) loss=0.664 grad_norm=39.99 num_segments=256 num_words=216
2020-06-08 19:33:59,145: 7) loss=0.697 grad_norm=34.99 num_segments=256 num_words=203
2020-06-08 19:34:44,400: 8) loss=0.753 grad_norm=50.62 num_segments=256 num_words=218
2020-06-08 19:35:29,693: 9) loss=0.580 grad_norm=42.91 num_segments=256 num_words=212
2020-06-08 19:36:14,973: 10) loss=0.691 grad_norm=38.65 num_segments=256 num_words=208
2020-06-08 19:37:00,222: 11) loss=0.653 grad_norm=42.01 num_segments=256 num_words=213
2020-06-08 19:37:59,433: 12) loss=0.600 grad_norm=32.93 num_segments=256 num_words=218
2020-06-08 19:38:44,688: 13) loss=0.610 grad_norm=36.36 num_segments=256 num_words=208
2020-06-08 19:39:30,112: 14) loss=0.618 grad_norm=32.69 num_segments=256 num_words=213
2020-06-08 19:40:15,447: 15) loss=0.622 grad_norm=28.20 num_segments=256 num_words=200
2020-06-08 19:41:00,857: 16) loss=0.590 grad_norm=35.46 num_segments=256 num_words=208
2020-06-08 19:41:46,033: 17) loss=0.548 grad_norm=38.00 num_segments=256 num_words=210
2020-06-08 19:42:31,175: 18) loss=0.682 grad_norm=40.58 num_segments=256 num_words=200
2020-06-08 19:43:16,399: 19) loss=0.849 grad_norm=48.20 num_segments=256 num_words=221
2020-06-08 19:44:01,574: 20) loss=0.631 grad_norm=38.70 num_segments=256 num_words=209
2020-06-08 19:44:46,904: 21) loss=0.540 grad_norm=43.72 num_segments=256 num_words=203
2020-06-08 19:45:32,280: 22) loss=0.663 grad_norm=39.72 num_segments=256 num_words=210
2020-06-08 19:46:22,132: 23) loss=0.628 grad_norm=42.30 num_segments=256 num_words=222
2020-06-08 19:47:18,643: 24) loss=0.728 grad_norm=42.66 num_segments=256 num_words=215
2020-06-08 19:48:15,103: 25) loss=0.540 grad_norm=35.02 num_segments=256 num_words=205
2020-06-08 19:49:28,087: 26) loss=0.571 grad_norm=31.54 num_segments=256 num_words=215
2020-06-08 19:50:24,663: 27) loss=0.722 grad_norm=43.87 num_segments=256 num_words=213
2020-06-08 19:51:20,973: 28) loss=0.646 grad_norm=46.40 num_segments=256 num_words=214
2020-06-08 19:52:17,369: 29) loss=0.631 grad_norm=35.94 num_segments=256 num_words=205
2020-06-08 19:53:13,851: 30) loss=0.756 grad_norm=34.56 num_segments=256 num_words=209
2020-06-08 19:54:10,369: 31) loss=0.696 grad_norm=40.60 num_segments=256 num_words=209
2020-06-08 19:55:06,825: 32) loss=0.706 grad_norm=42.72 num_segments=256 num_words=200
2020-06-08 19:56:03,367: 33) loss=0.890 grad_norm=50.41 num_segments=256 num_words=201
2020-06-08 19:56:59,661: 34) loss=0.661 grad_norm=37.81 num_segments=256 num_words=211
2020-06-08 19:57:56,091: 35) loss=0.563 grad_norm=39.25 num_segments=256 num_words=206
2020-06-08 19:58:52,383: 36) loss=0.661 grad_norm=39.73 num_segments=256 num_words=210
2020-06-08 19:59:48,940: 37) loss=0.595 grad_norm=48.70 num_segments=256 num_words=204
2020-06-08 20:00:30,754: 38) loss=0.718 grad_norm=48.03 num_segments=243 num_words=196
2020-06-08 20:00:30,762: epoch= 2.00
2020-06-08 20:00:30,762:  >> time to evaluate and save:
2020-06-08 20:00:30,790: saved save/MultiViewDataset_IndividualWords.78.pth
2020-06-08 20:00:30,792: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-08 20:00:30,793: saved MultiViewDataset_IndividualWords successfully
2020-06-08 20:00:31,236: saved save/MultiViewRNN.78.pth
2020-06-08 20:00:31,308: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-08 20:00:31,317: saved MultiViewRNN successfully
2020-06-08 20:00:32,325: saved save/Adam.78.pth
2020-06-08 20:00:32,326: most_recent linked save/Adam.most_recent.pth
2020-06-08 20:00:32,331: saved Adam successfully
2020-06-08 20:00:32,333: saved save/ReduceLROnPlateau.78.pth
2020-06-08 20:00:32,335: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-08 20:00:32,338: saved ReduceLROnPlateau successfully
2020-06-08 20:00:32,340: saved config successfully
2020-06-08 20:02:11,330:   >> crossview_ap=0.103 (10966 x 3921 pairs)
2020-06-08 20:03:19,422:   >> acoustic_ap=0.150 (10966 choose 2 pairs)
2020-06-08 20:03:19,428: best_so_far= 0.103 at 78
2020-06-08 20:03:19,481: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-08 20:03:19,484: saved MultiViewDataset_IndividualWords successfully
2020-06-08 20:03:19,485: best linked save/MultiViewRNN.best.pth
2020-06-08 20:03:19,490: saved MultiViewRNN successfully
2020-06-08 20:03:19,492: best linked save/Adam.best.pth
2020-06-08 20:03:19,496: saved Adam successfully
2020-06-08 20:03:19,497: best linked save/ReduceLROnPlateau.best.pth
2020-06-08 20:03:19,500: saved ReduceLROnPlateau successfully
2020-06-08 20:03:19,935: epoch=2.00 global_step=78 lr=0.001 start_iter=0
2020-06-08 20:03:19,935: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-08 20:04:09,335: 0) loss=0.817 grad_norm=64.03 num_segments=256 num_words=199
2020-06-08 20:05:06,169: 1) loss=0.672 grad_norm=51.73 num_segments=256 num_words=217
2020-06-08 20:05:57,918: 2) loss=0.611 grad_norm=53.91 num_segments=256 num_words=208
2020-06-08 20:06:44,047: 3) loss=0.524 grad_norm=80.02 num_segments=256 num_words=209
2020-06-08 20:07:31,362: 4) loss=0.873 grad_norm=43.34 num_segments=256 num_words=210
2020-06-08 20:08:55,037: 5) loss=0.686 grad_norm=52.80 num_segments=256 num_words=208
2020-06-08 20:09:46,236: 6) loss=0.839 grad_norm=53.54 num_segments=256 num_words=212
2020-06-08 20:10:36,054: 7) loss=0.675 grad_norm=35.42 num_segments=256 num_words=218
2020-06-08 20:11:21,478: 8) loss=0.534 grad_norm=39.89 num_segments=256 num_words=210
2020-06-08 20:12:06,732: 9) loss=0.515 grad_norm=45.77 num_segments=256 num_words=217
2020-06-08 20:12:52,223: 10) loss=0.569 grad_norm=38.12 num_segments=256 num_words=208
2020-06-08 20:13:38,675: 11) loss=0.602 grad_norm=37.52 num_segments=256 num_words=197
2020-06-08 20:14:27,780: 12) loss=0.549 grad_norm=40.49 num_segments=256 num_words=219
2020-06-08 20:15:13,182: 13) loss=0.529 grad_norm=56.68 num_segments=256 num_words=200
2020-06-08 20:15:58,617: 14) loss=0.484 grad_norm=48.37 num_segments=256 num_words=212
2020-06-08 20:16:44,033: 15) loss=0.682 grad_norm=53.55 num_segments=256 num_words=211
2020-06-08 20:17:29,597: 16) loss=0.667 grad_norm=49.89 num_segments=256 num_words=209
2020-06-08 20:18:15,145: 17) loss=1.018 grad_norm=37.52 num_segments=256 num_words=218
2020-06-08 20:19:00,633: 18) loss=0.660 grad_norm=39.34 num_segments=256 num_words=214
2020-06-08 20:19:46,270: 19) loss=0.626 grad_norm=50.26 num_segments=256 num_words=206
2020-06-08 20:20:31,726: 20) loss=0.837 grad_norm=33.61 num_segments=256 num_words=209
2020-06-08 20:21:17,112: 21) loss=0.642 grad_norm=32.34 num_segments=256 num_words=212
2020-06-08 20:22:02,484: 22) loss=0.580 grad_norm=58.16 num_segments=256 num_words=212
2020-06-08 20:22:47,898: 23) loss=0.575 grad_norm=41.01 num_segments=256 num_words=217
2020-06-08 20:23:33,554: 24) loss=0.524 grad_norm=34.70 num_segments=256 num_words=214
2020-06-08 20:24:18,968: 25) loss=0.696 grad_norm=47.86 num_segments=256 num_words=227
2020-06-08 20:25:33,267: 26) loss=0.764 grad_norm=33.52 num_segments=256 num_words=202
2020-06-08 20:26:28,986: 27) loss=0.638 grad_norm=31.38 num_segments=256 num_words=206
2020-06-08 20:27:25,639: 28) loss=0.762 grad_norm=32.68 num_segments=256 num_words=210
2020-06-08 20:28:22,179: 29) loss=0.895 grad_norm=41.79 num_segments=256 num_words=206
2020-06-08 20:29:07,859: 30) loss=0.527 grad_norm=38.27 num_segments=256 num_words=210
2020-06-08 20:29:53,353: 31) loss=0.623 grad_norm=51.57 num_segments=256 num_words=219
2020-06-08 20:30:38,825: 32) loss=0.693 grad_norm=40.82 num_segments=256 num_words=216
2020-06-08 20:31:24,260: 33) loss=0.551 grad_norm=39.27 num_segments=256 num_words=221
2020-06-08 20:32:09,753: 34) loss=0.475 grad_norm=35.21 num_segments=256 num_words=199
2020-06-08 20:32:55,216: 35) loss=0.550 grad_norm=38.46 num_segments=256 num_words=206
2020-06-08 20:33:40,531: 36) loss=0.506 grad_norm=52.73 num_segments=256 num_words=210
2020-06-08 20:34:26,075: 37) loss=0.699 grad_norm=42.80 num_segments=256 num_words=212
2020-06-08 20:35:07,213: 38) loss=0.626 grad_norm=41.48 num_segments=243 num_words=200
2020-06-08 20:35:07,221: epoch= 3.00
2020-06-08 20:35:07,221:  >> time to evaluate and save:
2020-06-08 20:35:07,244: saved save/MultiViewDataset_IndividualWords.117.pth
2020-06-08 20:35:07,245: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-08 20:35:07,247: saved MultiViewDataset_IndividualWords successfully
2020-06-08 20:35:07,660: saved save/MultiViewRNN.117.pth
2020-06-08 20:35:07,661: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-08 20:35:07,667: saved MultiViewRNN successfully
2020-06-08 20:35:08,661: saved save/Adam.117.pth
2020-06-08 20:35:08,662: most_recent linked save/Adam.most_recent.pth
2020-06-08 20:35:08,667: saved Adam successfully
2020-06-08 20:35:08,670: saved save/ReduceLROnPlateau.117.pth
2020-06-08 20:35:08,671: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-08 20:35:08,674: saved ReduceLROnPlateau successfully
2020-06-08 20:35:08,675: saved config successfully
2020-06-08 20:36:44,989:   >> crossview_ap=0.201 (10966 x 3921 pairs)
2020-06-08 20:37:51,502:   >> acoustic_ap=0.287 (10966 choose 2 pairs)
2020-06-08 20:37:51,508: best_so_far= 0.201 at 117
2020-06-08 20:37:51,511: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-08 20:37:51,513: saved MultiViewDataset_IndividualWords successfully
2020-06-08 20:37:51,514: best linked save/MultiViewRNN.best.pth
2020-06-08 20:37:51,518: saved MultiViewRNN successfully
2020-06-08 20:37:51,520: best linked save/Adam.best.pth
2020-06-08 20:37:51,523: saved Adam successfully
2020-06-08 20:37:51,524: best linked save/ReduceLROnPlateau.best.pth
2020-06-08 20:37:51,526: saved ReduceLROnPlateau successfully
2020-06-08 20:37:52,066: epoch=3.00 global_step=117 lr=0.001 start_iter=0
2020-06-08 20:37:52,067: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-08 20:38:39,007: 0) loss=0.613 grad_norm=38.94 num_segments=256 num_words=203
2020-06-08 20:39:24,299: 1) loss=0.581 grad_norm=62.52 num_segments=256 num_words=215
2020-06-08 20:40:09,569: 2) loss=0.464 grad_norm=53.42 num_segments=256 num_words=209
2020-06-08 20:40:54,794: 3) loss=0.502 grad_norm=28.99 num_segments=256 num_words=209
2020-06-08 20:41:40,314: 4) loss=0.478 grad_norm=56.60 num_segments=256 num_words=209
2020-06-08 20:42:25,588: 5) loss=0.541 grad_norm=46.62 num_segments=256 num_words=210
2020-06-08 20:43:10,763: 6) loss=0.775 grad_norm=48.62 num_segments=256 num_words=207
2020-06-08 20:43:56,071: 7) loss=0.469 grad_norm=26.84 num_segments=256 num_words=223
2020-06-08 20:44:41,478: 8) loss=0.617 grad_norm=68.29 num_segments=256 num_words=212
2020-06-08 20:45:26,763: 9) loss=0.524 grad_norm=52.61 num_segments=256 num_words=214
2020-06-08 20:46:12,039: 10) loss=0.754 grad_norm=51.26 num_segments=256 num_words=212
2020-06-08 20:46:57,311: 11) loss=0.455 grad_norm=41.05 num_segments=256 num_words=211
2020-06-08 20:47:42,625: 12) loss=0.625 grad_norm=45.45 num_segments=256 num_words=206
2020-06-08 20:48:27,899: 13) loss=0.651 grad_norm=45.23 num_segments=256 num_words=219
2020-06-08 20:49:54,715: 14) loss=0.445 grad_norm=37.02 num_segments=256 num_words=212
2020-06-08 20:50:40,113: 15) loss=0.489 grad_norm=44.52 num_segments=256 num_words=205
2020-06-08 20:51:25,492: 16) loss=0.479 grad_norm=41.75 num_segments=256 num_words=211
2020-06-08 20:52:10,739: 17) loss=0.683 grad_norm=41.94 num_segments=256 num_words=210
2020-06-08 20:52:56,151: 18) loss=0.523 grad_norm=43.18 num_segments=256 num_words=218
2020-06-08 20:53:41,486: 19) loss=0.665 grad_norm=38.49 num_segments=256 num_words=207
2020-06-08 20:54:26,716: 20) loss=0.588 grad_norm=35.15 num_segments=256 num_words=208
2020-06-08 20:55:12,139: 21) loss=0.578 grad_norm=31.58 num_segments=256 num_words=213
2020-06-08 20:55:57,345: 22) loss=0.583 grad_norm=37.12 num_segments=256 num_words=207
2020-06-08 20:56:42,647: 23) loss=0.687 grad_norm=39.61 num_segments=256 num_words=214
2020-06-08 20:57:27,973: 24) loss=0.620 grad_norm=38.33 num_segments=256 num_words=212
2020-06-08 20:58:13,406: 25) loss=0.472 grad_norm=49.56 num_segments=256 num_words=212
2020-06-08 20:58:58,667: 26) loss=0.674 grad_norm=39.22 num_segments=256 num_words=210
2020-06-08 20:59:43,940: 27) loss=0.951 grad_norm=48.19 num_segments=256 num_words=209
2020-06-08 21:00:29,184: 28) loss=0.523 grad_norm=33.20 num_segments=256 num_words=213
2020-06-08 21:01:14,501: 29) loss=0.550 grad_norm=47.97 num_segments=256 num_words=218
2020-06-08 21:01:59,789: 30) loss=0.667 grad_norm=34.52 num_segments=256 num_words=199
2020-06-08 21:02:45,172: 31) loss=0.538 grad_norm=38.14 num_segments=256 num_words=202
2020-06-08 21:03:30,699: 32) loss=0.610 grad_norm=36.71 num_segments=256 num_words=210
2020-06-08 21:04:15,958: 33) loss=0.569 grad_norm=24.03 num_segments=256 num_words=213
2020-06-08 21:05:01,506: 34) loss=0.431 grad_norm=28.36 num_segments=256 num_words=208
2020-06-08 21:05:46,844: 35) loss=0.626 grad_norm=36.61 num_segments=256 num_words=203
2020-06-08 21:06:32,191: 36) loss=0.725 grad_norm=28.25 num_segments=256 num_words=213
2020-06-08 21:07:17,531: 37) loss=0.455 grad_norm=35.69 num_segments=256 num_words=195
2020-06-08 21:07:58,437: 38) loss=0.459 grad_norm=30.82 num_segments=243 num_words=203
2020-06-08 21:07:58,445: epoch= 4.00
2020-06-08 21:07:58,445:  >> time to evaluate and save:
2020-06-08 21:07:58,468: saved save/MultiViewDataset_IndividualWords.156.pth
2020-06-08 21:07:58,470: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-08 21:07:58,472: saved MultiViewDataset_IndividualWords successfully
2020-06-08 21:07:58,895: saved save/MultiViewRNN.156.pth
2020-06-08 21:07:58,897: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-08 21:07:58,904: saved MultiViewRNN successfully
2020-06-08 21:07:59,886: saved save/Adam.156.pth
2020-06-08 21:07:59,888: most_recent linked save/Adam.most_recent.pth
2020-06-08 21:07:59,894: saved Adam successfully
2020-06-08 21:07:59,896: saved save/ReduceLROnPlateau.156.pth
2020-06-08 21:07:59,898: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-08 21:07:59,900: saved ReduceLROnPlateau successfully
2020-06-08 21:07:59,902: saved config successfully
2020-06-08 21:09:37,097:   >> crossview_ap=0.283 (10966 x 3921 pairs)
2020-06-08 21:10:43,532:   >> acoustic_ap=0.326 (10966 choose 2 pairs)
2020-06-08 21:10:43,538: best_so_far= 0.283 at 156
2020-06-08 21:10:43,541: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-08 21:10:43,543: saved MultiViewDataset_IndividualWords successfully
2020-06-08 21:10:43,544: best linked save/MultiViewRNN.best.pth
2020-06-08 21:10:43,551: saved MultiViewRNN successfully
2020-06-08 21:10:43,552: best linked save/Adam.best.pth
2020-06-08 21:10:43,557: saved Adam successfully
2020-06-08 21:10:43,558: best linked save/ReduceLROnPlateau.best.pth
2020-06-08 21:10:43,560: saved ReduceLROnPlateau successfully
2020-06-08 21:10:44,576: epoch=4.00 global_step=156 lr=0.001 start_iter=0
2020-06-08 21:10:44,576: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-08 21:11:32,334: 0) loss=0.427 grad_norm=29.90 num_segments=256 num_words=204
2020-06-08 21:12:17,970: 1) loss=0.581 grad_norm=24.87 num_segments=256 num_words=215
2020-06-08 21:13:03,672: 2) loss=0.726 grad_norm=45.87 num_segments=256 num_words=214
2020-06-08 21:13:49,328: 3) loss=0.545 grad_norm=38.10 num_segments=256 num_words=203
2020-06-08 21:14:35,139: 4) loss=0.546 grad_norm=37.37 num_segments=256 num_words=216
2020-06-08 21:15:20,999: 5) loss=0.634 grad_norm=27.04 num_segments=256 num_words=212
2020-06-08 21:16:06,730: 6) loss=0.506 grad_norm=31.49 num_segments=256 num_words=206
2020-06-08 21:16:52,416: 7) loss=0.571 grad_norm=31.61 num_segments=256 num_words=205
2020-06-08 21:17:38,068: 8) loss=0.465 grad_norm=40.60 num_segments=256 num_words=213
2020-06-08 21:19:16,290: 9) loss=0.525 grad_norm=40.20 num_segments=256 num_words=219
2020-06-08 21:20:02,152: 10) loss=0.448 grad_norm=35.23 num_segments=256 num_words=217
2020-06-08 21:20:52,438: 11) loss=0.572 grad_norm=34.65 num_segments=256 num_words=214
2020-06-08 21:21:41,925: 12) loss=0.799 grad_norm=45.02 num_segments=256 num_words=207
2020-06-08 21:22:31,677: 13) loss=0.552 grad_norm=42.33 num_segments=256 num_words=210
2020-06-08 21:23:21,229: 14) loss=0.472 grad_norm=41.27 num_segments=256 num_words=204
2020-06-08 21:24:10,997: 15) loss=0.438 grad_norm=38.62 num_segments=256 num_words=211
2020-06-08 21:25:00,602: 16) loss=0.463 grad_norm=37.76 num_segments=256 num_words=201
2020-06-08 21:25:50,235: 17) loss=0.474 grad_norm=35.17 num_segments=256 num_words=210
2020-06-08 21:26:39,944: 18) loss=0.450 grad_norm=28.72 num_segments=256 num_words=217
2020-06-08 21:27:29,972: 19) loss=0.738 grad_norm=44.33 num_segments=256 num_words=212
2020-06-08 21:28:19,655: 20) loss=0.492 grad_norm=32.03 num_segments=256 num_words=194
2020-06-08 21:29:09,368: 21) loss=0.404 grad_norm=37.01 num_segments=256 num_words=203
2020-06-08 21:29:59,228: 22) loss=0.552 grad_norm=30.34 num_segments=256 num_words=219
2020-06-08 21:30:48,889: 23) loss=0.579 grad_norm=26.02 num_segments=256 num_words=207
2020-06-08 21:31:38,383: 24) loss=0.484 grad_norm=28.05 num_segments=256 num_words=196
2020-06-08 21:32:28,165: 25) loss=0.469 grad_norm=37.45 num_segments=256 num_words=220
2020-06-08 21:33:17,817: 26) loss=0.479 grad_norm=31.81 num_segments=256 num_words=213
2020-06-08 21:34:07,475: 27) loss=0.392 grad_norm=38.02 num_segments=256 num_words=214
2020-06-08 21:34:57,383: 28) loss=0.667 grad_norm=26.89 num_segments=256 num_words=207
2020-06-08 21:35:47,085: 29) loss=0.776 grad_norm=39.90 num_segments=256 num_words=210
2020-06-08 21:36:37,065: 30) loss=0.410 grad_norm=35.12 num_segments=256 num_words=208
2020-06-08 21:37:26,905: 31) loss=0.584 grad_norm=38.06 num_segments=256 num_words=216
2020-06-08 21:38:16,649: 32) loss=0.507 grad_norm=37.28 num_segments=256 num_words=202
2020-06-08 21:39:06,210: 33) loss=0.575 grad_norm=37.35 num_segments=256 num_words=220
2020-06-08 21:39:55,759: 34) loss=0.422 grad_norm=42.22 num_segments=256 num_words=218
2020-06-08 21:40:45,368: 35) loss=0.568 grad_norm=44.36 num_segments=256 num_words=213
2020-06-08 21:41:34,949: 36) loss=0.426 grad_norm=45.90 num_segments=256 num_words=205
2020-06-08 21:42:24,687: 37) loss=0.560 grad_norm=37.01 num_segments=256 num_words=204
2020-06-08 21:43:09,632: 38) loss=0.663 grad_norm=38.99 num_segments=243 num_words=206
2020-06-08 21:43:09,640: epoch= 5.00
2020-06-08 21:43:09,641:  >> time to evaluate and save:
2020-06-08 21:43:09,667: saved save/MultiViewDataset_IndividualWords.195.pth
2020-06-08 21:43:09,668: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-08 21:43:09,670: saved MultiViewDataset_IndividualWords successfully
2020-06-08 21:43:10,145: saved save/MultiViewRNN.195.pth
2020-06-08 21:43:10,147: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-08 21:43:10,153: saved MultiViewRNN successfully
2020-06-08 21:43:11,162: saved save/Adam.195.pth
2020-06-08 21:43:11,164: most_recent linked save/Adam.most_recent.pth
2020-06-08 21:43:11,169: saved Adam successfully
2020-06-08 21:43:11,171: saved save/ReduceLROnPlateau.195.pth
2020-06-08 21:43:11,173: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-08 21:43:11,175: saved ReduceLROnPlateau successfully
2020-06-08 21:43:11,177: saved config successfully
2020-06-08 21:44:57,047:   >> crossview_ap=0.363 (10966 x 3921 pairs)
2020-06-08 21:46:16,591:   >> acoustic_ap=0.448 (10966 choose 2 pairs)
2020-06-08 21:46:16,595: best_so_far= 0.363 at 195
2020-06-08 21:46:16,598: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-08 21:46:16,600: saved MultiViewDataset_IndividualWords successfully
2020-06-08 21:46:16,602: best linked save/MultiViewRNN.best.pth
2020-06-08 21:46:16,611: saved MultiViewRNN successfully
2020-06-08 21:46:16,613: best linked save/Adam.best.pth
2020-06-08 21:46:16,619: saved Adam successfully
2020-06-08 21:46:16,620: best linked save/ReduceLROnPlateau.best.pth
2020-06-08 21:46:16,622: saved ReduceLROnPlateau successfully
2020-06-08 21:46:17,773: epoch=5.00 global_step=195 lr=0.001 start_iter=0
2020-06-08 21:46:17,774: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-08 21:47:09,731: 0) loss=0.542 grad_norm=36.25 num_segments=256 num_words=208
2020-06-08 21:47:59,271: 1) loss=0.450 grad_norm=31.49 num_segments=256 num_words=212
2020-06-08 21:48:48,877: 2) loss=0.431 grad_norm=49.57 num_segments=256 num_words=209
2020-06-08 21:49:38,609: 3) loss=0.392 grad_norm=37.62 num_segments=256 num_words=206
2020-06-08 21:50:28,191: 4) loss=0.457 grad_norm=33.51 num_segments=256 num_words=209
2020-06-08 21:51:18,126: 5) loss=0.568 grad_norm=38.70 num_segments=256 num_words=214
2020-06-08 21:52:07,760: 6) loss=0.440 grad_norm=29.30 num_segments=256 num_words=209
2020-06-08 21:52:57,358: 7) loss=0.473 grad_norm=29.80 num_segments=256 num_words=212
2020-06-08 21:53:47,002: 8) loss=0.599 grad_norm=34.54 num_segments=256 num_words=198
2020-06-08 21:54:36,641: 9) loss=0.493 grad_norm=25.36 num_segments=256 num_words=210
2020-06-08 21:55:26,572: 10) loss=0.418 grad_norm=34.60 num_segments=256 num_words=205
2020-06-08 21:56:16,204: 11) loss=0.733 grad_norm=25.69 num_segments=256 num_words=217
2020-06-08 21:58:13,919: 12) loss=0.438 grad_norm=41.74 num_segments=256 num_words=221
2020-06-08 21:59:03,668: 13) loss=0.486 grad_norm=34.68 num_segments=256 num_words=212
2020-06-08 21:59:53,716: 14) loss=0.497 grad_norm=29.83 num_segments=256 num_words=207
2020-06-08 22:00:43,615: 15) loss=0.569 grad_norm=40.57 num_segments=256 num_words=205
2020-06-08 22:01:33,712: 16) loss=0.451 grad_norm=35.43 num_segments=256 num_words=210
2020-06-08 22:02:23,689: 17) loss=0.375 grad_norm=30.13 num_segments=256 num_words=203
2020-06-08 22:03:13,863: 18) loss=0.463 grad_norm=26.91 num_segments=256 num_words=206
2020-06-08 22:04:03,770: 19) loss=0.446 grad_norm=33.87 num_segments=256 num_words=211
2020-06-08 22:04:53,542: 20) loss=0.503 grad_norm=33.08 num_segments=256 num_words=209
2020-06-08 22:05:43,662: 21) loss=0.498 grad_norm=29.58 num_segments=256 num_words=202
2020-06-08 22:06:33,815: 22) loss=0.442 grad_norm=33.16 num_segments=256 num_words=210
2020-06-08 22:07:23,929: 23) loss=0.760 grad_norm=33.75 num_segments=256 num_words=216
2020-06-08 22:08:14,088: 24) loss=0.453 grad_norm=29.96 num_segments=256 num_words=206
2020-06-08 22:09:04,535: 25) loss=0.717 grad_norm=35.86 num_segments=256 num_words=216
2020-06-08 22:09:54,741: 26) loss=0.429 grad_norm=28.75 num_segments=256 num_words=210
2020-06-08 22:10:45,194: 27) loss=0.413 grad_norm=31.77 num_segments=256 num_words=208
2020-06-08 22:11:35,645: 28) loss=0.456 grad_norm=48.07 num_segments=256 num_words=210
2020-06-08 22:12:25,795: 29) loss=0.360 grad_norm=38.36 num_segments=256 num_words=213
2020-06-08 22:13:15,891: 30) loss=0.673 grad_norm=43.31 num_segments=256 num_words=212
2020-06-08 22:14:05,998: 31) loss=0.390 grad_norm=49.13 num_segments=256 num_words=209
2020-06-08 22:14:56,374: 32) loss=0.655 grad_norm=32.54 num_segments=256 num_words=219
2020-06-08 22:15:46,581: 33) loss=0.395 grad_norm=60.68 num_segments=256 num_words=203
2020-06-08 22:16:36,797: 34) loss=0.529 grad_norm=45.52 num_segments=256 num_words=215
2020-06-08 22:17:27,047: 35) loss=0.391 grad_norm=33.70 num_segments=256 num_words=214
2020-06-08 22:18:17,219: 36) loss=0.506 grad_norm=39.36 num_segments=256 num_words=212
2020-06-08 22:19:07,734: 37) loss=0.486 grad_norm=43.67 num_segments=256 num_words=208
2020-06-08 22:19:53,090: 38) loss=0.388 grad_norm=40.89 num_segments=243 num_words=205
2020-06-08 22:19:53,098: epoch= 6.00
2020-06-08 22:19:53,099:  >> time to evaluate and save:
2020-06-08 22:19:53,124: saved save/MultiViewDataset_IndividualWords.234.pth
2020-06-08 22:19:53,126: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-08 22:19:53,128: saved MultiViewDataset_IndividualWords successfully
2020-06-08 22:19:53,691: saved save/MultiViewRNN.234.pth
2020-06-08 22:19:53,742: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-08 22:19:53,751: saved MultiViewRNN successfully
2020-06-08 22:19:54,692: saved save/Adam.234.pth
2020-06-08 22:19:54,694: most_recent linked save/Adam.most_recent.pth
2020-06-08 22:19:54,700: saved Adam successfully
2020-06-08 22:19:54,703: saved save/ReduceLROnPlateau.234.pth
2020-06-08 22:19:54,704: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-08 22:19:54,707: saved ReduceLROnPlateau successfully
2020-06-08 22:19:54,709: saved config successfully
2020-06-08 22:21:56,234:   >> crossview_ap=0.421 (10966 x 3921 pairs)
2020-06-08 22:23:36,655:   >> acoustic_ap=0.509 (10966 choose 2 pairs)
2020-06-08 22:23:36,661: best_so_far= 0.421 at 234
2020-06-08 22:23:36,664: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-08 22:23:36,666: saved MultiViewDataset_IndividualWords successfully
2020-06-08 22:23:36,667: best linked save/MultiViewRNN.best.pth
2020-06-08 22:23:36,676: saved MultiViewRNN successfully
2020-06-08 22:23:36,677: best linked save/Adam.best.pth
2020-06-08 22:23:36,685: saved Adam successfully
2020-06-08 22:23:36,686: best linked save/ReduceLROnPlateau.best.pth
2020-06-08 22:23:36,688: saved ReduceLROnPlateau successfully
2020-06-08 22:23:38,249: epoch=6.00 global_step=234 lr=0.001 start_iter=0
2020-06-08 22:23:38,250: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-08 22:24:35,705: 0) loss=0.460 grad_norm=43.22 num_segments=256 num_words=217
2020-06-08 22:25:26,705: 1) loss=0.550 grad_norm=62.29 num_segments=256 num_words=211
2020-06-08 22:26:17,183: 2) loss=0.381 grad_norm=41.10 num_segments=256 num_words=218
2020-06-08 22:27:07,682: 3) loss=0.725 grad_norm=32.35 num_segments=256 num_words=214
2020-06-08 22:27:58,136: 4) loss=0.476 grad_norm=48.47 num_segments=256 num_words=206
2020-06-08 22:28:48,394: 5) loss=0.539 grad_norm=59.00 num_segments=256 num_words=217
2020-06-08 22:29:38,590: 6) loss=0.429 grad_norm=33.85 num_segments=256 num_words=217
2020-06-08 22:30:28,881: 7) loss=0.393 grad_norm=34.59 num_segments=256 num_words=209
2020-06-08 22:31:19,225: 8) loss=0.438 grad_norm=24.43 num_segments=256 num_words=210
2020-06-08 22:32:09,495: 9) loss=0.454 grad_norm=29.23 num_segments=256 num_words=208
2020-06-08 22:32:59,678: 10) loss=0.329 grad_norm=34.78 num_segments=256 num_words=212
2020-06-08 22:33:49,783: 11) loss=0.496 grad_norm=38.12 num_segments=256 num_words=208
2020-06-08 22:34:39,931: 12) loss=0.499 grad_norm=28.93 num_segments=256 num_words=206
2020-06-08 22:35:30,132: 13) loss=0.493 grad_norm=26.69 num_segments=256 num_words=211
2020-06-08 22:36:20,381: 14) loss=0.451 grad_norm=25.28 num_segments=256 num_words=208
2020-06-08 22:37:10,665: 15) loss=0.456 grad_norm=31.22 num_segments=256 num_words=218
2020-06-08 22:38:04,431: 16) loss=0.707 grad_norm=31.77 num_segments=256 num_words=217
2020-06-08 22:39:06,758: 17) loss=0.477 grad_norm=28.61 num_segments=256 num_words=204
2020-06-08 22:40:00,607: 18) loss=0.645 grad_norm=35.52 num_segments=256 num_words=205
2020-06-08 22:40:50,957: 19) loss=0.655 grad_norm=27.41 num_segments=256 num_words=227
2020-06-08 22:41:41,395: 20) loss=0.423 grad_norm=32.28 num_segments=256 num_words=207
2020-06-08 22:42:31,701: 21) loss=0.403 grad_norm=28.38 num_segments=256 num_words=207
2020-06-08 22:43:21,798: 22) loss=0.362 grad_norm=28.84 num_segments=256 num_words=211
2020-06-08 22:44:12,116: 23) loss=0.420 grad_norm=29.31 num_segments=256 num_words=205
2020-06-08 22:45:02,232: 24) loss=0.750 grad_norm=39.84 num_segments=256 num_words=199
2020-06-08 22:45:52,357: 25) loss=0.402 grad_norm=26.60 num_segments=256 num_words=215
2020-06-08 22:48:38,826: 26) loss=0.449 grad_norm=31.17 num_segments=256 num_words=213
2020-06-08 22:49:29,439: 27) loss=0.413 grad_norm=26.01 num_segments=256 num_words=195
2020-06-08 22:50:19,957: 28) loss=0.517 grad_norm=27.23 num_segments=256 num_words=206
2020-06-08 23:09:31,925: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-08 23:09:32,096: Using 1 GPU(s)
2020-06-08 23:09:32,097: Machine: 0 / 1
2020-06-08 23:09:32,100: Hyperparam tuning-------------------
2020-06-08 23:09:32,100: optim_lr: 0.001
2020-06-08 23:09:32,100: dropout (for both): 0.4
2020-06-08 23:09:32,100: margin: 0.4
2020-06-08 23:09:32,100: ------------------------------------
2020-06-08 23:09:32,104: Calling main function: multiview_trainer.train
2020-06-08 23:09:32,104: Using config file: train_config.json
2020-06-08 23:09:32,104: Using module at multiview_trainer.train
2020-06-08 23:09:33,645: Using module at multiview_vocab.MultiViewVocab
2020-06-08 23:09:33,650: Building vocab_data from config
2020-06-08 23:09:33,980:  >> min_count= 0
2020-06-08 23:09:33,981:  >> # words= 34323 (# removed= 0)
2020-06-08 23:09:33,981:  >> # subwords= 38
2020-06-08 23:09:33,981:      = 1
2020-06-08 23:09:33,981:     '= 2
2020-06-08 23:09:33,981:     -= 3
2020-06-08 23:09:33,981:     .= 4
2020-06-08 23:09:33,981:     <= 5
2020-06-08 23:09:33,981:     >= 6
2020-06-08 23:09:33,981:     [= 7
2020-06-08 23:09:33,981:     [laughter]= 8
2020-06-08 23:09:33,981:     [noise]= 9
2020-06-08 23:09:33,981:     [vocalized-noise]= 10
2020-06-08 23:09:33,981:     ]= 11
2020-06-08 23:09:33,981:     _= 12
2020-06-08 23:09:33,981:     a= 13
2020-06-08 23:09:33,981:     b= 14
2020-06-08 23:09:33,981:     c= 15
2020-06-08 23:09:33,981:     d= 16
2020-06-08 23:09:33,982:     e= 17
2020-06-08 23:09:33,982:     f= 18
2020-06-08 23:09:33,982:     g= 19
2020-06-08 23:09:33,982:     h= 20
2020-06-08 23:09:33,982:     i= 21
2020-06-08 23:09:33,982:     j= 22
2020-06-08 23:09:33,982:     k= 23
2020-06-08 23:09:33,982:     l= 24
2020-06-08 23:09:33,982:     m= 25
2020-06-08 23:09:33,982:     n= 26
2020-06-08 23:09:33,982:     o= 27
2020-06-08 23:09:33,982:     p= 28
2020-06-08 23:09:33,982:     q= 29
2020-06-08 23:09:33,982:     r= 30
2020-06-08 23:09:33,982:     s= 31
2020-06-08 23:09:33,982:     t= 32
2020-06-08 23:09:33,982:     u= 33
2020-06-08 23:09:33,982:     v= 34
2020-06-08 23:09:33,982:     w= 35
2020-06-08 23:09:33,982:     x= 36
2020-06-08 23:09:33,982:     y= 37
2020-06-08 23:09:33,982:     z= 38
2020-06-08 23:09:34,000: Using module at data.batch_samplers.BatchSampler
2020-06-08 23:09:34,001: Building vocab_sampler from config
2020-06-08 23:09:34,001:  >> # examples= 34323
2020-06-08 23:09:34,001:  >> batch_size= 1000
2020-06-08 23:09:34,001:  >> shuffle= False
2020-06-08 23:09:34,008:  >> BatchSampler; 35 batches
2020-06-08 23:09:34,008: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 23:09:34,299: Building train_data from config
2020-06-08 23:09:40,474:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-08 23:09:40,474:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-08 23:09:40,474:  >> stack= False
2020-06-08 23:09:40,474:  >> seg_durs= (1, None)
2020-06-08 23:09:40,474:  >> # words= 9971 (# ignored= 0)
2020-06-08 23:09:40,475:  >> input_feat_dim= 108
2020-06-08 23:09:40,475:  >> input_num_subwords= 38
2020-06-08 23:09:40,475: Using module at data.batch_samplers.BatchSampler
2020-06-08 23:09:40,475: Building train_sampler from config
2020-06-08 23:09:40,476:  >> # examples= 9971
2020-06-08 23:09:40,476:  >> batch_size= 256
2020-06-08 23:09:40,476:  >> shuffle= True
2020-06-08 23:09:40,483:  >> BatchSampler; 39 batches
2020-06-08 23:09:40,483: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 23:09:40,483: Building dev_data from config
2020-06-08 23:09:48,071:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-08 23:09:48,072:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-08 23:09:48,072:  >> stack= False
2020-06-08 23:09:48,072:  >> seg_durs= (1, None)
2020-06-08 23:09:48,072:  >> # words= 10966 (# ignored= 0)
2020-06-08 23:09:48,072:  >> input_feat_dim= 108
2020-06-08 23:09:48,072:  >> input_num_subwords= 38
2020-06-08 23:09:48,072: Using module at data.batch_samplers.BatchSampler
2020-06-08 23:09:48,072: Building dev_sampler from config
2020-06-08 23:09:48,073:  >> # examples= 10966
2020-06-08 23:09:48,073:  >> batch_size= 256
2020-06-08 23:09:48,073:  >> shuffle= False
2020-06-08 23:09:48,076:  >> BatchSampler; 43 batches
2020-06-08 23:09:48,076: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 23:09:48,076: Building test_data from config
2020-06-08 23:09:54,133:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-08 23:09:54,134:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-08 23:09:54,134:  >> stack= False
2020-06-08 23:09:54,134:  >> seg_durs= (1, None)
2020-06-08 23:09:54,134:  >> # words= 11024 (# ignored= 0)
2020-06-08 23:09:54,134:  >> input_feat_dim= 108
2020-06-08 23:09:54,134:  >> input_num_subwords= 38
2020-06-08 23:09:54,134: Using module at data.batch_samplers.BatchSampler
2020-06-08 23:09:54,134: Building test_sampler from config
2020-06-08 23:09:54,135:  >> # examples= 11024
2020-06-08 23:09:54,135:  >> batch_size= 256
2020-06-08 23:09:54,135:  >> shuffle= False
2020-06-08 23:09:54,138:  >> BatchSampler; 44 batches
2020-06-08 23:09:54,138: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-08 23:09:54,164: Building loss from config
2020-06-08 23:09:54,165:  >> margin= 0.4
2020-06-08 23:09:54,166:  >> k= 16
2020-06-08 23:09:54,166:  >> min_k= 8
2020-06-08 23:09:54,166:  >> extra= 0
2020-06-08 23:09:54,166:  >> average= False
2020-06-08 23:09:54,166:  >> margin_max= 0.5
2020-06-08 23:09:54,166:  >> threshold_max= 9
2020-06-08 23:09:54,166:  >> using obj0
2020-06-08 23:09:54,167: Using module at metric.multiview_ap.MultiViewAP
2020-06-08 23:09:54,220: Building eval from config
2020-06-08 23:09:54,221:  >> acoustic_ap= True
2020-06-08 23:09:54,221:  >> crossview_ap= True
2020-06-08 23:09:54,221:  >> full_vocab= False
2020-06-08 23:09:54,221:  >> metric= crossview_ap
2020-06-08 23:09:54,221:  >> mode= max
2020-06-08 23:09:54,221: Using module at multiview_rnn.MultiViewRNN
2020-06-08 23:09:54,227: Building net from config
2020-06-08 23:09:54,229: view1:
2020-06-08 23:09:54,230:  >> cell= GRU
2020-06-08 23:09:54,230:  >> input_size= 108
2020-06-08 23:09:54,230:  >> hidden_size= 512
2020-06-08 23:09:54,230:  >> bidirectional= True
2020-06-08 23:09:54,230:  >> num_layers= 6
2020-06-08 23:09:54,230:  >> dropout between layers= 0.4
2020-06-08 23:09:54,471: view2:
2020-06-08 23:09:54,471:  >> cell= GRU
2020-06-08 23:09:54,471:  >> input_size= 64
2020-06-08 23:09:54,472:  >> hidden_size= 512
2020-06-08 23:09:54,472:  >> bidirectional= True
2020-06-08 23:09:54,472:  >> num_layers= 2
2020-06-08 23:09:54,472:  >> dropout between layers= 0.4
2020-06-08 23:09:54,472:  >> num input embeddings= 38
2020-06-08 23:09:57,900: Using module at optim.adam.Adam
2020-06-08 23:09:57,902: Building optim from config
2020-06-08 23:09:57,902:  >> lr= 0.001
2020-06-08 23:09:57,902:  >> betas= (0.9, 0.999)
2020-06-08 23:09:57,902:  >> eps= 1e-08
2020-06-08 23:09:57,903:  >> weight_decay= 0
2020-06-08 23:09:57,903:  >> amsgrad= False
2020-06-08 23:09:57,903:  >> min_lr= 1e-07
2020-06-08 23:09:57,903: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-08 23:09:57,908: Building sched from config
2020-06-08 23:09:57,909:  >> optim= Adam
2020-06-08 23:09:57,909:  >> decay lr by 0.1
2020-06-08 23:09:57,909:  >> eval_fn= MultiViewAP
2020-06-08 23:09:57,910:  >> patience=4
2020-06-08 23:09:57,910:  >> revert=True
2020-06-08 23:09:57,923: loaded save/MultiViewDataset_IndividualWords.234.pth
2020-06-08 23:09:57,923: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-08 23:09:58,036: loaded save/MultiViewRNN.234.pth
2020-06-08 23:09:58,036: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-08 23:09:58,194: loaded save/Adam.234.pth
2020-06-08 23:09:58,194: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-08 23:09:58,195: loaded save/ReduceLROnPlateau.234.pth
2020-06-08 23:09:58,195: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-08 23:09:58,195: epoch=6.00 global_step=234 lr=0.001 start_iter=0
2020-06-08 23:09:58,196: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-08 23:11:41,454: 0) loss=0.359 grad_norm=39.04 num_segments=256 num_words=217
2020-06-08 23:13:09,513: 1) loss=0.408 grad_norm=58.88 num_segments=256 num_words=211
2020-06-08 23:14:33,379: 2) loss=0.313 grad_norm=36.72 num_segments=256 num_words=218
2020-06-08 23:15:49,709: 3) loss=0.645 grad_norm=27.80 num_segments=256 num_words=214
2020-06-08 23:17:01,814: 4) loss=0.417 grad_norm=52.65 num_segments=256 num_words=206
2020-06-08 23:18:06,479: 5) loss=0.493 grad_norm=55.12 num_segments=256 num_words=217
2020-06-08 23:19:05,158: 6) loss=0.407 grad_norm=33.34 num_segments=256 num_words=217
2020-06-08 23:19:59,300: 7) loss=0.519 grad_norm=28.72 num_segments=256 num_words=209
2020-06-08 23:20:54,820: 8) loss=0.411 grad_norm=25.09 num_segments=256 num_words=210
2020-06-08 23:21:46,227: 9) loss=0.457 grad_norm=31.91 num_segments=256 num_words=208
2020-06-08 23:22:43,988: 10) loss=0.326 grad_norm=33.28 num_segments=256 num_words=212
2020-06-08 23:23:37,984: 11) loss=0.497 grad_norm=39.84 num_segments=256 num_words=208
2020-06-08 23:24:35,546: 12) loss=0.504 grad_norm=37.08 num_segments=256 num_words=206
2020-06-08 23:25:27,970: 13) loss=0.496 grad_norm=28.26 num_segments=256 num_words=211
2020-06-08 23:26:27,011: 14) loss=0.453 grad_norm=24.62 num_segments=256 num_words=208
2020-06-08 23:27:22,228: 15) loss=0.494 grad_norm=37.32 num_segments=256 num_words=218
2020-06-08 23:28:14,622: 16) loss=0.628 grad_norm=31.14 num_segments=256 num_words=217
2020-06-08 23:29:08,705: 17) loss=0.515 grad_norm=34.12 num_segments=256 num_words=204
2020-06-08 23:29:59,854: 18) loss=0.641 grad_norm=35.30 num_segments=256 num_words=205
2020-06-08 23:30:57,673: 19) loss=0.656 grad_norm=30.46 num_segments=256 num_words=227
2020-06-08 23:31:46,877: 20) loss=0.507 grad_norm=30.19 num_segments=256 num_words=207
2020-06-08 23:32:36,201: 21) loss=0.405 grad_norm=32.30 num_segments=256 num_words=207
2020-06-08 23:33:29,075: 22) loss=0.360 grad_norm=27.89 num_segments=256 num_words=211
2020-06-08 23:34:20,690: 23) loss=0.422 grad_norm=31.99 num_segments=256 num_words=205
2020-06-08 23:35:17,782: 24) loss=0.649 grad_norm=51.41 num_segments=256 num_words=199
2020-06-08 23:36:06,613: 25) loss=0.403 grad_norm=29.29 num_segments=256 num_words=215
2020-06-08 23:36:54,996: 26) loss=0.452 grad_norm=32.01 num_segments=256 num_words=213
2020-06-08 23:37:43,274: 27) loss=0.416 grad_norm=35.91 num_segments=256 num_words=195
2020-06-08 23:38:31,573: 28) loss=0.452 grad_norm=33.14 num_segments=256 num_words=206
2020-06-08 23:39:20,261: 29) loss=0.501 grad_norm=28.06 num_segments=256 num_words=218
2020-06-08 23:40:08,468: 30) loss=0.381 grad_norm=26.89 num_segments=256 num_words=208
2020-06-08 23:41:05,931: 31) loss=0.398 grad_norm=30.57 num_segments=256 num_words=209
2020-06-08 23:41:54,198: 32) loss=0.703 grad_norm=30.56 num_segments=256 num_words=215
2020-06-08 23:42:42,438: 33) loss=0.463 grad_norm=31.72 num_segments=256 num_words=206
2020-06-08 23:43:30,975: 34) loss=0.452 grad_norm=42.01 num_segments=256 num_words=209
2020-06-08 23:44:19,372: 35) loss=0.350 grad_norm=33.98 num_segments=256 num_words=214
2020-06-08 23:45:07,647: 36) loss=0.335 grad_norm=27.67 num_segments=256 num_words=209
2020-06-08 23:45:56,123: 37) loss=0.400 grad_norm=34.69 num_segments=256 num_words=209
2020-06-08 23:46:39,826: 38) loss=0.496 grad_norm=31.80 num_segments=243 num_words=204
2020-06-08 23:46:39,834: epoch= 7.00
2020-06-08 23:46:39,834:  >> time to evaluate and save:
2020-06-08 23:46:39,874: saved save/MultiViewDataset_IndividualWords.273.pth
2020-06-08 23:46:39,883: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-08 23:46:39,913: removed save/MultiViewDataset_IndividualWords.39.pth
2020-06-08 23:46:39,913: saved MultiViewDataset_IndividualWords successfully
2020-06-08 23:46:40,349: saved save/MultiViewRNN.273.pth
2020-06-08 23:46:40,362: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-08 23:46:40,466: removed save/MultiViewRNN.39.pth
2020-06-08 23:46:40,466: saved MultiViewRNN successfully
2020-06-08 23:46:41,314: saved save/Adam.273.pth
2020-06-08 23:46:41,375: most_recent linked save/Adam.most_recent.pth
2020-06-08 23:46:41,492: removed save/Adam.39.pth
2020-06-08 23:46:41,493: saved Adam successfully
2020-06-08 23:46:41,495: saved save/ReduceLROnPlateau.273.pth
2020-06-08 23:46:41,553: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-08 23:46:41,560: saved ReduceLROnPlateau successfully
2020-06-08 23:46:41,563: saved config successfully
2020-06-08 23:48:22,655:   >> crossview_ap=0.455 (10966 x 3921 pairs)
2020-06-08 23:49:39,141:   >> acoustic_ap=0.541 (10966 choose 2 pairs)
2020-06-08 23:49:39,143: best_so_far= 0.455 at 273
2020-06-08 23:49:39,156: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-08 23:49:39,159: saved MultiViewDataset_IndividualWords successfully
2020-06-08 23:49:39,173: best linked save/MultiViewRNN.best.pth
2020-06-08 23:49:39,180: saved MultiViewRNN successfully
2020-06-08 23:49:39,189: best linked save/Adam.best.pth
2020-06-08 23:49:39,191: saved Adam successfully
2020-06-08 23:49:39,202: best linked save/ReduceLROnPlateau.best.pth
2020-06-08 23:49:39,206: saved ReduceLROnPlateau successfully
2020-06-08 23:49:39,267: epoch=7.00 global_step=273 lr=0.001 start_iter=0
2020-06-08 23:49:39,267: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-08 23:50:36,306: 0) loss=0.498 grad_norm=32.78 num_segments=256 num_words=207
2020-06-08 23:51:44,281: 1) loss=0.352 grad_norm=26.38 num_segments=256 num_words=207
2020-06-08 23:52:33,077: 2) loss=0.400 grad_norm=32.65 num_segments=256 num_words=213
2020-06-08 23:53:21,751: 3) loss=0.524 grad_norm=41.04 num_segments=256 num_words=215
2020-06-08 23:54:10,113: 4) loss=0.356 grad_norm=31.03 num_segments=256 num_words=213
2020-06-08 23:54:58,716: 5) loss=0.650 grad_norm=27.06 num_segments=256 num_words=213
2020-06-08 23:55:47,580: 6) loss=0.328 grad_norm=40.26 num_segments=256 num_words=217
2020-06-08 23:56:35,960: 7) loss=0.386 grad_norm=28.58 num_segments=256 num_words=202
2020-06-08 23:57:24,400: 8) loss=0.385 grad_norm=29.85 num_segments=256 num_words=210
2020-06-08 23:58:12,901: 9) loss=0.403 grad_norm=40.75 num_segments=256 num_words=211
2020-06-08 23:59:01,407: 10) loss=0.501 grad_norm=36.40 num_segments=256 num_words=211
2020-06-08 23:59:50,220: 11) loss=0.342 grad_norm=33.31 num_segments=256 num_words=202
2020-06-09 00:00:53,617: 12) loss=0.507 grad_norm=29.39 num_segments=256 num_words=213
2020-06-09 00:01:42,260: 13) loss=0.366 grad_norm=45.32 num_segments=256 num_words=212
2020-06-09 00:02:30,637: 14) loss=0.463 grad_norm=35.45 num_segments=256 num_words=215
2020-06-09 00:03:19,735: 15) loss=0.366 grad_norm=28.82 num_segments=256 num_words=208
2020-06-09 00:04:12,113: 16) loss=0.386 grad_norm=32.46 num_segments=256 num_words=202
2020-06-09 00:05:03,993: 17) loss=0.514 grad_norm=47.34 num_segments=256 num_words=214
2020-06-09 00:05:53,014: 18) loss=0.445 grad_norm=25.87 num_segments=256 num_words=220
2020-06-09 00:06:41,549: 19) loss=0.740 grad_norm=26.56 num_segments=256 num_words=208
2020-06-09 00:07:29,900: 20) loss=0.511 grad_norm=27.39 num_segments=256 num_words=198
2020-06-09 00:08:18,573: 21) loss=0.383 grad_norm=25.45 num_segments=256 num_words=215
2020-06-09 00:09:07,029: 22) loss=0.430 grad_norm=23.97 num_segments=256 num_words=207
2020-06-09 00:09:55,584: 23) loss=0.349 grad_norm=23.47 num_segments=256 num_words=210
2020-06-09 00:10:44,352: 24) loss=0.325 grad_norm=25.14 num_segments=256 num_words=202
2020-06-09 00:11:32,750: 25) loss=0.429 grad_norm=25.58 num_segments=256 num_words=209
2020-06-09 00:12:39,633: 26) loss=0.428 grad_norm=30.90 num_segments=256 num_words=213
2020-06-09 00:13:27,876: 27) loss=0.579 grad_norm=29.91 num_segments=256 num_words=212
2020-06-09 00:14:16,085: 28) loss=0.454 grad_norm=28.57 num_segments=256 num_words=215
2020-06-09 00:15:04,245: 29) loss=0.367 grad_norm=26.75 num_segments=256 num_words=205
2020-06-09 00:15:53,983: 30) loss=0.465 grad_norm=29.56 num_segments=256 num_words=209
2020-06-09 00:16:42,788: 31) loss=0.546 grad_norm=38.79 num_segments=256 num_words=214
2020-06-09 00:17:31,869: 32) loss=0.412 grad_norm=28.45 num_segments=256 num_words=214
2020-06-09 00:18:20,300: 33) loss=0.447 grad_norm=32.48 num_segments=256 num_words=201
2020-06-09 00:19:08,877: 34) loss=0.575 grad_norm=25.39 num_segments=256 num_words=217
2020-06-09 00:19:57,922: 35) loss=0.361 grad_norm=25.28 num_segments=256 num_words=214
2020-06-09 00:20:46,586: 36) loss=0.370 grad_norm=32.94 num_segments=256 num_words=203
2020-06-09 00:21:35,490: 37) loss=0.526 grad_norm=26.31 num_segments=256 num_words=201
2020-06-09 00:22:19,424: 38) loss=0.832 grad_norm=29.90 num_segments=243 num_words=201
2020-06-09 00:22:19,431: epoch= 8.00
2020-06-09 00:22:19,431:  >> time to evaluate and save:
2020-06-09 00:22:19,455: saved save/MultiViewDataset_IndividualWords.312.pth
2020-06-09 00:22:19,462: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 00:22:19,490: removed save/MultiViewDataset_IndividualWords.78.pth
2020-06-09 00:22:19,490: saved MultiViewDataset_IndividualWords successfully
2020-06-09 00:22:19,934: saved save/MultiViewRNN.312.pth
2020-06-09 00:22:20,053: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 00:22:20,121: removed save/MultiViewRNN.78.pth
2020-06-09 00:22:20,121: saved MultiViewRNN successfully
2020-06-09 00:22:20,951: saved save/Adam.312.pth
2020-06-09 00:22:21,128: most_recent linked save/Adam.most_recent.pth
2020-06-09 00:22:21,243: removed save/Adam.78.pth
2020-06-09 00:22:21,243: saved Adam successfully
2020-06-09 00:22:21,245: saved save/ReduceLROnPlateau.312.pth
2020-06-09 00:22:21,305: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 00:22:21,324: removed save/ReduceLROnPlateau.39.pth
2020-06-09 00:22:21,324: saved ReduceLROnPlateau successfully
2020-06-09 00:22:21,325: saved config successfully
2020-06-09 00:23:56,592:   >> crossview_ap=0.499 (10966 x 3921 pairs)
2020-06-09 00:25:07,081:   >> acoustic_ap=0.590 (10966 choose 2 pairs)
2020-06-09 00:25:07,085: best_so_far= 0.499 at 312
2020-06-09 00:25:07,091: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 00:25:07,093: saved MultiViewDataset_IndividualWords successfully
2020-06-09 00:25:07,151: best linked save/MultiViewRNN.best.pth
2020-06-09 00:25:07,168: saved MultiViewRNN successfully
2020-06-09 00:25:07,186: best linked save/Adam.best.pth
2020-06-09 00:25:07,192: saved Adam successfully
2020-06-09 00:25:07,202: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 00:25:07,225: removed save/ReduceLROnPlateau.78.pth
2020-06-09 00:25:07,226: saved ReduceLROnPlateau successfully
2020-06-09 00:25:07,749: epoch=8.00 global_step=312 lr=0.001 start_iter=0
2020-06-09 00:25:07,749: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 00:25:57,891: 0) loss=0.409 grad_norm=23.17 num_segments=256 num_words=212
2020-06-09 00:26:46,905: 1) loss=0.464 grad_norm=22.10 num_segments=256 num_words=198
2020-06-09 00:27:36,829: 2) loss=0.316 grad_norm=24.86 num_segments=256 num_words=213
2020-06-09 00:28:26,561: 3) loss=0.322 grad_norm=29.33 num_segments=256 num_words=209
2020-06-09 00:29:17,934: 4) loss=0.396 grad_norm=25.10 num_segments=256 num_words=207
2020-06-09 00:30:33,803: 5) loss=0.530 grad_norm=31.07 num_segments=256 num_words=213
2020-06-09 00:31:22,685: 6) loss=0.522 grad_norm=28.20 num_segments=256 num_words=221
2020-06-09 00:32:12,071: 7) loss=0.441 grad_norm=40.59 num_segments=256 num_words=210
2020-06-09 00:33:01,305: 8) loss=0.314 grad_norm=41.36 num_segments=256 num_words=200
2020-06-09 00:33:50,274: 9) loss=0.318 grad_norm=27.66 num_segments=256 num_words=214
2020-06-09 00:34:39,149: 10) loss=0.350 grad_norm=37.38 num_segments=256 num_words=212
2020-06-09 00:35:28,588: 11) loss=0.408 grad_norm=22.42 num_segments=256 num_words=215
2020-06-09 00:36:18,134: 12) loss=0.676 grad_norm=30.27 num_segments=256 num_words=207
2020-06-09 00:37:07,055: 13) loss=0.481 grad_norm=34.26 num_segments=256 num_words=198
2020-06-09 00:37:55,786: 14) loss=0.681 grad_norm=32.95 num_segments=256 num_words=213
2020-06-09 00:38:44,789: 15) loss=0.354 grad_norm=32.15 num_segments=256 num_words=214
2020-06-09 00:39:33,886: 16) loss=0.352 grad_norm=32.16 num_segments=256 num_words=214
2020-06-09 00:40:22,899: 17) loss=0.506 grad_norm=39.44 num_segments=256 num_words=204
2020-06-09 00:41:12,068: 18) loss=0.515 grad_norm=36.44 num_segments=256 num_words=213
2020-06-09 00:42:01,110: 19) loss=0.440 grad_norm=35.08 num_segments=256 num_words=214
2020-06-09 00:42:50,535: 20) loss=0.567 grad_norm=25.28 num_segments=256 num_words=200
2020-06-09 00:43:39,450: 21) loss=0.473 grad_norm=37.48 num_segments=256 num_words=204
2020-06-09 00:44:28,666: 22) loss=0.422 grad_norm=30.77 num_segments=256 num_words=199
2020-06-09 00:45:17,608: 23) loss=0.376 grad_norm=38.11 num_segments=256 num_words=201
2020-06-09 00:46:06,575: 24) loss=0.320 grad_norm=38.75 num_segments=256 num_words=210
2020-06-09 00:46:55,332: 25) loss=0.323 grad_norm=23.68 num_segments=256 num_words=207
2020-06-09 00:48:14,274: 26) loss=0.453 grad_norm=32.24 num_segments=256 num_words=221
2020-06-09 00:49:02,996: 27) loss=0.348 grad_norm=46.70 num_segments=256 num_words=206
2020-06-09 00:49:52,432: 28) loss=0.424 grad_norm=36.40 num_segments=256 num_words=196
2020-06-09 00:50:41,770: 29) loss=0.503 grad_norm=31.90 num_segments=256 num_words=215
2020-06-09 00:51:30,388: 30) loss=0.422 grad_norm=33.20 num_segments=256 num_words=210
2020-06-09 00:52:19,189: 31) loss=0.457 grad_norm=24.97 num_segments=256 num_words=215
2020-06-09 00:53:08,153: 32) loss=0.540 grad_norm=27.23 num_segments=256 num_words=210
2020-06-09 00:53:56,955: 33) loss=0.549 grad_norm=29.14 num_segments=256 num_words=208
2020-06-09 00:54:46,070: 34) loss=0.395 grad_norm=34.47 num_segments=256 num_words=209
2020-06-09 00:55:35,027: 35) loss=0.768 grad_norm=25.94 num_segments=256 num_words=211
2020-06-09 00:56:25,102: 36) loss=0.381 grad_norm=34.22 num_segments=256 num_words=209
2020-06-09 00:57:14,103: 37) loss=0.480 grad_norm=41.50 num_segments=256 num_words=207
2020-06-09 00:57:58,313: 38) loss=0.443 grad_norm=26.34 num_segments=243 num_words=197
2020-06-09 00:57:58,321: epoch= 9.00
2020-06-09 00:57:58,321:  >> time to evaluate and save:
2020-06-09 00:57:58,345: saved save/MultiViewDataset_IndividualWords.351.pth
2020-06-09 00:57:58,357: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 00:57:58,379: removed save/MultiViewDataset_IndividualWords.117.pth
2020-06-09 00:57:58,379: saved MultiViewDataset_IndividualWords successfully
2020-06-09 00:57:58,793: saved save/MultiViewRNN.351.pth
2020-06-09 00:57:58,804: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 00:57:58,877: removed save/MultiViewRNN.117.pth
2020-06-09 00:57:58,877: saved MultiViewRNN successfully
2020-06-09 00:57:59,841: saved save/Adam.351.pth
2020-06-09 00:57:59,846: most_recent linked save/Adam.most_recent.pth
2020-06-09 00:58:00,046: removed save/Adam.117.pth
2020-06-09 00:58:00,046: saved Adam successfully
2020-06-09 00:58:00,049: saved save/ReduceLROnPlateau.351.pth
2020-06-09 00:58:00,059: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 00:58:00,066: removed save/ReduceLROnPlateau.117.pth
2020-06-09 00:58:00,067: saved ReduceLROnPlateau successfully
2020-06-09 00:58:00,068: saved config successfully
2020-06-09 00:59:33,548:   >> crossview_ap=0.522 (10966 x 3921 pairs)
2020-06-09 01:00:43,213:   >> acoustic_ap=0.625 (10966 choose 2 pairs)
2020-06-09 01:00:43,216: best_so_far= 0.522 at 351
2020-06-09 01:00:43,229: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 01:00:43,231: saved MultiViewDataset_IndividualWords successfully
2020-06-09 01:00:43,240: best linked save/MultiViewRNN.best.pth
2020-06-09 01:00:43,248: saved MultiViewRNN successfully
2020-06-09 01:00:43,256: best linked save/Adam.best.pth
2020-06-09 01:00:43,260: saved Adam successfully
2020-06-09 01:00:43,266: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 01:00:43,269: saved ReduceLROnPlateau successfully
2020-06-09 01:00:44,129: epoch=9.00 global_step=351 lr=0.001 start_iter=0
2020-06-09 01:00:44,130: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 01:01:35,216: 0) loss=0.758 grad_norm=35.53 num_segments=256 num_words=207
2020-06-09 01:02:24,373: 1) loss=0.397 grad_norm=26.09 num_segments=256 num_words=211
2020-06-09 01:03:14,610: 2) loss=0.321 grad_norm=19.70 num_segments=256 num_words=205
2020-06-09 01:04:04,571: 3) loss=0.395 grad_norm=27.62 num_segments=256 num_words=224
2020-06-09 01:04:53,681: 4) loss=0.431 grad_norm=20.53 num_segments=256 num_words=207
2020-06-09 01:05:43,191: 5) loss=0.764 grad_norm=27.44 num_segments=256 num_words=216
2020-06-09 01:06:33,348: 6) loss=0.329 grad_norm=23.42 num_segments=256 num_words=202
2020-06-09 01:07:23,022: 7) loss=0.382 grad_norm=26.92 num_segments=256 num_words=207
2020-06-09 01:08:12,214: 8) loss=0.406 grad_norm=25.37 num_segments=256 num_words=206
2020-06-09 01:09:01,856: 9) loss=0.508 grad_norm=36.14 num_segments=256 num_words=221
2020-06-09 01:09:51,003: 10) loss=0.393 grad_norm=26.78 num_segments=256 num_words=216
2020-06-09 01:10:40,846: 11) loss=0.480 grad_norm=24.28 num_segments=256 num_words=213
2020-06-09 01:11:29,909: 12) loss=0.335 grad_norm=21.42 num_segments=256 num_words=213
2020-06-09 01:12:18,729: 13) loss=0.372 grad_norm=37.51 num_segments=256 num_words=207
2020-06-09 01:13:52,493: 14) loss=0.324 grad_norm=24.47 num_segments=256 num_words=216
2020-06-09 01:14:41,974: 15) loss=0.313 grad_norm=33.43 num_segments=256 num_words=213
2020-06-09 01:15:31,474: 16) loss=0.306 grad_norm=24.03 num_segments=256 num_words=205
2020-06-09 01:16:20,653: 17) loss=0.374 grad_norm=25.99 num_segments=256 num_words=210
2020-06-09 01:17:09,759: 18) loss=0.296 grad_norm=32.75 num_segments=256 num_words=201
2020-06-09 01:18:00,523: 19) loss=0.577 grad_norm=25.11 num_segments=256 num_words=201
2020-06-09 01:18:50,610: 20) loss=0.425 grad_norm=29.47 num_segments=256 num_words=201
2020-06-09 01:19:40,669: 21) loss=0.367 grad_norm=29.13 num_segments=256 num_words=207
2020-06-09 01:20:30,069: 22) loss=0.409 grad_norm=22.21 num_segments=256 num_words=199
2020-06-09 01:21:23,604: 23) loss=0.375 grad_norm=25.18 num_segments=256 num_words=210
2020-06-09 01:22:14,670: 24) loss=0.530 grad_norm=33.38 num_segments=256 num_words=203
2020-06-09 01:23:01,630: 25) loss=0.416 grad_norm=28.10 num_segments=256 num_words=207
2020-06-09 01:23:56,949: 26) loss=0.423 grad_norm=26.23 num_segments=256 num_words=220
2020-06-09 01:24:44,914: 27) loss=0.752 grad_norm=33.30 num_segments=256 num_words=211
2020-06-09 01:25:35,180: 28) loss=0.464 grad_norm=26.36 num_segments=256 num_words=210
2020-06-09 01:26:22,677: 29) loss=0.425 grad_norm=36.44 num_segments=256 num_words=213
2020-06-09 01:27:09,815: 30) loss=0.504 grad_norm=52.52 num_segments=256 num_words=208
2020-06-09 01:27:57,465: 31) loss=0.283 grad_norm=26.14 num_segments=256 num_words=218
2020-06-09 01:28:45,188: 32) loss=0.323 grad_norm=29.72 num_segments=256 num_words=216
2020-06-09 01:29:35,531: 33) loss=0.419 grad_norm=37.28 num_segments=256 num_words=206
2020-06-09 01:30:31,553: 34) loss=0.335 grad_norm=39.51 num_segments=256 num_words=213
2020-06-09 01:31:19,512: 35) loss=0.343 grad_norm=29.23 num_segments=256 num_words=217
2020-06-09 01:32:06,544: 36) loss=0.554 grad_norm=28.92 num_segments=256 num_words=208
2020-06-09 01:32:53,618: 37) loss=0.518 grad_norm=26.06 num_segments=256 num_words=211
2020-06-09 01:33:36,738: 38) loss=0.286 grad_norm=24.02 num_segments=243 num_words=200
2020-06-09 01:33:36,747: epoch= 10.00
2020-06-09 01:33:36,747:  >> time to evaluate and save:
2020-06-09 01:33:36,773: saved save/MultiViewDataset_IndividualWords.390.pth
2020-06-09 01:33:36,802: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 01:33:36,838: removed save/MultiViewDataset_IndividualWords.156.pth
2020-06-09 01:33:36,838: saved MultiViewDataset_IndividualWords successfully
2020-06-09 01:33:37,361: saved save/MultiViewRNN.390.pth
2020-06-09 01:33:37,373: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 01:33:37,441: removed save/MultiViewRNN.156.pth
2020-06-09 01:33:37,441: saved MultiViewRNN successfully
2020-06-09 01:33:38,467: saved save/Adam.390.pth
2020-06-09 01:33:38,478: most_recent linked save/Adam.most_recent.pth
2020-06-09 01:33:38,572: removed save/Adam.156.pth
2020-06-09 01:33:38,572: saved Adam successfully
2020-06-09 01:33:38,575: saved save/ReduceLROnPlateau.390.pth
2020-06-09 01:33:38,660: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 01:33:38,671: removed save/ReduceLROnPlateau.156.pth
2020-06-09 01:33:38,671: saved ReduceLROnPlateau successfully
2020-06-09 01:33:38,674: saved config successfully
2020-06-09 01:35:22,922:   >> crossview_ap=0.535 (10966 x 3921 pairs)
2020-06-09 01:36:30,614:   >> acoustic_ap=0.634 (10966 choose 2 pairs)
2020-06-09 01:36:30,621: best_so_far= 0.535 at 390
2020-06-09 01:36:30,651: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 01:36:30,654: saved MultiViewDataset_IndividualWords successfully
2020-06-09 01:36:30,665: best linked save/MultiViewRNN.best.pth
2020-06-09 01:36:30,677: saved MultiViewRNN successfully
2020-06-09 01:36:30,698: best linked save/Adam.best.pth
2020-06-09 01:36:30,705: saved Adam successfully
2020-06-09 01:36:30,735: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 01:36:30,740: saved ReduceLROnPlateau successfully
2020-06-09 01:36:32,146: epoch=10.00 global_step=390 lr=0.001 start_iter=0
2020-06-09 01:36:32,146: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 01:37:21,875: 0) loss=0.445 grad_norm=26.73 num_segments=256 num_words=214
2020-06-09 01:38:19,317: 1) loss=0.432 grad_norm=22.05 num_segments=256 num_words=209
2020-06-09 01:39:06,228: 2) loss=0.563 grad_norm=20.80 num_segments=256 num_words=219
2020-06-09 01:39:51,504: 3) loss=0.427 grad_norm=25.54 num_segments=256 num_words=211
2020-06-09 01:40:44,165: 4) loss=0.467 grad_norm=21.93 num_segments=256 num_words=205
2020-06-09 01:41:35,103: 5) loss=0.288 grad_norm=26.51 num_segments=256 num_words=207
2020-06-09 01:42:31,022: 6) loss=0.305 grad_norm=23.02 num_segments=256 num_words=214
2020-06-09 01:43:18,890: 7) loss=0.438 grad_norm=21.42 num_segments=256 num_words=206
2020-06-09 01:44:06,341: 8) loss=0.340 grad_norm=23.16 num_segments=256 num_words=216
2020-06-09 01:46:45,652: 9) loss=0.399 grad_norm=20.28 num_segments=256 num_words=209
2020-06-09 01:47:43,802: 10) loss=0.656 grad_norm=32.63 num_segments=256 num_words=213
2020-06-09 01:48:46,359: 11) loss=0.376 grad_norm=24.01 num_segments=256 num_words=215
2020-06-09 01:49:44,545: 12) loss=0.519 grad_norm=23.04 num_segments=256 num_words=212
2020-06-09 01:50:42,379: 13) loss=0.296 grad_norm=18.40 num_segments=256 num_words=213
2020-06-09 01:51:40,266: 14) loss=0.377 grad_norm=22.97 num_segments=256 num_words=199
2020-06-09 01:52:38,262: 15) loss=0.320 grad_norm=30.33 num_segments=256 num_words=212
2020-06-09 01:53:36,118: 16) loss=0.311 grad_norm=26.74 num_segments=256 num_words=205
2020-06-09 01:54:34,231: 17) loss=0.352 grad_norm=29.12 num_segments=256 num_words=210
2020-06-09 01:55:32,057: 18) loss=0.275 grad_norm=24.97 num_segments=256 num_words=207
2020-06-09 01:56:30,129: 19) loss=0.329 grad_norm=34.05 num_segments=256 num_words=218
2020-06-09 01:57:23,433: 20) loss=0.387 grad_norm=22.14 num_segments=256 num_words=211
2020-06-09 01:58:18,576: 21) loss=0.522 grad_norm=26.79 num_segments=256 num_words=210
2020-06-09 01:59:14,364: 22) loss=0.495 grad_norm=33.46 num_segments=256 num_words=196
2020-06-09 02:00:01,122: 23) loss=0.381 grad_norm=27.63 num_segments=256 num_words=220
2020-06-09 02:00:47,593: 24) loss=0.287 grad_norm=21.78 num_segments=256 num_words=208
2020-06-09 02:01:34,045: 25) loss=0.541 grad_norm=26.95 num_segments=256 num_words=213
2020-06-09 02:02:20,452: 26) loss=0.624 grad_norm=29.92 num_segments=256 num_words=214
2020-06-09 02:03:07,279: 27) loss=0.267 grad_norm=19.42 num_segments=256 num_words=211
2020-06-09 02:03:54,123: 28) loss=0.484 grad_norm=16.29 num_segments=256 num_words=206
2020-06-09 02:04:41,336: 29) loss=0.829 grad_norm=24.49 num_segments=256 num_words=209
2020-06-09 02:05:28,024: 30) loss=0.377 grad_norm=22.66 num_segments=256 num_words=209
2020-06-09 02:06:14,714: 31) loss=0.413 grad_norm=22.76 num_segments=256 num_words=211
2020-06-09 02:07:01,327: 32) loss=0.521 grad_norm=25.00 num_segments=256 num_words=218
2020-06-09 02:07:47,995: 33) loss=0.435 grad_norm=21.84 num_segments=256 num_words=212
2020-06-09 02:08:34,591: 34) loss=0.280 grad_norm=26.47 num_segments=256 num_words=209
2020-06-09 02:09:21,286: 35) loss=0.283 grad_norm=28.34 num_segments=256 num_words=208
2020-06-09 02:10:07,874: 36) loss=0.313 grad_norm=27.16 num_segments=256 num_words=210
2020-06-09 02:10:54,584: 37) loss=0.311 grad_norm=20.41 num_segments=256 num_words=205
2020-06-09 02:11:36,728: 38) loss=0.303 grad_norm=24.09 num_segments=243 num_words=201
2020-06-09 02:11:36,736: epoch= 11.00
2020-06-09 02:11:36,736:  >> time to evaluate and save:
2020-06-09 02:11:36,759: saved save/MultiViewDataset_IndividualWords.429.pth
2020-06-09 02:11:36,761: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 02:11:36,775: removed save/MultiViewDataset_IndividualWords.195.pth
2020-06-09 02:11:36,776: saved MultiViewDataset_IndividualWords successfully
2020-06-09 02:11:37,209: saved save/MultiViewRNN.429.pth
2020-06-09 02:11:37,211: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 02:11:37,360: removed save/MultiViewRNN.195.pth
2020-06-09 02:11:37,360: saved MultiViewRNN successfully
2020-06-09 02:11:38,310: saved save/Adam.429.pth
2020-06-09 02:11:38,312: most_recent linked save/Adam.most_recent.pth
2020-06-09 02:11:38,514: removed save/Adam.195.pth
2020-06-09 02:11:38,514: saved Adam successfully
2020-06-09 02:11:38,516: saved save/ReduceLROnPlateau.429.pth
2020-06-09 02:11:38,527: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 02:11:38,540: removed save/ReduceLROnPlateau.195.pth
2020-06-09 02:11:38,540: saved ReduceLROnPlateau successfully
2020-06-09 02:11:38,542: saved config successfully
2020-06-09 02:13:17,061:   >> crossview_ap=0.549 (10966 x 3921 pairs)
2020-06-09 02:14:29,136:   >> acoustic_ap=0.654 (10966 choose 2 pairs)
2020-06-09 02:14:29,140: best_so_far= 0.549 at 429
2020-06-09 02:14:29,143: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 02:14:29,146: saved MultiViewDataset_IndividualWords successfully
2020-06-09 02:14:29,147: best linked save/MultiViewRNN.best.pth
2020-06-09 02:14:29,154: saved MultiViewRNN successfully
2020-06-09 02:14:29,156: best linked save/Adam.best.pth
2020-06-09 02:14:29,162: saved Adam successfully
2020-06-09 02:14:29,163: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 02:14:29,167: saved ReduceLROnPlateau successfully
2020-06-09 02:14:30,521: epoch=11.00 global_step=429 lr=0.001 start_iter=0
2020-06-09 02:14:30,521: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 02:15:19,962: 0) loss=0.324 grad_norm=22.63 num_segments=256 num_words=210
2020-06-09 02:16:06,725: 1) loss=0.365 grad_norm=14.17 num_segments=256 num_words=200
2020-06-09 02:16:53,568: 2) loss=0.470 grad_norm=19.37 num_segments=256 num_words=206
2020-06-09 02:17:39,661: 3) loss=0.359 grad_norm=22.34 num_segments=256 num_words=213
2020-06-09 02:18:26,568: 4) loss=0.449 grad_norm=35.69 num_segments=256 num_words=220
2020-06-09 02:19:13,121: 5) loss=0.491 grad_norm=23.82 num_segments=256 num_words=209
2020-06-09 02:20:00,464: 6) loss=0.285 grad_norm=17.93 num_segments=256 num_words=223
2020-06-09 02:20:48,269: 7) loss=0.336 grad_norm=24.81 num_segments=256 num_words=204
2020-06-09 02:21:35,287: 8) loss=0.362 grad_norm=26.64 num_segments=256 num_words=215
2020-06-09 02:22:22,575: 9) loss=0.481 grad_norm=30.46 num_segments=256 num_words=213
2020-06-09 02:23:09,488: 10) loss=0.555 grad_norm=25.72 num_segments=256 num_words=213
2020-06-09 02:23:56,345: 11) loss=0.378 grad_norm=26.49 num_segments=256 num_words=210
2020-06-09 02:26:03,556: 12) loss=0.464 grad_norm=23.36 num_segments=256 num_words=208
2020-06-09 02:26:50,409: 13) loss=0.325 grad_norm=17.09 num_segments=256 num_words=212
2020-06-09 02:27:36,739: 14) loss=0.490 grad_norm=21.51 num_segments=256 num_words=211
2020-06-09 02:28:23,581: 15) loss=0.422 grad_norm=24.21 num_segments=256 num_words=207
2020-06-09 02:29:10,657: 16) loss=0.643 grad_norm=22.58 num_segments=256 num_words=212
2020-06-09 02:30:08,841: 17) loss=0.480 grad_norm=22.37 num_segments=256 num_words=209
2020-06-09 02:30:59,224: 18) loss=0.465 grad_norm=23.16 num_segments=256 num_words=209
2020-06-09 02:31:46,345: 19) loss=0.292 grad_norm=22.40 num_segments=256 num_words=201
2020-06-09 02:32:36,340: 20) loss=0.417 grad_norm=21.62 num_segments=256 num_words=217
2020-06-09 02:33:23,430: 21) loss=0.423 grad_norm=28.21 num_segments=256 num_words=216
2020-06-09 02:34:10,391: 22) loss=0.335 grad_norm=30.56 num_segments=256 num_words=214
2020-06-09 02:34:57,185: 23) loss=0.352 grad_norm=22.57 num_segments=256 num_words=204
2020-06-09 02:35:43,810: 24) loss=0.481 grad_norm=25.77 num_segments=256 num_words=210
2020-06-09 02:36:30,516: 25) loss=0.428 grad_norm=23.06 num_segments=256 num_words=214
2020-06-09 02:37:17,121: 26) loss=0.345 grad_norm=17.17 num_segments=256 num_words=212
2020-06-09 02:38:03,827: 27) loss=0.483 grad_norm=26.46 num_segments=256 num_words=204
2020-06-09 02:38:50,486: 28) loss=0.520 grad_norm=26.20 num_segments=256 num_words=209
2020-06-09 02:39:37,541: 29) loss=0.326 grad_norm=17.21 num_segments=256 num_words=211
2020-06-09 02:40:24,287: 30) loss=0.659 grad_norm=23.36 num_segments=256 num_words=214
2020-06-09 02:41:10,751: 31) loss=0.269 grad_norm=29.64 num_segments=256 num_words=213
2020-06-09 02:41:57,494: 32) loss=0.499 grad_norm=22.59 num_segments=256 num_words=207
2020-06-09 02:42:44,223: 33) loss=0.457 grad_norm=30.73 num_segments=256 num_words=211
2020-06-09 02:43:31,167: 34) loss=0.358 grad_norm=19.45 num_segments=256 num_words=202
2020-06-09 02:44:18,145: 35) loss=0.481 grad_norm=24.40 num_segments=256 num_words=213
2020-06-09 02:45:05,142: 36) loss=0.394 grad_norm=23.05 num_segments=256 num_words=213
2020-06-09 02:45:52,021: 37) loss=0.395 grad_norm=22.03 num_segments=256 num_words=211
2020-06-09 02:46:34,220: 38) loss=0.296 grad_norm=23.42 num_segments=243 num_words=199
2020-06-09 02:46:34,228: epoch= 12.00
2020-06-09 02:46:34,228:  >> time to evaluate and save:
2020-06-09 02:46:34,251: saved save/MultiViewDataset_IndividualWords.468.pth
2020-06-09 02:46:34,284: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 02:46:34,292: removed save/MultiViewDataset_IndividualWords.234.pth
2020-06-09 02:46:34,292: saved MultiViewDataset_IndividualWords successfully
2020-06-09 02:46:34,890: saved save/MultiViewRNN.468.pth
2020-06-09 02:46:34,902: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 02:46:34,992: removed save/MultiViewRNN.234.pth
2020-06-09 02:46:34,992: saved MultiViewRNN successfully
2020-06-09 02:46:36,029: saved save/Adam.468.pth
2020-06-09 02:46:36,135: most_recent linked save/Adam.most_recent.pth
2020-06-09 02:46:36,255: removed save/Adam.234.pth
2020-06-09 02:46:36,255: saved Adam successfully
2020-06-09 02:46:36,258: saved save/ReduceLROnPlateau.468.pth
2020-06-09 02:46:36,270: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 02:46:36,291: removed save/ReduceLROnPlateau.234.pth
2020-06-09 02:46:36,291: saved ReduceLROnPlateau successfully
2020-06-09 02:46:36,293: saved config successfully
2020-06-09 02:48:28,501:   >> crossview_ap=0.556 (10966 x 3921 pairs)
2020-06-09 02:49:50,127:   >> acoustic_ap=0.651 (10966 choose 2 pairs)
2020-06-09 02:49:50,131: best_so_far= 0.556 at 468
2020-06-09 02:49:50,142: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 02:49:50,145: saved MultiViewDataset_IndividualWords successfully
2020-06-09 02:49:50,163: best linked save/MultiViewRNN.best.pth
2020-06-09 02:49:50,173: saved MultiViewRNN successfully
2020-06-09 02:49:50,188: best linked save/Adam.best.pth
2020-06-09 02:49:50,197: saved Adam successfully
2020-06-09 02:49:50,200: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 02:49:50,203: saved ReduceLROnPlateau successfully
2020-06-09 02:49:51,796: epoch=12.00 global_step=468 lr=0.001 start_iter=0
2020-06-09 02:49:51,796: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 02:50:39,433: 0) loss=0.260 grad_norm=16.38 num_segments=256 num_words=211
2020-06-09 02:51:38,136: 1) loss=0.455 grad_norm=21.68 num_segments=256 num_words=212
2020-06-09 02:52:37,064: 2) loss=0.524 grad_norm=33.61 num_segments=256 num_words=213
2020-06-09 02:53:36,079: 3) loss=0.292 grad_norm=18.54 num_segments=256 num_words=221
2020-06-09 02:54:35,159: 4) loss=0.288 grad_norm=23.43 num_segments=256 num_words=213
2020-06-09 02:55:34,122: 5) loss=0.256 grad_norm=28.18 num_segments=256 num_words=207
2020-06-09 02:56:33,179: 6) loss=0.320 grad_norm=37.91 num_segments=256 num_words=209
2020-06-09 02:57:32,353: 7) loss=0.321 grad_norm=16.33 num_segments=256 num_words=206
2020-06-09 02:58:31,134: 8) loss=0.437 grad_norm=19.69 num_segments=256 num_words=205
2020-06-09 02:59:30,088: 9) loss=0.349 grad_norm=26.59 num_segments=256 num_words=216
2020-06-09 03:00:18,201: 10) loss=0.416 grad_norm=24.37 num_segments=256 num_words=215
2020-06-09 03:01:05,929: 11) loss=0.411 grad_norm=31.52 num_segments=256 num_words=202
2020-06-09 03:01:53,378: 12) loss=0.358 grad_norm=26.05 num_segments=256 num_words=211
2020-06-09 03:02:40,807: 13) loss=0.330 grad_norm=23.28 num_segments=256 num_words=206
2020-06-09 03:03:28,526: 14) loss=0.373 grad_norm=30.40 num_segments=256 num_words=204
2020-06-09 03:04:16,244: 15) loss=0.387 grad_norm=25.24 num_segments=256 num_words=207
2020-06-09 03:05:03,770: 16) loss=0.382 grad_norm=24.65 num_segments=256 num_words=217
2020-06-09 03:05:51,034: 17) loss=0.315 grad_norm=22.44 num_segments=256 num_words=205
2020-06-09 03:06:38,506: 18) loss=0.320 grad_norm=18.27 num_segments=256 num_words=203
2020-06-09 03:07:26,031: 19) loss=0.269 grad_norm=22.61 num_segments=256 num_words=212
2020-06-09 03:08:13,665: 20) loss=0.400 grad_norm=22.20 num_segments=256 num_words=222
2020-06-09 03:09:01,316: 21) loss=0.272 grad_norm=17.22 num_segments=256 num_words=208
2020-06-09 03:10:43,459: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-09 03:10:43,525: Using 1 GPU(s)
2020-06-09 03:10:43,525: Machine: 0 / 1
2020-06-09 03:10:43,527: Hyperparam tuning-------------------
2020-06-09 03:10:43,527: optim_lr: 0.001
2020-06-09 03:10:43,527: dropout (for both): 0.4
2020-06-09 03:10:43,527: margin: 0.4
2020-06-09 03:10:43,527: ------------------------------------
2020-06-09 03:10:43,646: Calling main function: multiview_trainer.train
2020-06-09 03:10:43,646: Using config file: train_config.json
2020-06-09 03:10:43,646: Using module at multiview_trainer.train
2020-06-09 03:10:56,596: Using module at multiview_vocab.MultiViewVocab
2020-06-09 03:10:56,635: Building vocab_data from config
2020-06-09 03:10:56,931:  >> min_count= 0
2020-06-09 03:10:56,931:  >> # words= 34323 (# removed= 0)
2020-06-09 03:10:56,931:  >> # subwords= 38
2020-06-09 03:10:56,931:      = 1
2020-06-09 03:10:56,931:     '= 2
2020-06-09 03:10:56,931:     -= 3
2020-06-09 03:10:56,931:     .= 4
2020-06-09 03:10:56,931:     <= 5
2020-06-09 03:10:56,931:     >= 6
2020-06-09 03:10:56,931:     [= 7
2020-06-09 03:10:56,931:     [laughter]= 8
2020-06-09 03:10:56,931:     [noise]= 9
2020-06-09 03:10:56,931:     [vocalized-noise]= 10
2020-06-09 03:10:56,931:     ]= 11
2020-06-09 03:10:56,931:     _= 12
2020-06-09 03:10:56,931:     a= 13
2020-06-09 03:10:56,931:     b= 14
2020-06-09 03:10:56,932:     c= 15
2020-06-09 03:10:56,932:     d= 16
2020-06-09 03:10:56,932:     e= 17
2020-06-09 03:10:56,932:     f= 18
2020-06-09 03:10:56,932:     g= 19
2020-06-09 03:10:56,932:     h= 20
2020-06-09 03:10:56,932:     i= 21
2020-06-09 03:10:56,932:     j= 22
2020-06-09 03:10:56,932:     k= 23
2020-06-09 03:10:56,932:     l= 24
2020-06-09 03:10:56,932:     m= 25
2020-06-09 03:10:56,932:     n= 26
2020-06-09 03:10:56,932:     o= 27
2020-06-09 03:10:56,932:     p= 28
2020-06-09 03:10:56,932:     q= 29
2020-06-09 03:10:56,932:     r= 30
2020-06-09 03:10:56,932:     s= 31
2020-06-09 03:10:56,932:     t= 32
2020-06-09 03:10:56,932:     u= 33
2020-06-09 03:10:56,933:     v= 34
2020-06-09 03:10:56,933:     w= 35
2020-06-09 03:10:56,933:     x= 36
2020-06-09 03:10:56,933:     y= 37
2020-06-09 03:10:56,933:     z= 38
2020-06-09 03:10:56,947: Using module at data.batch_samplers.BatchSampler
2020-06-09 03:10:56,949: Building vocab_sampler from config
2020-06-09 03:10:56,950:  >> # examples= 34323
2020-06-09 03:10:56,950:  >> batch_size= 1000
2020-06-09 03:10:56,950:  >> shuffle= False
2020-06-09 03:10:56,957:  >> BatchSampler; 35 batches
2020-06-09 03:10:56,957: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 03:11:00,941: Building train_data from config
2020-06-09 03:11:07,273:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-09 03:11:07,274:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-09 03:11:07,274:  >> stack= False
2020-06-09 03:11:07,274:  >> seg_durs= (1, None)
2020-06-09 03:11:07,274:  >> # words= 9971 (# ignored= 0)
2020-06-09 03:11:07,274:  >> input_feat_dim= 108
2020-06-09 03:11:07,274:  >> input_num_subwords= 38
2020-06-09 03:11:07,274: Using module at data.batch_samplers.BatchSampler
2020-06-09 03:11:07,275: Building train_sampler from config
2020-06-09 03:11:07,275:  >> # examples= 9971
2020-06-09 03:11:07,275:  >> batch_size= 256
2020-06-09 03:11:07,275:  >> shuffle= True
2020-06-09 03:11:07,282:  >> BatchSampler; 39 batches
2020-06-09 03:11:07,282: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 03:11:07,282: Building dev_data from config
2020-06-09 03:11:14,115:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-09 03:11:14,115:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-09 03:11:14,115:  >> stack= False
2020-06-09 03:11:14,115:  >> seg_durs= (1, None)
2020-06-09 03:11:14,115:  >> # words= 10966 (# ignored= 0)
2020-06-09 03:11:14,115:  >> input_feat_dim= 108
2020-06-09 03:11:14,115:  >> input_num_subwords= 38
2020-06-09 03:11:14,115: Using module at data.batch_samplers.BatchSampler
2020-06-09 03:11:14,115: Building dev_sampler from config
2020-06-09 03:11:14,116:  >> # examples= 10966
2020-06-09 03:11:14,116:  >> batch_size= 256
2020-06-09 03:11:14,116:  >> shuffle= False
2020-06-09 03:11:14,118:  >> BatchSampler; 43 batches
2020-06-09 03:11:14,118: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 03:11:14,118: Building test_data from config
2020-06-09 03:11:20,170:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-09 03:11:20,171:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-09 03:11:20,171:  >> stack= False
2020-06-09 03:11:20,171:  >> seg_durs= (1, None)
2020-06-09 03:11:20,171:  >> # words= 11024 (# ignored= 0)
2020-06-09 03:11:20,171:  >> input_feat_dim= 108
2020-06-09 03:11:20,171:  >> input_num_subwords= 38
2020-06-09 03:11:20,172: Using module at data.batch_samplers.BatchSampler
2020-06-09 03:11:20,172: Building test_sampler from config
2020-06-09 03:11:20,173:  >> # examples= 11024
2020-06-09 03:11:20,173:  >> batch_size= 256
2020-06-09 03:11:20,173:  >> shuffle= False
2020-06-09 03:11:20,177:  >> BatchSampler; 44 batches
2020-06-09 03:11:20,178: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-09 03:11:21,349: Building loss from config
2020-06-09 03:11:21,350:  >> margin= 0.4
2020-06-09 03:11:21,350:  >> k= 16
2020-06-09 03:11:21,350:  >> min_k= 8
2020-06-09 03:11:21,350:  >> extra= 0
2020-06-09 03:11:21,350:  >> average= False
2020-06-09 03:11:21,350:  >> margin_max= 0.5
2020-06-09 03:11:21,350:  >> threshold_max= 9
2020-06-09 03:11:21,351:  >> using obj0
2020-06-09 03:11:21,351: Using module at metric.multiview_ap.MultiViewAP
2020-06-09 03:11:23,241: Building eval from config
2020-06-09 03:11:23,242:  >> acoustic_ap= True
2020-06-09 03:11:23,242:  >> crossview_ap= True
2020-06-09 03:11:23,242:  >> full_vocab= False
2020-06-09 03:11:23,242:  >> metric= crossview_ap
2020-06-09 03:11:23,242:  >> mode= max
2020-06-09 03:11:23,242: Using module at multiview_rnn.MultiViewRNN
2020-06-09 03:11:23,278: Building net from config
2020-06-09 03:11:23,280: view1:
2020-06-09 03:11:23,281:  >> cell= GRU
2020-06-09 03:11:23,281:  >> input_size= 108
2020-06-09 03:11:23,281:  >> hidden_size= 512
2020-06-09 03:11:23,281:  >> bidirectional= True
2020-06-09 03:11:23,281:  >> num_layers= 6
2020-06-09 03:11:23,282:  >> dropout between layers= 0.4
2020-06-09 03:11:23,586: view2:
2020-06-09 03:11:23,587:  >> cell= GRU
2020-06-09 03:11:23,587:  >> input_size= 64
2020-06-09 03:11:23,587:  >> hidden_size= 512
2020-06-09 03:11:23,587:  >> bidirectional= True
2020-06-09 03:11:23,587:  >> num_layers= 2
2020-06-09 03:11:23,587:  >> dropout between layers= 0.4
2020-06-09 03:11:23,587:  >> num input embeddings= 38
2020-06-09 03:11:37,468: Using module at optim.adam.Adam
2020-06-09 03:11:37,500: Building optim from config
2020-06-09 03:11:37,500:  >> lr= 0.001
2020-06-09 03:11:37,501:  >> betas= (0.9, 0.999)
2020-06-09 03:11:37,501:  >> eps= 1e-08
2020-06-09 03:11:37,501:  >> weight_decay= 0
2020-06-09 03:11:37,501:  >> amsgrad= False
2020-06-09 03:11:37,501:  >> min_lr= 1e-07
2020-06-09 03:11:37,502: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-09 03:11:37,518: Building sched from config
2020-06-09 03:11:37,518:  >> optim= Adam
2020-06-09 03:11:37,518:  >> decay lr by 0.1
2020-06-09 03:11:37,518:  >> eval_fn= MultiViewAP
2020-06-09 03:11:37,519:  >> patience=4
2020-06-09 03:11:37,519:  >> revert=True
2020-06-09 03:11:37,529: loaded save/MultiViewDataset_IndividualWords.468.pth
2020-06-09 03:11:37,529: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 03:11:38,640: loaded save/MultiViewRNN.468.pth
2020-06-09 03:11:38,640: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 03:11:40,846: loaded save/Adam.468.pth
2020-06-09 03:11:40,846: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 03:11:40,849: loaded save/ReduceLROnPlateau.468.pth
2020-06-09 03:11:40,849: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 03:11:40,849: epoch=12.00 global_step=468 lr=0.001 start_iter=0
2020-06-09 03:11:40,849: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 03:13:35,387: 0) loss=0.329 grad_norm=17.92 num_segments=256 num_words=211
2020-06-09 03:15:16,934: 1) loss=0.322 grad_norm=16.67 num_segments=256 num_words=212
2020-06-09 03:16:51,489: 2) loss=0.399 grad_norm=36.11 num_segments=256 num_words=213
2020-06-09 03:18:19,527: 3) loss=0.241 grad_norm=15.77 num_segments=256 num_words=221
2020-06-09 03:19:38,814: 4) loss=0.228 grad_norm=18.32 num_segments=256 num_words=213
2020-06-09 03:20:53,633: 5) loss=0.235 grad_norm=29.68 num_segments=256 num_words=207
2020-06-09 03:21:58,492: 6) loss=0.300 grad_norm=32.97 num_segments=256 num_words=209
2020-06-09 03:22:56,381: 7) loss=0.321 grad_norm=15.85 num_segments=256 num_words=206
2020-06-09 03:23:56,637: 8) loss=0.458 grad_norm=19.73 num_segments=256 num_words=205
2020-06-09 03:24:54,755: 9) loss=0.344 grad_norm=24.91 num_segments=256 num_words=216
2020-06-09 03:25:55,276: 10) loss=0.414 grad_norm=21.49 num_segments=256 num_words=215
2020-06-09 03:26:54,046: 11) loss=0.413 grad_norm=21.39 num_segments=256 num_words=202
2020-06-09 03:27:51,986: 12) loss=0.360 grad_norm=17.95 num_segments=256 num_words=211
2020-06-09 03:28:49,434: 13) loss=0.254 grad_norm=22.03 num_segments=256 num_words=206
2020-06-09 03:29:51,994: 14) loss=0.369 grad_norm=17.95 num_segments=256 num_words=204
2020-06-09 03:30:51,141: 15) loss=0.382 grad_norm=20.03 num_segments=256 num_words=207
2020-06-09 03:31:54,365: 16) loss=0.382 grad_norm=23.73 num_segments=256 num_words=217
2020-06-09 03:32:54,624: 17) loss=0.268 grad_norm=20.06 num_segments=256 num_words=205
2020-06-09 03:33:52,608: 18) loss=0.366 grad_norm=24.52 num_segments=256 num_words=203
2020-06-09 03:34:56,121: 19) loss=0.320 grad_norm=22.06 num_segments=256 num_words=212
2020-06-09 03:35:57,315: 20) loss=0.397 grad_norm=20.19 num_segments=256 num_words=222
2020-06-09 03:36:55,429: 21) loss=0.272 grad_norm=22.55 num_segments=256 num_words=208
2020-06-09 03:37:53,500: 22) loss=0.497 grad_norm=29.72 num_segments=256 num_words=209
2020-06-09 03:38:51,677: 23) loss=0.344 grad_norm=22.38 num_segments=256 num_words=215
2020-06-09 03:39:55,501: 24) loss=0.645 grad_norm=19.68 num_segments=256 num_words=212
2020-06-09 03:40:54,331: 25) loss=0.396 grad_norm=20.44 num_segments=256 num_words=196
2020-06-09 03:41:55,390: 26) loss=0.405 grad_norm=16.47 num_segments=256 num_words=205
2020-06-09 03:42:55,240: 27) loss=0.260 grad_norm=23.79 num_segments=256 num_words=220
2020-06-09 03:43:54,186: 28) loss=0.343 grad_norm=19.57 num_segments=256 num_words=217
2020-06-09 03:44:52,760: 29) loss=0.548 grad_norm=23.75 num_segments=256 num_words=207
2020-06-09 03:45:50,919: 30) loss=0.348 grad_norm=25.81 num_segments=256 num_words=211
2020-06-09 03:46:56,659: 31) loss=0.389 grad_norm=24.14 num_segments=256 num_words=216
2020-06-09 03:47:56,160: 32) loss=0.312 grad_norm=26.58 num_segments=256 num_words=219
2020-06-09 03:48:56,843: 33) loss=0.407 grad_norm=19.77 num_segments=256 num_words=209
2020-06-09 03:49:56,476: 34) loss=0.287 grad_norm=21.46 num_segments=256 num_words=212
2020-06-09 03:50:55,067: 35) loss=0.310 grad_norm=18.72 num_segments=256 num_words=210
2020-06-09 03:51:53,451: 36) loss=0.295 grad_norm=17.09 num_segments=256 num_words=218
2020-06-09 03:52:51,920: 37) loss=0.398 grad_norm=20.00 num_segments=256 num_words=206
2020-06-09 03:53:45,319: 38) loss=0.422 grad_norm=21.12 num_segments=243 num_words=208
2020-06-09 03:53:45,335: epoch= 13.00
2020-06-09 03:53:45,336:  >> time to evaluate and save:
2020-06-09 03:53:45,375: saved save/MultiViewDataset_IndividualWords.507.pth
2020-06-09 03:53:45,400: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 03:53:45,415: removed save/MultiViewDataset_IndividualWords.273.pth
2020-06-09 03:53:45,415: saved MultiViewDataset_IndividualWords successfully
2020-06-09 03:53:46,736: saved save/MultiViewRNN.507.pth
2020-06-09 03:53:46,738: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 03:53:46,935: removed save/MultiViewRNN.273.pth
2020-06-09 03:53:46,935: saved MultiViewRNN successfully
2020-06-09 03:53:49,698: saved save/Adam.507.pth
2020-06-09 03:53:49,700: most_recent linked save/Adam.most_recent.pth
2020-06-09 03:53:49,917: removed save/Adam.273.pth
2020-06-09 03:53:49,918: saved Adam successfully
2020-06-09 03:53:49,920: saved save/ReduceLROnPlateau.507.pth
2020-06-09 03:53:49,921: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 03:53:49,926: saved ReduceLROnPlateau successfully
2020-06-09 03:53:49,927: saved config successfully
2020-06-09 03:55:17,077:   >> crossview_ap=0.570 (10966 x 3921 pairs)
2020-06-09 03:56:10,275:   >> acoustic_ap=0.682 (10966 choose 2 pairs)
2020-06-09 03:56:10,277: best_so_far= 0.570 at 507
2020-06-09 03:56:10,281: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 03:56:10,303: saved MultiViewDataset_IndividualWords successfully
2020-06-09 03:56:10,305: best linked save/MultiViewRNN.best.pth
2020-06-09 03:56:10,313: saved MultiViewRNN successfully
2020-06-09 03:56:10,314: best linked save/Adam.best.pth
2020-06-09 03:56:10,322: saved Adam successfully
2020-06-09 03:56:10,323: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 03:56:10,326: saved ReduceLROnPlateau successfully
2020-06-09 03:56:10,350: epoch=13.00 global_step=507 lr=0.001 start_iter=0
2020-06-09 03:56:10,350: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 03:57:12,270: 0) loss=0.266 grad_norm=17.81 num_segments=256 num_words=215
2020-06-09 03:58:21,055: 1) loss=0.374 grad_norm=17.01 num_segments=256 num_words=217
2020-06-09 03:59:20,010: 2) loss=0.351 grad_norm=20.02 num_segments=256 num_words=213
2020-06-09 04:00:23,156: 3) loss=0.268 grad_norm=11.70 num_segments=256 num_words=204
2020-06-09 04:01:26,259: 4) loss=0.388 grad_norm=25.52 num_segments=256 num_words=202
2020-06-09 04:02:30,577: 5) loss=0.294 grad_norm=20.88 num_segments=256 num_words=209
2020-06-09 04:03:36,144: 6) loss=0.558 grad_norm=20.00 num_segments=256 num_words=207
2020-06-09 04:04:40,635: 7) loss=0.257 grad_norm=19.52 num_segments=256 num_words=203
2020-06-09 04:05:43,934: 8) loss=0.219 grad_norm=18.74 num_segments=256 num_words=207
2020-06-09 04:06:48,617: 9) loss=0.399 grad_norm=19.27 num_segments=256 num_words=209
2020-06-09 04:07:46,877: 10) loss=0.328 grad_norm=16.90 num_segments=256 num_words=217
2020-06-09 04:08:48,745: 11) loss=0.383 grad_norm=15.48 num_segments=256 num_words=210
2020-06-09 04:10:00,175: 12) loss=0.371 grad_norm=19.99 num_segments=256 num_words=204
2020-06-09 04:10:59,666: 13) loss=0.399 grad_norm=29.44 num_segments=256 num_words=209
2020-06-09 04:12:01,827: 14) loss=0.446 grad_norm=19.50 num_segments=256 num_words=202
2020-06-09 04:13:04,432: 15) loss=0.281 grad_norm=17.77 num_segments=256 num_words=217
2020-06-09 04:14:07,168: 16) loss=0.300 grad_norm=20.20 num_segments=256 num_words=208
2020-06-09 04:15:11,524: 17) loss=0.259 grad_norm=21.78 num_segments=256 num_words=224
2020-06-09 04:16:13,528: 18) loss=0.396 grad_norm=21.83 num_segments=256 num_words=203
2020-06-09 04:17:16,222: 19) loss=0.374 grad_norm=16.83 num_segments=256 num_words=213
2020-06-09 04:18:17,122: 20) loss=0.399 grad_norm=23.94 num_segments=256 num_words=215
2020-06-09 04:19:19,372: 21) loss=0.437 grad_norm=25.14 num_segments=256 num_words=208
2020-06-09 04:20:22,013: 22) loss=0.416 grad_norm=28.64 num_segments=256 num_words=200
2020-06-09 04:21:24,141: 23) loss=0.409 grad_norm=27.31 num_segments=256 num_words=213
2020-06-09 04:22:26,556: 24) loss=0.287 grad_norm=21.56 num_segments=256 num_words=215
2020-06-09 04:23:27,568: 25) loss=0.371 grad_norm=32.41 num_segments=256 num_words=200
2020-06-09 04:24:45,483: 26) loss=0.279 grad_norm=17.84 num_segments=256 num_words=200
2020-06-09 04:25:46,382: 27) loss=0.626 grad_norm=23.31 num_segments=256 num_words=212
2020-06-09 04:26:47,809: 28) loss=0.484 grad_norm=23.16 num_segments=256 num_words=206
2020-06-09 04:27:52,912: 29) loss=0.268 grad_norm=17.99 num_segments=256 num_words=213
2020-06-09 04:29:01,692: 30) loss=0.228 grad_norm=16.30 num_segments=256 num_words=208
2020-06-09 04:30:06,242: 31) loss=0.369 grad_norm=16.96 num_segments=256 num_words=211
2020-06-09 04:31:07,162: 32) loss=0.362 grad_norm=19.99 num_segments=256 num_words=201
2020-06-09 04:32:07,580: 33) loss=0.271 grad_norm=18.71 num_segments=256 num_words=203
2020-06-09 04:33:07,338: 34) loss=0.434 grad_norm=25.65 num_segments=256 num_words=204
2020-06-09 04:34:09,857: 35) loss=0.398 grad_norm=25.51 num_segments=256 num_words=210
2020-06-09 04:35:10,675: 36) loss=0.274 grad_norm=15.78 num_segments=256 num_words=220
2020-06-09 04:36:13,071: 37) loss=0.430 grad_norm=18.69 num_segments=256 num_words=208
2020-06-09 04:37:08,333: 38) loss=0.304 grad_norm=24.73 num_segments=243 num_words=206
2020-06-09 04:37:08,345: epoch= 14.00
2020-06-09 04:37:08,345:  >> time to evaluate and save:
2020-06-09 04:37:08,393: saved save/MultiViewDataset_IndividualWords.546.pth
2020-06-09 04:37:08,408: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 04:37:08,411: removed save/MultiViewDataset_IndividualWords.312.pth
2020-06-09 04:37:08,412: saved MultiViewDataset_IndividualWords successfully
2020-06-09 04:37:09,717: saved save/MultiViewRNN.546.pth
2020-06-09 04:37:09,724: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 04:37:09,763: removed save/MultiViewRNN.312.pth
2020-06-09 04:37:09,763: saved MultiViewRNN successfully
2020-06-09 04:37:12,261: saved save/Adam.546.pth
2020-06-09 04:37:12,284: most_recent linked save/Adam.most_recent.pth
2020-06-09 04:37:12,299: removed save/Adam.312.pth
2020-06-09 04:37:12,299: saved Adam successfully
2020-06-09 04:37:12,301: saved save/ReduceLROnPlateau.546.pth
2020-06-09 04:37:12,309: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 04:37:12,322: removed save/ReduceLROnPlateau.273.pth
2020-06-09 04:37:12,322: saved ReduceLROnPlateau successfully
2020-06-09 04:37:12,324: saved config successfully
2020-06-09 04:38:32,489:   >> crossview_ap=0.560 (10966 x 3921 pairs)
2020-06-09 04:39:27,024:   >> acoustic_ap=0.659 (10966 choose 2 pairs)
2020-06-09 04:39:27,030: best_so_far= 0.570 at 507
2020-06-09 04:39:27,382: epoch=14.00 global_step=546 lr=0.001 start_iter=0
2020-06-09 04:39:27,383: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 04:40:29,390: 0) loss=0.422 grad_norm=20.11 num_segments=256 num_words=208
2020-06-09 04:41:29,217: 1) loss=0.240 grad_norm=15.17 num_segments=256 num_words=213
2020-06-09 04:42:30,335: 2) loss=0.438 grad_norm=16.09 num_segments=256 num_words=213
2020-06-09 04:43:30,480: 3) loss=0.434 grad_norm=15.80 num_segments=256 num_words=207
2020-06-09 04:44:32,279: 4) loss=0.379 grad_norm=22.52 num_segments=256 num_words=207
2020-06-09 04:45:55,442: 5) loss=0.438 grad_norm=19.97 num_segments=256 num_words=206
2020-06-09 04:46:55,752: 6) loss=0.526 grad_norm=20.07 num_segments=256 num_words=222
2020-06-09 04:47:56,288: 7) loss=0.413 grad_norm=17.22 num_segments=256 num_words=216
2020-06-09 04:48:56,753: 8) loss=0.270 grad_norm=17.40 num_segments=256 num_words=203
2020-06-09 04:49:56,443: 9) loss=0.428 grad_norm=21.37 num_segments=256 num_words=205
2020-06-09 04:50:57,760: 10) loss=0.531 grad_norm=26.47 num_segments=256 num_words=218
2020-06-09 04:51:57,620: 11) loss=0.345 grad_norm=19.15 num_segments=256 num_words=209
2020-06-09 04:53:03,229: 12) loss=0.353 grad_norm=16.13 num_segments=256 num_words=206
2020-06-09 04:54:04,584: 13) loss=0.373 grad_norm=17.85 num_segments=256 num_words=211
2020-06-09 04:55:04,140: 14) loss=0.337 grad_norm=28.55 num_segments=256 num_words=212
2020-06-09 04:56:04,726: 15) loss=0.293 grad_norm=22.31 num_segments=256 num_words=214
2020-06-09 04:57:03,860: 16) loss=0.263 grad_norm=14.36 num_segments=256 num_words=209
2020-06-09 04:58:02,096: 17) loss=0.416 grad_norm=23.35 num_segments=256 num_words=217
2020-06-09 04:59:02,547: 18) loss=0.433 grad_norm=22.86 num_segments=256 num_words=199
2020-06-09 05:00:05,421: 19) loss=0.443 grad_norm=17.12 num_segments=256 num_words=208
2020-06-09 05:01:05,502: 20) loss=0.311 grad_norm=40.96 num_segments=256 num_words=222
2020-06-09 05:02:04,951: 21) loss=0.273 grad_norm=26.30 num_segments=256 num_words=221
2020-06-09 05:03:06,472: 22) loss=0.316 grad_norm=20.48 num_segments=256 num_words=202
2020-06-09 05:04:06,800: 23) loss=0.353 grad_norm=15.32 num_segments=256 num_words=210
2020-06-09 05:05:08,063: 24) loss=0.396 grad_norm=21.13 num_segments=256 num_words=213
2020-06-09 05:06:11,057: 25) loss=0.342 grad_norm=15.31 num_segments=256 num_words=218
2020-06-09 05:07:41,822: 26) loss=0.278 grad_norm=16.24 num_segments=256 num_words=213
2020-06-09 05:08:41,957: 27) loss=0.266 grad_norm=17.88 num_segments=256 num_words=212
2020-06-09 05:09:41,059: 28) loss=0.261 grad_norm=15.02 num_segments=256 num_words=215
2020-06-09 05:10:39,855: 29) loss=0.435 grad_norm=15.94 num_segments=256 num_words=199
2020-06-09 05:11:39,321: 30) loss=0.356 grad_norm=14.61 num_segments=256 num_words=208
2020-06-09 05:12:39,651: 31) loss=0.310 grad_norm=15.60 num_segments=256 num_words=211
2020-06-09 05:13:43,806: 32) loss=0.403 grad_norm=20.12 num_segments=256 num_words=207
2020-06-09 05:14:48,377: 33) loss=0.310 grad_norm=21.77 num_segments=256 num_words=204
2020-06-09 05:15:47,859: 34) loss=0.524 grad_norm=17.18 num_segments=256 num_words=209
2020-06-09 05:16:49,139: 35) loss=0.352 grad_norm=23.74 num_segments=256 num_words=215
2020-06-09 05:17:48,346: 36) loss=0.262 grad_norm=18.75 num_segments=256 num_words=206
2020-06-09 05:18:47,820: 37) loss=0.392 grad_norm=25.54 num_segments=256 num_words=215
2020-06-09 05:19:42,864: 38) loss=0.331 grad_norm=19.03 num_segments=243 num_words=206
2020-06-09 05:19:42,879: epoch= 15.00
2020-06-09 05:19:42,879:  >> time to evaluate and save:
2020-06-09 05:19:42,913: saved save/MultiViewDataset_IndividualWords.585.pth
2020-06-09 05:19:42,924: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 05:19:42,932: removed save/MultiViewDataset_IndividualWords.351.pth
2020-06-09 05:19:42,932: saved MultiViewDataset_IndividualWords successfully
2020-06-09 05:19:45,387: saved save/MultiViewRNN.585.pth
2020-06-09 05:19:45,393: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 05:19:45,468: removed save/MultiViewRNN.351.pth
2020-06-09 05:19:45,468: saved MultiViewRNN successfully
2020-06-09 05:19:50,117: saved save/Adam.585.pth
2020-06-09 05:19:50,127: most_recent linked save/Adam.most_recent.pth
2020-06-09 05:19:50,148: removed save/Adam.351.pth
2020-06-09 05:19:50,148: saved Adam successfully
2020-06-09 05:19:50,150: saved save/ReduceLROnPlateau.585.pth
2020-06-09 05:19:50,152: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 05:19:50,155: removed save/ReduceLROnPlateau.312.pth
2020-06-09 05:19:50,155: saved ReduceLROnPlateau successfully
2020-06-09 05:19:50,157: saved config successfully
2020-06-09 05:21:20,234:   >> crossview_ap=0.571 (10966 x 3921 pairs)
2020-06-09 05:22:12,713:   >> acoustic_ap=0.685 (10966 choose 2 pairs)
2020-06-09 05:22:12,717: best_so_far= 0.571 at 585
2020-06-09 05:22:12,738: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 05:22:12,742: saved MultiViewDataset_IndividualWords successfully
2020-06-09 05:22:12,755: best linked save/MultiViewRNN.best.pth
2020-06-09 05:22:12,765: saved MultiViewRNN successfully
2020-06-09 05:22:12,767: best linked save/Adam.best.pth
2020-06-09 05:22:12,776: saved Adam successfully
2020-06-09 05:22:12,788: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 05:22:12,804: removed save/ReduceLROnPlateau.351.pth
2020-06-09 05:22:12,804: saved ReduceLROnPlateau successfully
2020-06-09 05:22:13,639: epoch=15.00 global_step=585 lr=0.001 start_iter=0
2020-06-09 05:22:13,640: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 05:23:13,234: 0) loss=0.381 grad_norm=13.85 num_segments=256 num_words=214
2020-06-09 05:24:11,405: 1) loss=0.249 grad_norm=12.75 num_segments=256 num_words=204
2020-06-09 05:25:09,923: 2) loss=0.468 grad_norm=16.81 num_segments=256 num_words=220
2020-06-09 05:26:09,873: 3) loss=0.363 grad_norm=16.21 num_segments=256 num_words=212
2020-06-09 05:27:08,449: 4) loss=0.450 grad_norm=14.55 num_segments=256 num_words=202
2020-06-09 05:28:08,251: 5) loss=0.396 grad_norm=18.41 num_segments=256 num_words=201
2020-06-09 05:29:06,872: 6) loss=0.461 grad_norm=15.98 num_segments=256 num_words=208
2020-06-09 05:30:07,289: 7) loss=0.553 grad_norm=20.44 num_segments=256 num_words=215
2020-06-09 05:31:09,142: 8) loss=0.247 grad_norm=16.90 num_segments=256 num_words=207
2020-06-09 05:32:08,200: 9) loss=0.336 grad_norm=22.12 num_segments=256 num_words=207
2020-06-09 05:33:06,970: 10) loss=0.366 grad_norm=23.29 num_segments=256 num_words=218
2020-06-09 05:34:08,068: 11) loss=0.252 grad_norm=18.95 num_segments=256 num_words=210
2020-06-09 05:35:07,508: 12) loss=0.449 grad_norm=17.53 num_segments=256 num_words=208
2020-06-09 05:36:11,327: 13) loss=0.285 grad_norm=17.34 num_segments=256 num_words=213
2020-06-09 05:37:47,883: 14) loss=0.231 grad_norm=22.76 num_segments=256 num_words=217
2020-06-09 05:38:45,763: 15) loss=0.327 grad_norm=28.67 num_segments=256 num_words=208
2020-06-09 05:39:44,280: 16) loss=0.600 grad_norm=40.49 num_segments=256 num_words=204
2020-06-09 05:40:43,402: 17) loss=0.355 grad_norm=17.92 num_segments=256 num_words=196
2020-06-09 05:41:45,047: 18) loss=0.454 grad_norm=28.41 num_segments=256 num_words=216
2020-06-09 05:42:43,107: 19) loss=0.348 grad_norm=19.90 num_segments=256 num_words=209
2020-06-09 05:43:41,338: 20) loss=0.244 grad_norm=15.18 num_segments=256 num_words=221
2020-06-09 05:44:39,656: 21) loss=0.371 grad_norm=15.61 num_segments=256 num_words=215
2020-06-09 05:45:37,677: 22) loss=0.276 grad_norm=12.59 num_segments=256 num_words=214
2020-06-09 05:46:35,931: 23) loss=0.328 grad_norm=20.72 num_segments=256 num_words=209
2020-06-09 05:47:39,011: 24) loss=0.461 grad_norm=19.00 num_segments=256 num_words=210
2020-06-09 05:48:37,031: 25) loss=0.351 grad_norm=21.91 num_segments=256 num_words=205
2020-06-09 05:49:36,420: 26) loss=0.347 grad_norm=24.39 num_segments=256 num_words=218
2020-06-09 05:50:36,864: 27) loss=0.303 grad_norm=14.66 num_segments=256 num_words=205
2020-06-09 05:51:35,126: 28) loss=0.258 grad_norm=16.73 num_segments=256 num_words=212
2020-06-09 05:52:33,520: 29) loss=0.389 grad_norm=19.84 num_segments=256 num_words=217
2020-06-09 05:53:32,886: 30) loss=0.342 grad_norm=19.53 num_segments=256 num_words=216
2020-06-09 05:54:31,971: 31) loss=0.373 grad_norm=18.29 num_segments=256 num_words=218
2020-06-09 05:55:35,333: 32) loss=0.235 grad_norm=12.89 num_segments=256 num_words=208
2020-06-09 05:56:36,716: 33) loss=0.246 grad_norm=17.43 num_segments=256 num_words=217
2020-06-09 05:57:39,896: 34) loss=0.298 grad_norm=20.29 num_segments=256 num_words=217
2020-06-09 05:58:38,308: 35) loss=0.272 grad_norm=17.87 num_segments=256 num_words=214
2020-06-09 05:59:40,111: 36) loss=0.288 grad_norm=23.88 num_segments=256 num_words=211
2020-06-09 06:00:40,997: 37) loss=0.419 grad_norm=24.40 num_segments=256 num_words=218
2020-06-09 06:01:33,528: 38) loss=0.277 grad_norm=17.20 num_segments=243 num_words=201
2020-06-09 06:01:33,537: epoch= 16.00
2020-06-09 06:01:33,537:  >> time to evaluate and save:
2020-06-09 06:01:33,561: saved save/MultiViewDataset_IndividualWords.624.pth
2020-06-09 06:01:33,580: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 06:01:33,583: removed save/MultiViewDataset_IndividualWords.390.pth
2020-06-09 06:01:33,583: saved MultiViewDataset_IndividualWords successfully
2020-06-09 06:01:34,934: saved save/MultiViewRNN.624.pth
2020-06-09 06:01:34,938: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 06:01:34,970: removed save/MultiViewRNN.390.pth
2020-06-09 06:01:34,970: saved MultiViewRNN successfully
2020-06-09 06:01:37,543: saved save/Adam.624.pth
2020-06-09 06:01:37,554: most_recent linked save/Adam.most_recent.pth
2020-06-09 06:01:37,639: removed save/Adam.390.pth
2020-06-09 06:01:37,639: saved Adam successfully
2020-06-09 06:01:37,641: saved save/ReduceLROnPlateau.624.pth
2020-06-09 06:01:37,648: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 06:01:37,653: removed save/ReduceLROnPlateau.390.pth
2020-06-09 06:01:37,653: saved ReduceLROnPlateau successfully
2020-06-09 06:01:37,655: saved config successfully
2020-06-09 06:03:00,312:   >> crossview_ap=0.572 (10966 x 3921 pairs)
2020-06-09 06:03:51,140:   >> acoustic_ap=0.682 (10966 choose 2 pairs)
2020-06-09 06:03:51,143: best_so_far= 0.572 at 624
2020-06-09 06:03:51,155: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 06:03:51,157: saved MultiViewDataset_IndividualWords successfully
2020-06-09 06:03:51,165: best linked save/MultiViewRNN.best.pth
2020-06-09 06:03:51,174: saved MultiViewRNN successfully
2020-06-09 06:03:51,183: best linked save/Adam.best.pth
2020-06-09 06:03:51,190: saved Adam successfully
2020-06-09 06:03:51,202: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 06:03:51,206: saved ReduceLROnPlateau successfully
2020-06-09 06:03:52,008: epoch=16.00 global_step=624 lr=0.001 start_iter=0
2020-06-09 06:03:52,008: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 06:04:54,283: 0) loss=0.361 grad_norm=20.45 num_segments=256 num_words=213
2020-06-09 06:05:49,799: 1) loss=0.286 grad_norm=13.14 num_segments=256 num_words=208
2020-06-09 06:06:45,385: 2) loss=0.352 grad_norm=14.05 num_segments=256 num_words=199
2020-06-09 06:07:40,712: 3) loss=0.319 grad_norm=15.48 num_segments=256 num_words=203
2020-06-09 06:08:37,754: 4) loss=0.597 grad_norm=14.22 num_segments=256 num_words=204
2020-06-09 06:09:36,826: 5) loss=0.274 grad_norm=16.26 num_segments=256 num_words=207
2020-06-09 06:10:37,194: 6) loss=0.234 grad_norm=13.58 num_segments=256 num_words=211
2020-06-09 06:11:37,905: 7) loss=0.464 grad_norm=17.39 num_segments=256 num_words=210
2020-06-09 06:12:41,058: 8) loss=0.301 grad_norm=13.09 num_segments=256 num_words=191
2020-06-09 06:14:22,423: 9) loss=0.559 grad_norm=18.31 num_segments=256 num_words=214
2020-06-09 06:15:22,564: 10) loss=0.279 grad_norm=16.15 num_segments=256 num_words=214
2020-06-09 06:16:28,031: 11) loss=0.253 grad_norm=10.78 num_segments=256 num_words=215
2020-06-09 06:17:28,055: 12) loss=0.676 grad_norm=20.71 num_segments=256 num_words=222
2020-06-09 06:18:29,964: 13) loss=0.705 grad_norm=17.49 num_segments=256 num_words=214
2020-06-09 06:19:26,720: 14) loss=0.368 grad_norm=15.89 num_segments=256 num_words=220
2020-06-09 06:20:24,088: 15) loss=0.392 grad_norm=14.75 num_segments=256 num_words=212
2020-06-09 06:21:22,393: 16) loss=0.293 grad_norm=14.12 num_segments=256 num_words=210
2020-06-09 06:22:19,649: 17) loss=0.397 grad_norm=23.16 num_segments=256 num_words=205
2020-06-09 06:23:20,532: 18) loss=0.506 grad_norm=19.81 num_segments=256 num_words=202
2020-06-09 06:24:19,125: 19) loss=0.494 grad_norm=23.20 num_segments=256 num_words=208
2020-06-09 06:25:19,532: 20) loss=0.383 grad_norm=29.39 num_segments=256 num_words=203
2020-06-09 06:26:17,900: 21) loss=0.252 grad_norm=20.22 num_segments=256 num_words=209
2020-06-09 06:27:21,275: 22) loss=0.254 grad_norm=16.31 num_segments=256 num_words=220
2020-06-09 06:28:18,556: 23) loss=0.485 grad_norm=21.31 num_segments=256 num_words=207
2020-06-09 06:29:18,040: 24) loss=0.350 grad_norm=20.59 num_segments=256 num_words=214
2020-06-09 06:30:14,760: 25) loss=0.443 grad_norm=35.66 num_segments=256 num_words=216
2020-06-09 06:31:14,201: 26) loss=0.358 grad_norm=25.09 num_segments=256 num_words=215
2020-06-09 06:32:16,259: 27) loss=0.264 grad_norm=23.04 num_segments=256 num_words=206
2020-06-09 06:33:16,638: 28) loss=0.430 grad_norm=14.27 num_segments=256 num_words=207
2020-06-09 06:34:13,840: 29) loss=0.226 grad_norm=23.86 num_segments=256 num_words=205
2020-06-09 06:35:14,062: 30) loss=0.284 grad_norm=21.34 num_segments=256 num_words=219
2020-06-09 06:36:10,963: 31) loss=0.248 grad_norm=17.76 num_segments=256 num_words=203
2020-06-09 06:37:07,772: 32) loss=0.363 grad_norm=13.82 num_segments=256 num_words=208
2020-06-09 06:38:09,338: 33) loss=0.382 grad_norm=19.36 num_segments=256 num_words=212
2020-06-09 06:39:08,387: 34) loss=0.366 grad_norm=21.00 num_segments=256 num_words=205
2020-06-09 06:40:07,869: 35) loss=0.403 grad_norm=20.00 num_segments=256 num_words=216
2020-06-09 06:41:08,655: 36) loss=0.444 grad_norm=13.01 num_segments=256 num_words=216
2020-06-09 06:42:08,500: 37) loss=0.337 grad_norm=13.23 num_segments=256 num_words=219
2020-06-09 06:43:07,412: 38) loss=0.349 grad_norm=17.87 num_segments=243 num_words=203
2020-06-09 06:43:07,423: epoch= 17.00
2020-06-09 06:43:07,423:  >> time to evaluate and save:
2020-06-09 06:43:07,453: saved save/MultiViewDataset_IndividualWords.663.pth
2020-06-09 06:43:07,470: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 06:43:07,488: removed save/MultiViewDataset_IndividualWords.429.pth
2020-06-09 06:43:07,488: saved MultiViewDataset_IndividualWords successfully
2020-06-09 06:43:08,860: saved save/MultiViewRNN.663.pth
2020-06-09 06:43:08,870: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 06:43:08,897: removed save/MultiViewRNN.429.pth
2020-06-09 06:43:08,897: saved MultiViewRNN successfully
2020-06-09 06:43:11,454: saved save/Adam.663.pth
2020-06-09 06:43:11,464: most_recent linked save/Adam.most_recent.pth
2020-06-09 06:43:11,486: removed save/Adam.429.pth
2020-06-09 06:43:11,486: saved Adam successfully
2020-06-09 06:43:11,488: saved save/ReduceLROnPlateau.663.pth
2020-06-09 06:43:11,508: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 06:43:11,524: removed save/ReduceLROnPlateau.429.pth
2020-06-09 06:43:11,524: saved ReduceLROnPlateau successfully
2020-06-09 06:43:11,526: saved config successfully
2020-06-09 06:44:39,515:   >> crossview_ap=0.582 (10966 x 3921 pairs)
2020-06-09 06:45:33,365:   >> acoustic_ap=0.692 (10966 choose 2 pairs)
2020-06-09 06:45:33,369: best_so_far= 0.582 at 663
2020-06-09 06:45:33,373: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 06:45:33,376: saved MultiViewDataset_IndividualWords successfully
2020-06-09 06:45:33,387: best linked save/MultiViewRNN.best.pth
2020-06-09 06:45:33,399: saved MultiViewRNN successfully
2020-06-09 06:45:33,401: best linked save/Adam.best.pth
2020-06-09 06:45:33,410: saved Adam successfully
2020-06-09 06:45:33,412: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 06:45:33,414: saved ReduceLROnPlateau successfully
2020-06-09 06:45:34,725: epoch=17.00 global_step=663 lr=0.001 start_iter=0
2020-06-09 06:45:34,725: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 06:46:35,332: 0) loss=0.484 grad_norm=18.07 num_segments=256 num_words=219
2020-06-09 06:47:31,749: 1) loss=0.255 grad_norm=15.89 num_segments=256 num_words=205
2020-06-09 06:48:33,487: 2) loss=0.228 grad_norm=8.31 num_segments=256 num_words=219
2020-06-09 06:49:32,501: 3) loss=0.331 grad_norm=10.22 num_segments=256 num_words=206
2020-06-09 06:50:29,482: 4) loss=0.632 grad_norm=24.16 num_segments=256 num_words=208
2020-06-09 06:51:31,862: 5) loss=0.308 grad_norm=14.90 num_segments=256 num_words=210
2020-06-09 06:52:30,408: 6) loss=0.220 grad_norm=11.88 num_segments=256 num_words=205
2020-06-09 06:53:30,847: 7) loss=0.274 grad_norm=17.39 num_segments=256 num_words=205
2020-06-09 06:54:29,474: 8) loss=0.329 grad_norm=11.85 num_segments=256 num_words=206
2020-06-09 06:55:26,601: 9) loss=0.295 grad_norm=21.91 num_segments=256 num_words=208
2020-06-09 06:56:25,260: 10) loss=0.260 grad_norm=15.97 num_segments=256 num_words=219
2020-06-09 06:57:23,627: 11) loss=0.236 grad_norm=11.02 num_segments=256 num_words=211
2020-06-09 06:59:11,749: 12) loss=0.348 grad_norm=14.38 num_segments=256 num_words=218
2020-06-09 07:00:09,699: 13) loss=0.370 grad_norm=18.84 num_segments=256 num_words=216
2020-06-09 07:01:09,690: 14) loss=0.508 grad_norm=20.26 num_segments=256 num_words=206
2020-06-09 07:02:05,920: 15) loss=0.255 grad_norm=14.55 num_segments=256 num_words=211
2020-06-09 07:03:01,386: 16) loss=0.368 grad_norm=21.46 num_segments=256 num_words=210
2020-06-09 07:03:57,327: 17) loss=0.314 grad_norm=10.45 num_segments=256 num_words=201
2020-06-09 07:04:55,072: 18) loss=0.285 grad_norm=19.20 num_segments=256 num_words=212
2020-06-09 07:05:53,411: 19) loss=0.232 grad_norm=14.23 num_segments=256 num_words=205
2020-06-09 07:06:58,120: 20) loss=0.389 grad_norm=19.49 num_segments=256 num_words=219
2020-06-09 07:07:57,610: 21) loss=0.337 grad_norm=18.68 num_segments=256 num_words=210
2020-06-09 07:08:59,854: 22) loss=0.388 grad_norm=16.79 num_segments=256 num_words=218
2020-06-09 07:09:59,304: 23) loss=0.378 grad_norm=14.13 num_segments=256 num_words=204
2020-06-09 07:10:29,593: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-09 07:10:29,630: Using 1 GPU(s)
2020-06-09 07:10:29,630: Machine: 0 / 1
2020-06-09 07:10:29,631: Hyperparam tuning-------------------
2020-06-09 07:10:29,631: optim_lr: 0.001
2020-06-09 07:10:29,631: dropout (for both): 0.4
2020-06-09 07:10:29,631: margin: 0.4
2020-06-09 07:10:29,632: ------------------------------------
2020-06-09 07:10:29,633: Calling main function: multiview_trainer.train
2020-06-09 07:10:29,633: Using config file: train_config.json
2020-06-09 07:10:29,633: Using module at multiview_trainer.train
2020-06-09 07:10:31,585: Using module at multiview_vocab.MultiViewVocab
2020-06-09 07:10:31,588: Building vocab_data from config
2020-06-09 07:10:31,845:  >> min_count= 0
2020-06-09 07:10:31,845:  >> # words= 34323 (# removed= 0)
2020-06-09 07:10:31,845:  >> # subwords= 38
2020-06-09 07:10:31,845:      = 1
2020-06-09 07:10:31,845:     '= 2
2020-06-09 07:10:31,845:     -= 3
2020-06-09 07:10:31,845:     .= 4
2020-06-09 07:10:31,845:     <= 5
2020-06-09 07:10:31,845:     >= 6
2020-06-09 07:10:31,845:     [= 7
2020-06-09 07:10:31,845:     [laughter]= 8
2020-06-09 07:10:31,845:     [noise]= 9
2020-06-09 07:10:31,845:     [vocalized-noise]= 10
2020-06-09 07:10:31,845:     ]= 11
2020-06-09 07:10:31,845:     _= 12
2020-06-09 07:10:31,845:     a= 13
2020-06-09 07:10:31,846:     b= 14
2020-06-09 07:10:31,846:     c= 15
2020-06-09 07:10:31,846:     d= 16
2020-06-09 07:10:31,846:     e= 17
2020-06-09 07:10:31,846:     f= 18
2020-06-09 07:10:31,846:     g= 19
2020-06-09 07:10:31,846:     h= 20
2020-06-09 07:10:31,846:     i= 21
2020-06-09 07:10:31,846:     j= 22
2020-06-09 07:10:31,846:     k= 23
2020-06-09 07:10:31,846:     l= 24
2020-06-09 07:10:31,846:     m= 25
2020-06-09 07:10:31,846:     n= 26
2020-06-09 07:10:31,846:     o= 27
2020-06-09 07:10:31,846:     p= 28
2020-06-09 07:10:31,846:     q= 29
2020-06-09 07:10:31,846:     r= 30
2020-06-09 07:10:31,846:     s= 31
2020-06-09 07:10:31,846:     t= 32
2020-06-09 07:10:31,846:     u= 33
2020-06-09 07:10:31,847:     v= 34
2020-06-09 07:10:31,847:     w= 35
2020-06-09 07:10:31,847:     x= 36
2020-06-09 07:10:31,847:     y= 37
2020-06-09 07:10:31,847:     z= 38
2020-06-09 07:10:31,863: Using module at data.batch_samplers.BatchSampler
2020-06-09 07:10:31,865: Building vocab_sampler from config
2020-06-09 07:10:31,865:  >> # examples= 34323
2020-06-09 07:10:31,865:  >> batch_size= 1000
2020-06-09 07:10:31,865:  >> shuffle= False
2020-06-09 07:10:31,873:  >> BatchSampler; 35 batches
2020-06-09 07:10:31,873: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 07:10:32,317: Building train_data from config
2020-06-09 07:10:38,943:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-09 07:10:38,944:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-09 07:10:38,944:  >> stack= False
2020-06-09 07:10:38,944:  >> seg_durs= (1, None)
2020-06-09 07:10:38,944:  >> # words= 9971 (# ignored= 0)
2020-06-09 07:10:38,944:  >> input_feat_dim= 108
2020-06-09 07:10:38,944:  >> input_num_subwords= 38
2020-06-09 07:10:38,944: Using module at data.batch_samplers.BatchSampler
2020-06-09 07:10:38,944: Building train_sampler from config
2020-06-09 07:10:38,945:  >> # examples= 9971
2020-06-09 07:10:38,945:  >> batch_size= 256
2020-06-09 07:10:38,945:  >> shuffle= True
2020-06-09 07:10:38,955:  >> BatchSampler; 39 batches
2020-06-09 07:10:38,955: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 07:10:38,955: Building dev_data from config
2020-06-09 07:10:46,020:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-09 07:10:46,021:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-09 07:10:46,021:  >> stack= False
2020-06-09 07:10:46,021:  >> seg_durs= (1, None)
2020-06-09 07:10:46,021:  >> # words= 10966 (# ignored= 0)
2020-06-09 07:10:46,021:  >> input_feat_dim= 108
2020-06-09 07:10:46,021:  >> input_num_subwords= 38
2020-06-09 07:10:46,022: Using module at data.batch_samplers.BatchSampler
2020-06-09 07:10:46,022: Building dev_sampler from config
2020-06-09 07:10:46,022:  >> # examples= 10966
2020-06-09 07:10:46,023:  >> batch_size= 256
2020-06-09 07:10:46,023:  >> shuffle= False
2020-06-09 07:10:46,026:  >> BatchSampler; 43 batches
2020-06-09 07:10:46,026: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 07:10:46,026: Building test_data from config
2020-06-09 07:10:52,556:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-09 07:10:52,557:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-09 07:10:52,557:  >> stack= False
2020-06-09 07:10:52,557:  >> seg_durs= (1, None)
2020-06-09 07:10:52,557:  >> # words= 11024 (# ignored= 0)
2020-06-09 07:10:52,557:  >> input_feat_dim= 108
2020-06-09 07:10:52,557:  >> input_num_subwords= 38
2020-06-09 07:10:52,558: Using module at data.batch_samplers.BatchSampler
2020-06-09 07:10:52,558: Building test_sampler from config
2020-06-09 07:10:52,559:  >> # examples= 11024
2020-06-09 07:10:52,559:  >> batch_size= 256
2020-06-09 07:10:52,559:  >> shuffle= False
2020-06-09 07:10:52,563:  >> BatchSampler; 44 batches
2020-06-09 07:10:52,564: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-09 07:10:52,581: Building loss from config
2020-06-09 07:10:52,581:  >> margin= 0.4
2020-06-09 07:10:52,581:  >> k= 16
2020-06-09 07:10:52,582:  >> min_k= 8
2020-06-09 07:10:52,582:  >> extra= 0
2020-06-09 07:10:52,582:  >> average= False
2020-06-09 07:10:52,582:  >> margin_max= 0.5
2020-06-09 07:10:52,582:  >> threshold_max= 9
2020-06-09 07:10:52,582:  >> using obj0
2020-06-09 07:10:52,582: Using module at metric.multiview_ap.MultiViewAP
2020-06-09 07:10:52,623: Building eval from config
2020-06-09 07:10:52,624:  >> acoustic_ap= True
2020-06-09 07:10:52,624:  >> crossview_ap= True
2020-06-09 07:10:52,624:  >> full_vocab= False
2020-06-09 07:10:52,624:  >> metric= crossview_ap
2020-06-09 07:10:52,624:  >> mode= max
2020-06-09 07:10:52,624: Using module at multiview_rnn.MultiViewRNN
2020-06-09 07:10:52,631: Building net from config
2020-06-09 07:10:52,632: view1:
2020-06-09 07:10:52,633:  >> cell= GRU
2020-06-09 07:10:52,634:  >> input_size= 108
2020-06-09 07:10:52,634:  >> hidden_size= 512
2020-06-09 07:10:52,634:  >> bidirectional= True
2020-06-09 07:10:52,634:  >> num_layers= 6
2020-06-09 07:10:52,634:  >> dropout between layers= 0.4
2020-06-09 07:10:52,878: view2:
2020-06-09 07:10:52,879:  >> cell= GRU
2020-06-09 07:10:52,879:  >> input_size= 64
2020-06-09 07:10:52,879:  >> hidden_size= 512
2020-06-09 07:10:52,879:  >> bidirectional= True
2020-06-09 07:10:52,879:  >> num_layers= 2
2020-06-09 07:10:52,879:  >> dropout between layers= 0.4
2020-06-09 07:10:52,879:  >> num input embeddings= 38
2020-06-09 07:10:55,508: Using module at optim.adam.Adam
2020-06-09 07:10:55,511: Building optim from config
2020-06-09 07:10:55,511:  >> lr= 0.001
2020-06-09 07:10:55,511:  >> betas= (0.9, 0.999)
2020-06-09 07:10:55,511:  >> eps= 1e-08
2020-06-09 07:10:55,511:  >> weight_decay= 0
2020-06-09 07:10:55,511:  >> amsgrad= False
2020-06-09 07:10:55,512:  >> min_lr= 1e-07
2020-06-09 07:10:55,512: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-09 07:10:55,516: Building sched from config
2020-06-09 07:10:55,517:  >> optim= Adam
2020-06-09 07:10:55,517:  >> decay lr by 0.1
2020-06-09 07:10:55,517:  >> eval_fn= MultiViewAP
2020-06-09 07:10:55,517:  >> patience=4
2020-06-09 07:10:55,517:  >> revert=True
2020-06-09 07:10:55,522: loaded save/MultiViewDataset_IndividualWords.663.pth
2020-06-09 07:10:55,522: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 07:10:55,592: loaded save/MultiViewRNN.663.pth
2020-06-09 07:10:55,592: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 07:10:55,710: loaded save/Adam.663.pth
2020-06-09 07:10:55,711: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 07:10:55,712: loaded save/ReduceLROnPlateau.663.pth
2020-06-09 07:10:55,712: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 07:10:55,712: epoch=17.00 global_step=663 lr=0.001 start_iter=0
2020-06-09 07:10:55,713: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 07:13:05,070: 0) loss=0.430 grad_norm=23.94 num_segments=256 num_words=219
2020-06-09 07:14:40,638: 1) loss=0.237 grad_norm=20.11 num_segments=256 num_words=205
2020-06-09 07:16:10,309: 2) loss=0.191 grad_norm=8.24 num_segments=256 num_words=219
2020-06-09 07:17:35,244: 3) loss=0.267 grad_norm=9.89 num_segments=256 num_words=206
2020-06-09 07:18:52,386: 4) loss=0.542 grad_norm=18.36 num_segments=256 num_words=208
2020-06-09 07:20:02,664: 5) loss=0.265 grad_norm=20.98 num_segments=256 num_words=210
2020-06-09 07:21:05,224: 6) loss=0.212 grad_norm=20.15 num_segments=256 num_words=205
2020-06-09 07:22:00,182: 7) loss=0.277 grad_norm=18.18 num_segments=256 num_words=205
2020-06-09 07:22:58,283: 8) loss=0.333 grad_norm=19.09 num_segments=256 num_words=206
2020-06-09 07:23:53,587: 9) loss=0.291 grad_norm=14.24 num_segments=256 num_words=208
2020-06-09 07:24:51,189: 10) loss=0.262 grad_norm=20.02 num_segments=256 num_words=219
2020-06-09 07:25:49,313: 11) loss=0.325 grad_norm=15.91 num_segments=256 num_words=211
2020-06-09 07:26:44,683: 12) loss=0.355 grad_norm=13.76 num_segments=256 num_words=218
2020-06-09 07:27:39,835: 13) loss=0.367 grad_norm=24.31 num_segments=256 num_words=216
2020-06-09 07:28:40,128: 14) loss=0.412 grad_norm=17.23 num_segments=256 num_words=206
2020-06-09 07:29:36,826: 15) loss=0.327 grad_norm=14.03 num_segments=256 num_words=211
2020-06-09 07:30:32,319: 16) loss=0.364 grad_norm=13.93 num_segments=256 num_words=210
2020-06-09 07:31:31,680: 17) loss=0.401 grad_norm=10.38 num_segments=256 num_words=201
2020-06-09 07:32:27,106: 18) loss=0.351 grad_norm=15.98 num_segments=256 num_words=212
2020-06-09 07:33:27,467: 19) loss=0.230 grad_norm=12.12 num_segments=256 num_words=205
2020-06-09 07:34:24,188: 20) loss=0.324 grad_norm=13.51 num_segments=256 num_words=219
2020-06-09 07:35:19,234: 21) loss=0.335 grad_norm=25.44 num_segments=256 num_words=210
2020-06-09 07:36:14,176: 22) loss=0.424 grad_norm=18.08 num_segments=256 num_words=218
2020-06-09 07:37:11,054: 23) loss=0.272 grad_norm=15.77 num_segments=256 num_words=204
2020-06-09 07:38:11,816: 24) loss=0.249 grad_norm=15.42 num_segments=256 num_words=219
2020-06-09 07:39:07,374: 25) loss=0.264 grad_norm=13.89 num_segments=256 num_words=211
2020-06-09 07:40:10,041: 26) loss=0.320 grad_norm=12.62 num_segments=256 num_words=210
2020-06-09 07:41:11,205: 27) loss=0.400 grad_norm=26.93 num_segments=256 num_words=207
2020-06-09 07:42:06,488: 28) loss=0.330 grad_norm=12.69 num_segments=256 num_words=208
2020-06-09 07:43:01,592: 29) loss=0.535 grad_norm=17.17 num_segments=256 num_words=208
2020-06-09 07:43:58,413: 30) loss=0.269 grad_norm=10.63 num_segments=256 num_words=215
2020-06-09 07:45:00,982: 31) loss=0.413 grad_norm=14.02 num_segments=256 num_words=211
2020-06-09 07:45:58,873: 32) loss=0.333 grad_norm=13.51 num_segments=256 num_words=215
2020-06-09 07:46:53,863: 33) loss=0.299 grad_norm=14.46 num_segments=256 num_words=216
2020-06-09 07:47:49,882: 34) loss=0.258 grad_norm=14.11 num_segments=256 num_words=209
2020-06-09 07:48:46,759: 35) loss=0.375 grad_norm=19.27 num_segments=256 num_words=219
2020-06-09 07:49:42,718: 36) loss=0.379 grad_norm=16.76 num_segments=256 num_words=215
2020-06-09 07:50:38,255: 37) loss=0.269 grad_norm=16.65 num_segments=256 num_words=223
2020-06-09 07:51:29,554: 38) loss=0.596 grad_norm=17.57 num_segments=243 num_words=192
2020-06-09 07:51:29,563: epoch= 18.00
2020-06-09 07:51:29,563:  >> time to evaluate and save:
2020-06-09 07:51:29,592: saved save/MultiViewDataset_IndividualWords.702.pth
2020-06-09 07:51:29,691: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 07:51:29,736: removed save/MultiViewDataset_IndividualWords.468.pth
2020-06-09 07:51:29,736: saved MultiViewDataset_IndividualWords successfully
2020-06-09 07:51:31,130: saved save/MultiViewRNN.702.pth
2020-06-09 07:51:31,158: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 07:51:31,270: removed save/MultiViewRNN.468.pth
2020-06-09 07:51:31,271: saved MultiViewRNN successfully
2020-06-09 07:51:33,831: saved save/Adam.702.pth
2020-06-09 07:51:33,869: most_recent linked save/Adam.most_recent.pth
2020-06-09 07:51:33,968: removed save/Adam.468.pth
2020-06-09 07:51:33,968: saved Adam successfully
2020-06-09 07:51:33,981: saved save/ReduceLROnPlateau.702.pth
2020-06-09 07:51:33,992: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 07:51:33,997: saved ReduceLROnPlateau successfully
2020-06-09 07:51:33,998: saved config successfully
2020-06-09 07:52:54,659:   >> crossview_ap=0.579 (10966 x 3921 pairs)
2020-06-09 07:53:47,848:   >> acoustic_ap=0.679 (10966 choose 2 pairs)
2020-06-09 07:53:47,851: best_so_far= 0.579 at 702
2020-06-09 07:53:47,903: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 07:53:47,908: saved MultiViewDataset_IndividualWords successfully
2020-06-09 07:53:47,928: best linked save/MultiViewRNN.best.pth
2020-06-09 07:53:47,938: saved MultiViewRNN successfully
2020-06-09 07:53:47,968: best linked save/Adam.best.pth
2020-06-09 07:53:47,977: saved Adam successfully
2020-06-09 07:53:48,000: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 07:53:48,005: saved ReduceLROnPlateau successfully
2020-06-09 07:53:48,054: epoch=18.00 global_step=702 lr=0.001 start_iter=0
2020-06-09 07:53:48,055: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 07:54:51,196: 0) loss=0.276 grad_norm=10.96 num_segments=256 num_words=223
2020-06-09 07:55:56,926: 1) loss=0.564 grad_norm=18.60 num_segments=256 num_words=205
2020-06-09 07:56:52,817: 2) loss=0.648 grad_norm=13.64 num_segments=256 num_words=212
2020-06-09 07:57:52,283: 3) loss=0.236 grad_norm=8.57 num_segments=256 num_words=208
2020-06-09 07:58:48,705: 4) loss=0.259 grad_norm=13.63 num_segments=256 num_words=215
2020-06-09 07:59:46,029: 5) loss=0.251 grad_norm=8.40 num_segments=256 num_words=195
2020-06-09 08:00:41,132: 6) loss=0.312 grad_norm=9.81 num_segments=256 num_words=208
2020-06-09 08:01:37,824: 7) loss=0.278 grad_norm=20.75 num_segments=256 num_words=212
2020-06-09 08:02:33,352: 8) loss=0.295 grad_norm=12.16 num_segments=256 num_words=208
2020-06-09 08:03:28,732: 9) loss=0.328 grad_norm=14.45 num_segments=256 num_words=213
2020-06-09 08:04:23,513: 10) loss=0.230 grad_norm=16.56 num_segments=256 num_words=220
2020-06-09 08:05:18,361: 11) loss=0.274 grad_norm=15.26 num_segments=256 num_words=213
2020-06-09 08:06:24,381: 12) loss=0.332 grad_norm=11.27 num_segments=256 num_words=215
2020-06-09 08:07:26,351: 13) loss=0.338 grad_norm=14.19 num_segments=256 num_words=209
2020-06-09 08:08:21,843: 14) loss=0.309 grad_norm=16.84 num_segments=256 num_words=219
2020-06-09 08:09:17,452: 15) loss=0.310 grad_norm=12.81 num_segments=256 num_words=216
2020-06-09 08:10:12,518: 16) loss=0.339 grad_norm=13.13 num_segments=256 num_words=213
2020-06-09 08:11:08,371: 17) loss=0.257 grad_norm=9.81 num_segments=256 num_words=205
2020-06-09 08:12:03,728: 18) loss=0.228 grad_norm=12.25 num_segments=256 num_words=208
2020-06-09 08:12:58,951: 19) loss=0.270 grad_norm=11.26 num_segments=256 num_words=206
2020-06-09 08:13:54,264: 20) loss=0.389 grad_norm=16.05 num_segments=256 num_words=213
2020-06-09 08:14:49,715: 21) loss=0.372 grad_norm=18.48 num_segments=256 num_words=204
2020-06-09 08:15:46,337: 22) loss=0.405 grad_norm=18.99 num_segments=256 num_words=211
2020-06-09 08:16:42,160: 23) loss=0.444 grad_norm=18.07 num_segments=256 num_words=210
2020-06-09 08:17:37,468: 24) loss=0.235 grad_norm=19.87 num_segments=256 num_words=208
2020-06-09 08:18:33,805: 25) loss=0.762 grad_norm=19.75 num_segments=256 num_words=203
2020-06-09 08:19:43,926: 26) loss=0.220 grad_norm=17.37 num_segments=256 num_words=213
2020-06-09 08:20:44,056: 27) loss=0.317 grad_norm=13.18 num_segments=256 num_words=211
2020-06-09 08:21:40,272: 28) loss=0.267 grad_norm=14.06 num_segments=256 num_words=210
2020-06-09 08:22:35,918: 29) loss=0.373 grad_norm=13.66 num_segments=256 num_words=210
2020-06-09 08:23:31,916: 30) loss=0.449 grad_norm=19.39 num_segments=256 num_words=214
2020-06-09 08:24:28,658: 31) loss=0.331 grad_norm=20.11 num_segments=256 num_words=213
2020-06-09 08:25:24,582: 32) loss=0.556 grad_norm=18.62 num_segments=256 num_words=215
2020-06-09 08:26:22,264: 33) loss=0.246 grad_norm=13.09 num_segments=256 num_words=202
2020-06-09 08:27:18,351: 34) loss=0.344 grad_norm=11.27 num_segments=256 num_words=192
2020-06-09 08:28:17,557: 35) loss=0.219 grad_norm=7.72 num_segments=256 num_words=202
2020-06-09 08:29:13,257: 36) loss=0.313 grad_norm=23.53 num_segments=256 num_words=209
2020-06-09 08:30:09,361: 37) loss=0.324 grad_norm=14.20 num_segments=256 num_words=212
2020-06-09 08:30:59,707: 38) loss=0.359 grad_norm=14.97 num_segments=243 num_words=200
2020-06-09 08:30:59,716: epoch= 19.00
2020-06-09 08:30:59,716:  >> time to evaluate and save:
2020-06-09 08:30:59,740: saved save/MultiViewDataset_IndividualWords.741.pth
2020-06-09 08:30:59,767: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 08:30:59,814: removed save/MultiViewDataset_IndividualWords.507.pth
2020-06-09 08:30:59,814: saved MultiViewDataset_IndividualWords successfully
2020-06-09 08:31:01,126: saved save/MultiViewRNN.741.pth
2020-06-09 08:31:01,152: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 08:31:01,242: removed save/MultiViewRNN.507.pth
2020-06-09 08:31:01,243: saved MultiViewRNN successfully
2020-06-09 08:31:03,770: saved save/Adam.741.pth
2020-06-09 08:31:03,778: most_recent linked save/Adam.most_recent.pth
2020-06-09 08:31:03,860: removed save/Adam.507.pth
2020-06-09 08:31:03,860: saved Adam successfully
2020-06-09 08:31:03,863: saved save/ReduceLROnPlateau.741.pth
2020-06-09 08:31:03,869: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 08:31:03,883: removed save/ReduceLROnPlateau.468.pth
2020-06-09 08:31:03,883: saved ReduceLROnPlateau successfully
2020-06-09 08:31:03,885: saved config successfully
2020-06-09 08:32:21,698:   >> crossview_ap=0.589 (10966 x 3921 pairs)
2020-06-09 08:33:13,739:   >> acoustic_ap=0.718 (10966 choose 2 pairs)
2020-06-09 08:33:13,744: best_so_far= 0.589 at 741
2020-06-09 08:33:13,789: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 08:33:13,793: saved MultiViewDataset_IndividualWords successfully
2020-06-09 08:33:13,817: best linked save/MultiViewRNN.best.pth
2020-06-09 08:33:13,829: saved MultiViewRNN successfully
2020-06-09 08:33:13,849: best linked save/Adam.best.pth
2020-06-09 08:33:13,858: saved Adam successfully
2020-06-09 08:33:13,910: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 08:33:13,936: removed save/ReduceLROnPlateau.507.pth
2020-06-09 08:33:13,936: saved ReduceLROnPlateau successfully
2020-06-09 08:33:14,400: epoch=19.00 global_step=741 lr=0.001 start_iter=0
2020-06-09 08:33:14,401: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 08:34:11,558: 0) loss=0.364 grad_norm=14.29 num_segments=256 num_words=206
2020-06-09 08:35:08,016: 1) loss=0.354 grad_norm=10.32 num_segments=256 num_words=205
2020-06-09 08:36:04,145: 2) loss=0.382 grad_norm=17.51 num_segments=256 num_words=205
2020-06-09 08:37:04,212: 3) loss=0.349 grad_norm=13.91 num_segments=256 num_words=207
2020-06-09 08:38:03,356: 4) loss=0.339 grad_norm=13.32 num_segments=256 num_words=217
2020-06-09 08:39:21,644: 5) loss=0.328 grad_norm=9.33 num_segments=256 num_words=208
2020-06-09 08:40:20,143: 6) loss=0.270 grad_norm=11.88 num_segments=256 num_words=213
2020-06-09 08:41:17,870: 7) loss=0.314 grad_norm=11.04 num_segments=256 num_words=210
2020-06-09 08:42:14,500: 8) loss=0.231 grad_norm=10.65 num_segments=256 num_words=219
2020-06-09 08:43:11,385: 9) loss=0.326 grad_norm=29.14 num_segments=256 num_words=209
2020-06-09 08:44:09,232: 10) loss=0.270 grad_norm=13.26 num_segments=256 num_words=211
2020-06-09 08:45:06,492: 11) loss=0.258 grad_norm=26.22 num_segments=256 num_words=216
2020-06-09 08:46:01,392: 12) loss=0.374 grad_norm=12.76 num_segments=256 num_words=205
2020-06-09 08:46:57,744: 13) loss=0.453 grad_norm=12.80 num_segments=256 num_words=207
2020-06-09 08:47:56,799: 14) loss=0.236 grad_norm=10.25 num_segments=256 num_words=209
2020-06-09 08:49:00,110: 15) loss=0.335 grad_norm=17.83 num_segments=256 num_words=206
2020-06-09 08:49:55,352: 16) loss=0.315 grad_norm=13.97 num_segments=256 num_words=202
2020-06-09 08:50:52,218: 17) loss=0.223 grad_norm=14.63 num_segments=256 num_words=207
2020-06-09 08:51:49,378: 18) loss=0.254 grad_norm=11.20 num_segments=256 num_words=212
2020-06-09 08:52:46,252: 19) loss=0.330 grad_norm=21.07 num_segments=256 num_words=223
2020-06-09 08:53:41,556: 20) loss=0.225 grad_norm=17.57 num_segments=256 num_words=216
2020-06-09 08:54:37,030: 21) loss=0.391 grad_norm=20.57 num_segments=256 num_words=217
2020-06-09 08:55:32,662: 22) loss=0.411 grad_norm=17.37 num_segments=256 num_words=204
2020-06-09 08:56:28,245: 23) loss=0.392 grad_norm=31.46 num_segments=256 num_words=208
2020-06-09 08:57:23,620: 24) loss=0.333 grad_norm=16.65 num_segments=256 num_words=201
2020-06-09 08:58:19,311: 25) loss=0.323 grad_norm=17.36 num_segments=256 num_words=214
2020-06-09 08:59:36,031: 26) loss=0.312 grad_norm=13.59 num_segments=256 num_words=208
2020-06-09 09:00:31,570: 27) loss=0.600 grad_norm=20.39 num_segments=256 num_words=215
2020-06-09 09:01:28,804: 28) loss=0.386 grad_norm=17.43 num_segments=256 num_words=213
2020-06-09 09:02:24,184: 29) loss=0.326 grad_norm=13.84 num_segments=256 num_words=215
2020-06-09 09:03:19,493: 30) loss=0.268 grad_norm=15.65 num_segments=256 num_words=200
2020-06-09 09:04:16,149: 31) loss=0.301 grad_norm=13.86 num_segments=256 num_words=211
2020-06-09 09:05:12,340: 32) loss=0.411 grad_norm=20.29 num_segments=256 num_words=218
2020-06-09 09:06:07,854: 33) loss=0.340 grad_norm=14.62 num_segments=256 num_words=210
2020-06-09 09:07:03,184: 34) loss=0.309 grad_norm=22.37 num_segments=256 num_words=214
2020-06-09 09:08:05,999: 35) loss=0.405 grad_norm=25.55 num_segments=256 num_words=202
2020-06-09 09:09:03,053: 36) loss=0.292 grad_norm=22.42 num_segments=256 num_words=208
2020-06-09 09:09:59,143: 37) loss=0.266 grad_norm=18.92 num_segments=256 num_words=206
2020-06-09 09:10:48,762: 38) loss=0.293 grad_norm=13.20 num_segments=243 num_words=197
2020-06-09 09:10:48,771: epoch= 20.00
2020-06-09 09:10:48,771:  >> time to evaluate and save:
2020-06-09 09:10:48,795: saved save/MultiViewDataset_IndividualWords.780.pth
2020-06-09 09:10:48,814: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 09:10:48,838: removed save/MultiViewDataset_IndividualWords.546.pth
2020-06-09 09:10:48,839: saved MultiViewDataset_IndividualWords successfully
2020-06-09 09:10:50,156: saved save/MultiViewRNN.780.pth
2020-06-09 09:10:50,168: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 09:10:50,199: removed save/MultiViewRNN.546.pth
2020-06-09 09:10:50,200: saved MultiViewRNN successfully
2020-06-09 09:10:52,930: saved save/Adam.780.pth
2020-06-09 09:10:53,074: most_recent linked save/Adam.most_recent.pth
2020-06-09 09:10:53,878: removed save/Adam.546.pth
2020-06-09 09:10:53,878: saved Adam successfully
2020-06-09 09:10:54,066: saved save/ReduceLROnPlateau.780.pth
2020-06-09 09:10:54,200: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 09:10:54,505: removed save/ReduceLROnPlateau.546.pth
2020-06-09 09:10:54,505: saved ReduceLROnPlateau successfully
2020-06-09 09:10:54,537: saved config successfully
2020-06-09 09:12:09,816:   >> crossview_ap=0.584 (10966 x 3921 pairs)
2020-06-09 09:13:04,935:   >> acoustic_ap=0.702 (10966 choose 2 pairs)
2020-06-09 09:13:04,940: best_so_far= 0.589 at 741
2020-06-09 09:13:05,607: epoch=20.00 global_step=780 lr=0.001 start_iter=0
2020-06-09 09:13:05,607: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 09:14:04,941: 0) loss=0.394 grad_norm=16.69 num_segments=256 num_words=204
2020-06-09 09:15:01,354: 1) loss=0.224 grad_norm=18.58 num_segments=256 num_words=215
2020-06-09 09:15:57,382: 2) loss=0.411 grad_norm=16.30 num_segments=256 num_words=208
2020-06-09 09:16:56,927: 3) loss=0.298 grad_norm=14.35 num_segments=256 num_words=214
2020-06-09 09:17:53,770: 4) loss=0.493 grad_norm=21.07 num_segments=256 num_words=218
2020-06-09 09:18:50,236: 5) loss=0.453 grad_norm=17.04 num_segments=256 num_words=206
2020-06-09 09:19:46,597: 6) loss=0.245 grad_norm=13.33 num_segments=256 num_words=212
2020-06-09 09:20:43,259: 7) loss=0.390 grad_norm=10.40 num_segments=256 num_words=203
2020-06-09 09:21:49,663: 8) loss=0.364 grad_norm=12.16 num_segments=256 num_words=212
2020-06-09 09:22:54,134: 9) loss=0.269 grad_norm=17.32 num_segments=256 num_words=211
2020-06-09 09:23:51,886: 10) loss=0.341 grad_norm=24.13 num_segments=256 num_words=213
2020-06-09 09:24:49,807: 11) loss=0.218 grad_norm=9.79 num_segments=256 num_words=218
2020-06-09 09:25:48,810: 12) loss=0.367 grad_norm=13.29 num_segments=256 num_words=200
2020-06-09 09:26:45,782: 13) loss=0.246 grad_norm=25.35 num_segments=256 num_words=214
2020-06-09 09:28:15,887: 14) loss=0.360 grad_norm=12.52 num_segments=256 num_words=211
2020-06-09 09:29:11,572: 15) loss=0.296 grad_norm=10.20 num_segments=256 num_words=195
2020-06-09 09:30:09,845: 16) loss=0.293 grad_norm=22.31 num_segments=256 num_words=216
2020-06-09 09:31:10,841: 17) loss=0.428 grad_norm=22.03 num_segments=256 num_words=215
2020-06-09 09:32:07,297: 18) loss=0.658 grad_norm=21.41 num_segments=256 num_words=195
2020-06-09 09:33:03,860: 19) loss=0.308 grad_norm=13.71 num_segments=256 num_words=202
2020-06-09 09:34:00,151: 20) loss=0.416 grad_norm=14.70 num_segments=256 num_words=207
2020-06-09 09:34:56,578: 21) loss=0.342 grad_norm=20.16 num_segments=256 num_words=209
2020-06-09 09:35:53,114: 22) loss=0.343 grad_norm=19.67 num_segments=256 num_words=216
2020-06-09 09:36:49,264: 23) loss=0.297 grad_norm=10.86 num_segments=256 num_words=213
2020-06-09 09:37:45,265: 24) loss=0.374 grad_norm=13.78 num_segments=256 num_words=215
2020-06-09 09:38:47,025: 25) loss=0.285 grad_norm=13.77 num_segments=256 num_words=218
2020-06-09 09:39:42,577: 26) loss=0.268 grad_norm=13.60 num_segments=256 num_words=220
2020-06-09 09:40:39,730: 27) loss=0.325 grad_norm=8.68 num_segments=256 num_words=195
2020-06-09 09:41:37,824: 28) loss=0.317 grad_norm=9.76 num_segments=256 num_words=214
2020-06-09 09:42:35,331: 29) loss=0.440 grad_norm=20.61 num_segments=256 num_words=216
2020-06-09 09:43:31,601: 30) loss=0.224 grad_norm=22.86 num_segments=256 num_words=210
2020-06-09 09:44:27,689: 31) loss=0.241 grad_norm=14.31 num_segments=256 num_words=223
2020-06-09 09:45:23,778: 32) loss=0.431 grad_norm=16.08 num_segments=256 num_words=210
2020-06-09 09:46:19,666: 33) loss=0.272 grad_norm=15.37 num_segments=256 num_words=218
2020-06-09 09:47:17,731: 34) loss=0.271 grad_norm=16.56 num_segments=256 num_words=211
2020-06-09 09:48:13,941: 35) loss=0.274 grad_norm=11.29 num_segments=256 num_words=215
2020-06-09 09:49:10,881: 36) loss=0.290 grad_norm=14.67 num_segments=256 num_words=212
2020-06-09 09:50:06,839: 37) loss=0.426 grad_norm=15.22 num_segments=256 num_words=211
2020-06-09 09:50:57,332: 38) loss=0.322 grad_norm=18.52 num_segments=243 num_words=199
2020-06-09 09:50:57,341: epoch= 21.00
2020-06-09 09:50:57,341:  >> time to evaluate and save:
2020-06-09 09:50:57,365: saved save/MultiViewDataset_IndividualWords.819.pth
2020-06-09 09:50:57,395: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 09:50:57,442: removed save/MultiViewDataset_IndividualWords.585.pth
2020-06-09 09:50:57,442: saved MultiViewDataset_IndividualWords successfully
2020-06-09 09:50:58,859: saved save/MultiViewRNN.819.pth
2020-06-09 09:50:58,869: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 09:50:58,894: removed save/MultiViewRNN.585.pth
2020-06-09 09:50:58,894: saved MultiViewRNN successfully
2020-06-09 09:51:01,512: saved save/Adam.819.pth
2020-06-09 09:51:01,520: most_recent linked save/Adam.most_recent.pth
2020-06-09 09:51:01,568: removed save/Adam.585.pth
2020-06-09 09:51:01,568: saved Adam successfully
2020-06-09 09:51:01,570: saved save/ReduceLROnPlateau.819.pth
2020-06-09 09:51:01,576: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 09:51:01,595: removed save/ReduceLROnPlateau.585.pth
2020-06-09 09:51:01,595: saved ReduceLROnPlateau successfully
2020-06-09 09:51:01,596: saved config successfully
2020-06-09 09:52:37,793:   >> crossview_ap=0.587 (10966 x 3921 pairs)
2020-06-09 09:53:42,999:   >> acoustic_ap=0.710 (10966 choose 2 pairs)
2020-06-09 09:53:43,002: best_so_far= 0.589 at 741
2020-06-09 09:53:43,937: epoch=21.00 global_step=819 lr=0.001 start_iter=0
2020-06-09 09:53:43,937: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 09:54:45,213: 0) loss=0.303 grad_norm=11.19 num_segments=256 num_words=220
2020-06-09 09:55:43,305: 1) loss=0.392 grad_norm=11.15 num_segments=256 num_words=224
2020-06-09 09:56:42,691: 2) loss=0.350 grad_norm=16.79 num_segments=256 num_words=208
2020-06-09 09:57:40,288: 3) loss=0.411 grad_norm=15.73 num_segments=256 num_words=212
2020-06-09 09:58:41,407: 4) loss=0.289 grad_norm=10.96 num_segments=256 num_words=220
2020-06-09 09:59:40,068: 5) loss=0.510 grad_norm=11.42 num_segments=256 num_words=205
2020-06-09 10:00:36,000: 6) loss=0.356 grad_norm=8.90 num_segments=256 num_words=212
2020-06-09 10:01:32,627: 7) loss=0.369 grad_norm=13.08 num_segments=256 num_words=210
2020-06-09 10:02:29,804: 8) loss=0.264 grad_norm=6.78 num_segments=256 num_words=204
2020-06-09 10:04:07,604: 9) loss=0.594 grad_norm=18.29 num_segments=256 num_words=217
2020-06-09 10:05:04,706: 10) loss=0.330 grad_norm=8.97 num_segments=256 num_words=204
2020-06-09 10:06:11,671: 11) loss=0.435 grad_norm=10.52 num_segments=256 num_words=215
2020-06-09 10:07:10,248: 12) loss=0.251 grad_norm=7.98 num_segments=256 num_words=213
2020-06-09 10:08:10,952: 13) loss=0.278 grad_norm=15.44 num_segments=256 num_words=207
2020-06-09 10:09:15,520: 14) loss=0.228 grad_norm=12.35 num_segments=256 num_words=211
2020-06-09 10:10:25,615: 15) loss=0.342 grad_norm=8.99 num_segments=256 num_words=201
2020-06-09 10:11:26,783: 16) loss=0.270 grad_norm=14.52 num_segments=256 num_words=214
2020-06-09 10:12:34,521: 17) loss=0.317 grad_norm=11.83 num_segments=256 num_words=205
2020-06-09 10:13:33,670: 18) loss=0.299 grad_norm=13.74 num_segments=256 num_words=214
2020-06-09 10:14:33,121: 19) loss=0.258 grad_norm=13.69 num_segments=256 num_words=213
2020-06-09 10:15:32,514: 20) loss=0.295 grad_norm=21.65 num_segments=256 num_words=212
2020-06-09 10:16:36,301: 21) loss=0.221 grad_norm=10.40 num_segments=256 num_words=211
2020-06-09 10:17:36,423: 22) loss=0.240 grad_norm=12.34 num_segments=256 num_words=212
2020-06-09 10:18:36,106: 23) loss=0.322 grad_norm=19.41 num_segments=256 num_words=211
2020-06-09 10:19:37,618: 24) loss=0.303 grad_norm=18.01 num_segments=256 num_words=208
2020-06-09 10:20:38,484: 25) loss=0.336 grad_norm=15.10 num_segments=256 num_words=218
2020-06-09 10:21:37,406: 26) loss=0.357 grad_norm=15.08 num_segments=256 num_words=212
2020-06-09 10:22:37,249: 27) loss=0.276 grad_norm=11.33 num_segments=256 num_words=214
2020-06-09 10:23:35,220: 28) loss=0.232 grad_norm=19.56 num_segments=256 num_words=210
2020-06-09 10:24:34,193: 29) loss=0.337 grad_norm=11.56 num_segments=256 num_words=210
2020-06-09 10:25:36,164: 30) loss=0.245 grad_norm=14.02 num_segments=256 num_words=204
2020-06-09 10:26:35,674: 31) loss=0.512 grad_norm=13.05 num_segments=256 num_words=193
2020-06-09 10:27:34,736: 32) loss=0.294 grad_norm=14.17 num_segments=256 num_words=205
2020-06-09 10:28:32,515: 33) loss=0.276 grad_norm=14.89 num_segments=256 num_words=203
2020-06-09 10:29:32,668: 34) loss=0.329 grad_norm=17.74 num_segments=256 num_words=213
2020-06-09 10:30:30,548: 35) loss=0.435 grad_norm=12.85 num_segments=256 num_words=210
2020-06-09 10:31:30,905: 36) loss=0.383 grad_norm=16.53 num_segments=256 num_words=203
2020-06-09 10:32:29,506: 37) loss=0.423 grad_norm=21.32 num_segments=256 num_words=217
2020-06-09 10:33:25,168: 38) loss=0.333 grad_norm=12.92 num_segments=243 num_words=202
2020-06-09 10:33:25,177: epoch= 22.00
2020-06-09 10:33:25,177:  >> time to evaluate and save:
2020-06-09 10:33:25,202: saved save/MultiViewDataset_IndividualWords.858.pth
2020-06-09 10:33:25,230: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 10:33:25,250: removed save/MultiViewDataset_IndividualWords.624.pth
2020-06-09 10:33:25,250: saved MultiViewDataset_IndividualWords successfully
2020-06-09 10:33:26,641: saved save/MultiViewRNN.858.pth
2020-06-09 10:33:26,660: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 10:33:26,689: removed save/MultiViewRNN.624.pth
2020-06-09 10:33:26,689: saved MultiViewRNN successfully
2020-06-09 10:33:29,253: saved save/Adam.858.pth
2020-06-09 10:33:29,259: most_recent linked save/Adam.most_recent.pth
2020-06-09 10:33:29,306: removed save/Adam.624.pth
2020-06-09 10:33:29,307: saved Adam successfully
2020-06-09 10:33:29,309: saved save/ReduceLROnPlateau.858.pth
2020-06-09 10:33:29,325: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 10:33:29,333: removed save/ReduceLROnPlateau.624.pth
2020-06-09 10:33:29,333: saved ReduceLROnPlateau successfully
2020-06-09 10:33:29,334: saved config successfully
2020-06-09 10:35:05,143:   >> crossview_ap=0.585 (10966 x 3921 pairs)
2020-06-09 10:36:03,436:   >> acoustic_ap=0.700 (10966 choose 2 pairs)
2020-06-09 10:36:03,442: best_so_far= 0.589 at 741
2020-06-09 10:36:04,678: epoch=22.00 global_step=858 lr=0.001 start_iter=0
2020-06-09 10:36:04,678: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 10:37:06,933: 0) loss=0.309 grad_norm=10.43 num_segments=256 num_words=211
2020-06-09 10:38:04,971: 1) loss=0.396 grad_norm=9.76 num_segments=256 num_words=209
2020-06-09 10:39:02,257: 2) loss=0.592 grad_norm=14.48 num_segments=256 num_words=210
2020-06-09 10:39:59,820: 3) loss=0.213 grad_norm=11.00 num_segments=256 num_words=216
2020-06-09 10:41:02,148: 4) loss=0.312 grad_norm=29.15 num_segments=256 num_words=209
2020-06-09 10:42:00,344: 5) loss=0.368 grad_norm=15.04 num_segments=256 num_words=204
2020-06-09 10:42:58,024: 6) loss=0.338 grad_norm=16.31 num_segments=256 num_words=214
2020-06-09 10:44:01,158: 7) loss=0.246 grad_norm=6.91 num_segments=256 num_words=217
2020-06-09 10:45:02,955: 8) loss=0.232 grad_norm=11.48 num_segments=256 num_words=205
2020-06-09 10:46:02,226: 9) loss=0.210 grad_norm=10.15 num_segments=256 num_words=207
2020-06-09 10:46:58,821: 10) loss=0.272 grad_norm=11.98 num_segments=256 num_words=200
2020-06-09 10:47:55,503: 11) loss=0.200 grad_norm=10.39 num_segments=256 num_words=214
2020-06-09 10:49:46,232: 12) loss=0.201 grad_norm=13.54 num_segments=256 num_words=212
2020-06-09 10:50:43,224: 13) loss=0.360 grad_norm=21.91 num_segments=256 num_words=211
2020-06-09 10:51:40,001: 14) loss=0.210 grad_norm=14.44 num_segments=256 num_words=208
2020-06-09 10:52:36,670: 15) loss=0.315 grad_norm=17.81 num_segments=256 num_words=205
2020-06-09 10:53:33,424: 16) loss=0.235 grad_norm=8.70 num_segments=256 num_words=215
2020-06-09 10:54:30,111: 17) loss=0.496 grad_norm=25.98 num_segments=256 num_words=195
2020-06-09 10:55:26,882: 18) loss=0.260 grad_norm=13.42 num_segments=256 num_words=213
2020-06-09 10:56:23,495: 19) loss=0.340 grad_norm=19.82 num_segments=256 num_words=220
2020-06-09 10:57:20,762: 20) loss=0.322 grad_norm=14.50 num_segments=256 num_words=213
2020-06-09 10:58:19,622: 21) loss=0.254 grad_norm=11.58 num_segments=256 num_words=209
2020-06-09 10:59:18,739: 22) loss=0.388 grad_norm=24.27 num_segments=256 num_words=210
2020-06-09 11:00:18,729: 23) loss=0.257 grad_norm=10.20 num_segments=256 num_words=205
2020-06-09 11:01:18,061: 24) loss=0.258 grad_norm=15.59 num_segments=256 num_words=207
2020-06-09 11:02:17,142: 25) loss=0.311 grad_norm=12.05 num_segments=256 num_words=217
2020-06-09 11:03:16,017: 26) loss=0.218 grad_norm=8.67 num_segments=256 num_words=213
2020-06-09 11:04:13,839: 27) loss=0.355 grad_norm=14.16 num_segments=256 num_words=216
2020-06-09 11:05:12,443: 28) loss=0.329 grad_norm=11.85 num_segments=256 num_words=204
2020-06-09 11:06:10,797: 29) loss=0.334 grad_norm=12.72 num_segments=256 num_words=220
2020-06-09 11:07:08,829: 30) loss=0.433 grad_norm=20.18 num_segments=256 num_words=215
2020-06-09 11:08:06,978: 31) loss=0.392 grad_norm=20.15 num_segments=256 num_words=207
2020-06-09 11:09:06,025: 32) loss=0.210 grad_norm=29.27 num_segments=256 num_words=210
2020-06-09 11:10:04,701: 33) loss=0.331 grad_norm=19.23 num_segments=256 num_words=206
2020-06-09 11:22:47,592: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-09 11:22:47,642: Using 1 GPU(s)
2020-06-09 11:22:47,642: Machine: 0 / 1
2020-06-09 11:22:47,644: Hyperparam tuning-------------------
2020-06-09 11:22:47,644: optim_lr: 0.001
2020-06-09 11:22:47,644: dropout (for both): 0.4
2020-06-09 11:22:47,644: margin: 0.4
2020-06-09 11:22:47,644: ------------------------------------
2020-06-09 11:22:47,772: Calling main function: multiview_trainer.train
2020-06-09 11:22:47,772: Using config file: train_config.json
2020-06-09 11:22:47,772: Using module at multiview_trainer.train
2020-06-09 11:22:56,787: Using module at multiview_vocab.MultiViewVocab
2020-06-09 11:22:56,821: Building vocab_data from config
2020-06-09 11:22:57,228:  >> min_count= 0
2020-06-09 11:22:57,228:  >> # words= 34323 (# removed= 0)
2020-06-09 11:22:57,228:  >> # subwords= 38
2020-06-09 11:22:57,228:      = 1
2020-06-09 11:22:57,228:     '= 2
2020-06-09 11:22:57,228:     -= 3
2020-06-09 11:22:57,228:     .= 4
2020-06-09 11:22:57,229:     <= 5
2020-06-09 11:22:57,229:     >= 6
2020-06-09 11:22:57,229:     [= 7
2020-06-09 11:22:57,229:     [laughter]= 8
2020-06-09 11:22:57,229:     [noise]= 9
2020-06-09 11:22:57,229:     [vocalized-noise]= 10
2020-06-09 11:22:57,229:     ]= 11
2020-06-09 11:22:57,229:     _= 12
2020-06-09 11:22:57,229:     a= 13
2020-06-09 11:22:57,229:     b= 14
2020-06-09 11:22:57,229:     c= 15
2020-06-09 11:22:57,229:     d= 16
2020-06-09 11:22:57,229:     e= 17
2020-06-09 11:22:57,229:     f= 18
2020-06-09 11:22:57,229:     g= 19
2020-06-09 11:22:57,229:     h= 20
2020-06-09 11:22:57,229:     i= 21
2020-06-09 11:22:57,229:     j= 22
2020-06-09 11:22:57,229:     k= 23
2020-06-09 11:22:57,230:     l= 24
2020-06-09 11:22:57,230:     m= 25
2020-06-09 11:22:57,230:     n= 26
2020-06-09 11:22:57,230:     o= 27
2020-06-09 11:22:57,230:     p= 28
2020-06-09 11:22:57,230:     q= 29
2020-06-09 11:22:57,230:     r= 30
2020-06-09 11:22:57,230:     s= 31
2020-06-09 11:22:57,230:     t= 32
2020-06-09 11:22:57,230:     u= 33
2020-06-09 11:22:57,230:     v= 34
2020-06-09 11:22:57,230:     w= 35
2020-06-09 11:22:57,230:     x= 36
2020-06-09 11:22:57,230:     y= 37
2020-06-09 11:22:57,230:     z= 38
2020-06-09 11:22:57,245: Using module at data.batch_samplers.BatchSampler
2020-06-09 11:22:57,247: Building vocab_sampler from config
2020-06-09 11:22:57,248:  >> # examples= 34323
2020-06-09 11:22:57,248:  >> batch_size= 1000
2020-06-09 11:22:57,248:  >> shuffle= False
2020-06-09 11:22:57,256:  >> BatchSampler; 35 batches
2020-06-09 11:22:57,256: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 11:22:59,466: Building train_data from config
2020-06-09 11:23:05,848:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-09 11:23:05,849:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-09 11:23:05,849:  >> stack= False
2020-06-09 11:23:05,850:  >> seg_durs= (1, None)
2020-06-09 11:23:05,850:  >> # words= 9971 (# ignored= 0)
2020-06-09 11:23:05,850:  >> input_feat_dim= 108
2020-06-09 11:23:05,850:  >> input_num_subwords= 38
2020-06-09 11:23:05,850: Using module at data.batch_samplers.BatchSampler
2020-06-09 11:23:05,850: Building train_sampler from config
2020-06-09 11:23:05,851:  >> # examples= 9971
2020-06-09 11:23:05,851:  >> batch_size= 256
2020-06-09 11:23:05,852:  >> shuffle= True
2020-06-09 11:23:05,866:  >> BatchSampler; 39 batches
2020-06-09 11:23:05,866: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 11:23:05,866: Building dev_data from config
2020-06-09 11:23:12,929:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-09 11:23:12,929:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-09 11:23:12,929:  >> stack= False
2020-06-09 11:23:12,929:  >> seg_durs= (1, None)
2020-06-09 11:23:12,929:  >> # words= 10966 (# ignored= 0)
2020-06-09 11:23:12,929:  >> input_feat_dim= 108
2020-06-09 11:23:12,929:  >> input_num_subwords= 38
2020-06-09 11:23:12,930: Using module at data.batch_samplers.BatchSampler
2020-06-09 11:23:12,930: Building dev_sampler from config
2020-06-09 11:23:12,930:  >> # examples= 10966
2020-06-09 11:23:12,930:  >> batch_size= 256
2020-06-09 11:23:12,930:  >> shuffle= False
2020-06-09 11:23:12,932:  >> BatchSampler; 43 batches
2020-06-09 11:23:12,932: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 11:23:12,932: Building test_data from config
2020-06-09 11:23:19,116:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-09 11:23:19,116:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-09 11:23:19,116:  >> stack= False
2020-06-09 11:23:19,116:  >> seg_durs= (1, None)
2020-06-09 11:23:19,116:  >> # words= 11024 (# ignored= 0)
2020-06-09 11:23:19,116:  >> input_feat_dim= 108
2020-06-09 11:23:19,116:  >> input_num_subwords= 38
2020-06-09 11:23:19,116: Using module at data.batch_samplers.BatchSampler
2020-06-09 11:23:19,116: Building test_sampler from config
2020-06-09 11:23:19,117:  >> # examples= 11024
2020-06-09 11:23:19,117:  >> batch_size= 256
2020-06-09 11:23:19,117:  >> shuffle= False
2020-06-09 11:23:19,119:  >> BatchSampler; 44 batches
2020-06-09 11:23:19,119: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-09 11:23:19,276: Building loss from config
2020-06-09 11:23:19,277:  >> margin= 0.4
2020-06-09 11:23:19,277:  >> k= 16
2020-06-09 11:23:19,277:  >> min_k= 8
2020-06-09 11:23:19,277:  >> extra= 0
2020-06-09 11:23:19,277:  >> average= False
2020-06-09 11:23:19,278:  >> margin_max= 0.5
2020-06-09 11:23:19,278:  >> threshold_max= 9
2020-06-09 11:23:19,278:  >> using obj0
2020-06-09 11:23:19,278: Using module at metric.multiview_ap.MultiViewAP
2020-06-09 11:23:20,527: Building eval from config
2020-06-09 11:23:20,527:  >> acoustic_ap= True
2020-06-09 11:23:20,528:  >> crossview_ap= True
2020-06-09 11:23:20,528:  >> full_vocab= False
2020-06-09 11:23:20,528:  >> metric= crossview_ap
2020-06-09 11:23:20,528:  >> mode= max
2020-06-09 11:23:20,528: Using module at multiview_rnn.MultiViewRNN
2020-06-09 11:23:20,585: Building net from config
2020-06-09 11:23:20,587: view1:
2020-06-09 11:23:20,587:  >> cell= GRU
2020-06-09 11:23:20,588:  >> input_size= 108
2020-06-09 11:23:20,588:  >> hidden_size= 512
2020-06-09 11:23:20,588:  >> bidirectional= True
2020-06-09 11:23:20,588:  >> num_layers= 6
2020-06-09 11:23:20,588:  >> dropout between layers= 0.4
2020-06-09 11:23:20,838: view2:
2020-06-09 11:23:20,839:  >> cell= GRU
2020-06-09 11:23:20,840:  >> input_size= 64
2020-06-09 11:23:20,840:  >> hidden_size= 512
2020-06-09 11:23:20,840:  >> bidirectional= True
2020-06-09 11:23:20,840:  >> num_layers= 2
2020-06-09 11:23:20,840:  >> dropout between layers= 0.4
2020-06-09 11:23:20,840:  >> num input embeddings= 38
2020-06-09 11:23:32,709: Using module at optim.adam.Adam
2020-06-09 11:23:32,720: Building optim from config
2020-06-09 11:23:32,721:  >> lr= 0.001
2020-06-09 11:23:32,721:  >> betas= (0.9, 0.999)
2020-06-09 11:23:32,721:  >> eps= 1e-08
2020-06-09 11:23:32,721:  >> weight_decay= 0
2020-06-09 11:23:32,721:  >> amsgrad= False
2020-06-09 11:23:32,721:  >> min_lr= 1e-07
2020-06-09 11:23:32,722: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-09 11:23:32,753: Building sched from config
2020-06-09 11:23:32,753:  >> optim= Adam
2020-06-09 11:23:32,754:  >> decay lr by 0.1
2020-06-09 11:23:32,754:  >> eval_fn= MultiViewAP
2020-06-09 11:23:32,754:  >> patience=4
2020-06-09 11:23:32,755:  >> revert=True
2020-06-09 11:23:32,767: loaded save/MultiViewDataset_IndividualWords.858.pth
2020-06-09 11:23:32,767: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 11:23:33,874: loaded save/MultiViewRNN.858.pth
2020-06-09 11:23:33,875: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 11:23:36,074: loaded save/Adam.858.pth
2020-06-09 11:23:36,074: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 11:23:36,076: loaded save/ReduceLROnPlateau.858.pth
2020-06-09 11:23:36,076: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 11:23:36,076: epoch=22.00 global_step=858 lr=0.001 start_iter=0
2020-06-09 11:23:36,076: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 11:25:25,751: 0) loss=0.221 grad_norm=7.23 num_segments=256 num_words=211
2020-06-09 11:27:05,494: 1) loss=0.338 grad_norm=9.07 num_segments=256 num_words=209
2020-06-09 11:28:53,336: 2) loss=0.475 grad_norm=13.59 num_segments=256 num_words=210
2020-06-09 11:30:20,747: 3) loss=0.242 grad_norm=6.57 num_segments=256 num_words=216
2020-06-09 11:31:39,253: 4) loss=0.296 grad_norm=11.64 num_segments=256 num_words=209
2020-06-09 11:32:53,090: 5) loss=0.318 grad_norm=7.70 num_segments=256 num_words=204
2020-06-09 11:33:57,167: 6) loss=0.315 grad_norm=15.68 num_segments=256 num_words=214
2020-06-09 11:34:55,121: 7) loss=0.246 grad_norm=16.30 num_segments=256 num_words=217
2020-06-09 11:35:55,341: 8) loss=0.228 grad_norm=19.91 num_segments=256 num_words=205
2020-06-09 11:36:52,363: 9) loss=0.214 grad_norm=10.63 num_segments=256 num_words=207
2020-06-09 11:37:53,088: 10) loss=0.347 grad_norm=13.47 num_segments=256 num_words=200
2020-06-09 11:38:51,973: 11) loss=0.198 grad_norm=12.80 num_segments=256 num_words=214
2020-06-09 11:40:02,081: 12) loss=0.202 grad_norm=9.64 num_segments=256 num_words=212
2020-06-09 11:41:06,542: 13) loss=0.356 grad_norm=21.79 num_segments=256 num_words=211
2020-06-09 11:42:13,523: 14) loss=0.214 grad_norm=25.64 num_segments=256 num_words=208
2020-06-09 11:43:14,190: 15) loss=0.323 grad_norm=10.19 num_segments=256 num_words=205
2020-06-09 11:44:13,554: 16) loss=0.235 grad_norm=8.19 num_segments=256 num_words=215
2020-06-09 11:45:14,233: 17) loss=0.490 grad_norm=16.51 num_segments=256 num_words=195
2020-06-09 11:46:32,516: 18) loss=0.311 grad_norm=12.39 num_segments=256 num_words=213
2020-06-09 11:47:38,641: 19) loss=0.326 grad_norm=12.63 num_segments=256 num_words=220
2020-06-09 11:48:35,818: 20) loss=0.326 grad_norm=10.88 num_segments=256 num_words=213
2020-06-09 11:49:34,320: 21) loss=0.250 grad_norm=12.60 num_segments=256 num_words=209
2020-06-09 11:50:31,822: 22) loss=0.347 grad_norm=15.14 num_segments=256 num_words=210
2020-06-09 11:51:30,485: 23) loss=0.251 grad_norm=7.84 num_segments=256 num_words=205
2020-06-09 11:52:36,928: 24) loss=0.305 grad_norm=10.25 num_segments=256 num_words=207
2020-06-09 11:53:36,113: 25) loss=0.306 grad_norm=9.09 num_segments=256 num_words=217
2020-06-09 11:54:34,420: 26) loss=0.217 grad_norm=6.99 num_segments=256 num_words=213
2020-06-09 11:55:34,196: 27) loss=0.353 grad_norm=16.57 num_segments=256 num_words=216
2020-06-09 11:56:32,808: 28) loss=0.370 grad_norm=18.99 num_segments=256 num_words=204
2020-06-09 11:57:30,579: 29) loss=0.423 grad_norm=10.03 num_segments=256 num_words=220
2020-06-09 11:58:30,571: 30) loss=0.339 grad_norm=9.08 num_segments=256 num_words=215
2020-06-09 11:59:35,978: 31) loss=0.389 grad_norm=21.20 num_segments=256 num_words=207
2020-06-09 12:00:34,449: 32) loss=0.204 grad_norm=9.43 num_segments=256 num_words=210
2020-06-09 12:01:34,068: 33) loss=0.330 grad_norm=16.61 num_segments=256 num_words=206
2020-06-09 12:02:32,390: 34) loss=0.360 grad_norm=12.34 num_segments=256 num_words=213
2020-06-09 12:03:31,534: 35) loss=0.268 grad_norm=13.32 num_segments=256 num_words=205
2020-06-09 12:04:37,004: 36) loss=0.376 grad_norm=17.97 num_segments=256 num_words=203
2020-06-09 12:05:35,577: 37) loss=0.391 grad_norm=13.24 num_segments=256 num_words=214
2020-06-09 12:06:29,011: 38) loss=0.318 grad_norm=13.63 num_segments=243 num_words=189
2020-06-09 12:06:29,025: epoch= 23.00
2020-06-09 12:06:29,025:  >> time to evaluate and save:
2020-06-09 12:06:29,062: saved save/MultiViewDataset_IndividualWords.897.pth
2020-06-09 12:06:29,071: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 12:06:29,077: removed save/MultiViewDataset_IndividualWords.663.pth
2020-06-09 12:06:29,077: saved MultiViewDataset_IndividualWords successfully
2020-06-09 12:06:30,397: saved save/MultiViewRNN.897.pth
2020-06-09 12:06:30,399: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 12:06:30,586: removed save/MultiViewRNN.663.pth
2020-06-09 12:06:30,586: saved MultiViewRNN successfully
2020-06-09 12:06:33,166: saved save/Adam.897.pth
2020-06-09 12:06:33,167: most_recent linked save/Adam.most_recent.pth
2020-06-09 12:06:33,446: removed save/Adam.663.pth
2020-06-09 12:06:33,446: saved Adam successfully
2020-06-09 12:06:33,448: saved save/ReduceLROnPlateau.897.pth
2020-06-09 12:06:33,450: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 12:06:33,453: removed save/ReduceLROnPlateau.663.pth
2020-06-09 12:06:33,454: saved ReduceLROnPlateau successfully
2020-06-09 12:06:33,455: saved config successfully
2020-06-09 12:07:58,236:   >> crossview_ap=0.588 (10966 x 3921 pairs)
2020-06-09 12:08:56,245:   >> acoustic_ap=0.707 (10966 choose 2 pairs)
2020-06-09 12:08:56,248: best_so_far= 0.589 at 741
2020-06-09 12:08:56,286: epoch=23.00 global_step=897 lr=0.001 start_iter=0
2020-06-09 12:08:56,286: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 12:09:58,604: 0) loss=0.342 grad_norm=17.79 num_segments=256 num_words=209
2020-06-09 12:11:07,924: 1) loss=0.242 grad_norm=9.79 num_segments=256 num_words=216
2020-06-09 12:12:08,159: 2) loss=0.299 grad_norm=10.05 num_segments=256 num_words=210
2020-06-09 12:13:10,445: 3) loss=0.379 grad_norm=8.97 num_segments=256 num_words=211
2020-06-09 12:14:19,034: 4) loss=0.306 grad_norm=8.18 num_segments=256 num_words=211
2020-06-09 12:15:25,329: 5) loss=0.246 grad_norm=11.41 num_segments=256 num_words=209
2020-06-09 12:16:31,900: 6) loss=0.240 grad_norm=7.66 num_segments=256 num_words=212
2020-06-09 12:17:42,608: 7) loss=0.254 grad_norm=19.52 num_segments=256 num_words=210
2020-06-09 12:18:48,351: 8) loss=0.355 grad_norm=12.73 num_segments=256 num_words=213
2020-06-09 12:19:54,433: 9) loss=0.416 grad_norm=12.08 num_segments=256 num_words=209
2020-06-09 12:21:00,422: 10) loss=0.344 grad_norm=12.68 num_segments=256 num_words=209
2020-06-09 12:22:14,898: 11) loss=0.218 grad_norm=10.50 num_segments=256 num_words=213
2020-06-09 12:23:33,552: 12) loss=0.337 grad_norm=10.40 num_segments=256 num_words=210
2020-06-09 12:24:39,682: 13) loss=0.311 grad_norm=16.27 num_segments=256 num_words=212
2020-06-09 12:25:45,196: 14) loss=0.231 grad_norm=7.87 num_segments=256 num_words=208
2020-06-09 12:26:52,693: 15) loss=0.320 grad_norm=13.20 num_segments=256 num_words=220
2020-06-09 12:28:00,728: 16) loss=0.371 grad_norm=14.65 num_segments=256 num_words=199
2020-06-09 12:29:06,513: 17) loss=0.218 grad_norm=8.32 num_segments=256 num_words=215
2020-06-09 12:30:12,630: 18) loss=0.424 grad_norm=15.26 num_segments=256 num_words=215
2020-06-09 12:31:18,453: 19) loss=0.329 grad_norm=10.76 num_segments=256 num_words=215
2020-06-09 12:32:24,804: 20) loss=0.292 grad_norm=10.60 num_segments=256 num_words=206
2020-06-09 12:33:34,562: 21) loss=0.313 grad_norm=15.00 num_segments=256 num_words=211
2020-06-09 12:34:40,472: 22) loss=0.399 grad_norm=11.03 num_segments=256 num_words=208
2020-06-09 12:35:46,162: 23) loss=0.342 grad_norm=10.61 num_segments=256 num_words=203
2020-06-09 12:36:51,940: 24) loss=0.250 grad_norm=8.73 num_segments=256 num_words=207
2020-06-09 12:37:58,153: 25) loss=0.468 grad_norm=10.25 num_segments=256 num_words=205
2020-06-09 12:39:20,470: 26) loss=0.332 grad_norm=14.28 num_segments=256 num_words=214
2020-06-09 12:40:24,869: 27) loss=0.428 grad_norm=11.03 num_segments=256 num_words=201
2020-06-09 12:41:30,566: 28) loss=0.273 grad_norm=10.90 num_segments=256 num_words=216
2020-06-09 12:42:36,269: 29) loss=0.279 grad_norm=9.81 num_segments=256 num_words=218
2020-06-09 12:43:41,962: 30) loss=0.396 grad_norm=20.46 num_segments=256 num_words=209
2020-06-09 12:44:50,617: 31) loss=0.330 grad_norm=10.57 num_segments=256 num_words=215
2020-06-09 12:45:56,618: 32) loss=0.324 grad_norm=14.29 num_segments=256 num_words=210
2020-06-09 12:47:03,399: 33) loss=0.398 grad_norm=17.40 num_segments=256 num_words=199
2020-06-09 12:48:09,444: 34) loss=0.256 grad_norm=10.12 num_segments=256 num_words=208
2020-06-09 12:49:16,732: 35) loss=0.307 grad_norm=18.72 num_segments=256 num_words=197
2020-06-09 12:50:25,847: 36) loss=0.219 grad_norm=20.84 num_segments=256 num_words=207
2020-06-09 12:51:31,673: 37) loss=0.348 grad_norm=24.20 num_segments=256 num_words=212
2020-06-09 12:52:31,045: 38) loss=0.330 grad_norm=19.17 num_segments=243 num_words=197
2020-06-09 12:52:31,057: epoch= 24.00
2020-06-09 12:52:31,057:  >> time to evaluate and save:
2020-06-09 12:52:31,102: saved save/MultiViewDataset_IndividualWords.936.pth
2020-06-09 12:52:31,114: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 12:52:31,136: removed save/MultiViewDataset_IndividualWords.702.pth
2020-06-09 12:52:31,136: saved MultiViewDataset_IndividualWords successfully
2020-06-09 12:52:32,459: saved save/MultiViewRNN.936.pth
2020-06-09 12:52:32,468: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 12:52:32,503: removed save/MultiViewRNN.702.pth
2020-06-09 12:52:32,503: saved MultiViewRNN successfully
2020-06-09 12:52:35,055: saved save/Adam.936.pth
2020-06-09 12:52:35,073: most_recent linked save/Adam.most_recent.pth
2020-06-09 12:52:35,143: removed save/Adam.702.pth
2020-06-09 12:52:35,144: saved Adam successfully
2020-06-09 12:52:35,146: saved save/ReduceLROnPlateau.936.pth
2020-06-09 12:52:35,194: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 12:52:35,208: removed save/ReduceLROnPlateau.702.pth
2020-06-09 12:52:35,208: saved ReduceLROnPlateau successfully
2020-06-09 12:52:35,210: saved config successfully
2020-06-09 12:54:08,303:   >> crossview_ap=0.579 (10966 x 3921 pairs)
2020-06-09 12:55:10,455:   >> acoustic_ap=0.706 (10966 choose 2 pairs)
2020-06-09 12:55:10,460: best_so_far= 0.589 at 741
2020-06-09 12:55:10,460: Reverting to previous best
2020-06-09 12:55:11,620: loaded save/MultiViewRNN.741.pth
2020-06-09 12:55:11,620: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 12:55:13,880: loaded save/Adam.741.pth
2020-06-09 12:55:13,880: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 12:55:13,880: Reducing group lr from 0.001 to 0.0001
2020-06-09 12:55:13,894: best linked save/Adam.best.pth
2020-06-09 12:55:14,414: epoch=24.00 global_step=936 lr=0.0001 start_iter=0
2020-06-09 12:55:14,414: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 12:56:21,780: 0) loss=0.330 grad_norm=15.13 num_segments=256 num_words=212
2020-06-09 12:57:28,229: 1) loss=0.363 grad_norm=9.23 num_segments=256 num_words=215
2020-06-09 12:58:47,805: 2) loss=0.220 grad_norm=7.90 num_segments=256 num_words=221
2020-06-09 12:59:54,251: 3) loss=0.223 grad_norm=7.00 num_segments=256 num_words=207
2020-06-09 13:01:02,001: 4) loss=0.224 grad_norm=9.10 num_segments=256 num_words=213
2020-06-09 13:02:32,059: 5) loss=0.608 grad_norm=9.26 num_segments=256 num_words=203
2020-06-09 13:03:37,987: 6) loss=0.494 grad_norm=16.11 num_segments=256 num_words=206
2020-06-09 13:04:44,576: 7) loss=0.504 grad_norm=9.76 num_segments=256 num_words=205
2020-06-09 13:05:49,764: 8) loss=0.350 grad_norm=9.14 num_segments=256 num_words=201
2020-06-09 13:06:54,773: 9) loss=0.275 grad_norm=8.05 num_segments=256 num_words=204
2020-06-09 13:08:01,010: 10) loss=0.285 grad_norm=7.21 num_segments=256 num_words=200
2020-06-09 13:09:06,169: 11) loss=0.278 grad_norm=8.34 num_segments=256 num_words=200
2020-06-09 13:10:13,493: 12) loss=0.252 grad_norm=9.79 num_segments=256 num_words=215
2020-06-09 13:11:18,111: 13) loss=0.381 grad_norm=8.36 num_segments=256 num_words=210
2020-06-09 13:12:25,646: 14) loss=0.391 grad_norm=11.36 num_segments=256 num_words=206
2020-06-09 13:13:30,670: 15) loss=0.332 grad_norm=10.40 num_segments=256 num_words=211
2020-06-09 13:14:36,283: 16) loss=0.417 grad_norm=11.62 num_segments=256 num_words=212
2020-06-09 13:15:42,135: 17) loss=0.322 grad_norm=10.35 num_segments=256 num_words=212
2020-06-09 13:16:47,449: 18) loss=0.273 grad_norm=8.36 num_segments=256 num_words=221
2020-06-09 13:17:53,432: 19) loss=0.470 grad_norm=8.60 num_segments=256 num_words=209
2020-06-09 13:18:59,214: 20) loss=0.296 grad_norm=6.53 num_segments=256 num_words=207
2020-06-09 13:20:05,918: 21) loss=0.374 grad_norm=7.36 num_segments=256 num_words=196
2020-06-09 13:21:11,760: 22) loss=0.507 grad_norm=9.36 num_segments=256 num_words=212
2020-06-09 13:22:14,815: 23) loss=0.355 grad_norm=6.08 num_segments=256 num_words=210
2020-06-09 13:23:16,256: 24) loss=0.242 grad_norm=8.04 num_segments=256 num_words=216
2020-06-09 13:24:16,788: 25) loss=0.319 grad_norm=7.38 num_segments=256 num_words=218
2020-06-09 13:25:48,976: 26) loss=0.204 grad_norm=6.53 num_segments=256 num_words=213
2020-06-09 13:26:51,594: 27) loss=0.341 grad_norm=7.73 num_segments=256 num_words=215
2020-06-09 13:27:53,873: 28) loss=0.206 grad_norm=5.06 num_segments=256 num_words=219
2020-06-09 13:28:55,777: 29) loss=0.232 grad_norm=6.49 num_segments=256 num_words=207
2020-06-09 13:29:58,684: 30) loss=0.375 grad_norm=9.17 num_segments=256 num_words=209
2020-06-09 13:30:59,699: 31) loss=0.351 grad_norm=8.15 num_segments=256 num_words=207
2020-06-09 13:32:00,000: 32) loss=0.286 grad_norm=7.91 num_segments=256 num_words=204
2020-06-09 13:33:00,686: 33) loss=0.213 grad_norm=11.23 num_segments=256 num_words=212
2020-06-09 13:34:00,294: 34) loss=0.349 grad_norm=7.11 num_segments=256 num_words=218
2020-06-09 13:34:59,179: 35) loss=0.472 grad_norm=8.12 num_segments=256 num_words=208
2020-06-09 13:35:58,045: 36) loss=0.242 grad_norm=5.34 num_segments=256 num_words=211
2020-06-09 13:36:58,382: 37) loss=0.429 grad_norm=8.51 num_segments=256 num_words=210
2020-06-09 13:37:51,557: 38) loss=0.471 grad_norm=9.69 num_segments=243 num_words=209
2020-06-09 13:37:51,566: epoch= 25.00
2020-06-09 13:37:51,566:  >> time to evaluate and save:
2020-06-09 13:37:51,598: saved save/MultiViewDataset_IndividualWords.975.pth
2020-06-09 13:37:51,617: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 13:37:51,636: removed save/MultiViewDataset_IndividualWords.780.pth
2020-06-09 13:37:51,636: saved MultiViewDataset_IndividualWords successfully
2020-06-09 13:37:52,926: saved save/MultiViewRNN.975.pth
2020-06-09 13:37:52,943: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 13:37:53,006: removed save/MultiViewRNN.780.pth
2020-06-09 13:37:53,006: saved MultiViewRNN successfully
2020-06-09 13:37:55,580: saved save/Adam.975.pth
2020-06-09 13:37:55,596: most_recent linked save/Adam.most_recent.pth
2020-06-09 13:37:55,644: removed save/Adam.741.pth
2020-06-09 13:37:55,644: saved Adam successfully
2020-06-09 13:37:55,647: saved save/ReduceLROnPlateau.975.pth
2020-06-09 13:37:55,661: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 13:37:55,682: removed save/ReduceLROnPlateau.780.pth
2020-06-09 13:37:55,682: saved ReduceLROnPlateau successfully
2020-06-09 13:37:55,684: saved config successfully
2020-06-09 13:39:24,150:   >> crossview_ap=0.606 (10966 x 3921 pairs)
2020-06-09 13:40:20,494:   >> acoustic_ap=0.729 (10966 choose 2 pairs)
2020-06-09 13:40:20,499: best_so_far= 0.606 at 975
2020-06-09 13:40:20,526: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 13:40:20,530: saved MultiViewDataset_IndividualWords successfully
2020-06-09 13:40:20,566: best linked save/MultiViewRNN.best.pth
2020-06-09 13:40:20,576: saved MultiViewRNN successfully
2020-06-09 13:40:20,589: best linked save/Adam.best.pth
2020-06-09 13:40:20,599: saved Adam successfully
2020-06-09 13:40:20,604: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 13:40:20,617: saved ReduceLROnPlateau successfully
2020-06-09 13:40:21,425: epoch=25.00 global_step=975 lr=0.0001 start_iter=0
2020-06-09 13:40:21,426: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 13:41:21,311: 0) loss=0.370 grad_norm=6.39 num_segments=256 num_words=212
2020-06-09 13:42:21,202: 1) loss=0.472 grad_norm=8.65 num_segments=256 num_words=198
2020-06-09 13:43:20,100: 2) loss=0.223 grad_norm=5.66 num_segments=256 num_words=210
2020-06-09 13:44:19,113: 3) loss=0.210 grad_norm=5.38 num_segments=256 num_words=223
2020-06-09 13:45:20,091: 4) loss=0.237 grad_norm=5.16 num_segments=256 num_words=211
2020-06-09 13:46:20,352: 5) loss=0.352 grad_norm=8.11 num_segments=256 num_words=220
2020-06-09 13:47:18,730: 6) loss=0.235 grad_norm=4.66 num_segments=256 num_words=205
2020-06-09 13:48:15,753: 7) loss=0.265 grad_norm=5.45 num_segments=256 num_words=211
2020-06-09 13:49:14,295: 8) loss=0.342 grad_norm=8.85 num_segments=256 num_words=206
2020-06-09 13:50:11,741: 9) loss=0.329 grad_norm=6.24 num_segments=256 num_words=211
2020-06-09 13:51:09,329: 10) loss=0.420 grad_norm=6.84 num_segments=256 num_words=203
2020-06-09 13:52:09,912: 11) loss=0.293 grad_norm=8.42 num_segments=256 num_words=222
2020-06-09 13:53:08,488: 12) loss=0.276 grad_norm=5.58 num_segments=256 num_words=208
2020-06-09 13:54:10,137: 13) loss=0.381 grad_norm=6.96 num_segments=256 num_words=200
2020-06-09 13:55:41,964: 14) loss=0.223 grad_norm=6.96 num_segments=256 num_words=217
2020-06-09 13:56:40,375: 15) loss=0.297 grad_norm=5.51 num_segments=256 num_words=226
2020-06-09 13:57:38,948: 16) loss=0.463 grad_norm=5.97 num_segments=256 num_words=202
2020-06-09 13:58:37,449: 17) loss=0.415 grad_norm=6.80 num_segments=256 num_words=201
2020-06-09 13:59:34,798: 18) loss=0.378 grad_norm=5.72 num_segments=256 num_words=217
2020-06-09 14:00:33,314: 19) loss=0.322 grad_norm=6.38 num_segments=256 num_words=206
2020-06-09 14:01:30,512: 20) loss=0.396 grad_norm=6.56 num_segments=256 num_words=202
2020-06-09 14:02:28,466: 21) loss=0.287 grad_norm=5.49 num_segments=256 num_words=215
2020-06-09 14:03:26,661: 22) loss=0.318 grad_norm=5.94 num_segments=256 num_words=211
2020-06-09 14:04:26,578: 23) loss=0.350 grad_norm=6.44 num_segments=256 num_words=204
2020-06-09 14:05:26,536: 24) loss=0.433 grad_norm=7.70 num_segments=256 num_words=204
2020-06-09 14:06:27,192: 25) loss=0.370 grad_norm=6.46 num_segments=256 num_words=219
2020-06-09 14:07:25,761: 26) loss=0.313 grad_norm=5.34 num_segments=256 num_words=206
2020-06-09 14:08:24,922: 27) loss=0.247 grad_norm=5.52 num_segments=256 num_words=212
2020-06-09 14:09:22,210: 28) loss=0.239 grad_norm=4.92 num_segments=256 num_words=215
2020-06-09 14:10:20,862: 29) loss=0.412 grad_norm=5.98 num_segments=256 num_words=214
2020-06-09 14:11:19,820: 30) loss=0.251 grad_norm=5.61 num_segments=256 num_words=213
2020-06-09 14:12:17,074: 31) loss=0.420 grad_norm=8.98 num_segments=256 num_words=204
2020-06-09 14:13:17,330: 32) loss=0.246 grad_norm=5.79 num_segments=256 num_words=208
2020-06-09 14:14:21,125: 33) loss=0.289 grad_norm=6.22 num_segments=256 num_words=218
2020-06-09 14:15:20,028: 34) loss=0.395 grad_norm=8.00 num_segments=256 num_words=209
2020-06-09 14:16:19,186: 35) loss=0.304 grad_norm=5.31 num_segments=256 num_words=202
2020-06-09 14:17:18,962: 36) loss=0.292 grad_norm=5.76 num_segments=256 num_words=212
2020-06-09 14:18:19,591: 37) loss=0.473 grad_norm=6.72 num_segments=256 num_words=219
2020-06-09 14:19:13,328: 38) loss=0.267 grad_norm=5.16 num_segments=243 num_words=206
2020-06-09 14:19:13,337: epoch= 26.00
2020-06-09 14:19:13,337:  >> time to evaluate and save:
2020-06-09 14:19:13,393: saved save/MultiViewDataset_IndividualWords.1014.pth
2020-06-09 14:19:13,436: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 14:19:13,485: removed save/MultiViewDataset_IndividualWords.741.pth
2020-06-09 14:19:13,485: saved MultiViewDataset_IndividualWords successfully
2020-06-09 14:19:14,805: saved save/MultiViewRNN.1014.pth
2020-06-09 14:19:14,818: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 14:19:14,896: removed save/MultiViewRNN.741.pth
2020-06-09 14:19:14,896: saved MultiViewRNN successfully
2020-06-09 14:19:17,371: saved save/Adam.1014.pth
2020-06-09 14:19:17,399: most_recent linked save/Adam.most_recent.pth
2020-06-09 14:19:17,458: removed save/Adam.780.pth
2020-06-09 14:19:17,458: saved Adam successfully
2020-06-09 14:19:17,460: saved save/ReduceLROnPlateau.1014.pth
2020-06-09 14:19:17,477: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 14:19:17,502: removed save/ReduceLROnPlateau.741.pth
2020-06-09 14:19:17,502: saved ReduceLROnPlateau successfully
2020-06-09 14:19:17,504: saved config successfully
2020-06-09 14:20:43,140:   >> crossview_ap=0.610 (10966 x 3921 pairs)
2020-06-09 14:21:35,787:   >> acoustic_ap=0.731 (10966 choose 2 pairs)
2020-06-09 14:21:35,791: best_so_far= 0.610 at 1014
2020-06-09 14:21:35,876: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 14:21:35,879: saved MultiViewDataset_IndividualWords successfully
2020-06-09 14:21:35,927: best linked save/MultiViewRNN.best.pth
2020-06-09 14:21:35,940: saved MultiViewRNN successfully
2020-06-09 14:21:35,986: best linked save/Adam.best.pth
2020-06-09 14:21:35,995: saved Adam successfully
2020-06-09 14:21:36,018: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 14:21:36,024: saved ReduceLROnPlateau successfully
2020-06-09 14:21:37,147: epoch=26.00 global_step=1014 lr=0.0001 start_iter=0
2020-06-09 14:21:37,147: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 14:22:38,932: 0) loss=0.336 grad_norm=4.63 num_segments=256 num_words=202
2020-06-09 14:23:37,107: 1) loss=0.200 grad_norm=4.10 num_segments=256 num_words=221
2020-06-09 14:24:34,533: 2) loss=0.208 grad_norm=4.49 num_segments=256 num_words=210
2020-06-09 14:25:33,937: 3) loss=0.307 grad_norm=4.73 num_segments=256 num_words=204
2020-06-09 14:26:32,770: 4) loss=0.212 grad_norm=4.13 num_segments=256 num_words=210
2020-06-09 14:27:30,516: 5) loss=0.408 grad_norm=5.95 num_segments=256 num_words=210
2020-06-09 14:28:28,342: 6) loss=0.337 grad_norm=5.06 num_segments=256 num_words=204
2020-06-09 14:29:26,130: 7) loss=0.264 grad_norm=5.03 num_segments=256 num_words=213
2020-06-09 14:30:23,038: 8) loss=0.228 grad_norm=4.41 num_segments=256 num_words=206
2020-06-09 14:32:03,998: 9) loss=0.443 grad_norm=6.62 num_segments=256 num_words=207
2020-06-09 14:33:03,064: 10) loss=0.290 grad_norm=4.21 num_segments=256 num_words=202
2020-06-09 14:34:06,437: 11) loss=0.258 grad_norm=4.54 num_segments=256 num_words=209
2020-06-09 14:35:06,752: 12) loss=0.208 grad_norm=4.33 num_segments=256 num_words=216
2020-06-09 14:36:06,545: 13) loss=0.283 grad_norm=6.92 num_segments=256 num_words=208
2020-06-09 14:37:10,098: 14) loss=0.258 grad_norm=5.06 num_segments=256 num_words=213
2020-06-09 14:38:09,216: 15) loss=0.231 grad_norm=3.99 num_segments=256 num_words=205
2020-06-09 14:39:09,194: 16) loss=0.341 grad_norm=5.66 num_segments=256 num_words=215
2020-06-09 14:40:12,096: 17) loss=0.260 grad_norm=3.88 num_segments=256 num_words=206
2020-06-09 14:41:14,267: 18) loss=0.370 grad_norm=5.97 num_segments=256 num_words=209
2020-06-09 14:42:14,507: 19) loss=0.417 grad_norm=5.52 num_segments=256 num_words=210
2020-06-09 14:43:13,983: 20) loss=0.262 grad_norm=4.92 num_segments=256 num_words=209
2020-06-09 14:44:13,420: 21) loss=0.263 grad_norm=6.35 num_segments=256 num_words=198
2020-06-09 14:45:12,327: 22) loss=0.293 grad_norm=4.95 num_segments=256 num_words=208
2020-06-09 14:46:12,162: 23) loss=0.255 grad_norm=5.24 num_segments=256 num_words=208
2020-06-09 14:47:11,228: 24) loss=0.258 grad_norm=4.39 num_segments=256 num_words=220
2020-06-09 14:48:09,490: 25) loss=0.409 grad_norm=5.20 num_segments=256 num_words=208
2020-06-09 14:49:08,940: 26) loss=0.355 grad_norm=6.31 num_segments=256 num_words=221
2020-06-09 14:50:06,010: 27) loss=0.302 grad_norm=4.76 num_segments=256 num_words=204
2020-06-09 14:51:03,232: 28) loss=0.251 grad_norm=5.11 num_segments=256 num_words=217
2020-06-09 14:52:00,107: 29) loss=0.575 grad_norm=7.65 num_segments=256 num_words=205
2020-06-09 14:52:55,508: 30) loss=0.475 grad_norm=6.06 num_segments=256 num_words=203
2020-06-09 14:53:51,448: 31) loss=0.295 grad_norm=4.36 num_segments=256 num_words=214
2020-06-09 14:54:46,643: 32) loss=0.320 grad_norm=7.83 num_segments=256 num_words=202
2020-06-09 14:55:42,244: 33) loss=0.231 grad_norm=8.37 num_segments=256 num_words=215
2020-06-09 14:56:37,204: 34) loss=0.292 grad_norm=6.83 num_segments=256 num_words=217
2020-06-09 14:57:34,802: 35) loss=0.431 grad_norm=7.27 num_segments=256 num_words=208
2020-06-09 14:58:32,693: 36) loss=0.214 grad_norm=4.58 num_segments=256 num_words=210
2020-06-09 14:59:28,476: 37) loss=0.402 grad_norm=5.34 num_segments=256 num_words=205
2020-06-09 15:00:18,817: 38) loss=0.241 grad_norm=3.84 num_segments=243 num_words=211
2020-06-09 15:00:18,825: epoch= 27.00
2020-06-09 15:00:18,826:  >> time to evaluate and save:
2020-06-09 15:00:18,857: saved save/MultiViewDataset_IndividualWords.1053.pth
2020-06-09 15:00:18,886: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 15:00:18,921: removed save/MultiViewDataset_IndividualWords.819.pth
2020-06-09 15:00:18,921: saved MultiViewDataset_IndividualWords successfully
2020-06-09 15:00:20,225: saved save/MultiViewRNN.1053.pth
2020-06-09 15:00:20,229: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 15:00:20,284: removed save/MultiViewRNN.819.pth
2020-06-09 15:00:20,284: saved MultiViewRNN successfully
2020-06-09 15:00:22,849: saved save/Adam.1053.pth
2020-06-09 15:00:22,864: most_recent linked save/Adam.most_recent.pth
2020-06-09 15:00:22,921: removed save/Adam.819.pth
2020-06-09 15:00:22,921: saved Adam successfully
2020-06-09 15:00:22,923: saved save/ReduceLROnPlateau.1053.pth
2020-06-09 15:00:22,933: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 15:00:22,944: removed save/ReduceLROnPlateau.819.pth
2020-06-09 15:00:22,945: saved ReduceLROnPlateau successfully
2020-06-09 15:00:22,946: saved config successfully
2020-06-09 15:01:44,383:   >> crossview_ap=0.611 (10966 x 3921 pairs)
2020-06-09 15:02:34,548:   >> acoustic_ap=0.737 (10966 choose 2 pairs)
2020-06-09 15:02:34,551: best_so_far= 0.611 at 1053
2020-06-09 15:02:34,564: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 15:02:34,567: saved MultiViewDataset_IndividualWords successfully
2020-06-09 15:02:34,580: best linked save/MultiViewRNN.best.pth
2020-06-09 15:02:34,588: saved MultiViewRNN successfully
2020-06-09 15:02:34,599: best linked save/Adam.best.pth
2020-06-09 15:02:34,606: saved Adam successfully
2020-06-09 15:02:34,623: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 15:02:34,625: saved ReduceLROnPlateau successfully
2020-06-09 15:02:35,944: epoch=27.00 global_step=1053 lr=0.0001 start_iter=0
2020-06-09 15:02:35,944: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 15:03:36,134: 0) loss=0.315 grad_norm=4.66 num_segments=256 num_words=216
2020-06-09 15:04:32,736: 1) loss=0.429 grad_norm=5.75 num_segments=256 num_words=214
2020-06-09 15:05:29,626: 2) loss=0.349 grad_norm=6.03 num_segments=256 num_words=214
2020-06-09 15:06:25,223: 3) loss=0.307 grad_norm=5.91 num_segments=256 num_words=210
2020-06-09 15:07:21,137: 4) loss=0.353 grad_norm=5.35 num_segments=256 num_words=208
2020-06-09 15:08:17,395: 5) loss=0.633 grad_norm=4.84 num_segments=256 num_words=212
2020-06-09 15:09:12,869: 6) loss=0.579 grad_norm=4.62 num_segments=256 num_words=207
2020-06-09 15:10:09,144: 7) loss=0.239 grad_norm=4.07 num_segments=256 num_words=214
2020-06-09 15:11:05,005: 8) loss=0.334 grad_norm=5.15 num_segments=256 num_words=205
2020-06-09 15:12:01,309: 9) loss=0.365 grad_norm=4.90 num_segments=256 num_words=206
2020-06-09 15:12:58,974: 10) loss=0.227 grad_norm=4.00 num_segments=256 num_words=222
2020-06-09 15:13:58,096: 11) loss=0.451 grad_norm=6.82 num_segments=256 num_words=209
2020-06-09 15:15:46,788: 12) loss=0.219 grad_norm=4.18 num_segments=256 num_words=211
2020-06-09 15:16:43,366: 13) loss=0.499 grad_norm=7.90 num_segments=256 num_words=213
2020-06-09 15:17:38,751: 14) loss=0.260 grad_norm=5.11 num_segments=256 num_words=210
2020-06-09 15:18:34,335: 15) loss=0.302 grad_norm=5.49 num_segments=256 num_words=220
2020-06-09 15:19:29,760: 16) loss=0.344 grad_norm=5.98 num_segments=256 num_words=214
2020-06-09 15:20:25,447: 17) loss=0.430 grad_norm=5.99 num_segments=256 num_words=205
2020-06-09 15:21:21,299: 18) loss=0.293 grad_norm=5.04 num_segments=256 num_words=212
2020-06-09 15:22:17,465: 19) loss=0.348 grad_norm=4.59 num_segments=256 num_words=203
2020-06-09 15:23:10,415: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-09 15:23:10,464: Using 1 GPU(s)
2020-06-09 15:23:10,464: Machine: 0 / 1
2020-06-09 15:23:10,465: Hyperparam tuning-------------------
2020-06-09 15:23:10,466: optim_lr: 0.001
2020-06-09 15:23:10,466: dropout (for both): 0.4
2020-06-09 15:23:10,467: margin: 0.4
2020-06-09 15:23:10,467: ------------------------------------
2020-06-09 15:23:10,469: Calling main function: multiview_trainer.train
2020-06-09 15:23:10,469: Using config file: train_config.json
2020-06-09 15:23:10,469: Using module at multiview_trainer.train
2020-06-09 15:23:10,674: Using module at multiview_vocab.MultiViewVocab
2020-06-09 15:23:10,717: Building vocab_data from config
2020-06-09 15:23:10,922:  >> min_count= 0
2020-06-09 15:23:10,922:  >> # words= 34323 (# removed= 0)
2020-06-09 15:23:10,922:  >> # subwords= 38
2020-06-09 15:23:10,922:      = 1
2020-06-09 15:23:10,922:     '= 2
2020-06-09 15:23:10,922:     -= 3
2020-06-09 15:23:10,922:     .= 4
2020-06-09 15:23:10,922:     <= 5
2020-06-09 15:23:10,922:     >= 6
2020-06-09 15:23:10,923:     [= 7
2020-06-09 15:23:10,923:     [laughter]= 8
2020-06-09 15:23:10,923:     [noise]= 9
2020-06-09 15:23:10,923:     [vocalized-noise]= 10
2020-06-09 15:23:10,923:     ]= 11
2020-06-09 15:23:10,923:     _= 12
2020-06-09 15:23:10,923:     a= 13
2020-06-09 15:23:10,923:     b= 14
2020-06-09 15:23:10,923:     c= 15
2020-06-09 15:23:10,923:     d= 16
2020-06-09 15:23:10,923:     e= 17
2020-06-09 15:23:10,923:     f= 18
2020-06-09 15:23:10,923:     g= 19
2020-06-09 15:23:10,923:     h= 20
2020-06-09 15:23:10,923:     i= 21
2020-06-09 15:23:10,923:     j= 22
2020-06-09 15:23:10,923:     k= 23
2020-06-09 15:23:10,923:     l= 24
2020-06-09 15:23:10,923:     m= 25
2020-06-09 15:23:10,923:     n= 26
2020-06-09 15:23:10,923:     o= 27
2020-06-09 15:23:10,923:     p= 28
2020-06-09 15:23:10,923:     q= 29
2020-06-09 15:23:10,923:     r= 30
2020-06-09 15:23:10,924:     s= 31
2020-06-09 15:23:10,924:     t= 32
2020-06-09 15:23:10,924:     u= 33
2020-06-09 15:23:10,924:     v= 34
2020-06-09 15:23:10,924:     w= 35
2020-06-09 15:23:10,924:     x= 36
2020-06-09 15:23:10,924:     y= 37
2020-06-09 15:23:10,924:     z= 38
2020-06-09 15:23:10,937: Using module at data.batch_samplers.BatchSampler
2020-06-09 15:23:10,955: Building vocab_sampler from config
2020-06-09 15:23:10,956:  >> # examples= 34323
2020-06-09 15:23:10,956:  >> batch_size= 1000
2020-06-09 15:23:10,956:  >> shuffle= False
2020-06-09 15:23:10,968:  >> BatchSampler; 35 batches
2020-06-09 15:23:10,968: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 15:23:11,056: Building train_data from config
2020-06-09 15:23:17,620:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-09 15:23:17,621:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-09 15:23:17,621:  >> stack= False
2020-06-09 15:23:17,621:  >> seg_durs= (1, None)
2020-06-09 15:23:17,621:  >> # words= 9971 (# ignored= 0)
2020-06-09 15:23:17,621:  >> input_feat_dim= 108
2020-06-09 15:23:17,621:  >> input_num_subwords= 38
2020-06-09 15:23:17,621: Using module at data.batch_samplers.BatchSampler
2020-06-09 15:23:17,622: Building train_sampler from config
2020-06-09 15:23:17,622:  >> # examples= 9971
2020-06-09 15:23:17,622:  >> batch_size= 256
2020-06-09 15:23:17,623:  >> shuffle= True
2020-06-09 15:23:17,635:  >> BatchSampler; 39 batches
2020-06-09 15:23:17,635: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 15:23:17,635: Building dev_data from config
2020-06-09 15:23:25,300:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-09 15:23:25,301:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-09 15:23:25,301:  >> stack= False
2020-06-09 15:23:25,301:  >> seg_durs= (1, None)
2020-06-09 15:23:25,301:  >> # words= 10966 (# ignored= 0)
2020-06-09 15:23:25,301:  >> input_feat_dim= 108
2020-06-09 15:23:25,301:  >> input_num_subwords= 38
2020-06-09 15:23:25,301: Using module at data.batch_samplers.BatchSampler
2020-06-09 15:23:25,301: Building dev_sampler from config
2020-06-09 15:23:25,302:  >> # examples= 10966
2020-06-09 15:23:25,302:  >> batch_size= 256
2020-06-09 15:23:25,302:  >> shuffle= False
2020-06-09 15:23:25,304:  >> BatchSampler; 43 batches
2020-06-09 15:23:25,304: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 15:23:25,304: Building test_data from config
2020-06-09 15:23:31,618:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-09 15:23:31,618:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-09 15:23:31,618:  >> stack= False
2020-06-09 15:23:31,618:  >> seg_durs= (1, None)
2020-06-09 15:23:31,618:  >> # words= 11024 (# ignored= 0)
2020-06-09 15:23:31,618:  >> input_feat_dim= 108
2020-06-09 15:23:31,618:  >> input_num_subwords= 38
2020-06-09 15:23:31,618: Using module at data.batch_samplers.BatchSampler
2020-06-09 15:23:31,619: Building test_sampler from config
2020-06-09 15:23:31,619:  >> # examples= 11024
2020-06-09 15:23:31,619:  >> batch_size= 256
2020-06-09 15:23:31,619:  >> shuffle= False
2020-06-09 15:23:31,621:  >> BatchSampler; 44 batches
2020-06-09 15:23:31,621: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-09 15:23:31,661: Building loss from config
2020-06-09 15:23:31,662:  >> margin= 0.4
2020-06-09 15:23:31,662:  >> k= 16
2020-06-09 15:23:31,662:  >> min_k= 8
2020-06-09 15:23:31,662:  >> extra= 0
2020-06-09 15:23:31,662:  >> average= False
2020-06-09 15:23:31,662:  >> margin_max= 0.5
2020-06-09 15:23:31,662:  >> threshold_max= 9
2020-06-09 15:23:31,662:  >> using obj0
2020-06-09 15:23:31,663: Using module at metric.multiview_ap.MultiViewAP
2020-06-09 15:23:31,727: Building eval from config
2020-06-09 15:23:31,728:  >> acoustic_ap= True
2020-06-09 15:23:31,728:  >> crossview_ap= True
2020-06-09 15:23:31,728:  >> full_vocab= False
2020-06-09 15:23:31,728:  >> metric= crossview_ap
2020-06-09 15:23:31,728:  >> mode= max
2020-06-09 15:23:31,728: Using module at multiview_rnn.MultiViewRNN
2020-06-09 15:23:31,793: Building net from config
2020-06-09 15:23:31,795: view1:
2020-06-09 15:23:31,796:  >> cell= GRU
2020-06-09 15:23:31,796:  >> input_size= 108
2020-06-09 15:23:31,796:  >> hidden_size= 512
2020-06-09 15:23:31,796:  >> bidirectional= True
2020-06-09 15:23:31,796:  >> num_layers= 6
2020-06-09 15:23:31,796:  >> dropout between layers= 0.4
2020-06-09 15:23:32,048: view2:
2020-06-09 15:23:32,048:  >> cell= GRU
2020-06-09 15:23:32,049:  >> input_size= 64
2020-06-09 15:23:32,049:  >> hidden_size= 512
2020-06-09 15:23:32,049:  >> bidirectional= True
2020-06-09 15:23:32,049:  >> num_layers= 2
2020-06-09 15:23:32,049:  >> dropout between layers= 0.4
2020-06-09 15:23:32,049:  >> num input embeddings= 38
2020-06-09 15:23:35,327: Using module at optim.adam.Adam
2020-06-09 15:23:35,334: Building optim from config
2020-06-09 15:23:35,335:  >> lr= 0.001
2020-06-09 15:23:35,335:  >> betas= (0.9, 0.999)
2020-06-09 15:23:35,335:  >> eps= 1e-08
2020-06-09 15:23:35,335:  >> weight_decay= 0
2020-06-09 15:23:35,335:  >> amsgrad= False
2020-06-09 15:23:35,335:  >> min_lr= 1e-07
2020-06-09 15:23:35,336: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-09 15:23:35,373: Building sched from config
2020-06-09 15:23:35,373:  >> optim= Adam
2020-06-09 15:23:35,373:  >> decay lr by 0.1
2020-06-09 15:23:35,374:  >> eval_fn= MultiViewAP
2020-06-09 15:23:35,375:  >> patience=4
2020-06-09 15:23:35,375:  >> revert=True
2020-06-09 15:23:35,385: loaded save/MultiViewDataset_IndividualWords.1053.pth
2020-06-09 15:23:35,386: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 15:23:36,491: loaded save/MultiViewRNN.1053.pth
2020-06-09 15:23:36,491: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 15:23:38,688: loaded save/Adam.1053.pth
2020-06-09 15:23:38,689: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 15:23:38,691: loaded save/ReduceLROnPlateau.1053.pth
2020-06-09 15:23:38,691: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 15:23:38,691: epoch=27.00 global_step=1053 lr=0.0001 start_iter=0
2020-06-09 15:23:38,691: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 15:25:34,593: 0) loss=0.228 grad_norm=3.69 num_segments=256 num_words=216
2020-06-09 15:27:24,580: 1) loss=0.332 grad_norm=4.47 num_segments=256 num_words=214
2020-06-09 15:29:14,963: 2) loss=0.315 grad_norm=5.36 num_segments=256 num_words=214
2020-06-09 15:30:56,541: 3) loss=0.330 grad_norm=6.33 num_segments=256 num_words=210
2020-06-09 15:32:29,995: 4) loss=0.368 grad_norm=6.63 num_segments=256 num_words=208
2020-06-09 15:33:55,558: 5) loss=0.531 grad_norm=4.99 num_segments=256 num_words=212
2020-06-09 15:35:10,865: 6) loss=0.525 grad_norm=4.28 num_segments=256 num_words=207
2020-06-09 15:36:18,485: 7) loss=0.260 grad_norm=5.10 num_segments=256 num_words=214
2020-06-09 15:37:27,980: 8) loss=0.332 grad_norm=4.66 num_segments=256 num_words=205
2020-06-09 15:38:35,343: 9) loss=0.369 grad_norm=5.04 num_segments=256 num_words=206
2020-06-09 15:39:47,193: 10) loss=0.228 grad_norm=3.96 num_segments=256 num_words=222
2020-06-09 15:40:53,665: 11) loss=0.445 grad_norm=6.01 num_segments=256 num_words=209
2020-06-09 15:42:01,635: 12) loss=0.220 grad_norm=3.67 num_segments=256 num_words=211
2020-06-09 15:43:08,847: 13) loss=0.526 grad_norm=7.29 num_segments=256 num_words=213
2020-06-09 15:44:20,530: 14) loss=0.358 grad_norm=5.68 num_segments=256 num_words=210
2020-06-09 15:45:28,666: 15) loss=0.302 grad_norm=4.71 num_segments=256 num_words=220
2020-06-09 15:46:36,671: 16) loss=0.344 grad_norm=5.48 num_segments=256 num_words=214
2020-06-09 15:47:44,774: 17) loss=0.375 grad_norm=7.62 num_segments=256 num_words=205
2020-06-09 15:48:53,317: 18) loss=0.293 grad_norm=4.65 num_segments=256 num_words=212
2020-06-09 15:50:06,234: 19) loss=0.348 grad_norm=4.56 num_segments=256 num_words=203
2020-06-09 15:51:13,788: 20) loss=0.334 grad_norm=4.48 num_segments=256 num_words=211
2020-06-09 15:52:21,543: 21) loss=0.218 grad_norm=4.13 num_segments=256 num_words=217
2020-06-09 15:53:28,794: 22) loss=0.273 grad_norm=5.67 num_segments=256 num_words=207
2020-06-09 15:54:35,874: 23) loss=0.486 grad_norm=4.78 num_segments=256 num_words=213
2020-06-09 15:55:49,597: 24) loss=0.218 grad_norm=4.12 num_segments=256 num_words=215
2020-06-09 15:56:57,327: 25) loss=0.420 grad_norm=5.56 num_segments=256 num_words=201
2020-06-09 15:58:04,823: 26) loss=0.258 grad_norm=3.59 num_segments=256 num_words=213
2020-06-09 15:59:15,146: 27) loss=0.334 grad_norm=5.06 num_segments=256 num_words=211
2020-06-09 16:00:23,308: 28) loss=0.240 grad_norm=3.58 num_segments=256 num_words=214
2020-06-09 16:01:31,690: 29) loss=0.275 grad_norm=4.64 num_segments=256 num_words=206
2020-06-09 16:02:36,031: 30) loss=0.585 grad_norm=6.07 num_segments=256 num_words=207
2020-06-09 16:03:51,646: 31) loss=0.385 grad_norm=6.17 num_segments=256 num_words=208
2020-06-09 16:04:56,994: 32) loss=0.328 grad_norm=4.34 num_segments=256 num_words=204
2020-06-09 16:06:00,433: 33) loss=0.403 grad_norm=5.09 num_segments=256 num_words=195
2020-06-09 16:07:06,313: 34) loss=0.251 grad_norm=5.90 num_segments=256 num_words=209
2020-06-09 16:08:10,341: 35) loss=0.224 grad_norm=4.43 num_segments=256 num_words=213
2020-06-09 16:09:14,140: 36) loss=0.362 grad_norm=5.42 num_segments=256 num_words=198
2020-06-09 16:10:19,316: 37) loss=0.227 grad_norm=4.10 num_segments=256 num_words=217
2020-06-09 16:11:17,206: 38) loss=0.298 grad_norm=5.26 num_segments=243 num_words=209
2020-06-09 16:11:17,222: epoch= 28.00
2020-06-09 16:11:17,223:  >> time to evaluate and save:
2020-06-09 16:11:17,300: saved save/MultiViewDataset_IndividualWords.1092.pth
2020-06-09 16:11:17,330: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 16:11:17,385: removed save/MultiViewDataset_IndividualWords.858.pth
2020-06-09 16:11:17,385: saved MultiViewDataset_IndividualWords successfully
2020-06-09 16:11:18,717: saved save/MultiViewRNN.1092.pth
2020-06-09 16:11:18,722: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 16:11:19,055: removed save/MultiViewRNN.858.pth
2020-06-09 16:11:19,055: saved MultiViewRNN successfully
2020-06-09 16:11:21,610: saved save/Adam.1092.pth
2020-06-09 16:11:21,622: most_recent linked save/Adam.most_recent.pth
2020-06-09 16:11:22,004: removed save/Adam.858.pth
2020-06-09 16:11:22,005: saved Adam successfully
2020-06-09 16:11:22,007: saved save/ReduceLROnPlateau.1092.pth
2020-06-09 16:11:22,019: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 16:11:22,024: saved ReduceLROnPlateau successfully
2020-06-09 16:11:22,025: saved config successfully
2020-06-09 16:12:50,942:   >> crossview_ap=0.611 (10966 x 3921 pairs)
2020-06-09 16:13:50,822:   >> acoustic_ap=0.736 (10966 choose 2 pairs)
2020-06-09 16:13:50,825: best_so_far= 0.611 at 1092
2020-06-09 16:13:50,836: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 16:13:50,838: saved MultiViewDataset_IndividualWords successfully
2020-06-09 16:13:50,844: best linked save/MultiViewRNN.best.pth
2020-06-09 16:13:50,852: saved MultiViewRNN successfully
2020-06-09 16:13:50,857: best linked save/Adam.best.pth
2020-06-09 16:13:50,865: saved Adam successfully
2020-06-09 16:13:50,868: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 16:13:50,871: saved ReduceLROnPlateau successfully
2020-06-09 16:13:50,935: epoch=28.00 global_step=1092 lr=0.0001 start_iter=0
2020-06-09 16:13:50,936: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 16:14:55,391: 0) loss=0.244 grad_norm=4.62 num_segments=256 num_words=215
2020-06-09 16:16:12,452: 1) loss=0.543 grad_norm=5.50 num_segments=256 num_words=217
2020-06-09 16:17:15,374: 2) loss=0.285 grad_norm=3.77 num_segments=256 num_words=214
2020-06-09 16:18:20,364: 3) loss=0.369 grad_norm=4.41 num_segments=256 num_words=207
2020-06-09 16:19:31,572: 4) loss=0.218 grad_norm=4.00 num_segments=256 num_words=211
2020-06-09 16:20:47,006: 5) loss=0.313 grad_norm=6.19 num_segments=256 num_words=218
2020-06-09 16:21:51,935: 6) loss=0.213 grad_norm=3.81 num_segments=256 num_words=208
2020-06-09 16:22:55,679: 7) loss=0.261 grad_norm=4.70 num_segments=256 num_words=209
2020-06-09 16:24:02,904: 8) loss=0.277 grad_norm=4.76 num_segments=256 num_words=214
2020-06-09 16:25:08,727: 9) loss=0.209 grad_norm=3.91 num_segments=256 num_words=221
2020-06-09 16:26:11,672: 10) loss=0.282 grad_norm=3.82 num_segments=256 num_words=213
2020-06-09 16:27:16,173: 11) loss=0.306 grad_norm=5.07 num_segments=256 num_words=208
2020-06-09 16:28:33,491: 12) loss=0.633 grad_norm=5.15 num_segments=256 num_words=209
2020-06-09 16:29:35,568: 13) loss=0.279 grad_norm=4.60 num_segments=256 num_words=213
2020-06-09 16:30:38,549: 14) loss=0.491 grad_norm=7.17 num_segments=256 num_words=215
2020-06-09 16:31:44,677: 15) loss=0.265 grad_norm=5.30 num_segments=256 num_words=209
2020-06-09 16:32:50,776: 16) loss=0.218 grad_norm=3.77 num_segments=256 num_words=215
2020-06-09 16:33:55,847: 17) loss=0.269 grad_norm=5.36 num_segments=256 num_words=202
2020-06-09 16:34:59,562: 18) loss=0.368 grad_norm=4.27 num_segments=256 num_words=209
2020-06-09 16:36:01,019: 19) loss=0.303 grad_norm=4.47 num_segments=256 num_words=206
2020-06-09 16:37:04,519: 20) loss=0.424 grad_norm=4.83 num_segments=256 num_words=208
2020-06-09 16:38:04,815: 21) loss=0.209 grad_norm=3.87 num_segments=256 num_words=214
2020-06-09 16:39:03,573: 22) loss=0.358 grad_norm=4.76 num_segments=256 num_words=224
2020-06-09 16:40:00,930: 23) loss=0.297 grad_norm=4.60 num_segments=256 num_words=197
2020-06-09 16:41:02,652: 24) loss=0.332 grad_norm=5.98 num_segments=256 num_words=212
2020-06-09 16:42:05,058: 25) loss=0.248 grad_norm=5.25 num_segments=256 num_words=210
2020-06-09 16:43:23,462: 26) loss=0.210 grad_norm=3.32 num_segments=256 num_words=210
2020-06-09 16:44:27,513: 27) loss=0.230 grad_norm=4.07 num_segments=256 num_words=199
2020-06-09 16:45:27,561: 28) loss=0.217 grad_norm=4.29 num_segments=256 num_words=214
2020-06-09 16:46:36,724: 29) loss=0.266 grad_norm=4.12 num_segments=256 num_words=202
2020-06-09 16:47:39,057: 30) loss=0.229 grad_norm=4.83 num_segments=256 num_words=212
2020-06-09 16:48:36,220: 31) loss=0.387 grad_norm=4.63 num_segments=256 num_words=195
2020-06-09 16:49:33,283: 32) loss=0.256 grad_norm=4.55 num_segments=256 num_words=215
2020-06-09 16:50:30,777: 33) loss=0.382 grad_norm=4.95 num_segments=256 num_words=215
2020-06-09 16:51:27,759: 34) loss=0.350 grad_norm=4.95 num_segments=256 num_words=209
2020-06-09 16:52:24,816: 35) loss=0.225 grad_norm=4.91 num_segments=256 num_words=221
2020-06-09 16:53:21,830: 36) loss=0.330 grad_norm=4.37 num_segments=256 num_words=209
2020-06-09 16:54:18,863: 37) loss=0.302 grad_norm=4.08 num_segments=256 num_words=207
2020-06-09 16:55:10,525: 38) loss=0.397 grad_norm=4.98 num_segments=243 num_words=202
2020-06-09 16:55:10,535: epoch= 29.00
2020-06-09 16:55:10,535:  >> time to evaluate and save:
2020-06-09 16:55:10,563: saved save/MultiViewDataset_IndividualWords.1131.pth
2020-06-09 16:55:10,573: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 16:55:10,592: removed save/MultiViewDataset_IndividualWords.897.pth
2020-06-09 16:55:10,593: saved MultiViewDataset_IndividualWords successfully
2020-06-09 16:55:11,897: saved save/MultiViewRNN.1131.pth
2020-06-09 16:55:11,905: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 16:55:11,934: removed save/MultiViewRNN.897.pth
2020-06-09 16:55:11,934: saved MultiViewRNN successfully
2020-06-09 16:55:14,473: saved save/Adam.1131.pth
2020-06-09 16:55:14,482: most_recent linked save/Adam.most_recent.pth
2020-06-09 16:55:14,515: removed save/Adam.897.pth
2020-06-09 16:55:14,515: saved Adam successfully
2020-06-09 16:55:14,518: saved save/ReduceLROnPlateau.1131.pth
2020-06-09 16:55:14,525: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 16:55:14,539: removed save/ReduceLROnPlateau.858.pth
2020-06-09 16:55:14,539: saved ReduceLROnPlateau successfully
2020-06-09 16:55:14,541: saved config successfully
2020-06-09 16:56:31,503:   >> crossview_ap=0.612 (10966 x 3921 pairs)
2020-06-09 16:57:20,332:   >> acoustic_ap=0.736 (10966 choose 2 pairs)
2020-06-09 16:57:20,338: best_so_far= 0.612 at 1131
2020-06-09 16:57:20,352: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 16:57:20,355: saved MultiViewDataset_IndividualWords successfully
2020-06-09 16:57:20,371: best linked save/MultiViewRNN.best.pth
2020-06-09 16:57:20,381: saved MultiViewRNN successfully
2020-06-09 16:57:20,393: best linked save/Adam.best.pth
2020-06-09 16:57:20,401: saved Adam successfully
2020-06-09 16:57:20,410: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 16:57:20,458: removed save/ReduceLROnPlateau.897.pth
2020-06-09 16:57:20,458: saved ReduceLROnPlateau successfully
2020-06-09 16:57:21,056: epoch=29.00 global_step=1131 lr=0.0001 start_iter=0
2020-06-09 16:57:21,056: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 16:58:20,262: 0) loss=0.195 grad_norm=3.71 num_segments=256 num_words=213
2020-06-09 16:59:17,684: 1) loss=0.231 grad_norm=4.46 num_segments=256 num_words=210
2020-06-09 17:00:14,996: 2) loss=0.245 grad_norm=4.34 num_segments=256 num_words=220
2020-06-09 17:01:12,381: 3) loss=0.212 grad_norm=3.95 num_segments=256 num_words=213
2020-06-09 17:02:11,458: 4) loss=0.289 grad_norm=4.41 num_segments=256 num_words=207
2020-06-09 17:03:35,315: 5) loss=0.293 grad_norm=4.32 num_segments=256 num_words=188
2020-06-09 17:04:31,283: 6) loss=0.320 grad_norm=5.03 num_segments=256 num_words=214
2020-06-09 17:05:27,284: 7) loss=0.409 grad_norm=5.60 num_segments=256 num_words=215
2020-06-09 17:06:25,303: 8) loss=0.379 grad_norm=5.45 num_segments=256 num_words=201
2020-06-09 17:07:24,853: 9) loss=0.263 grad_norm=5.07 num_segments=256 num_words=206
2020-06-09 17:08:20,867: 10) loss=0.238 grad_norm=4.55 num_segments=256 num_words=216
2020-06-09 17:09:18,217: 11) loss=0.220 grad_norm=3.88 num_segments=256 num_words=208
2020-06-09 17:10:14,124: 12) loss=0.342 grad_norm=5.88 num_segments=256 num_words=212
2020-06-09 17:11:10,984: 13) loss=0.225 grad_norm=3.89 num_segments=256 num_words=218
2020-06-09 17:12:06,803: 14) loss=0.295 grad_norm=4.36 num_segments=256 num_words=209
2020-06-09 17:13:02,691: 15) loss=0.262 grad_norm=6.09 num_segments=256 num_words=212
2020-06-09 17:13:58,316: 16) loss=0.229 grad_norm=4.21 num_segments=256 num_words=211
2020-06-09 17:14:53,904: 17) loss=0.204 grad_norm=3.63 num_segments=256 num_words=217
2020-06-09 17:15:49,735: 18) loss=0.434 grad_norm=5.34 num_segments=256 num_words=208
2020-06-09 17:16:45,614: 19) loss=0.269 grad_norm=3.87 num_segments=256 num_words=216
2020-06-09 17:17:41,188: 20) loss=0.337 grad_norm=4.34 num_segments=256 num_words=219
2020-06-09 17:18:36,954: 21) loss=0.210 grad_norm=3.50 num_segments=256 num_words=215
2020-06-09 17:19:32,777: 22) loss=0.324 grad_norm=4.85 num_segments=256 num_words=218
2020-06-09 17:20:28,562: 23) loss=0.309 grad_norm=4.58 num_segments=256 num_words=204
2020-06-09 17:21:24,542: 24) loss=0.255 grad_norm=4.25 num_segments=256 num_words=217
2020-06-09 17:22:20,355: 25) loss=0.331 grad_norm=5.83 num_segments=256 num_words=221
2020-06-09 17:23:45,269: 26) loss=0.235 grad_norm=3.99 num_segments=256 num_words=207
2020-06-09 17:24:41,800: 27) loss=0.396 grad_norm=5.92 num_segments=256 num_words=213
2020-06-09 17:25:37,527: 28) loss=0.326 grad_norm=3.91 num_segments=256 num_words=213
2020-06-09 17:26:34,840: 29) loss=0.211 grad_norm=3.42 num_segments=256 num_words=201
2020-06-09 17:27:31,569: 30) loss=0.363 grad_norm=5.46 num_segments=256 num_words=195
2020-06-09 17:28:28,556: 31) loss=0.495 grad_norm=5.29 num_segments=256 num_words=204
2020-06-09 17:29:26,105: 32) loss=0.215 grad_norm=3.09 num_segments=256 num_words=212
2020-06-09 17:30:25,279: 33) loss=0.421 grad_norm=5.42 num_segments=256 num_words=218
2020-06-09 17:31:24,036: 34) loss=0.265 grad_norm=3.73 num_segments=256 num_words=215
2020-06-09 17:32:21,473: 35) loss=0.271 grad_norm=5.01 num_segments=256 num_words=225
2020-06-09 17:33:18,427: 36) loss=0.368 grad_norm=5.59 num_segments=256 num_words=215
2020-06-09 17:34:15,715: 37) loss=0.317 grad_norm=5.44 num_segments=256 num_words=228
2020-06-09 17:35:06,590: 38) loss=0.677 grad_norm=5.87 num_segments=243 num_words=183
2020-06-09 17:35:06,600: epoch= 30.00
2020-06-09 17:35:06,600:  >> time to evaluate and save:
2020-06-09 17:35:06,633: saved save/MultiViewDataset_IndividualWords.1170.pth
2020-06-09 17:35:06,650: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 17:35:06,676: removed save/MultiViewDataset_IndividualWords.936.pth
2020-06-09 17:35:06,676: saved MultiViewDataset_IndividualWords successfully
2020-06-09 17:35:08,015: saved save/MultiViewRNN.1170.pth
2020-06-09 17:35:08,022: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 17:35:08,058: removed save/MultiViewRNN.936.pth
2020-06-09 17:35:08,059: saved MultiViewRNN successfully
2020-06-09 17:35:10,625: saved save/Adam.1170.pth
2020-06-09 17:35:10,648: most_recent linked save/Adam.most_recent.pth
2020-06-09 17:35:10,689: removed save/Adam.936.pth
2020-06-09 17:35:10,689: saved Adam successfully
2020-06-09 17:35:10,692: saved save/ReduceLROnPlateau.1170.pth
2020-06-09 17:35:10,699: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 17:35:10,722: removed save/ReduceLROnPlateau.936.pth
2020-06-09 17:35:10,722: saved ReduceLROnPlateau successfully
2020-06-09 17:35:10,724: saved config successfully
2020-06-09 17:36:28,447:   >> crossview_ap=0.612 (10966 x 3921 pairs)
2020-06-09 17:37:17,875:   >> acoustic_ap=0.739 (10966 choose 2 pairs)
2020-06-09 17:37:17,880: best_so_far= 0.612 at 1170
2020-06-09 17:37:17,905: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 17:37:17,939: saved MultiViewDataset_IndividualWords successfully
2020-06-09 17:37:17,944: best linked save/MultiViewRNN.best.pth
2020-06-09 17:37:17,956: saved MultiViewRNN successfully
2020-06-09 17:37:17,963: best linked save/Adam.best.pth
2020-06-09 17:37:17,974: saved Adam successfully
2020-06-09 17:37:17,986: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 17:37:17,993: saved ReduceLROnPlateau successfully
2020-06-09 17:37:18,784: epoch=30.00 global_step=1170 lr=0.0001 start_iter=0
2020-06-09 17:37:18,784: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 17:38:18,874: 0) loss=0.357 grad_norm=4.61 num_segments=256 num_words=218
2020-06-09 17:39:15,248: 1) loss=0.236 grad_norm=3.71 num_segments=256 num_words=208
2020-06-09 17:40:11,341: 2) loss=0.271 grad_norm=4.12 num_segments=256 num_words=216
2020-06-09 17:41:07,358: 3) loss=0.306 grad_norm=4.73 num_segments=256 num_words=202
2020-06-09 17:42:05,483: 4) loss=0.262 grad_norm=4.08 num_segments=256 num_words=210
2020-06-09 17:43:01,733: 5) loss=0.330 grad_norm=5.17 num_segments=256 num_words=205
2020-06-09 17:43:58,021: 6) loss=0.292 grad_norm=5.32 num_segments=256 num_words=206
2020-06-09 17:44:56,105: 7) loss=0.221 grad_norm=3.26 num_segments=256 num_words=206
2020-06-09 17:45:54,090: 8) loss=0.334 grad_norm=5.55 num_segments=256 num_words=206
2020-06-09 17:46:52,191: 9) loss=0.208 grad_norm=3.29 num_segments=256 num_words=218
2020-06-09 17:47:50,577: 10) loss=0.313 grad_norm=4.00 num_segments=256 num_words=207
2020-06-09 17:48:46,798: 11) loss=0.204 grad_norm=3.88 num_segments=256 num_words=213
2020-06-09 17:49:42,891: 12) loss=0.264 grad_norm=4.64 num_segments=256 num_words=216
2020-06-09 17:50:39,063: 13) loss=0.218 grad_norm=3.58 num_segments=256 num_words=216
2020-06-09 17:52:11,848: 14) loss=0.314 grad_norm=4.44 num_segments=256 num_words=213
2020-06-09 17:53:09,260: 15) loss=0.293 grad_norm=4.01 num_segments=256 num_words=215
2020-06-09 17:54:06,226: 16) loss=0.313 grad_norm=4.82 num_segments=256 num_words=203
2020-06-09 17:55:02,313: 17) loss=0.273 grad_norm=4.30 num_segments=256 num_words=213
2020-06-09 17:55:58,260: 18) loss=0.364 grad_norm=4.64 num_segments=256 num_words=212
2020-06-09 17:56:54,467: 19) loss=0.277 grad_norm=4.23 num_segments=256 num_words=217
2020-06-09 17:57:50,605: 20) loss=0.238 grad_norm=3.76 num_segments=256 num_words=201
2020-06-09 17:58:46,264: 21) loss=0.206 grad_norm=3.91 num_segments=256 num_words=219
2020-06-09 17:59:42,173: 22) loss=0.367 grad_norm=4.90 num_segments=256 num_words=201
2020-06-09 18:00:38,176: 23) loss=0.293 grad_norm=3.90 num_segments=256 num_words=204
2020-06-09 18:01:34,151: 24) loss=0.219 grad_norm=3.63 num_segments=256 num_words=207
2020-06-09 18:02:30,156: 25) loss=0.282 grad_norm=4.26 num_segments=256 num_words=205
2020-06-09 18:03:26,091: 26) loss=0.400 grad_norm=5.23 num_segments=256 num_words=208
2020-06-09 18:04:22,308: 27) loss=0.271 grad_norm=4.87 num_segments=256 num_words=208
2020-06-09 18:05:18,365: 28) loss=0.207 grad_norm=3.34 num_segments=256 num_words=206
2020-06-09 18:06:15,358: 29) loss=0.366 grad_norm=5.29 num_segments=256 num_words=216
2020-06-09 18:07:11,403: 30) loss=0.268 grad_norm=3.85 num_segments=256 num_words=209
2020-06-09 18:08:07,171: 31) loss=0.213 grad_norm=4.02 num_segments=256 num_words=208
2020-06-09 18:09:03,139: 32) loss=0.217 grad_norm=3.88 num_segments=256 num_words=210
2020-06-09 18:09:59,073: 33) loss=0.238 grad_norm=4.46 num_segments=256 num_words=223
2020-06-09 18:10:57,496: 34) loss=0.335 grad_norm=4.44 num_segments=256 num_words=218
2020-06-09 18:11:55,099: 35) loss=0.313 grad_norm=5.30 num_segments=256 num_words=221
2020-06-09 18:12:52,376: 36) loss=0.478 grad_norm=4.96 num_segments=256 num_words=208
2020-06-09 18:13:50,842: 37) loss=0.238 grad_norm=4.83 num_segments=256 num_words=202
2020-06-09 18:14:42,987: 38) loss=0.326 grad_norm=4.36 num_segments=243 num_words=199
2020-06-09 18:14:42,997: epoch= 31.00
2020-06-09 18:14:42,997:  >> time to evaluate and save:
2020-06-09 18:14:43,024: saved save/MultiViewDataset_IndividualWords.1209.pth
2020-06-09 18:14:43,036: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 18:14:43,071: removed save/MultiViewDataset_IndividualWords.975.pth
2020-06-09 18:14:43,072: saved MultiViewDataset_IndividualWords successfully
2020-06-09 18:14:44,416: saved save/MultiViewRNN.1209.pth
2020-06-09 18:14:44,429: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 18:14:44,462: removed save/MultiViewRNN.975.pth
2020-06-09 18:14:44,462: saved MultiViewRNN successfully
2020-06-09 18:14:47,014: saved save/Adam.1209.pth
2020-06-09 18:14:47,024: most_recent linked save/Adam.most_recent.pth
2020-06-09 18:14:47,053: removed save/Adam.975.pth
2020-06-09 18:14:47,053: saved Adam successfully
2020-06-09 18:14:47,055: saved save/ReduceLROnPlateau.1209.pth
2020-06-09 18:14:47,077: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 18:14:47,088: removed save/ReduceLROnPlateau.975.pth
2020-06-09 18:14:47,088: saved ReduceLROnPlateau successfully
2020-06-09 18:14:47,089: saved config successfully
2020-06-09 18:16:14,633:   >> crossview_ap=0.613 (10966 x 3921 pairs)
2020-06-09 18:17:04,038:   >> acoustic_ap=0.740 (10966 choose 2 pairs)
2020-06-09 18:17:04,044: best_so_far= 0.613 at 1209
2020-06-09 18:17:04,056: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 18:17:04,059: saved MultiViewDataset_IndividualWords successfully
2020-06-09 18:17:04,075: best linked save/MultiViewRNN.best.pth
2020-06-09 18:17:04,083: saved MultiViewRNN successfully
2020-06-09 18:17:04,095: best linked save/Adam.best.pth
2020-06-09 18:17:04,103: saved Adam successfully
2020-06-09 18:17:04,133: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 18:17:04,136: saved ReduceLROnPlateau successfully
2020-06-09 18:17:05,104: epoch=31.00 global_step=1209 lr=0.0001 start_iter=0
2020-06-09 18:17:05,104: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 18:18:03,477: 0) loss=0.322 grad_norm=4.64 num_segments=256 num_words=215
2020-06-09 18:18:59,687: 1) loss=0.237 grad_norm=4.19 num_segments=256 num_words=213
2020-06-09 18:19:55,879: 2) loss=0.621 grad_norm=5.48 num_segments=256 num_words=207
2020-06-09 18:20:51,868: 3) loss=0.371 grad_norm=5.30 num_segments=256 num_words=210
2020-06-09 18:21:48,037: 4) loss=0.347 grad_norm=4.72 num_segments=256 num_words=223
2020-06-09 18:22:44,285: 5) loss=0.263 grad_norm=3.94 num_segments=256 num_words=207
2020-06-09 18:23:40,576: 6) loss=0.271 grad_norm=4.69 num_segments=256 num_words=211
2020-06-09 18:24:36,643: 7) loss=0.312 grad_norm=5.62 num_segments=256 num_words=222
2020-06-09 18:25:32,684: 8) loss=0.360 grad_norm=4.77 num_segments=256 num_words=211
2020-06-09 18:27:35,085: 9) loss=0.242 grad_norm=4.25 num_segments=256 num_words=217
2020-06-09 18:28:34,264: 10) loss=0.207 grad_norm=3.80 num_segments=256 num_words=216
2020-06-09 18:29:36,303: 11) loss=0.314 grad_norm=5.74 num_segments=256 num_words=206
2020-06-09 18:30:33,537: 12) loss=0.283 grad_norm=4.65 num_segments=256 num_words=210
2020-06-09 18:31:32,028: 13) loss=0.357 grad_norm=3.62 num_segments=256 num_words=203
2020-06-09 18:32:30,309: 14) loss=0.311 grad_norm=4.43 num_segments=256 num_words=224
2020-06-09 18:33:28,214: 15) loss=0.372 grad_norm=3.99 num_segments=256 num_words=210
2020-06-09 18:34:26,630: 16) loss=0.455 grad_norm=4.12 num_segments=256 num_words=203
2020-06-09 18:35:24,272: 17) loss=0.304 grad_norm=4.45 num_segments=256 num_words=205
2020-06-09 18:36:21,533: 18) loss=0.239 grad_norm=3.70 num_segments=256 num_words=207
2020-06-09 18:37:18,651: 19) loss=0.548 grad_norm=5.83 num_segments=256 num_words=207
2020-06-09 18:38:16,761: 20) loss=0.232 grad_norm=3.62 num_segments=256 num_words=207
2020-06-09 18:39:18,380: 21) loss=0.411 grad_norm=3.97 num_segments=256 num_words=200
2020-06-09 18:40:21,786: 22) loss=0.299 grad_norm=3.98 num_segments=256 num_words=206
2020-06-09 18:41:25,126: 23) loss=0.246 grad_norm=4.08 num_segments=256 num_words=203
2020-06-09 18:42:28,929: 24) loss=0.502 grad_norm=4.21 num_segments=256 num_words=206
2020-06-09 18:43:32,670: 25) loss=0.256 grad_norm=3.85 num_segments=256 num_words=214
2020-06-09 18:44:36,993: 26) loss=0.470 grad_norm=5.49 num_segments=256 num_words=214
2020-06-09 18:45:41,488: 27) loss=0.293 grad_norm=4.52 num_segments=256 num_words=202
2020-06-09 18:46:45,430: 28) loss=0.330 grad_norm=4.59 num_segments=256 num_words=211
2020-06-09 18:47:48,920: 29) loss=0.276 grad_norm=4.36 num_segments=256 num_words=218
2020-06-09 18:48:53,519: 30) loss=0.412 grad_norm=5.01 num_segments=256 num_words=208
2020-06-09 18:49:56,893: 31) loss=0.240 grad_norm=3.92 num_segments=256 num_words=208
2020-06-09 18:51:00,717: 32) loss=0.317 grad_norm=4.40 num_segments=256 num_words=212
2020-06-09 18:52:04,740: 33) loss=0.333 grad_norm=6.61 num_segments=256 num_words=212
2020-06-09 18:53:09,100: 34) loss=0.206 grad_norm=3.61 num_segments=256 num_words=215
2020-06-09 18:54:12,790: 35) loss=0.526 grad_norm=5.82 num_segments=256 num_words=209
2020-06-09 18:55:16,844: 36) loss=0.321 grad_norm=3.91 num_segments=256 num_words=205
2020-06-09 18:56:20,659: 37) loss=0.242 grad_norm=4.23 num_segments=256 num_words=210
2020-06-09 18:57:18,275: 38) loss=0.299 grad_norm=3.94 num_segments=243 num_words=202
2020-06-09 18:57:18,286: epoch= 32.00
2020-06-09 18:57:18,286:  >> time to evaluate and save:
2020-06-09 18:57:18,319: saved save/MultiViewDataset_IndividualWords.1248.pth
2020-06-09 18:57:18,328: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 18:57:18,370: removed save/MultiViewDataset_IndividualWords.1014.pth
2020-06-09 18:57:18,371: saved MultiViewDataset_IndividualWords successfully
2020-06-09 18:57:19,716: saved save/MultiViewRNN.1248.pth
2020-06-09 18:57:19,735: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 18:57:19,768: removed save/MultiViewRNN.1014.pth
2020-06-09 18:57:19,769: saved MultiViewRNN successfully
2020-06-09 18:57:22,296: saved save/Adam.1248.pth
2020-06-09 18:57:22,298: most_recent linked save/Adam.most_recent.pth
2020-06-09 18:57:22,347: removed save/Adam.1014.pth
2020-06-09 18:57:22,348: saved Adam successfully
2020-06-09 18:57:22,350: saved save/ReduceLROnPlateau.1248.pth
2020-06-09 18:57:22,362: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 18:57:22,371: removed save/ReduceLROnPlateau.1014.pth
2020-06-09 18:57:22,372: saved ReduceLROnPlateau successfully
2020-06-09 18:57:22,374: saved config successfully
2020-06-09 18:58:55,857:   >> crossview_ap=0.613 (10966 x 3921 pairs)
2020-06-09 18:59:53,863:   >> acoustic_ap=0.738 (10966 choose 2 pairs)
2020-06-09 18:59:53,869: best_so_far= 0.613 at 1248
2020-06-09 18:59:53,881: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 18:59:53,884: saved MultiViewDataset_IndividualWords successfully
2020-06-09 18:59:53,892: best linked save/MultiViewRNN.best.pth
2020-06-09 18:59:53,900: saved MultiViewRNN successfully
2020-06-09 18:59:53,907: best linked save/Adam.best.pth
2020-06-09 18:59:53,915: saved Adam successfully
2020-06-09 18:59:53,921: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 18:59:53,924: saved ReduceLROnPlateau successfully
2020-06-09 18:59:55,247: epoch=32.00 global_step=1248 lr=0.0001 start_iter=0
2020-06-09 18:59:55,247: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 19:01:01,299: 0) loss=0.410 grad_norm=4.88 num_segments=256 num_words=201
2020-06-09 19:02:04,858: 1) loss=0.348 grad_norm=4.43 num_segments=256 num_words=212
2020-06-09 19:03:09,075: 2) loss=0.238 grad_norm=3.47 num_segments=256 num_words=213
2020-06-09 19:04:12,904: 3) loss=0.378 grad_norm=4.35 num_segments=256 num_words=211
2020-06-09 19:05:17,339: 4) loss=0.346 grad_norm=5.34 num_segments=256 num_words=210
2020-06-09 19:06:21,213: 5) loss=0.444 grad_norm=6.53 num_segments=256 num_words=208
2020-06-09 19:07:25,072: 6) loss=0.222 grad_norm=4.23 num_segments=256 num_words=210
2020-06-09 19:08:29,181: 7) loss=0.388 grad_norm=4.92 num_segments=256 num_words=209
2020-06-09 19:09:33,613: 8) loss=0.329 grad_norm=4.09 num_segments=256 num_words=202
2020-06-09 19:10:37,830: 9) loss=0.336 grad_norm=3.98 num_segments=256 num_words=215
2020-06-09 19:11:42,301: 10) loss=0.269 grad_norm=5.28 num_segments=256 num_words=215
2020-06-09 19:12:46,504: 11) loss=0.383 grad_norm=4.56 num_segments=256 num_words=212
2020-06-09 19:15:02,228: 12) loss=0.220 grad_norm=3.93 num_segments=256 num_words=208
2020-06-09 19:16:06,433: 13) loss=0.310 grad_norm=3.61 num_segments=256 num_words=213
2020-06-09 19:17:10,578: 14) loss=0.317 grad_norm=4.79 num_segments=256 num_words=203
2020-06-09 19:18:14,818: 15) loss=0.318 grad_norm=3.92 num_segments=256 num_words=206
2020-06-09 19:19:18,895: 16) loss=0.259 grad_norm=4.35 num_segments=256 num_words=228
2020-06-09 19:20:22,867: 17) loss=0.296 grad_norm=4.00 num_segments=256 num_words=220
2020-06-09 19:21:27,177: 18) loss=0.225 grad_norm=5.03 num_segments=256 num_words=214
2020-06-09 19:22:31,385: 19) loss=0.532 grad_norm=4.45 num_segments=256 num_words=211
2020-06-09 19:23:29,557: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-09 19:23:29,616: Using 1 GPU(s)
2020-06-09 19:23:29,616: Machine: 0 / 1
2020-06-09 19:23:29,617: Hyperparam tuning-------------------
2020-06-09 19:23:29,617: optim_lr: 0.001
2020-06-09 19:23:29,617: dropout (for both): 0.4
2020-06-09 19:23:29,617: margin: 0.4
2020-06-09 19:23:29,618: ------------------------------------
2020-06-09 19:23:29,619: Calling main function: multiview_trainer.train
2020-06-09 19:23:29,619: Using config file: train_config.json
2020-06-09 19:23:29,620: Using module at multiview_trainer.train
2020-06-09 19:23:29,813: Using module at multiview_vocab.MultiViewVocab
2020-06-09 19:23:29,817: Building vocab_data from config
2020-06-09 19:23:30,115:  >> min_count= 0
2020-06-09 19:23:30,115:  >> # words= 34323 (# removed= 0)
2020-06-09 19:23:30,115:  >> # subwords= 38
2020-06-09 19:23:30,115:      = 1
2020-06-09 19:23:30,115:     '= 2
2020-06-09 19:23:30,115:     -= 3
2020-06-09 19:23:30,115:     .= 4
2020-06-09 19:23:30,115:     <= 5
2020-06-09 19:23:30,116:     >= 6
2020-06-09 19:23:30,116:     [= 7
2020-06-09 19:23:30,116:     [laughter]= 8
2020-06-09 19:23:30,116:     [noise]= 9
2020-06-09 19:23:30,116:     [vocalized-noise]= 10
2020-06-09 19:23:30,116:     ]= 11
2020-06-09 19:23:30,116:     _= 12
2020-06-09 19:23:30,116:     a= 13
2020-06-09 19:23:30,116:     b= 14
2020-06-09 19:23:30,116:     c= 15
2020-06-09 19:23:30,116:     d= 16
2020-06-09 19:23:30,116:     e= 17
2020-06-09 19:23:30,116:     f= 18
2020-06-09 19:23:30,116:     g= 19
2020-06-09 19:23:30,116:     h= 20
2020-06-09 19:23:30,116:     i= 21
2020-06-09 19:23:30,116:     j= 22
2020-06-09 19:23:30,117:     k= 23
2020-06-09 19:23:30,117:     l= 24
2020-06-09 19:23:30,117:     m= 25
2020-06-09 19:23:30,117:     n= 26
2020-06-09 19:23:30,117:     o= 27
2020-06-09 19:23:30,117:     p= 28
2020-06-09 19:23:30,117:     q= 29
2020-06-09 19:23:30,117:     r= 30
2020-06-09 19:23:30,117:     s= 31
2020-06-09 19:23:30,117:     t= 32
2020-06-09 19:23:30,117:     u= 33
2020-06-09 19:23:30,117:     v= 34
2020-06-09 19:23:30,117:     w= 35
2020-06-09 19:23:30,117:     x= 36
2020-06-09 19:23:30,117:     y= 37
2020-06-09 19:23:30,117:     z= 38
2020-06-09 19:23:30,135: Using module at data.batch_samplers.BatchSampler
2020-06-09 19:23:30,136: Building vocab_sampler from config
2020-06-09 19:23:30,137:  >> # examples= 34323
2020-06-09 19:23:30,137:  >> batch_size= 1000
2020-06-09 19:23:30,137:  >> shuffle= False
2020-06-09 19:23:30,145:  >> BatchSampler; 35 batches
2020-06-09 19:23:30,145: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 19:23:30,226: Building train_data from config
2020-06-09 19:23:37,700:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-09 19:23:37,701:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-09 19:23:37,701:  >> stack= False
2020-06-09 19:23:37,701:  >> seg_durs= (1, None)
2020-06-09 19:23:37,701:  >> # words= 9971 (# ignored= 0)
2020-06-09 19:23:37,701:  >> input_feat_dim= 108
2020-06-09 19:23:37,701:  >> input_num_subwords= 38
2020-06-09 19:23:37,701: Using module at data.batch_samplers.BatchSampler
2020-06-09 19:23:37,701: Building train_sampler from config
2020-06-09 19:23:37,702:  >> # examples= 9971
2020-06-09 19:23:37,702:  >> batch_size= 256
2020-06-09 19:23:37,702:  >> shuffle= True
2020-06-09 19:23:37,710:  >> BatchSampler; 39 batches
2020-06-09 19:23:37,710: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 19:23:37,710: Building dev_data from config
2020-06-09 19:23:46,087:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-09 19:23:46,088:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-09 19:23:46,088:  >> stack= False
2020-06-09 19:23:46,088:  >> seg_durs= (1, None)
2020-06-09 19:23:46,088:  >> # words= 10966 (# ignored= 0)
2020-06-09 19:23:46,088:  >> input_feat_dim= 108
2020-06-09 19:23:46,089:  >> input_num_subwords= 38
2020-06-09 19:23:46,089: Using module at data.batch_samplers.BatchSampler
2020-06-09 19:23:46,089: Building dev_sampler from config
2020-06-09 19:23:46,089:  >> # examples= 10966
2020-06-09 19:23:46,089:  >> batch_size= 256
2020-06-09 19:23:46,089:  >> shuffle= False
2020-06-09 19:23:46,092:  >> BatchSampler; 43 batches
2020-06-09 19:23:46,092: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 19:23:46,092: Building test_data from config
2020-06-09 19:23:52,783:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-09 19:23:52,784:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-09 19:23:52,784:  >> stack= False
2020-06-09 19:23:52,784:  >> seg_durs= (1, None)
2020-06-09 19:23:52,784:  >> # words= 11024 (# ignored= 0)
2020-06-09 19:23:52,784:  >> input_feat_dim= 108
2020-06-09 19:23:52,784:  >> input_num_subwords= 38
2020-06-09 19:23:52,784: Using module at data.batch_samplers.BatchSampler
2020-06-09 19:23:52,784: Building test_sampler from config
2020-06-09 19:23:52,785:  >> # examples= 11024
2020-06-09 19:23:52,785:  >> batch_size= 256
2020-06-09 19:23:52,785:  >> shuffle= False
2020-06-09 19:23:52,787:  >> BatchSampler; 44 batches
2020-06-09 19:23:52,787: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-09 19:23:52,794: Building loss from config
2020-06-09 19:23:52,795:  >> margin= 0.4
2020-06-09 19:23:52,795:  >> k= 16
2020-06-09 19:23:52,795:  >> min_k= 8
2020-06-09 19:23:52,795:  >> extra= 0
2020-06-09 19:23:52,795:  >> average= False
2020-06-09 19:23:52,795:  >> margin_max= 0.5
2020-06-09 19:23:52,795:  >> threshold_max= 9
2020-06-09 19:23:52,795:  >> using obj0
2020-06-09 19:23:52,795: Using module at metric.multiview_ap.MultiViewAP
2020-06-09 19:23:52,831: Building eval from config
2020-06-09 19:23:52,831:  >> acoustic_ap= True
2020-06-09 19:23:52,831:  >> crossview_ap= True
2020-06-09 19:23:52,831:  >> full_vocab= False
2020-06-09 19:23:52,831:  >> metric= crossview_ap
2020-06-09 19:23:52,831:  >> mode= max
2020-06-09 19:23:52,831: Using module at multiview_rnn.MultiViewRNN
2020-06-09 19:23:52,839: Building net from config
2020-06-09 19:23:52,840: view1:
2020-06-09 19:23:52,841:  >> cell= GRU
2020-06-09 19:23:52,841:  >> input_size= 108
2020-06-09 19:23:52,841:  >> hidden_size= 512
2020-06-09 19:23:52,841:  >> bidirectional= True
2020-06-09 19:23:52,841:  >> num_layers= 6
2020-06-09 19:23:52,841:  >> dropout between layers= 0.4
2020-06-09 19:23:53,044: view2:
2020-06-09 19:23:53,045:  >> cell= GRU
2020-06-09 19:23:53,045:  >> input_size= 64
2020-06-09 19:23:53,045:  >> hidden_size= 512
2020-06-09 19:23:53,045:  >> bidirectional= True
2020-06-09 19:23:53,045:  >> num_layers= 2
2020-06-09 19:23:53,045:  >> dropout between layers= 0.4
2020-06-09 19:23:53,045:  >> num input embeddings= 38
2020-06-09 19:23:56,364: Using module at optim.adam.Adam
2020-06-09 19:23:56,367: Building optim from config
2020-06-09 19:23:56,367:  >> lr= 0.001
2020-06-09 19:23:56,367:  >> betas= (0.9, 0.999)
2020-06-09 19:23:56,368:  >> eps= 1e-08
2020-06-09 19:23:56,368:  >> weight_decay= 0
2020-06-09 19:23:56,368:  >> amsgrad= False
2020-06-09 19:23:56,368:  >> min_lr= 1e-07
2020-06-09 19:23:56,369: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-09 19:23:56,374: Building sched from config
2020-06-09 19:23:56,374:  >> optim= Adam
2020-06-09 19:23:56,374:  >> decay lr by 0.1
2020-06-09 19:23:56,374:  >> eval_fn= MultiViewAP
2020-06-09 19:23:56,375:  >> patience=4
2020-06-09 19:23:56,375:  >> revert=True
2020-06-09 19:23:56,381: loaded save/MultiViewDataset_IndividualWords.1248.pth
2020-06-09 19:23:56,382: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 19:23:56,457: loaded save/MultiViewRNN.1248.pth
2020-06-09 19:23:56,457: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 19:23:56,555: loaded save/Adam.1248.pth
2020-06-09 19:23:56,555: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 19:23:56,557: loaded save/ReduceLROnPlateau.1248.pth
2020-06-09 19:23:56,557: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 19:23:56,557: epoch=32.00 global_step=1248 lr=0.0001 start_iter=0
2020-06-09 19:23:56,557: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 19:25:57,270: 0) loss=0.309 grad_norm=3.52 num_segments=256 num_words=201
2020-06-09 19:27:46,770: 1) loss=0.264 grad_norm=3.87 num_segments=256 num_words=212
2020-06-09 19:29:29,085: 2) loss=0.248 grad_norm=3.21 num_segments=256 num_words=213
2020-06-09 19:31:02,913: 3) loss=0.341 grad_norm=4.29 num_segments=256 num_words=211
2020-06-09 19:32:28,876: 4) loss=0.326 grad_norm=4.66 num_segments=256 num_words=210
2020-06-09 19:33:48,051: 5) loss=0.381 grad_norm=5.32 num_segments=256 num_words=208
2020-06-09 19:34:58,517: 6) loss=0.207 grad_norm=4.12 num_segments=256 num_words=210
2020-06-09 19:36:00,524: 7) loss=0.396 grad_norm=4.63 num_segments=256 num_words=209
2020-06-09 19:37:06,626: 8) loss=0.302 grad_norm=3.75 num_segments=256 num_words=202
2020-06-09 19:38:08,292: 9) loss=0.333 grad_norm=3.62 num_segments=256 num_words=215
2020-06-09 19:39:12,896: 10) loss=0.270 grad_norm=5.31 num_segments=256 num_words=215
2020-06-09 19:40:15,213: 11) loss=0.378 grad_norm=4.63 num_segments=256 num_words=212
2020-06-09 19:41:17,356: 12) loss=0.221 grad_norm=3.99 num_segments=256 num_words=208
2020-06-09 19:42:19,335: 13) loss=0.422 grad_norm=4.22 num_segments=256 num_words=213
2020-06-09 19:43:25,440: 14) loss=0.315 grad_norm=4.77 num_segments=256 num_words=203
2020-06-09 19:44:28,107: 15) loss=0.319 grad_norm=4.15 num_segments=256 num_words=206
2020-06-09 19:45:30,364: 16) loss=0.253 grad_norm=4.52 num_segments=256 num_words=228
2020-06-09 19:46:33,374: 17) loss=0.296 grad_norm=3.79 num_segments=256 num_words=220
2020-06-09 19:47:35,358: 18) loss=0.229 grad_norm=4.32 num_segments=256 num_words=214
2020-06-09 19:48:42,476: 19) loss=0.533 grad_norm=4.89 num_segments=256 num_words=211
2020-06-09 19:49:44,746: 20) loss=0.294 grad_norm=5.31 num_segments=256 num_words=206
2020-06-09 19:50:47,164: 21) loss=0.393 grad_norm=4.46 num_segments=256 num_words=213
2020-06-09 19:51:49,016: 22) loss=0.340 grad_norm=4.17 num_segments=256 num_words=209
2020-06-09 19:52:51,676: 23) loss=0.339 grad_norm=4.71 num_segments=256 num_words=215
2020-06-09 19:53:59,755: 24) loss=0.301 grad_norm=4.17 num_segments=256 num_words=212
2020-06-09 19:55:02,429: 25) loss=0.397 grad_norm=4.82 num_segments=256 num_words=208
2020-06-09 19:56:04,944: 26) loss=0.311 grad_norm=3.65 num_segments=256 num_words=205
2020-06-09 19:57:07,676: 27) loss=0.316 grad_norm=4.81 num_segments=256 num_words=204
2020-06-09 19:58:10,131: 28) loss=0.246 grad_norm=4.45 num_segments=256 num_words=212
2020-06-09 19:59:12,920: 29) loss=0.325 grad_norm=4.13 num_segments=256 num_words=204
2020-06-09 20:00:15,291: 30) loss=0.266 grad_norm=4.42 num_segments=256 num_words=214
2020-06-09 20:01:25,428: 31) loss=0.246 grad_norm=3.93 num_segments=256 num_words=206
2020-06-09 20:02:28,283: 32) loss=0.562 grad_norm=5.80 num_segments=256 num_words=207
2020-06-09 20:03:31,095: 33) loss=0.265 grad_norm=4.20 num_segments=256 num_words=209
2020-06-09 20:04:33,694: 34) loss=0.208 grad_norm=3.55 num_segments=256 num_words=210
2020-06-09 20:05:35,979: 35) loss=0.265 grad_norm=4.39 num_segments=256 num_words=206
2020-06-09 20:06:38,358: 36) loss=0.238 grad_norm=3.84 num_segments=256 num_words=212
2020-06-09 20:07:41,254: 37) loss=0.206 grad_norm=4.06 num_segments=256 num_words=211
2020-06-09 20:08:38,085: 38) loss=0.222 grad_norm=4.17 num_segments=243 num_words=191
2020-06-09 20:08:38,096: epoch= 33.00
2020-06-09 20:08:38,096:  >> time to evaluate and save:
2020-06-09 20:08:38,130: saved save/MultiViewDataset_IndividualWords.1287.pth
2020-06-09 20:08:38,141: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 20:08:38,152: removed save/MultiViewDataset_IndividualWords.1053.pth
2020-06-09 20:08:38,152: saved MultiViewDataset_IndividualWords successfully
2020-06-09 20:08:39,483: saved save/MultiViewRNN.1287.pth
2020-06-09 20:08:39,492: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 20:08:39,549: removed save/MultiViewRNN.1053.pth
2020-06-09 20:08:39,549: saved MultiViewRNN successfully
2020-06-09 20:08:42,077: saved save/Adam.1287.pth
2020-06-09 20:08:42,094: most_recent linked save/Adam.most_recent.pth
2020-06-09 20:08:42,189: removed save/Adam.1053.pth
2020-06-09 20:08:42,189: saved Adam successfully
2020-06-09 20:08:42,192: saved save/ReduceLROnPlateau.1287.pth
2020-06-09 20:08:42,200: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 20:08:42,206: saved ReduceLROnPlateau successfully
2020-06-09 20:08:42,208: saved config successfully
2020-06-09 20:10:09,427:   >> crossview_ap=0.613 (10966 x 3921 pairs)
2020-06-09 20:11:06,026:   >> acoustic_ap=0.737 (10966 choose 2 pairs)
2020-06-09 20:11:06,029: best_so_far= 0.613 at 1287
2020-06-09 20:11:06,061: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 20:11:06,065: saved MultiViewDataset_IndividualWords successfully
2020-06-09 20:11:06,095: best linked save/MultiViewRNN.best.pth
2020-06-09 20:11:06,107: saved MultiViewRNN successfully
2020-06-09 20:11:06,139: best linked save/Adam.best.pth
2020-06-09 20:11:06,150: saved Adam successfully
2020-06-09 20:11:06,151: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 20:11:06,156: saved ReduceLROnPlateau successfully
2020-06-09 20:11:06,213: epoch=33.00 global_step=1287 lr=0.0001 start_iter=0
2020-06-09 20:11:06,213: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 20:12:11,728: 0) loss=0.246 grad_norm=4.60 num_segments=256 num_words=224
2020-06-09 20:13:22,799: 1) loss=0.245 grad_norm=4.12 num_segments=256 num_words=214
2020-06-09 20:14:22,217: 2) loss=0.263 grad_norm=3.91 num_segments=256 num_words=204
2020-06-09 20:15:18,861: 3) loss=0.255 grad_norm=4.02 num_segments=256 num_words=201
2020-06-09 20:16:20,042: 4) loss=0.544 grad_norm=5.69 num_segments=256 num_words=211
2020-06-09 20:17:16,224: 5) loss=0.204 grad_norm=3.44 num_segments=256 num_words=215
2020-06-09 20:18:17,580: 6) loss=0.317 grad_norm=3.51 num_segments=256 num_words=203
2020-06-09 20:19:18,197: 7) loss=0.319 grad_norm=5.22 num_segments=256 num_words=212
2020-06-09 20:20:21,926: 8) loss=0.309 grad_norm=4.41 num_segments=256 num_words=204
2020-06-09 20:21:19,954: 9) loss=0.330 grad_norm=4.80 num_segments=256 num_words=213
2020-06-09 20:22:23,966: 10) loss=0.287 grad_norm=4.24 num_segments=256 num_words=195
2020-06-09 20:23:26,866: 11) loss=0.249 grad_norm=3.24 num_segments=256 num_words=218
2020-06-09 20:24:42,938: 12) loss=0.214 grad_norm=3.55 num_segments=256 num_words=213
2020-06-09 20:25:46,500: 13) loss=0.222 grad_norm=3.69 num_segments=256 num_words=208
2020-06-09 20:26:46,912: 14) loss=0.287 grad_norm=4.98 num_segments=256 num_words=220
2020-06-09 20:27:46,105: 15) loss=0.209 grad_norm=3.25 num_segments=256 num_words=208
2020-06-09 20:28:44,051: 16) loss=0.583 grad_norm=7.88 num_segments=256 num_words=201
2020-06-09 20:29:41,708: 17) loss=0.385 grad_norm=4.17 num_segments=256 num_words=212
2020-06-09 20:30:38,237: 18) loss=0.282 grad_norm=4.43 num_segments=256 num_words=213
2020-06-09 20:31:34,978: 19) loss=0.326 grad_norm=3.96 num_segments=256 num_words=215
2020-06-09 20:32:32,300: 20) loss=0.361 grad_norm=3.96 num_segments=256 num_words=202
2020-06-09 20:33:28,998: 21) loss=0.306 grad_norm=4.81 num_segments=256 num_words=210
2020-06-09 20:34:25,677: 22) loss=0.338 grad_norm=4.69 num_segments=256 num_words=197
2020-06-09 20:35:22,445: 23) loss=0.220 grad_norm=3.64 num_segments=256 num_words=214
2020-06-09 20:36:19,093: 24) loss=0.214 grad_norm=3.97 num_segments=256 num_words=205
2020-06-09 20:37:15,869: 25) loss=0.301 grad_norm=3.36 num_segments=256 num_words=221
2020-06-09 20:38:32,569: 26) loss=0.417 grad_norm=4.61 num_segments=256 num_words=203
2020-06-09 20:39:29,116: 27) loss=0.358 grad_norm=5.27 num_segments=256 num_words=204
2020-06-09 20:40:25,655: 28) loss=0.217 grad_norm=5.48 num_segments=256 num_words=219
2020-06-09 20:41:22,319: 29) loss=0.236 grad_norm=4.45 num_segments=256 num_words=207
2020-06-09 20:42:19,322: 30) loss=0.235 grad_norm=3.78 num_segments=256 num_words=206
2020-06-09 20:43:15,928: 31) loss=0.275 grad_norm=4.73 num_segments=256 num_words=217
2020-06-09 20:44:21,163: 32) loss=0.244 grad_norm=3.61 num_segments=256 num_words=202
2020-06-09 20:45:28,773: 33) loss=0.296 grad_norm=5.06 num_segments=256 num_words=210
2020-06-09 20:46:28,202: 34) loss=0.256 grad_norm=3.53 num_segments=256 num_words=219
2020-06-09 20:47:25,487: 35) loss=0.361 grad_norm=6.05 num_segments=256 num_words=225
2020-06-09 20:48:22,150: 36) loss=0.217 grad_norm=3.46 num_segments=256 num_words=204
2020-06-09 20:49:18,536: 37) loss=0.212 grad_norm=3.88 num_segments=256 num_words=208
2020-06-09 20:50:09,489: 38) loss=0.214 grad_norm=3.35 num_segments=243 num_words=198
2020-06-09 20:50:09,498: epoch= 34.00
2020-06-09 20:50:09,499:  >> time to evaluate and save:
2020-06-09 20:50:09,527: saved save/MultiViewDataset_IndividualWords.1326.pth
2020-06-09 20:50:09,540: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 20:50:09,578: removed save/MultiViewDataset_IndividualWords.1092.pth
2020-06-09 20:50:09,578: saved MultiViewDataset_IndividualWords successfully
2020-06-09 20:50:10,926: saved save/MultiViewRNN.1326.pth
2020-06-09 20:50:10,931: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 20:50:11,107: removed save/MultiViewRNN.1092.pth
2020-06-09 20:50:11,107: saved MultiViewRNN successfully
2020-06-09 20:50:13,742: saved save/Adam.1326.pth
2020-06-09 20:50:13,750: most_recent linked save/Adam.most_recent.pth
2020-06-09 20:50:13,918: removed save/Adam.1092.pth
2020-06-09 20:50:13,918: saved Adam successfully
2020-06-09 20:50:13,920: saved save/ReduceLROnPlateau.1326.pth
2020-06-09 20:50:13,952: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 20:50:13,968: removed save/ReduceLROnPlateau.1053.pth
2020-06-09 20:50:13,968: saved ReduceLROnPlateau successfully
2020-06-09 20:50:13,970: saved config successfully
2020-06-09 20:51:34,294:   >> crossview_ap=0.614 (10966 x 3921 pairs)
2020-06-09 20:52:23,982:   >> acoustic_ap=0.739 (10966 choose 2 pairs)
2020-06-09 20:52:23,988: best_so_far= 0.614 at 1326
2020-06-09 20:52:24,013: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 20:52:24,017: saved MultiViewDataset_IndividualWords successfully
2020-06-09 20:52:24,021: best linked save/MultiViewRNN.best.pth
2020-06-09 20:52:24,031: saved MultiViewRNN successfully
2020-06-09 20:52:24,042: best linked save/Adam.best.pth
2020-06-09 20:52:24,050: saved Adam successfully
2020-06-09 20:52:24,070: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 20:52:24,080: removed save/ReduceLROnPlateau.1092.pth
2020-06-09 20:52:24,081: saved ReduceLROnPlateau successfully
2020-06-09 20:52:24,699: epoch=34.00 global_step=1326 lr=0.0001 start_iter=0
2020-06-09 20:52:24,699: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 20:53:23,186: 0) loss=0.225 grad_norm=4.09 num_segments=256 num_words=226
2020-06-09 20:54:20,769: 1) loss=0.398 grad_norm=4.56 num_segments=256 num_words=216
2020-06-09 20:55:17,493: 2) loss=0.326 grad_norm=4.37 num_segments=256 num_words=201
2020-06-09 20:56:14,661: 3) loss=0.387 grad_norm=4.32 num_segments=256 num_words=207
2020-06-09 20:57:13,147: 4) loss=0.246 grad_norm=3.94 num_segments=256 num_words=204
2020-06-09 20:58:29,139: 5) loss=0.310 grad_norm=5.73 num_segments=256 num_words=213
2020-06-09 20:59:26,537: 6) loss=0.399 grad_norm=5.06 num_segments=256 num_words=206
2020-06-09 21:00:23,783: 7) loss=0.389 grad_norm=6.79 num_segments=256 num_words=218
2020-06-09 21:01:20,384: 8) loss=0.353 grad_norm=4.65 num_segments=256 num_words=204
2020-06-09 21:02:16,953: 9) loss=0.244 grad_norm=4.58 num_segments=256 num_words=211
2020-06-09 21:03:13,480: 10) loss=0.204 grad_norm=3.64 num_segments=256 num_words=206
2020-06-09 21:04:10,012: 11) loss=0.377 grad_norm=6.35 num_segments=256 num_words=217
2020-06-09 21:05:06,524: 12) loss=0.213 grad_norm=3.54 num_segments=256 num_words=210
2020-06-09 21:06:03,006: 13) loss=0.308 grad_norm=5.29 num_segments=256 num_words=206
2020-06-09 21:07:01,079: 14) loss=0.207 grad_norm=4.44 num_segments=256 num_words=214
2020-06-09 21:07:59,970: 15) loss=0.218 grad_norm=3.38 num_segments=256 num_words=208
2020-06-09 21:08:57,885: 16) loss=0.285 grad_norm=3.99 num_segments=256 num_words=204
2020-06-09 21:09:56,146: 17) loss=0.244 grad_norm=4.52 num_segments=256 num_words=218
2020-06-09 21:10:54,153: 18) loss=0.234 grad_norm=3.63 num_segments=256 num_words=222
2020-06-09 21:11:51,728: 19) loss=0.326 grad_norm=5.29 num_segments=256 num_words=210
2020-06-09 21:12:49,144: 20) loss=0.373 grad_norm=4.76 num_segments=256 num_words=197
2020-06-09 21:13:46,765: 21) loss=0.237 grad_norm=3.58 num_segments=256 num_words=207
2020-06-09 21:14:48,568: 22) loss=0.237 grad_norm=4.29 num_segments=256 num_words=210
2020-06-09 21:15:48,087: 23) loss=0.325 grad_norm=5.09 num_segments=256 num_words=202
2020-06-09 21:16:46,961: 24) loss=0.322 grad_norm=4.67 num_segments=256 num_words=210
2020-06-09 21:17:45,159: 25) loss=0.259 grad_norm=3.76 num_segments=256 num_words=207
2020-06-09 21:19:06,452: 26) loss=0.361 grad_norm=4.21 num_segments=256 num_words=210
2020-06-09 21:20:04,369: 27) loss=0.278 grad_norm=4.07 num_segments=256 num_words=208
2020-06-09 21:21:01,862: 28) loss=0.236 grad_norm=3.76 num_segments=256 num_words=217
2020-06-09 21:22:00,432: 29) loss=0.204 grad_norm=3.96 num_segments=256 num_words=211
2020-06-09 21:22:58,442: 30) loss=0.373 grad_norm=3.65 num_segments=256 num_words=220
2020-06-09 21:23:56,333: 31) loss=0.505 grad_norm=4.12 num_segments=256 num_words=199
2020-06-09 21:24:53,104: 32) loss=0.362 grad_norm=4.21 num_segments=256 num_words=213
2020-06-09 21:25:51,768: 33) loss=0.207 grad_norm=3.35 num_segments=256 num_words=208
2020-06-09 21:26:49,472: 34) loss=0.271 grad_norm=4.04 num_segments=256 num_words=208
2020-06-09 21:27:48,328: 35) loss=0.240 grad_norm=5.04 num_segments=256 num_words=206
2020-06-09 21:28:47,684: 36) loss=0.319 grad_norm=3.77 num_segments=256 num_words=213
2020-06-09 21:29:45,482: 37) loss=0.228 grad_norm=3.77 num_segments=256 num_words=208
2020-06-09 21:30:37,394: 38) loss=0.210 grad_norm=3.40 num_segments=243 num_words=197
2020-06-09 21:30:37,404: epoch= 35.00
2020-06-09 21:30:37,404:  >> time to evaluate and save:
2020-06-09 21:30:37,471: saved save/MultiViewDataset_IndividualWords.1365.pth
2020-06-09 21:30:37,490: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 21:30:37,533: removed save/MultiViewDataset_IndividualWords.1131.pth
2020-06-09 21:30:37,533: saved MultiViewDataset_IndividualWords successfully
2020-06-09 21:30:38,929: saved save/MultiViewRNN.1365.pth
2020-06-09 21:30:39,246: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 21:30:39,339: removed save/MultiViewRNN.1131.pth
2020-06-09 21:30:39,339: saved MultiViewRNN successfully
2020-06-09 21:30:42,134: saved save/Adam.1365.pth
2020-06-09 21:30:42,152: most_recent linked save/Adam.most_recent.pth
2020-06-09 21:30:42,238: removed save/Adam.1131.pth
2020-06-09 21:30:42,238: saved Adam successfully
2020-06-09 21:30:42,241: saved save/ReduceLROnPlateau.1365.pth
2020-06-09 21:30:42,253: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 21:30:42,266: removed save/ReduceLROnPlateau.1131.pth
2020-06-09 21:30:42,266: saved ReduceLROnPlateau successfully
2020-06-09 21:30:42,268: saved config successfully
2020-06-09 21:32:03,365:   >> crossview_ap=0.614 (10966 x 3921 pairs)
2020-06-09 21:32:53,988:   >> acoustic_ap=0.738 (10966 choose 2 pairs)
2020-06-09 21:32:53,991: best_so_far= 0.614 at 1326
2020-06-09 21:32:54,729: epoch=35.00 global_step=1365 lr=0.0001 start_iter=0
2020-06-09 21:32:54,729: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 21:33:54,209: 0) loss=0.359 grad_norm=5.34 num_segments=256 num_words=213
2020-06-09 21:34:53,140: 1) loss=0.207 grad_norm=3.68 num_segments=256 num_words=205
2020-06-09 21:35:52,759: 2) loss=0.313 grad_norm=4.29 num_segments=256 num_words=216
2020-06-09 21:36:51,531: 3) loss=0.247 grad_norm=3.47 num_segments=256 num_words=209
2020-06-09 21:37:50,177: 4) loss=0.367 grad_norm=4.87 num_segments=256 num_words=218
2020-06-09 21:38:47,908: 5) loss=0.253 grad_norm=3.67 num_segments=256 num_words=204
2020-06-09 21:39:45,869: 6) loss=0.302 grad_norm=4.10 num_segments=256 num_words=203
2020-06-09 21:40:43,104: 7) loss=0.268 grad_norm=5.08 num_segments=256 num_words=199
2020-06-09 21:41:42,075: 8) loss=0.343 grad_norm=5.08 num_segments=256 num_words=218
2020-06-09 21:42:40,330: 9) loss=0.248 grad_norm=4.23 num_segments=256 num_words=218
2020-06-09 21:43:37,782: 10) loss=0.252 grad_norm=4.16 num_segments=256 num_words=218
2020-06-09 21:44:36,013: 11) loss=0.303 grad_norm=3.96 num_segments=256 num_words=208
2020-06-09 21:45:33,739: 12) loss=0.355 grad_norm=4.71 num_segments=256 num_words=206
2020-06-09 21:46:32,798: 13) loss=0.223 grad_norm=3.24 num_segments=256 num_words=206
2020-06-09 21:48:03,064: 14) loss=0.311 grad_norm=4.47 num_segments=256 num_words=215
2020-06-09 21:49:00,097: 15) loss=0.246 grad_norm=4.27 num_segments=256 num_words=219
2020-06-09 21:49:57,395: 16) loss=0.250 grad_norm=4.36 num_segments=256 num_words=214
2020-06-09 21:50:55,804: 17) loss=0.206 grad_norm=3.45 num_segments=256 num_words=208
2020-06-09 21:51:54,896: 18) loss=0.379 grad_norm=4.79 num_segments=256 num_words=207
2020-06-09 21:52:52,550: 19) loss=0.305 grad_norm=4.67 num_segments=256 num_words=214
2020-06-09 21:53:49,432: 20) loss=0.336 grad_norm=4.28 num_segments=256 num_words=215
2020-06-09 21:54:46,137: 21) loss=0.244 grad_norm=3.35 num_segments=256 num_words=213
2020-06-09 21:55:43,149: 22) loss=0.392 grad_norm=5.03 num_segments=256 num_words=214
2020-06-09 21:56:40,084: 23) loss=0.336 grad_norm=3.96 num_segments=256 num_words=208
2020-06-09 21:57:36,902: 24) loss=0.225 grad_norm=3.69 num_segments=256 num_words=204
2020-06-09 21:58:34,398: 25) loss=0.237 grad_norm=3.70 num_segments=256 num_words=204
2020-06-09 21:59:32,759: 26) loss=0.217 grad_norm=3.92 num_segments=256 num_words=205
2020-06-09 22:00:31,222: 27) loss=0.225 grad_norm=4.51 num_segments=256 num_words=209
2020-06-09 22:01:29,730: 28) loss=0.248 grad_norm=4.34 num_segments=256 num_words=215
2020-06-09 22:02:27,549: 29) loss=0.275 grad_norm=3.88 num_segments=256 num_words=220
2020-06-09 22:03:24,949: 30) loss=0.285 grad_norm=3.89 num_segments=256 num_words=218
2020-06-09 22:04:22,575: 31) loss=0.307 grad_norm=4.06 num_segments=256 num_words=205
2020-06-09 22:05:19,498: 32) loss=0.332 grad_norm=3.81 num_segments=256 num_words=208
2020-06-09 22:06:16,284: 33) loss=0.445 grad_norm=5.92 num_segments=256 num_words=211
2020-06-09 22:07:13,191: 34) loss=0.285 grad_norm=4.01 num_segments=256 num_words=210
2020-06-09 22:08:11,349: 35) loss=0.430 grad_norm=4.78 num_segments=256 num_words=208
2020-06-09 22:09:10,043: 36) loss=0.253 grad_norm=3.78 num_segments=256 num_words=221
2020-06-09 22:10:07,101: 37) loss=0.389 grad_norm=4.90 num_segments=256 num_words=209
2020-06-09 22:10:59,051: 38) loss=0.364 grad_norm=4.58 num_segments=243 num_words=199
2020-06-09 22:10:59,064: epoch= 36.00
2020-06-09 22:10:59,064:  >> time to evaluate and save:
2020-06-09 22:10:59,118: saved save/MultiViewDataset_IndividualWords.1404.pth
2020-06-09 22:10:59,120: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 22:10:59,154: removed save/MultiViewDataset_IndividualWords.1170.pth
2020-06-09 22:10:59,154: saved MultiViewDataset_IndividualWords successfully
2020-06-09 22:11:00,518: saved save/MultiViewRNN.1404.pth
2020-06-09 22:11:00,532: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 22:11:00,608: removed save/MultiViewRNN.1170.pth
2020-06-09 22:11:00,608: saved MultiViewRNN successfully
2020-06-09 22:11:03,179: saved save/Adam.1404.pth
2020-06-09 22:11:03,296: most_recent linked save/Adam.most_recent.pth
2020-06-09 22:11:03,396: removed save/Adam.1170.pth
2020-06-09 22:11:03,396: saved Adam successfully
2020-06-09 22:11:03,398: saved save/ReduceLROnPlateau.1404.pth
2020-06-09 22:11:03,471: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 22:11:03,493: removed save/ReduceLROnPlateau.1170.pth
2020-06-09 22:11:03,493: saved ReduceLROnPlateau successfully
2020-06-09 22:11:03,495: saved config successfully
2020-06-09 22:12:29,625:   >> crossview_ap=0.614 (10966 x 3921 pairs)
2020-06-09 22:13:23,612:   >> acoustic_ap=0.739 (10966 choose 2 pairs)
2020-06-09 22:13:23,615: best_so_far= 0.614 at 1326
2020-06-09 22:13:24,484: epoch=36.00 global_step=1404 lr=0.0001 start_iter=0
2020-06-09 22:13:24,484: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 22:14:23,628: 0) loss=0.259 grad_norm=3.70 num_segments=256 num_words=208
2020-06-09 22:15:21,379: 1) loss=0.195 grad_norm=4.08 num_segments=256 num_words=214
2020-06-09 22:16:21,230: 2) loss=0.281 grad_norm=3.97 num_segments=256 num_words=204
2020-06-09 22:17:20,472: 3) loss=0.380 grad_norm=5.43 num_segments=256 num_words=213
2020-06-09 22:18:17,996: 4) loss=0.285 grad_norm=3.72 num_segments=256 num_words=211
2020-06-09 22:19:14,795: 5) loss=0.241 grad_norm=4.05 num_segments=256 num_words=214
2020-06-09 22:20:12,652: 6) loss=0.248 grad_norm=4.09 num_segments=256 num_words=211
2020-06-09 22:21:09,408: 7) loss=0.325 grad_norm=5.05 num_segments=256 num_words=209
2020-06-09 22:22:07,215: 8) loss=0.248 grad_norm=3.79 num_segments=256 num_words=216
2020-06-09 22:23:43,746: 9) loss=0.487 grad_norm=5.19 num_segments=256 num_words=213
2020-06-09 22:24:41,661: 10) loss=0.359 grad_norm=5.41 num_segments=256 num_words=214
2020-06-09 22:25:42,558: 11) loss=0.411 grad_norm=4.39 num_segments=256 num_words=206
2020-06-09 22:26:39,591: 12) loss=0.365 grad_norm=6.47 num_segments=256 num_words=219
2020-06-09 22:27:36,505: 13) loss=0.202 grad_norm=5.01 num_segments=256 num_words=205
2020-06-09 22:28:33,529: 14) loss=0.388 grad_norm=5.20 num_segments=256 num_words=210
2020-06-09 22:29:30,442: 15) loss=0.349 grad_norm=4.07 num_segments=256 num_words=215
2020-06-09 22:30:27,073: 16) loss=0.275 grad_norm=4.40 num_segments=256 num_words=211
2020-06-09 22:31:23,789: 17) loss=0.646 grad_norm=4.89 num_segments=256 num_words=219
2020-06-09 22:32:21,279: 18) loss=0.360 grad_norm=4.56 num_segments=256 num_words=209
2020-06-09 22:33:18,384: 19) loss=0.197 grad_norm=3.19 num_segments=256 num_words=217
2020-06-09 22:34:16,739: 20) loss=0.238 grad_norm=3.80 num_segments=256 num_words=204
2020-06-09 22:35:14,044: 21) loss=0.279 grad_norm=3.37 num_segments=256 num_words=209
2020-06-09 22:36:11,332: 22) loss=0.355 grad_norm=4.89 num_segments=256 num_words=217
2020-06-09 22:37:08,950: 23) loss=0.278 grad_norm=3.68 num_segments=256 num_words=214
2020-06-09 22:38:06,408: 24) loss=0.215 grad_norm=3.52 num_segments=256 num_words=216
2020-06-09 22:39:03,891: 25) loss=0.265 grad_norm=4.04 num_segments=256 num_words=212
2020-06-09 22:40:01,845: 26) loss=0.254 grad_norm=4.21 num_segments=256 num_words=205
2020-06-09 22:40:58,779: 27) loss=0.215 grad_norm=3.55 num_segments=256 num_words=212
2020-06-09 22:41:55,647: 28) loss=0.200 grad_norm=3.72 num_segments=256 num_words=210
2020-06-09 22:42:54,165: 29) loss=0.263 grad_norm=4.59 num_segments=256 num_words=215
2020-06-09 22:43:51,427: 30) loss=0.395 grad_norm=4.78 num_segments=256 num_words=192
2020-06-09 22:44:48,338: 31) loss=0.216 grad_norm=3.77 num_segments=256 num_words=212
2020-06-09 22:45:45,029: 32) loss=0.476 grad_norm=5.98 num_segments=256 num_words=202
2020-06-09 22:46:42,358: 33) loss=0.296 grad_norm=3.80 num_segments=256 num_words=215
2020-06-09 22:47:39,073: 34) loss=0.258 grad_norm=3.49 num_segments=256 num_words=202
2020-06-09 22:48:35,888: 35) loss=0.289 grad_norm=3.69 num_segments=256 num_words=206
2020-06-09 22:49:32,719: 36) loss=0.337 grad_norm=3.87 num_segments=256 num_words=206
2020-06-09 22:50:29,629: 37) loss=0.315 grad_norm=4.18 num_segments=256 num_words=221
2020-06-09 22:51:20,779: 38) loss=0.253 grad_norm=3.64 num_segments=243 num_words=200
2020-06-09 22:51:20,789: epoch= 37.00
2020-06-09 22:51:20,789:  >> time to evaluate and save:
2020-06-09 22:51:20,863: saved save/MultiViewDataset_IndividualWords.1443.pth
2020-06-09 22:51:20,865: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 22:51:20,928: removed save/MultiViewDataset_IndividualWords.1209.pth
2020-06-09 22:51:20,928: saved MultiViewDataset_IndividualWords successfully
2020-06-09 22:51:22,252: saved save/MultiViewRNN.1443.pth
2020-06-09 22:51:22,262: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 22:51:22,357: removed save/MultiViewRNN.1209.pth
2020-06-09 22:51:22,357: saved MultiViewRNN successfully
2020-06-09 22:51:24,862: saved save/Adam.1443.pth
2020-06-09 22:51:24,872: most_recent linked save/Adam.most_recent.pth
2020-06-09 22:51:24,959: removed save/Adam.1209.pth
2020-06-09 22:51:24,959: saved Adam successfully
2020-06-09 22:51:24,961: saved save/ReduceLROnPlateau.1443.pth
2020-06-09 22:51:24,970: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 22:51:24,988: removed save/ReduceLROnPlateau.1209.pth
2020-06-09 22:51:24,988: saved ReduceLROnPlateau successfully
2020-06-09 22:51:24,990: saved config successfully
2020-06-09 22:52:49,915:   >> crossview_ap=0.613 (10966 x 3921 pairs)
2020-06-09 22:53:39,317:   >> acoustic_ap=0.740 (10966 choose 2 pairs)
2020-06-09 22:53:39,321: best_so_far= 0.614 at 1326
2020-06-09 22:53:40,352: epoch=37.00 global_step=1443 lr=0.0001 start_iter=0
2020-06-09 22:53:40,353: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 22:54:39,547: 0) loss=0.619 grad_norm=4.45 num_segments=256 num_words=212
2020-06-09 22:55:36,515: 1) loss=0.321 grad_norm=5.49 num_segments=256 num_words=217
2020-06-09 22:56:33,542: 2) loss=0.389 grad_norm=4.36 num_segments=256 num_words=205
2020-06-09 22:57:31,276: 3) loss=0.209 grad_norm=3.92 num_segments=256 num_words=208
2020-06-09 22:58:28,326: 4) loss=0.347 grad_norm=5.23 num_segments=256 num_words=211
2020-06-09 22:59:25,583: 5) loss=0.237 grad_norm=7.29 num_segments=256 num_words=209
2020-06-09 23:00:23,641: 6) loss=0.238 grad_norm=4.14 num_segments=256 num_words=207
2020-06-09 23:01:22,644: 7) loss=0.243 grad_norm=4.24 num_segments=256 num_words=214
2020-06-09 23:02:20,084: 8) loss=0.361 grad_norm=5.26 num_segments=256 num_words=209
2020-06-09 23:03:18,119: 9) loss=0.541 grad_norm=5.00 num_segments=256 num_words=216
2020-06-09 23:04:15,095: 10) loss=0.629 grad_norm=6.39 num_segments=256 num_words=212
2020-06-09 23:05:11,996: 11) loss=0.262 grad_norm=4.04 num_segments=256 num_words=221
2020-06-09 23:07:02,533: 12) loss=0.322 grad_norm=4.41 num_segments=256 num_words=210
2020-06-09 23:07:59,555: 13) loss=0.210 grad_norm=4.00 num_segments=256 num_words=215
2020-06-09 23:08:56,888: 14) loss=0.352 grad_norm=6.20 num_segments=256 num_words=205
2020-06-09 23:09:54,100: 15) loss=0.219 grad_norm=3.07 num_segments=256 num_words=214
2020-06-09 23:10:51,187: 16) loss=0.243 grad_norm=4.34 num_segments=256 num_words=209
2020-06-09 23:11:48,195: 17) loss=0.282 grad_norm=3.74 num_segments=256 num_words=205
2020-06-09 23:12:45,515: 18) loss=0.308 grad_norm=4.67 num_segments=256 num_words=219
2020-06-09 23:13:42,702: 19) loss=0.291 grad_norm=4.35 num_segments=256 num_words=203
2020-06-09 23:14:39,894: 20) loss=0.212 grad_norm=3.43 num_segments=256 num_words=208
2020-06-09 23:15:37,528: 21) loss=0.390 grad_norm=4.96 num_segments=256 num_words=197
2020-06-09 23:16:34,694: 22) loss=0.570 grad_norm=6.22 num_segments=256 num_words=210
2020-06-09 23:17:32,319: 23) loss=0.232 grad_norm=3.43 num_segments=256 num_words=214
2020-06-09 23:18:30,035: 24) loss=0.391 grad_norm=4.98 num_segments=256 num_words=209
2020-06-09 23:19:27,752: 25) loss=0.218 grad_norm=4.42 num_segments=256 num_words=208
2020-06-09 23:20:25,299: 26) loss=0.294 grad_norm=3.72 num_segments=256 num_words=210
2020-06-09 23:21:23,405: 27) loss=0.282 grad_norm=4.58 num_segments=256 num_words=219
2020-06-09 23:22:23,046: 28) loss=0.274 grad_norm=4.29 num_segments=256 num_words=203
2020-06-09 23:23:21,253: 29) loss=0.409 grad_norm=3.94 num_segments=256 num_words=205
2020-06-09 23:23:50,912: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-09 23:23:50,969: Using 1 GPU(s)
2020-06-09 23:23:50,970: Machine: 0 / 1
2020-06-09 23:23:50,978: Hyperparam tuning-------------------
2020-06-09 23:23:50,978: optim_lr: 0.001
2020-06-09 23:23:50,979: dropout (for both): 0.4
2020-06-09 23:23:50,979: margin: 0.4
2020-06-09 23:23:50,979: ------------------------------------
2020-06-09 23:23:50,981: Calling main function: multiview_trainer.train
2020-06-09 23:23:50,981: Using config file: train_config.json
2020-06-09 23:23:50,981: Using module at multiview_trainer.train
2020-06-09 23:23:51,179: Using module at multiview_vocab.MultiViewVocab
2020-06-09 23:23:51,221: Building vocab_data from config
2020-06-09 23:23:51,513:  >> min_count= 0
2020-06-09 23:23:51,513:  >> # words= 34323 (# removed= 0)
2020-06-09 23:23:51,513:  >> # subwords= 38
2020-06-09 23:23:51,513:      = 1
2020-06-09 23:23:51,513:     '= 2
2020-06-09 23:23:51,513:     -= 3
2020-06-09 23:23:51,513:     .= 4
2020-06-09 23:23:51,513:     <= 5
2020-06-09 23:23:51,513:     >= 6
2020-06-09 23:23:51,514:     [= 7
2020-06-09 23:23:51,514:     [laughter]= 8
2020-06-09 23:23:51,514:     [noise]= 9
2020-06-09 23:23:51,514:     [vocalized-noise]= 10
2020-06-09 23:23:51,514:     ]= 11
2020-06-09 23:23:51,514:     _= 12
2020-06-09 23:23:51,514:     a= 13
2020-06-09 23:23:51,514:     b= 14
2020-06-09 23:23:51,514:     c= 15
2020-06-09 23:23:51,514:     d= 16
2020-06-09 23:23:51,514:     e= 17
2020-06-09 23:23:51,514:     f= 18
2020-06-09 23:23:51,515:     g= 19
2020-06-09 23:23:51,515:     h= 20
2020-06-09 23:23:51,515:     i= 21
2020-06-09 23:23:51,515:     j= 22
2020-06-09 23:23:51,515:     k= 23
2020-06-09 23:23:51,515:     l= 24
2020-06-09 23:23:51,515:     m= 25
2020-06-09 23:23:51,515:     n= 26
2020-06-09 23:23:51,515:     o= 27
2020-06-09 23:23:51,515:     p= 28
2020-06-09 23:23:51,515:     q= 29
2020-06-09 23:23:51,515:     r= 30
2020-06-09 23:23:51,515:     s= 31
2020-06-09 23:23:51,516:     t= 32
2020-06-09 23:23:51,516:     u= 33
2020-06-09 23:23:51,516:     v= 34
2020-06-09 23:23:51,516:     w= 35
2020-06-09 23:23:51,516:     x= 36
2020-06-09 23:23:51,516:     y= 37
2020-06-09 23:23:51,516:     z= 38
2020-06-09 23:23:51,537: Using module at data.batch_samplers.BatchSampler
2020-06-09 23:23:51,539: Building vocab_sampler from config
2020-06-09 23:23:51,540:  >> # examples= 34323
2020-06-09 23:23:51,540:  >> batch_size= 1000
2020-06-09 23:23:51,540:  >> shuffle= False
2020-06-09 23:23:51,549:  >> BatchSampler; 35 batches
2020-06-09 23:23:51,550: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 23:23:51,632: Building train_data from config
2020-06-09 23:23:58,639:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-09 23:23:58,641:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-09 23:23:58,641:  >> stack= False
2020-06-09 23:23:58,641:  >> seg_durs= (1, None)
2020-06-09 23:23:58,641:  >> # words= 9971 (# ignored= 0)
2020-06-09 23:23:58,641:  >> input_feat_dim= 108
2020-06-09 23:23:58,641:  >> input_num_subwords= 38
2020-06-09 23:23:58,641: Using module at data.batch_samplers.BatchSampler
2020-06-09 23:23:58,642: Building train_sampler from config
2020-06-09 23:23:58,643:  >> # examples= 9971
2020-06-09 23:23:58,643:  >> batch_size= 256
2020-06-09 23:23:58,643:  >> shuffle= True
2020-06-09 23:23:58,651:  >> BatchSampler; 39 batches
2020-06-09 23:23:58,651: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 23:23:58,651: Building dev_data from config
2020-06-09 23:24:06,098:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-09 23:24:06,098:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-09 23:24:06,099:  >> stack= False
2020-06-09 23:24:06,099:  >> seg_durs= (1, None)
2020-06-09 23:24:06,099:  >> # words= 10966 (# ignored= 0)
2020-06-09 23:24:06,099:  >> input_feat_dim= 108
2020-06-09 23:24:06,099:  >> input_num_subwords= 38
2020-06-09 23:24:06,099: Using module at data.batch_samplers.BatchSampler
2020-06-09 23:24:06,099: Building dev_sampler from config
2020-06-09 23:24:06,100:  >> # examples= 10966
2020-06-09 23:24:06,100:  >> batch_size= 256
2020-06-09 23:24:06,100:  >> shuffle= False
2020-06-09 23:24:06,104:  >> BatchSampler; 43 batches
2020-06-09 23:24:06,104: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 23:24:06,104: Building test_data from config
2020-06-09 23:24:12,645:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-09 23:24:12,645:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-09 23:24:12,645:  >> stack= False
2020-06-09 23:24:12,646:  >> seg_durs= (1, None)
2020-06-09 23:24:12,646:  >> # words= 11024 (# ignored= 0)
2020-06-09 23:24:12,646:  >> input_feat_dim= 108
2020-06-09 23:24:12,646:  >> input_num_subwords= 38
2020-06-09 23:24:12,646: Using module at data.batch_samplers.BatchSampler
2020-06-09 23:24:12,646: Building test_sampler from config
2020-06-09 23:24:12,646:  >> # examples= 11024
2020-06-09 23:24:12,646:  >> batch_size= 256
2020-06-09 23:24:12,646:  >> shuffle= False
2020-06-09 23:24:12,648:  >> BatchSampler; 44 batches
2020-06-09 23:24:12,648: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-09 23:24:12,693: Building loss from config
2020-06-09 23:24:12,693:  >> margin= 0.4
2020-06-09 23:24:12,693:  >> k= 16
2020-06-09 23:24:12,693:  >> min_k= 8
2020-06-09 23:24:12,694:  >> extra= 0
2020-06-09 23:24:12,694:  >> average= False
2020-06-09 23:24:12,694:  >> margin_max= 0.5
2020-06-09 23:24:12,694:  >> threshold_max= 9
2020-06-09 23:24:12,694:  >> using obj0
2020-06-09 23:24:12,694: Using module at metric.multiview_ap.MultiViewAP
2020-06-09 23:24:12,743: Building eval from config
2020-06-09 23:24:12,744:  >> acoustic_ap= True
2020-06-09 23:24:12,744:  >> crossview_ap= True
2020-06-09 23:24:12,744:  >> full_vocab= False
2020-06-09 23:24:12,744:  >> metric= crossview_ap
2020-06-09 23:24:12,744:  >> mode= max
2020-06-09 23:24:12,745: Using module at multiview_rnn.MultiViewRNN
2020-06-09 23:24:12,758: Building net from config
2020-06-09 23:24:12,760: view1:
2020-06-09 23:24:12,761:  >> cell= GRU
2020-06-09 23:24:12,761:  >> input_size= 108
2020-06-09 23:24:12,761:  >> hidden_size= 512
2020-06-09 23:24:12,761:  >> bidirectional= True
2020-06-09 23:24:12,761:  >> num_layers= 6
2020-06-09 23:24:12,761:  >> dropout between layers= 0.4
2020-06-09 23:24:13,019: view2:
2020-06-09 23:24:13,020:  >> cell= GRU
2020-06-09 23:24:13,020:  >> input_size= 64
2020-06-09 23:24:13,020:  >> hidden_size= 512
2020-06-09 23:24:13,020:  >> bidirectional= True
2020-06-09 23:24:13,020:  >> num_layers= 2
2020-06-09 23:24:13,020:  >> dropout between layers= 0.4
2020-06-09 23:24:13,020:  >> num input embeddings= 38
2020-06-09 23:24:16,355: Using module at optim.adam.Adam
2020-06-09 23:24:16,360: Building optim from config
2020-06-09 23:24:16,360:  >> lr= 0.001
2020-06-09 23:24:16,360:  >> betas= (0.9, 0.999)
2020-06-09 23:24:16,360:  >> eps= 1e-08
2020-06-09 23:24:16,360:  >> weight_decay= 0
2020-06-09 23:24:16,360:  >> amsgrad= False
2020-06-09 23:24:16,360:  >> min_lr= 1e-07
2020-06-09 23:24:16,361: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-09 23:24:16,389: Building sched from config
2020-06-09 23:24:16,390:  >> optim= Adam
2020-06-09 23:24:16,390:  >> decay lr by 0.1
2020-06-09 23:24:16,390:  >> eval_fn= MultiViewAP
2020-06-09 23:24:16,390:  >> patience=4
2020-06-09 23:24:16,390:  >> revert=True
2020-06-09 23:24:16,438: loaded save/MultiViewDataset_IndividualWords.1443.pth
2020-06-09 23:24:16,438: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 23:24:17,612: loaded save/MultiViewRNN.1443.pth
2020-06-09 23:24:17,612: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 23:24:19,880: loaded save/Adam.1443.pth
2020-06-09 23:24:19,880: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 23:24:19,904: loaded save/ReduceLROnPlateau.1443.pth
2020-06-09 23:24:19,905: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-09 23:24:19,905: epoch=37.00 global_step=1443 lr=0.0001 start_iter=0
2020-06-09 23:24:19,905: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 23:26:17,157: 0) loss=0.431 grad_norm=3.33 num_segments=256 num_words=212
2020-06-09 23:28:04,847: 1) loss=0.278 grad_norm=4.29 num_segments=256 num_words=217
2020-06-09 23:29:45,330: 2) loss=0.296 grad_norm=3.10 num_segments=256 num_words=205
                                                                                     2020-06-09 23:31:17,733: 3) loss=0.213 grad_norm=3.25 num_segments=256 num_words=208
                                                                                     2020-06-09 23:32:43,092: 4) loss=0.305 grad_norm=3.95 num_segments=256 num_words=211
                                                                                     2020-06-09 23:34:01,198: 5) loss=0.188 grad_norm=3.18 num_segments=256 num_words=209
                                                                                     2020-06-09 23:35:10,060: 6) loss=0.279 grad_norm=4.81 num_segments=256 num_words=207
2020-06-09 23:36:12,162: 7) loss=0.225 grad_norm=3.65 num_segments=256 num_words=214
2020-06-09 23:37:15,382: 8) loss=0.358 grad_norm=5.90 num_segments=256 num_words=209
2020-06-09 23:38:16,542: 9) loss=0.541 grad_norm=5.13 num_segments=256 num_words=216
                                                                                       2020-06-09 23:39:20,774: 10) loss=0.632 grad_norm=6.29 num_segments=256 num_words=212
                                                                                      2020-06-09 23:40:22,209: 11) loss=0.259 grad_norm=3.66 num_segments=256 num_words=221
                                                                                      2020-06-09 23:41:23,308: 12) loss=0.317 grad_norm=4.39 num_segments=256 num_words=210
                                                                                      2020-06-09 23:42:26,716: 13) loss=0.210 grad_norm=3.75 num_segments=256 num_words=215
                                                                                      2020-06-09 23:43:34,121: 14) loss=0.352 grad_norm=6.19 num_segments=256 num_words=205
                                                                                      2020-06-09 23:44:41,746: 15) loss=0.219 grad_norm=3.21 num_segments=256 num_words=214
2020-06-09 23:45:49,431: 16) loss=0.243 grad_norm=3.77 num_segments=256 num_words=209
2020-06-09 23:46:57,303: 17) loss=0.284 grad_norm=3.94 num_segments=256 num_words=205
                                                                                      2020-06-09 23:48:02,785: 18) loss=0.309 grad_norm=4.49 num_segments=256 num_words=219
                                                                                      2020-06-09 23:49:11,235: 19) loss=0.236 grad_norm=4.53 num_segments=256 num_words=203
                                                                                      2020-06-09 23:50:14,971: 20) loss=0.213 grad_norm=3.42 num_segments=256 num_words=208
2020-06-09 23:51:19,017: 21) loss=0.389 grad_norm=4.60 num_segments=256 num_words=197
2020-06-09 23:52:22,612: 22) loss=0.573 grad_norm=5.37 num_segments=256 num_words=210
2020-06-09 23:53:26,378: 23) loss=0.232 grad_norm=3.67 num_segments=256 num_words=214
                                                                                      2020-06-09 23:54:35,677: 24) loss=0.306 grad_norm=4.12 num_segments=256 num_words=209
                                                                                      2020-06-09 23:55:39,564: 25) loss=0.209 grad_norm=3.90 num_segments=256 num_words=208
                                                                                      2020-06-09 23:56:43,492: 26) loss=0.409 grad_norm=4.48 num_segments=256 num_words=210
                                                                                      2020-06-09 23:57:47,139: 27) loss=0.278 grad_norm=4.43 num_segments=256 num_words=219
                                                                                      2020-06-09 23:58:51,071: 28) loss=0.257 grad_norm=3.78 num_segments=256 num_words=203
2020-06-09 23:59:54,322: 29) loss=0.408 grad_norm=4.34 num_segments=256 num_words=205
2020-06-10 00:00:58,844: 30) loss=0.331 grad_norm=4.11 num_segments=256 num_words=206
                                                                                      2020-06-10 00:02:11,763: 31) loss=0.206 grad_norm=3.25 num_segments=256 num_words=210
                                                                                      2020-06-10 00:03:16,160: 32) loss=0.349 grad_norm=4.67 num_segments=256 num_words=211
                                                                                      2020-06-10 00:04:20,112: 33) loss=0.235 grad_norm=3.81 num_segments=256 num_words=211
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         2020-06-10 00:05:23,515: 34) loss=0.235 grad_norm=4.09 num_segments=256 num_words=208
                                                                      2020-06-10 00:06:26,548: 35) loss=0.397 grad_norm=4.65 num_segments=256 num_words=210
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  2020-06-10 00:07:29,748: 36) loss=0.271 grad_norm=4.70 num_segments=256 num_words=209
                                                                                     2020-06-10 00:08:31,326: 37) loss=0.260 grad_norm=3.74 num_segments=256 num_words=205
                                                                                     2020-06-10 00:09:28,912: 38) loss=0.413 grad_norm=4.10 num_segments=243 num_words=203
2020-06-10 00:09:28,924: epoch= 38.00
2020-06-10 00:09:28,924:  >> time to evaluate and save:
2020-06-10 00:09:28,929: saved MultiViewDataset_IndividualWords successfully
2020-06-10 00:09:29,573: saved MultiViewRNN successfully
2020-06-10 00:09:29,814: saved Adam successfully
2020-06-10 00:09:29,844: saved ReduceLROnPlateau successfully
2020-06-10 00:09:29,845: saved config successfully
                                                                                     2020-06-10 00:11:01,449:   >> crossview_ap=0.614 (10966 x 3921 pairs)
                                                                                     2020-06-10 00:12:00,241:   >> acoustic_ap=0.740 (10966 choose 2 pairs)
2020-06-10 00:12:00,244: best_so_far= 0.614 at 1326
2020-06-10 00:12:00,282: epoch=38.00 global_step=1482 lr=0.0001 start_iter=0
2020-06-10 00:12:00,282: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
                                                                                     2020-06-10 00:13:05,768: 0) loss=0.271 grad_norm=4.35 num_segments=256 num_words=214
                                                                                     2020-06-10 00:14:20,318: 1) loss=0.371 grad_norm=4.20 num_segments=256 num_words=205
                                                                                     2020-06-10 00:15:23,495: 2) loss=0.465 grad_norm=5.05 num_segments=256 num_words=203
                                                                                     2020-06-10 00:16:27,523: 3) loss=0.428 grad_norm=4.51 num_segments=256 num_words=219
                                                                                     2020-06-10 00:17:31,441: 4) loss=0.213 grad_norm=3.59 num_segments=256 num_words=208
                                                                                      2020-06-10 00:18:35,904: 5) loss=0.310 grad_norm=3.23 num_segments=256 num_words=208
                                                                                      2020-06-10 00:19:38,845: 6) loss=0.217 grad_norm=3.23 num_segments=256 num_words=212
                                                                                      2020-06-10 00:20:42,015: 7) loss=0.255 grad_norm=3.93 num_segments=256 num_words=211
                                                                                      2020-06-10 00:21:45,783: 8) loss=0.273 grad_norm=4.41 num_segments=256 num_words=202
                                                                                      2020-06-10 00:22:49,761: 9) loss=0.690 grad_norm=6.73 num_segments=256 num_words=206
                                                                                       2020-06-10 00:23:54,375: 10) loss=0.254 grad_norm=4.95 num_segments=256 num_words=209
                                                                                      2020-06-10 00:24:58,514: 11) loss=0.407 grad_norm=4.51 num_segments=256 num_words=212
                                                                                      2020-06-10 00:26:14,398: 12) loss=0.295 grad_norm=3.89 num_segments=256 num_words=216
                                                                                      2020-06-10 00:27:18,826: 13) loss=0.296 grad_norm=3.60 num_segments=256 num_words=212
                                                                                      2020-06-10 00:28:22,735: 14) loss=0.308 grad_norm=4.03 num_segments=256 num_words=215
                                                                                                                                                                            2020-06-10 00:29:27,317: 15) loss=0.335 grad_norm=5.45 num_segments=256 num_words=215
                                                                                      2020-06-10 00:30:31,647: 16) loss=0.205 grad_norm=3.23 num_segments=256 num_words=216
                                                                                      2020-06-10 00:31:35,712: 17) loss=0.270 grad_norm=3.53 num_segments=256 num_words=215
                                                                                      2020-06-10 00:32:37,605: 18) loss=0.321 grad_norm=4.18 num_segments=256 num_words=206
                                                                                      2020-06-10 00:33:40,657: 19) loss=0.216 grad_norm=3.60 num_segments=256 num_words=213
                                                                                      2020-06-10 00:34:44,735: 20) loss=0.299 grad_norm=3.92 num_segments=256 num_words=201
                                                                                      2020-06-10 00:35:48,088: 21) loss=0.291 grad_norm=5.06 num_segments=256 num_words=217
                                                                                      2020-06-10 00:36:51,881: 22) loss=0.455 grad_norm=4.70 num_segments=256 num_words=209
2020-06-10 00:37:10,219: 30) loss=0.395 grad_norm=4.72 num_segments=256 num_words=219
                                                                                      2020-06-10 00:38:06,882: 31) loss=0.333 grad_norm=4.78 num_segments=256 num_words=214
2020-06-10 00:39:04,887: 32) loss=0.235 grad_norm=3.45 num_segments=256 num_words=216
2020-06-10 00:40:01,284: 33) loss=0.301 grad_norm=3.52 num_segments=256 num_words=216
2020-06-10 00:40:57,822: 34) loss=0.219 grad_norm=3.67 num_segments=256 num_words=211
                                                                                      2020-06-10 00:41:54,377: 35) loss=0.368 grad_norm=4.96 num_segments=256 num_words=205
                                                                                      2020-06-10 00:42:50,637: 36) loss=0.328 grad_norm=4.47 num_segments=256 num_words=206
                                                                                      2020-06-10 00:43:46,780: 37) loss=0.433 grad_norm=4.90 num_segments=256 num_words=214
2020-06-10 00:44:37,394: 38) loss=0.403 grad_norm=4.17 num_segments=243 num_words=201
2020-06-10 00:44:37,403: epoch= 39.00
2020-06-10 00:44:37,403:  >> time to evaluate and save:
2020-06-10 00:44:37,469: saved save/MultiViewDataset_IndividualWords.1521.pth
2020-06-10 00:44:37,471: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 00:44:37,483: removed save/MultiViewDataset_IndividualWords.1287.pth
2020-06-10 00:44:37,483: saved MultiViewDataset_IndividualWords successfully
2020-06-10 00:44:38,793: saved save/MultiViewRNN.1521.pth
2020-06-10 00:44:38,795: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 00:44:38,859: removed save/MultiViewRNN.1287.pth
2020-06-10 00:44:38,859: saved MultiViewRNN successfully
2020-06-10 00:44:41,398: saved save/Adam.1521.pth
2020-06-10 00:44:41,400: most_recent linked save/Adam.most_recent.pth
2020-06-10 00:44:41,470: removed save/Adam.1287.pth
2020-06-10 00:44:41,470: saved Adam successfully
2020-06-10 00:44:41,472: saved save/ReduceLROnPlateau.1521.pth
2020-06-10 00:44:41,474: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 00:44:41,478: saved ReduceLROnPlateau successfully
2020-06-10 00:44:41,480: saved config successfully
                                                                                      2020-06-10 00:46:01,145:   >> crossview_ap=0.614 (10966 x 3921 pairs)
                                                                                      2020-06-10 00:46:53,901:   >> acoustic_ap=0.740 (10966 choose 2 pairs)
2020-06-10 00:46:53,906: best_so_far= 0.614 at 1482
2020-06-10 00:46:54,408: epoch=39.00 global_step=1521 lr=0.0001 start_iter=0
2020-06-10 00:46:54,408: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 00:47:52,673: 0) loss=0.279 grad_norm=3.74 num_segments=256 num_words=211
 2020-06-10 00:48:48,896: 1) loss=0.256 grad_norm=3.84 num_segments=256 num_words=207
                                                                                      2020-06-10 00:49:45,298: 2) loss=0.485 grad_norm=4.27 num_segments=256 num_words=209
                                                                                      2020-06-10 00:50:41,887: 3) loss=0.292 grad_norm=3.48 num_segments=256 num_words=213
                                                                                      2020-06-10 00:51:39,894: 4) loss=0.364 grad_norm=4.77 num_segments=256 num_words=218
                                                                                      2020-06-10 00:52:55,230: 5) loss=0.606 grad_norm=5.33 num_segments=256 num_words=213
                                                                                      2020-06-10 00:53:51,589: 6) loss=0.312 grad_norm=4.09 num_segments=256 num_words=217
2020-06-10 00:54:09,628: 38) loss=0.401 grad_norm=4.32 num_segments=243 num_words=201
2020-06-10 00:54:09,645: epoch= 39.00
2020-06-10 00:54:09,645:  >> time to evaluate and save:
2020-06-10 00:54:09,652: saved MultiViewDataset_IndividualWords successfully
2020-06-10 00:54:09,676: saved MultiViewRNN successfully
2020-06-10 00:54:09,698: saved Adam successfully
2020-06-10 00:54:09,702: saved ReduceLROnPlateau successfully
2020-06-10 00:54:09,703: saved config successfully
                                                                                     2020-06-10 00:55:39,912:   >> crossview_ap=0.613 (10966 x 3921 pairs)
               2020-06-10 00:56:38,816:   >> acoustic_ap=0.741 (10966 choose 2 pairs)
2020-06-10 00:56:38,821: best_so_far= 0.614 at 1326
2020-06-10 00:56:38,821: Reverting to previous best
2020-06-10 00:56:40,038: loaded save/MultiViewRNN.1482.pth
2020-06-10 00:56:40,038: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-10 00:56:42,294: loaded save/Adam.1482.pth
2020-06-10 00:56:42,295: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-10 00:56:42,295: Reducing group lr from 0.0001 to 1e-05
2020-06-10 00:56:42,378: best linked save/Adam.best.pth
2020-06-10 00:56:43,189: epoch=39.00 global_step=1521 lr=1e-05 start_iter=0
2020-06-10 00:56:43,189: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 00:57:45,751: 0) loss=0.280 grad_norm=3.70 num_segments=256 num_words=211
                                                                                       2020-06-10 00:58:49,248: 1) loss=0.342 grad_norm=4.70 num_segments=256 num_words=207
                                                                                      2020-06-10 00:59:52,872: 2) loss=0.485 grad_norm=4.42 num_segments=256 num_words=209
                                                                                      2020-06-10 01:00:56,560: 3) loss=0.293 grad_norm=3.79 num_segments=256 num_words=213
                                                                                      2020-06-10 01:02:03,113: 4) loss=0.365 grad_norm=5.62 num_segments=256 num_words=218
                                                                                      2020-06-10 01:03:30,666: 5) loss=0.608 grad_norm=6.71 num_segments=256 num_words=213
 2020-06-10 01:04:35,151: 6) loss=0.309 grad_norm=3.49 num_segments=256 num_words=217
                                                                                       2020-06-10 01:05:39,810: 7) loss=0.312 grad_norm=3.84 num_segments=256 num_words=211
                                                                                      2020-06-10 01:06:43,975: 8) loss=0.279 grad_norm=4.14 num_segments=256 num_words=209
                                                                                      2020-06-10 01:07:48,862: 9) loss=0.391 grad_norm=5.21 num_segments=256 num_words=206
                                                                                      2020-06-10 01:08:52,760: 10) loss=0.300 grad_norm=3.24 num_segments=256 num_words=219
                                                                                      2020-06-10 01:09:57,235: 11) loss=0.420 grad_norm=4.29 num_segments=256 num_words=211
2020-06-10 01:11:01,183: 12) loss=0.266 grad_norm=3.71 num_segments=256 num_words=207
2020-06-10 01:12:04,799: 13) loss=0.414 grad_norm=4.65 num_segments=256 num_words=215
2020-06-10 01:13:09,733: 14) loss=0.235 grad_norm=4.45 num_segments=256 num_words=216
2020-06-10 01:14:13,551: 15) loss=0.232 grad_norm=4.78 num_segments=256 num_words=213
                                                                                      2020-06-10 01:15:18,419: 16) loss=0.203 grad_norm=4.14 num_segments=256 num_words=203
                                                                                      2020-06-10 01:16:23,511: 17) loss=0.399 grad_norm=6.01 num_segments=256 num_words=214
                                                                                      2020-06-10 01:17:28,644: 18) loss=0.333 grad_norm=4.39 num_segments=256 num_words=202
                                                                                      2020-06-10 01:18:33,917: 19) loss=0.317 grad_norm=3.95 num_segments=256 num_words=209
2020-06-10 01:18:52,498: 32) loss=0.323 grad_norm=4.83 num_segments=256 num_words=210
                                                                                      2020-06-10 01:19:49,996: 33) loss=0.207 grad_norm=3.45 num_segments=256 num_words=219
2020-06-10 01:20:46,532: 34) loss=0.212 grad_norm=3.16 num_segments=256 num_words=207
2020-06-10 01:21:43,877: 35) loss=0.408 grad_norm=5.18 num_segments=256 num_words=207
                                                                                      2020-06-10 01:22:40,238: 36) loss=0.198 grad_norm=3.22 num_segments=256 num_words=206
                                                                                      2020-06-10 01:23:36,541: 37) loss=0.213 grad_norm=4.06 num_segments=256 num_words=212
                                                                                      2020-06-10 01:24:27,408: 38) loss=0.196 grad_norm=3.21 num_segments=243 num_words=200
2020-06-10 01:24:27,418: epoch= 40.00
2020-06-10 01:24:27,418:  >> time to evaluate and save:
2020-06-10 01:24:27,461: saved save/MultiViewDataset_IndividualWords.1560.pth
2020-06-10 01:24:27,474: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 01:24:27,504: removed save/MultiViewDataset_IndividualWords.1326.pth
2020-06-10 01:24:27,504: saved MultiViewDataset_IndividualWords successfully
2020-06-10 01:24:29,351: saved save/MultiViewRNN.1560.pth
2020-06-10 01:24:29,365: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 01:24:29,460: removed save/MultiViewRNN.1326.pth
2020-06-10 01:24:29,460: saved MultiViewRNN successfully
2020-06-10 01:24:32,196: saved save/Adam.1560.pth
2020-06-10 01:24:32,214: most_recent linked save/Adam.most_recent.pth
2020-06-10 01:24:32,335: removed save/Adam.1326.pth
2020-06-10 01:24:32,336: saved Adam successfully
2020-06-10 01:24:32,339: saved save/ReduceLROnPlateau.1560.pth
2020-06-10 01:24:32,351: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 01:24:32,447: removed save/ReduceLROnPlateau.1287.pth
2020-06-10 01:24:32,448: saved ReduceLROnPlateau successfully
2020-06-10 01:24:32,451: saved config successfully
                                                                                      2020-06-10 01:25:52,301:   >> crossview_ap=0.614 (10966 x 3921 pairs)
                2020-06-10 01:26:41,447:   >> acoustic_ap=0.742 (10966 choose 2 pairs)
2020-06-10 01:26:41,452: best_so_far= 0.614 at 1482
2020-06-10 01:26:41,962: epoch=40.00 global_step=1560 lr=0.0001 start_iter=0
2020-06-10 01:26:41,962: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
                                                                                      2020-06-10 01:27:40,304: 0) loss=0.212 grad_norm=3.17 num_segments=256 num_words=215
                                                                                      2020-06-10 01:28:38,672: 1) loss=0.270 grad_norm=4.64 num_segments=256 num_words=217
2020-06-10 01:29:36,102: 2) loss=0.422 grad_norm=4.27 num_segments=256 num_words=213
 2020-06-10 01:30:33,679: 3) loss=0.399 grad_norm=5.21 num_segments=256 num_words=209
 2020-06-10 01:31:32,619: 4) loss=0.474 grad_norm=5.36 num_segments=256 num_words=196
 2020-06-10 01:32:33,951: 5) loss=0.383 grad_norm=4.11 num_segments=256 num_words=212
 2020-06-10 01:33:31,319: 6) loss=0.238 grad_norm=3.79 num_segments=256 num_words=204
 2020-06-10 01:34:29,318: 7) loss=0.254 grad_norm=3.63 num_segments=256 num_words=208
                                                                                      2020-06-10 01:35:27,208: 8) loss=0.280 grad_norm=4.48 num_segments=256 num_words=211
                                                                                      2020-06-10 01:36:32,232: 9) loss=0.204 grad_norm=4.27 num_segments=256 num_words=210
                                                                                      2020-06-10 01:37:37,074: 10) loss=0.283 grad_norm=3.73 num_segments=256 num_words=207
                                                                                      2020-06-10 01:38:51,490: 11) loss=0.427 grad_norm=6.61 num_segments=256 num_words=204
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            2020-06-10 01:39:56,454: 12) loss=0.236 grad_norm=3.95 num_segments=256 num_words=207
2020-06-10 01:41:00,268: 13) loss=0.422 grad_norm=4.72 num_segments=256 num_words=220
                                                                      2020-06-10 01:42:39,906: 14) loss=0.342 grad_norm=5.14 num_segments=256 num_words=210
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  2020-06-10 01:43:39,307: 15) loss=0.338 grad_norm=4.88 num_segments=256 num_words=209
                                                                                     2020-06-10 01:44:42,022: 16) loss=0.336 grad_norm=4.50 num_segments=256 num_words=209
2020-06-10 01:45:45,805: 17) loss=0.425 grad_norm=5.26 num_segments=256 num_words=207
2020-06-10 01:46:54,559: 18) loss=0.232 grad_norm=3.81 num_segments=256 num_words=214
                                                                                     2020-06-10 01:48:08,528: 19) loss=0.440 grad_norm=5.49 num_segments=256 num_words=207
2020-06-10 01:49:14,835: 20) loss=0.240 grad_norm=3.57 num_segments=256 num_words=211
2020-06-10 01:50:21,223: 21) loss=0.207 grad_norm=3.79 num_segments=256 num_words=217
2020-06-10 01:51:26,743: 22) loss=0.403 grad_norm=4.75 num_segments=256 num_words=210
2020-06-10 01:52:30,536: 23) loss=0.318 grad_norm=4.24 num_segments=256 num_words=207
2020-06-10 01:53:34,847: 24) loss=0.300 grad_norm=4.07 num_segments=256 num_words=198
                                                                                     2020-06-10 01:54:38,921: 25) loss=0.269 grad_norm=4.02 num_segments=256 num_words=209
                                                                                     2020-06-10 01:55:43,552: 26) loss=0.191 grad_norm=3.86 num_segments=256 num_words=212
2020-06-10 01:56:50,846: 27) loss=0.226 grad_norm=3.70 num_segments=256 num_words=206
2020-06-10 01:57:57,541: 28) loss=0.236 grad_norm=4.17 num_segments=256 num_words=198
2020-06-10 01:59:03,666: 29) loss=0.284 grad_norm=3.40 num_segments=256 num_words=201
2020-06-10 02:00:09,324: 30) loss=0.396 grad_norm=5.08 num_segments=256 num_words=215
2020-06-10 02:01:13,779: 31) loss=0.401 grad_norm=4.58 num_segments=256 num_words=215
2020-06-10 02:02:20,213: 32) loss=0.236 grad_norm=3.40 num_segments=256 num_words=204
2020-06-10 02:03:26,778: 33) loss=0.216 grad_norm=3.64 num_segments=256 num_words=212
                                                                                      2020-06-10 02:04:33,823: 34) loss=0.321 grad_norm=3.75 num_segments=256 num_words=210
2020-06-10 02:05:40,982: 35) loss=0.242 grad_norm=3.45 num_segments=256 num_words=205
2020-06-10 02:06:47,654: 36) loss=0.204 grad_norm=3.79 num_segments=256 num_words=214
2020-06-10 02:07:55,411: 37) loss=0.210 grad_norm=3.76 num_segments=256 num_words=209
2020-06-10 02:08:10,593: 20) loss=0.238 grad_norm=3.57 num_segments=256 num_words=211
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               2020-06-10 02:09:19,363: 21) loss=0.203 grad_norm=3.12 num_segments=256 num_words=217
2020-06-10 02:10:28,272: 22) loss=0.401 grad_norm=4.87 num_segments=256 num_words=210
                                                                      2020-06-10 02:11:36,703: 23) loss=0.314 grad_norm=4.13 num_segments=256 num_words=207
                                                                                                                                                                                                      2020-06-10 02:12:45,159: 24) loss=0.301 grad_norm=4.00 num_segments=256 num_words=198
                                                                                     2020-06-10 02:13:53,167: 25) loss=0.240 grad_norm=3.99 num_segments=256 num_words=209
                                                                                     2020-06-10 02:15:00,467: 26) loss=0.186 grad_norm=3.44 num_segments=256 num_words=212
                                                                                     2020-06-10 02:16:08,170: 27) loss=0.227 grad_norm=3.73 num_segments=256 num_words=206
                                                                                     2020-06-10 02:17:15,538: 28) loss=0.231 grad_norm=3.48 num_segments=256 num_words=198
                                                                                     2020-06-10 02:18:22,444: 29) loss=0.284 grad_norm=3.16 num_segments=256 num_words=201
                                                                                     2020-06-10 02:19:29,988: 30) loss=0.388 grad_norm=4.75 num_segments=256 num_words=215
2020-06-10 02:20:37,571: 31) loss=0.397 grad_norm=4.79 num_segments=256 num_words=215
                                                                                     2020-06-10 02:21:45,232: 32) loss=0.237 grad_norm=3.52 num_segments=256 num_words=204
                                                                                     2020-06-10 02:22:52,825: 33) loss=0.216 grad_norm=3.06 num_segments=256 num_words=212
2020-06-10 02:24:00,594: 34) loss=0.327 grad_norm=3.81 num_segments=256 num_words=210
2020-06-10 02:25:08,325: 35) loss=0.243 grad_norm=3.50 num_segments=256 num_words=205
2020-06-10 02:26:15,630: 36) loss=0.207 grad_norm=3.43 num_segments=256 num_words=214
                                                                                      2020-06-10 02:27:23,636: 37) loss=0.210 grad_norm=3.38 num_segments=256 num_words=209
2020-06-10 02:28:21,555: 13) loss=0.287 grad_norm=3.75 num_segments=256 num_words=202
2020-06-10 02:28:24,286: epoch= 41.00
2020-06-10 02:28:24,286:  >> time to evaluate and save:
2020-06-10 02:28:24,304: saved MultiViewDataset_IndividualWords successfully
2020-06-10 02:28:24,389: saved MultiViewRNN successfully
2020-06-10 02:28:24,449: saved Adam successfully
2020-06-10 02:28:24,475: saved ReduceLROnPlateau successfully
2020-06-10 02:28:24,477: saved config successfully
                                                                                      2020-06-10 02:30:02,130:   >> crossview_ap=0.615 (10966 x 3921 pairs)
                                                                                      2020-06-10 02:31:06,919:   >> acoustic_ap=0.741 (10966 choose 2 pairs)
2020-06-10 02:31:06,924: best_so_far= 0.615 at 1599
2020-06-10 02:31:06,965: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 02:31:06,969: saved MultiViewDataset_IndividualWords successfully
2020-06-10 02:31:06,974: best linked save/MultiViewRNN.best.pth
2020-06-10 02:31:06,984: saved MultiViewRNN successfully
2020-06-10 02:31:06,995: best linked save/Adam.best.pth
2020-06-10 02:31:07,005: saved Adam successfully
2020-06-10 02:31:07,014: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 02:31:07,021: saved ReduceLROnPlateau successfully
2020-06-10 02:31:08,434: epoch=41.00 global_step=1599 lr=1e-05 start_iter=0
2020-06-10 02:31:08,435: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
                                                                                      2020-06-10 02:32:18,219: 0) loss=0.266 grad_norm=4.06 num_segments=256 num_words=218
2020-06-10 02:33:25,857: 1) loss=0.449 grad_norm=5.73 num_segments=256 num_words=215
                                                                                       2020-06-10 02:34:33,078: 2) loss=0.401 grad_norm=4.66 num_segments=256 num_words=207
                                                                                      2020-06-10 02:35:40,294: 3) loss=0.303 grad_norm=4.56 num_segments=256 num_words=213
                                                                                      2020-06-10 02:36:47,328: 4) loss=0.288 grad_norm=4.40 num_segments=256 num_words=215
2020-06-10 02:37:54,876: 5) loss=0.235 grad_norm=4.39 num_segments=256 num_words=210
 2020-06-10 02:39:02,091: 6) loss=0.228 grad_norm=3.34 num_segments=256 num_words=206
                                                                                       2020-06-10 02:40:09,252: 7) loss=0.315 grad_norm=4.44 num_segments=256 num_words=214
                                                                                      2020-06-10 02:41:16,709: 8) loss=0.392 grad_norm=3.51 num_segments=256 num_words=211
                                                                                      2020-06-10 02:43:11,800: 9) loss=0.217 grad_norm=2.86 num_segments=256 num_words=201
 2020-06-10 02:44:19,505: 10) loss=0.288 grad_norm=4.10 num_segments=256 num_words=214
                                                                                      2020-06-10 02:45:33,459: 11) loss=0.218 grad_norm=3.48 num_segments=256 num_words=213
2020-06-10 02:46:42,185: 12) loss=0.305 grad_norm=4.70 num_segments=256 num_words=217
2020-06-10 02:47:50,453: 13) loss=0.359 grad_norm=5.03 num_segments=256 num_words=202
2020-06-10 02:48:58,604: 14) loss=0.239 grad_norm=4.42 num_segments=256 num_words=213
2020-06-10 02:50:07,361: 15) loss=0.214 grad_norm=3.55 num_segments=256 num_words=198
2020-06-10 02:51:16,905: 16) loss=0.215 grad_norm=2.94 num_segments=256 num_words=205
2020-06-10 02:52:25,817: 17) loss=0.223 grad_norm=4.07 num_segments=256 num_words=201
2020-06-10 02:53:35,110: 18) loss=0.308 grad_norm=4.53 num_segments=256 num_words=212
2020-06-10 02:54:44,300: 19) loss=0.268 grad_norm=3.51 num_segments=256 num_words=220
2020-06-10 02:55:53,027: 20) loss=0.241 grad_norm=3.69 num_segments=256 num_words=210
2020-06-10 02:56:52,198: 38) loss=0.287 grad_norm=3.49 num_segments=243 num_words=205
2020-06-10 02:56:52,210: epoch= 42.00
2020-06-10 02:56:52,211:  >> time to evaluate and save:
2020-06-10 02:56:52,263: saved save/MultiViewDataset_IndividualWords.1638.pth
2020-06-10 02:56:52,287: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 02:56:52,569: removed save/MultiViewDataset_IndividualWords.1404.pth
2020-06-10 02:56:52,569: saved MultiViewDataset_IndividualWords successfully
2020-06-10 02:56:54,048: saved save/MultiViewRNN.1638.pth
2020-06-10 02:56:54,055: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 02:56:54,161: removed save/MultiViewRNN.1404.pth
2020-06-10 02:56:54,161: saved MultiViewRNN successfully
2020-06-10 02:56:56,776: saved save/Adam.1638.pth
2020-06-10 02:56:56,792: most_recent linked save/Adam.most_recent.pth
2020-06-10 02:56:56,908: removed save/Adam.1404.pth
2020-06-10 02:56:56,909: saved Adam successfully
2020-06-10 02:56:56,911: saved save/ReduceLROnPlateau.1638.pth
2020-06-10 02:56:56,931: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 02:56:56,948: removed save/ReduceLROnPlateau.1404.pth
2020-06-10 02:56:56,948: saved ReduceLROnPlateau successfully
2020-06-10 02:56:56,950: saved config successfully
                                                                                      2020-06-10 02:58:52,364:   >> crossview_ap=0.615 (10966 x 3921 pairs)
                2020-06-10 03:00:23,921:   >> acoustic_ap=0.739 (10966 choose 2 pairs)
2020-06-10 03:00:23,936: best_so_far= 0.615 at 1638
2020-06-10 03:00:23,999: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 03:00:24,002: saved MultiViewDataset_IndividualWords successfully
2020-06-10 03:00:24,034: best linked save/MultiViewRNN.best.pth
2020-06-10 03:00:24,046: saved MultiViewRNN successfully
2020-06-10 03:00:24,064: best linked save/Adam.best.pth
2020-06-10 03:00:24,073: saved Adam successfully
2020-06-10 03:00:24,084: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 03:00:24,089: saved ReduceLROnPlateau successfully
2020-06-10 03:00:25,459: epoch=42.00 global_step=1638 lr=0.0001 start_iter=0
2020-06-10 03:00:25,459: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
                                                                                      2020-06-10 03:01:48,233: 0) loss=0.405 grad_norm=4.78 num_segments=256 num_words=218
                                                                                      2020-06-10 03:03:00,900: 1) loss=0.322 grad_norm=4.57 num_segments=256 num_words=210
                                                                                      2020-06-10 03:04:10,634: 2) loss=0.327 grad_norm=4.01 num_segments=256 num_words=219
                                                                                      2020-06-10 03:05:19,117: 3) loss=0.247 grad_norm=3.48 num_segments=256 num_words=211
                                                                                      2020-06-10 03:06:28,538: 4) loss=0.276 grad_norm=3.38 num_segments=256 num_words=207
                                                                                      2020-06-10 03:07:37,725: 5) loss=0.301 grad_norm=4.42 num_segments=256 num_words=202
                                                                                      2020-06-10 03:08:47,166: 6) loss=0.352 grad_norm=3.83 num_segments=256 num_words=210
                                                                                      2020-06-10 03:09:56,488: 7) loss=0.227 grad_norm=3.78 num_segments=256 num_words=215
                                                                                      2020-06-10 03:11:05,480: 8) loss=0.256 grad_norm=4.91 num_segments=256 num_words=208
                                                                                      2020-06-10 03:12:14,484: 9) loss=0.349 grad_norm=3.87 num_segments=256 num_words=204
                                                                                      2020-06-10 03:13:22,567: 10) loss=0.259 grad_norm=4.13 num_segments=256 num_words=221
                                                                                      2020-06-10 03:14:30,983: 11) loss=0.312 grad_norm=4.50 num_segments=256 num_words=211
2020-06-10 03:15:20,089: 37) loss=0.317 grad_norm=4.27 num_segments=256 num_words=208
2020-06-10 03:16:22,395: 38) loss=0.289 grad_norm=3.59 num_segments=243 num_words=205
2020-06-10 03:16:22,406: epoch= 42.00
2020-06-10 03:16:22,406:  >> time to evaluate and save:
2020-06-10 03:16:22,420: saved MultiViewDataset_IndividualWords successfully
2020-06-10 03:16:22,499: saved MultiViewRNN successfully
2020-06-10 03:16:22,543: saved Adam successfully
2020-06-10 03:16:22,566: saved ReduceLROnPlateau successfully
2020-06-10 03:16:22,567: saved config successfully
                                                                                      2020-06-10 03:18:18,913:   >> crossview_ap=0.614 (10966 x 3921 pairs)
                                                                                                      2020-06-10 03:19:31,648:   >> acoustic_ap=0.741 (10966 choose 2 pairs)
2020-06-10 03:19:31,653: best_so_far= 0.615 at 1599
2020-06-10 03:19:33,160: epoch=42.00 global_step=1638 lr=1e-05 start_iter=0
2020-06-10 03:19:33,160: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
                                                                                      2020-06-10 03:20:47,180: 0) loss=0.408 grad_norm=5.10 num_segments=256 num_words=218
2020-06-10 03:21:56,145: 1) loss=0.336 grad_norm=4.77 num_segments=256 num_words=210
                                                                                       2020-06-10 03:23:04,858: 2) loss=0.328 grad_norm=3.52 num_segments=256 num_words=219
2020-06-10 03:23:48,434: 18) loss=0.206 grad_norm=3.48 num_segments=256 num_words=220
2020-06-10 05:12:58,758: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-10 05:12:58,831: Using 1 GPU(s)
2020-06-10 05:12:58,831: Machine: 0 / 1
2020-06-10 05:12:58,858: Hyperparam tuning-------------------
2020-06-10 05:12:58,858: optim_lr: 0.001
2020-06-10 05:12:58,858: dropout (for both): 0.4
2020-06-10 05:12:58,858: margin: 0.4
2020-06-10 05:12:58,858: ------------------------------------
2020-06-10 05:12:58,860: Calling main function: multiview_trainer.train
2020-06-10 05:12:58,860: Using config file: train_config.json
2020-06-10 05:12:58,860: Using module at multiview_trainer.train
2020-06-10 05:13:00,032: Using module at multiview_vocab.MultiViewVocab
2020-06-10 05:13:00,036: Building vocab_data from config
2020-06-10 05:13:00,355:  >> min_count= 0
2020-06-10 05:13:00,356:  >> # words= 34323 (# removed= 0)
2020-06-10 05:13:00,356:  >> # subwords= 38
2020-06-10 05:13:00,356:      = 1
2020-06-10 05:13:00,356:     '= 2
2020-06-10 05:13:00,356:     -= 3
2020-06-10 05:13:00,356:     .= 4
2020-06-10 05:13:00,356:     <= 5
2020-06-10 05:13:00,356:     >= 6
2020-06-10 05:13:00,356:     [= 7
2020-06-10 05:13:00,356:     [laughter]= 8
2020-06-10 05:13:00,356:     [noise]= 9
2020-06-10 05:13:00,356:     [vocalized-noise]= 10
2020-06-10 05:13:00,356:     ]= 11
2020-06-10 05:13:00,356:     _= 12
2020-06-10 05:13:00,356:     a= 13
2020-06-10 05:13:00,356:     b= 14
2020-06-10 05:13:00,356:     c= 15
2020-06-10 05:13:00,356:     d= 16
2020-06-10 05:13:00,357:     e= 17
2020-06-10 05:13:00,357:     f= 18
2020-06-10 05:13:00,357:     g= 19
2020-06-10 05:13:00,357:     h= 20
2020-06-10 05:13:00,357:     i= 21
2020-06-10 05:13:00,357:     j= 22
2020-06-10 05:13:00,357:     k= 23
2020-06-10 05:13:00,357:     l= 24
2020-06-10 05:13:00,357:     m= 25
2020-06-10 05:13:00,357:     n= 26
2020-06-10 05:13:00,357:     o= 27
2020-06-10 05:13:00,357:     p= 28
2020-06-10 05:13:00,357:     q= 29
2020-06-10 05:13:00,357:     r= 30
2020-06-10 05:13:00,357:     s= 31
2020-06-10 05:13:00,357:     t= 32
2020-06-10 05:13:00,357:     u= 33
2020-06-10 05:13:00,357:     v= 34
2020-06-10 05:13:00,357:     w= 35
2020-06-10 05:13:00,358:     x= 36
2020-06-10 05:13:00,358:     y= 37
2020-06-10 05:13:00,358:     z= 38
2020-06-10 05:13:00,375: Using module at data.batch_samplers.BatchSampler
2020-06-10 05:13:00,377: Building vocab_sampler from config
2020-06-10 05:13:00,377:  >> # examples= 34323
2020-06-10 05:13:00,377:  >> batch_size= 1000
2020-06-10 05:13:00,377:  >> shuffle= False
2020-06-10 05:13:00,386:  >> BatchSampler; 35 batches
2020-06-10 05:13:00,386: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 05:13:00,984: Building train_data from config
2020-06-10 05:13:07,940:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-10 05:13:07,940:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-10 05:13:07,940:  >> stack= False
2020-06-10 05:13:07,940:  >> seg_durs= (1, None)
2020-06-10 05:13:07,940:  >> # words= 9971 (# ignored= 0)
2020-06-10 05:13:07,940:  >> input_feat_dim= 108
2020-06-10 05:13:07,940:  >> input_num_subwords= 38
2020-06-10 05:13:07,941: Using module at data.batch_samplers.BatchSampler
2020-06-10 05:13:07,941: Building train_sampler from config
2020-06-10 05:13:07,941:  >> # examples= 9971
2020-06-10 05:13:07,941:  >> batch_size= 256
2020-06-10 05:13:07,942:  >> shuffle= True
2020-06-10 05:13:07,950:  >> BatchSampler; 39 batches
2020-06-10 05:13:07,950: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 05:13:07,950: Building dev_data from config
2020-06-10 05:13:16,152:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 05:13:16,153:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 05:13:16,153:  >> stack= False
2020-06-10 05:13:16,153:  >> seg_durs= (1, None)
2020-06-10 05:13:16,153:  >> # words= 10966 (# ignored= 0)
2020-06-10 05:13:16,153:  >> input_feat_dim= 108
2020-06-10 05:13:16,153:  >> input_num_subwords= 38
2020-06-10 05:13:16,154: Using module at data.batch_samplers.BatchSampler
2020-06-10 05:13:16,154: Building dev_sampler from config
2020-06-10 05:13:16,154:  >> # examples= 10966
2020-06-10 05:13:16,154:  >> batch_size= 256
2020-06-10 05:13:16,154:  >> shuffle= False
2020-06-10 05:13:16,157:  >> BatchSampler; 43 batches
2020-06-10 05:13:16,157: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 05:13:16,157: Building test_data from config
2020-06-10 05:13:23,082:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 05:13:23,082:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 05:13:23,082:  >> stack= False
2020-06-10 05:13:23,082:  >> seg_durs= (1, None)
2020-06-10 05:13:23,082:  >> # words= 11024 (# ignored= 0)
2020-06-10 05:13:23,082:  >> input_feat_dim= 108
2020-06-10 05:13:23,082:  >> input_num_subwords= 38
2020-06-10 05:13:23,082: Using module at data.batch_samplers.BatchSampler
2020-06-10 05:13:23,083: Building test_sampler from config
2020-06-10 05:13:23,083:  >> # examples= 11024
2020-06-10 05:13:23,083:  >> batch_size= 256
2020-06-10 05:13:23,083:  >> shuffle= False
2020-06-10 05:13:23,086:  >> BatchSampler; 44 batches
2020-06-10 05:13:23,086: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-10 05:13:23,092: Building loss from config
2020-06-10 05:13:23,092:  >> margin= 0.4
2020-06-10 05:13:23,092:  >> k= 16
2020-06-10 05:13:23,092:  >> min_k= 8
2020-06-10 05:13:23,092:  >> extra= 0
2020-06-10 05:13:23,092:  >> average= False
2020-06-10 05:13:23,092:  >> margin_max= 0.5
2020-06-10 05:13:23,093:  >> threshold_max= 9
2020-06-10 05:13:23,093:  >> using obj0
2020-06-10 05:13:23,093: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 05:13:23,128: Building eval from config
2020-06-10 05:13:23,128:  >> acoustic_ap= True
2020-06-10 05:13:23,128:  >> crossview_ap= True
2020-06-10 05:13:23,128:  >> full_vocab= False
2020-06-10 05:13:23,128:  >> metric= crossview_ap
2020-06-10 05:13:23,128:  >> mode= max
2020-06-10 05:13:23,128: Using module at multiview_rnn.MultiViewRNN
2020-06-10 05:13:23,136: Building net from config
2020-06-10 05:13:23,137: view1:
2020-06-10 05:13:23,138:  >> cell= GRU
2020-06-10 05:13:23,138:  >> input_size= 108
2020-06-10 05:13:23,138:  >> hidden_size= 512
2020-06-10 05:13:23,138:  >> bidirectional= True
2020-06-10 05:13:23,138:  >> num_layers= 6
2020-06-10 05:13:23,138:  >> dropout between layers= 0.4
2020-06-10 05:13:23,355: view2:
2020-06-10 05:13:23,356:  >> cell= GRU
2020-06-10 05:13:23,356:  >> input_size= 64
2020-06-10 05:13:23,356:  >> hidden_size= 512
2020-06-10 05:13:23,356:  >> bidirectional= True
2020-06-10 05:13:23,356:  >> num_layers= 2
2020-06-10 05:13:23,356:  >> dropout between layers= 0.4
2020-06-10 05:13:23,356:  >> num input embeddings= 38
2020-06-10 05:13:27,134: Using module at optim.adam.Adam
2020-06-10 05:13:27,137: Building optim from config
2020-06-10 05:13:27,137:  >> lr= 0.001
2020-06-10 05:13:27,137:  >> betas= (0.9, 0.999)
2020-06-10 05:13:27,137:  >> eps= 1e-08
2020-06-10 05:13:27,137:  >> weight_decay= 0
2020-06-10 05:13:27,137:  >> amsgrad= False
2020-06-10 05:13:27,138:  >> min_lr= 1e-07
2020-06-10 05:13:27,138: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-10 05:13:27,142: Building sched from config
2020-06-10 05:13:27,143:  >> optim= Adam
2020-06-10 05:13:27,143:  >> decay lr by 0.1
2020-06-10 05:13:27,143:  >> eval_fn= MultiViewAP
2020-06-10 05:13:27,143:  >> patience=4
2020-06-10 05:13:27,143:  >> revert=True
2020-06-10 05:13:27,149: loaded save/MultiViewDataset_IndividualWords.1638.pth
2020-06-10 05:13:27,149: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-10 05:13:27,226: loaded save/MultiViewRNN.1638.pth
2020-06-10 05:13:27,227: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-10 05:13:27,364: loaded save/Adam.1638.pth
2020-06-10 05:13:27,364: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-10 05:13:27,366: loaded save/ReduceLROnPlateau.1638.pth
2020-06-10 05:13:27,366: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-10 05:13:27,366: epoch=42.00 global_step=1638 lr=0.0001 start_iter=0
2020-06-10 05:13:27,366: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 05:15:35,929: 0) loss=0.491 grad_norm=4.74 num_segments=256 num_words=218
2020-06-10 05:17:30,733: 1) loss=0.241 grad_norm=3.89 num_segments=256 num_words=210
2020-06-10 05:19:17,805: 2) loss=0.293 grad_norm=3.16 num_segments=256 num_words=219
2020-06-10 05:20:56,610: 3) loss=0.205 grad_norm=2.98 num_segments=256 num_words=211
2020-06-10 05:22:29,069: 4) loss=0.244 grad_norm=3.43 num_segments=256 num_words=207
2020-06-10 05:23:52,925: 5) loss=0.266 grad_norm=4.25 num_segments=256 num_words=202
2020-06-10 05:25:06,668: 6) loss=0.326 grad_norm=3.47 num_segments=256 num_words=210
2020-06-10 05:26:13,653: 7) loss=0.226 grad_norm=3.86 num_segments=256 num_words=215
2020-06-10 05:27:21,639: 8) loss=0.255 grad_norm=3.69 num_segments=256 num_words=208
2020-06-10 05:28:27,452: 9) loss=0.349 grad_norm=4.19 num_segments=256 num_words=204
2020-06-10 05:29:37,233: 10) loss=0.259 grad_norm=4.41 num_segments=256 num_words=221
2020-06-10 05:30:43,288: 11) loss=0.311 grad_norm=4.53 num_segments=256 num_words=211
2020-06-10 05:31:49,428: 12) loss=0.212 grad_norm=3.59 num_segments=256 num_words=206
2020-06-10 05:32:56,636: 13) loss=0.434 grad_norm=5.29 num_segments=256 num_words=217
2020-06-10 05:34:06,501: 14) loss=0.256 grad_norm=4.14 num_segments=256 num_words=208
2020-06-10 05:35:12,505: 15) loss=0.350 grad_norm=4.96 num_segments=256 num_words=209
2020-06-10 05:36:18,994: 16) loss=0.293 grad_norm=4.27 num_segments=256 num_words=201
2020-06-10 05:37:25,322: 17) loss=0.381 grad_norm=4.29 num_segments=256 num_words=196
2020-06-10 05:38:31,271: 18) loss=0.234 grad_norm=3.79 num_segments=256 num_words=220
2020-06-10 05:39:41,942: 19) loss=0.506 grad_norm=4.97 num_segments=256 num_words=214
2020-06-10 05:40:48,732: 20) loss=0.280 grad_norm=3.72 num_segments=256 num_words=201
2020-06-10 05:41:54,317: 21) loss=0.254 grad_norm=3.63 num_segments=256 num_words=216
2020-06-10 05:43:00,185: 22) loss=0.343 grad_norm=5.29 num_segments=256 num_words=190
2020-06-10 05:44:06,668: 23) loss=0.357 grad_norm=4.82 num_segments=256 num_words=218
2020-06-10 05:45:19,500: 24) loss=0.569 grad_norm=5.55 num_segments=256 num_words=202
2020-06-10 05:46:26,348: 25) loss=0.320 grad_norm=3.29 num_segments=256 num_words=200
2020-06-10 05:47:32,736: 26) loss=0.355 grad_norm=4.07 num_segments=256 num_words=211
2020-06-10 05:48:38,814: 27) loss=0.374 grad_norm=4.51 num_segments=256 num_words=231
2020-06-10 05:49:45,082: 28) loss=0.339 grad_norm=3.88 num_segments=256 num_words=206
2020-06-10 05:50:51,308: 29) loss=0.300 grad_norm=3.09 num_segments=256 num_words=222
2020-06-10 05:51:57,490: 30) loss=0.234 grad_norm=3.84 num_segments=256 num_words=199
2020-06-10 05:53:12,261: 31) loss=0.294 grad_norm=3.84 num_segments=256 num_words=207
2020-06-10 05:54:18,486: 32) loss=0.263 grad_norm=4.22 num_segments=256 num_words=208
2020-06-10 05:55:25,182: 33) loss=0.321 grad_norm=4.75 num_segments=256 num_words=210
2020-06-10 05:56:31,261: 34) loss=0.202 grad_norm=3.42 num_segments=256 num_words=204
2020-06-10 05:57:37,477: 35) loss=0.539 grad_norm=4.86 num_segments=256 num_words=205
2020-06-10 05:58:44,448: 36) loss=0.316 grad_norm=3.19 num_segments=256 num_words=204
2020-06-10 05:59:50,625: 37) loss=0.343 grad_norm=4.57 num_segments=256 num_words=205
2020-06-10 06:00:49,916: 38) loss=0.241 grad_norm=3.30 num_segments=243 num_words=204
2020-06-10 06:00:49,928: epoch= 43.00
2020-06-10 06:00:49,929:  >> time to evaluate and save:
2020-06-10 06:00:49,980: saved save/MultiViewDataset_IndividualWords.1677.pth
2020-06-10 06:00:49,993: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 06:00:50,012: removed save/MultiViewDataset_IndividualWords.1443.pth
2020-06-10 06:00:50,012: saved MultiViewDataset_IndividualWords successfully
2020-06-10 06:00:51,378: saved save/MultiViewRNN.1677.pth
2020-06-10 06:00:51,404: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 06:00:51,465: removed save/MultiViewRNN.1443.pth
2020-06-10 06:00:51,466: saved MultiViewRNN successfully
2020-06-10 06:00:53,972: saved save/Adam.1677.pth
2020-06-10 06:00:53,984: most_recent linked save/Adam.most_recent.pth
2020-06-10 06:00:54,088: removed save/Adam.1443.pth
2020-06-10 06:00:54,088: saved Adam successfully
2020-06-10 06:00:54,276: saved save/ReduceLROnPlateau.1677.pth
2020-06-10 06:00:54,428: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 06:00:55,130: saved ReduceLROnPlateau successfully
2020-06-10 06:00:55,198: saved config successfully
2020-06-10 06:02:33,953:   >> crossview_ap=0.614 (10966 x 3921 pairs)
2020-06-10 06:03:38,182:   >> acoustic_ap=0.741 (10966 choose 2 pairs)
2020-06-10 06:03:38,185: best_so_far= 0.614 at 1482
2020-06-10 06:03:38,185: Reverting to previous best
2020-06-10 06:03:38,272: loaded save/MultiViewRNN.1638.pth
2020-06-10 06:03:38,272: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-10 06:03:38,377: loaded save/Adam.1638.pth
2020-06-10 06:03:38,377: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-10 06:03:38,377: Reducing group lr from 0.0001 to 1e-05
2020-06-10 06:03:38,414: best linked save/Adam.best.pth
2020-06-10 06:03:38,467: epoch=43.00 global_step=1677 lr=1e-05 start_iter=0
2020-06-10 06:03:38,468: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 06:04:48,502: 0) loss=0.362 grad_norm=4.69 num_segments=256 num_words=215
2020-06-10 06:06:08,831: 1) loss=0.360 grad_norm=4.11 num_segments=256 num_words=208
2020-06-10 06:07:17,736: 2) loss=0.230 grad_norm=3.43 num_segments=256 num_words=213
2020-06-10 06:08:26,240: 3) loss=0.592 grad_norm=5.34 num_segments=256 num_words=203
2020-06-10 06:09:34,388: 4) loss=0.265 grad_norm=4.65 num_segments=256 num_words=220
2020-06-10 06:10:42,552: 5) loss=0.208 grad_norm=3.56 num_segments=256 num_words=199
2020-06-10 06:11:49,992: 6) loss=0.285 grad_norm=3.24 num_segments=256 num_words=205
2020-06-10 06:12:58,370: 7) loss=0.215 grad_norm=2.95 num_segments=256 num_words=204
2020-06-10 06:14:07,210: 8) loss=0.204 grad_norm=3.42 num_segments=256 num_words=216
2020-06-10 06:15:15,489: 9) loss=0.398 grad_norm=4.51 num_segments=256 num_words=206
2020-06-10 06:16:24,304: 10) loss=0.283 grad_norm=3.98 num_segments=256 num_words=215
2020-06-10 06:17:33,534: 11) loss=0.465 grad_norm=4.45 num_segments=256 num_words=211
2020-06-10 06:18:58,214: 12) loss=0.339 grad_norm=6.41 num_segments=256 num_words=207
2020-06-10 06:20:07,039: 13) loss=0.213 grad_norm=2.89 num_segments=256 num_words=209
2020-06-10 06:21:15,819: 14) loss=0.310 grad_norm=4.48 num_segments=256 num_words=210
2020-06-10 06:22:25,135: 15) loss=0.358 grad_norm=5.15 num_segments=256 num_words=202
2020-06-10 06:23:33,765: 16) loss=0.366 grad_norm=5.06 num_segments=256 num_words=200
2020-06-10 06:24:42,218: 17) loss=0.312 grad_norm=3.81 num_segments=256 num_words=215
2020-06-10 06:25:51,496: 18) loss=0.340 grad_norm=6.05 num_segments=256 num_words=211
2020-06-10 06:27:00,416: 19) loss=0.559 grad_norm=4.85 num_segments=256 num_words=211
2020-06-10 06:28:08,690: 20) loss=0.194 grad_norm=3.18 num_segments=256 num_words=219
2020-06-10 06:29:17,669: 21) loss=0.282 grad_norm=3.74 num_segments=256 num_words=209
2020-06-10 06:30:26,031: 22) loss=0.304 grad_norm=3.87 num_segments=256 num_words=202
2020-06-10 06:31:34,275: 23) loss=0.308 grad_norm=4.87 num_segments=256 num_words=214
2020-06-10 06:32:43,223: 24) loss=0.355 grad_norm=4.77 num_segments=256 num_words=211
2020-06-10 06:33:52,760: 25) loss=0.248 grad_norm=3.13 num_segments=256 num_words=217
2020-06-10 06:35:20,674: 26) loss=0.279 grad_norm=3.53 num_segments=256 num_words=212
2020-06-10 06:36:29,338: 27) loss=0.254 grad_norm=3.83 num_segments=256 num_words=213
2020-06-10 06:37:37,894: 28) loss=0.224 grad_norm=3.47 num_segments=256 num_words=209
2020-06-10 06:38:46,923: 29) loss=0.322 grad_norm=4.02 num_segments=256 num_words=223
2020-06-10 06:39:56,175: 30) loss=0.295 grad_norm=4.06 num_segments=256 num_words=218
2020-06-10 06:41:05,203: 31) loss=0.247 grad_norm=3.50 num_segments=256 num_words=217
2020-06-10 06:42:14,321: 32) loss=0.206 grad_norm=2.90 num_segments=256 num_words=213
2020-06-10 06:43:23,246: 33) loss=0.231 grad_norm=3.51 num_segments=256 num_words=212
2020-06-10 06:44:32,145: 34) loss=0.206 grad_norm=3.51 num_segments=256 num_words=215
2020-06-10 06:45:41,037: 35) loss=0.366 grad_norm=4.16 num_segments=256 num_words=214
2020-06-10 06:46:49,961: 36) loss=0.205 grad_norm=2.87 num_segments=256 num_words=204
2020-06-10 06:47:58,856: 37) loss=0.202 grad_norm=3.22 num_segments=256 num_words=207
2020-06-10 06:49:01,149: 38) loss=0.272 grad_norm=4.21 num_segments=243 num_words=201
2020-06-10 06:49:01,162: epoch= 44.00
2020-06-10 06:49:01,162:  >> time to evaluate and save:
2020-06-10 06:49:01,195: saved save/MultiViewDataset_IndividualWords.1716.pth
2020-06-10 06:49:01,197: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 06:49:01,243: removed save/MultiViewDataset_IndividualWords.1482.pth
2020-06-10 06:49:01,243: saved MultiViewDataset_IndividualWords successfully
2020-06-10 06:49:02,589: saved save/MultiViewRNN.1716.pth
2020-06-10 06:49:02,608: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 06:49:02,672: removed save/MultiViewRNN.1482.pth
2020-06-10 06:49:02,672: saved MultiViewRNN successfully
2020-06-10 06:49:05,169: saved save/Adam.1716.pth
2020-06-10 06:49:05,177: most_recent linked save/Adam.most_recent.pth
2020-06-10 06:49:05,246: removed save/Adam.1482.pth
2020-06-10 06:49:05,246: saved Adam successfully
2020-06-10 06:49:05,249: saved save/ReduceLROnPlateau.1716.pth
2020-06-10 06:49:05,250: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 06:49:05,260: removed save/ReduceLROnPlateau.1443.pth
2020-06-10 06:49:05,260: saved ReduceLROnPlateau successfully
2020-06-10 06:49:05,262: saved config successfully
2020-06-10 06:50:40,530:   >> crossview_ap=0.614 (10966 x 3921 pairs)
2020-06-10 06:51:44,668:   >> acoustic_ap=0.739 (10966 choose 2 pairs)
2020-06-10 06:51:44,754: best_so_far= 0.614 at 1716
2020-06-10 06:51:44,773: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 06:51:44,778: saved MultiViewDataset_IndividualWords successfully
2020-06-10 06:51:44,797: best linked save/MultiViewRNN.best.pth
2020-06-10 06:51:44,813: saved MultiViewRNN successfully
2020-06-10 06:51:44,823: best linked save/Adam.best.pth
2020-06-10 06:51:44,834: saved Adam successfully
2020-06-10 06:51:44,850: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 06:51:44,860: saved ReduceLROnPlateau successfully
2020-06-10 06:51:45,484: epoch=44.00 global_step=1716 lr=1e-05 start_iter=0
2020-06-10 06:51:45,485: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 06:52:55,321: 0) loss=0.288 grad_norm=4.67 num_segments=256 num_words=209
2020-06-10 06:54:04,309: 1) loss=0.218 grad_norm=3.19 num_segments=256 num_words=213
2020-06-10 06:55:12,961: 2) loss=0.404 grad_norm=5.03 num_segments=256 num_words=200
2020-06-10 06:56:22,134: 3) loss=0.382 grad_norm=3.68 num_segments=256 num_words=210
2020-06-10 06:57:33,079: 4) loss=0.306 grad_norm=3.51 num_segments=256 num_words=212
2020-06-10 06:59:06,412: 5) loss=0.217 grad_norm=3.03 num_segments=256 num_words=206
2020-06-10 07:00:15,371: 6) loss=0.415 grad_norm=3.85 num_segments=256 num_words=205
2020-06-10 07:01:24,808: 7) loss=0.342 grad_norm=5.19 num_segments=256 num_words=205
2020-06-10 07:02:34,504: 8) loss=0.266 grad_norm=4.53 num_segments=256 num_words=209
2020-06-10 07:03:44,756: 9) loss=0.280 grad_norm=4.36 num_segments=256 num_words=214
2020-06-10 07:04:54,584: 10) loss=0.217 grad_norm=3.62 num_segments=256 num_words=209
2020-06-10 07:06:03,124: 11) loss=0.294 grad_norm=4.63 num_segments=256 num_words=221
2020-06-10 07:07:11,971: 12) loss=0.295 grad_norm=3.41 num_segments=256 num_words=209
2020-06-10 07:08:20,901: 13) loss=0.383 grad_norm=5.15 num_segments=256 num_words=210
2020-06-10 07:09:30,026: 14) loss=0.210 grad_norm=3.22 num_segments=256 num_words=209
2020-06-10 07:10:39,496: 15) loss=0.273 grad_norm=4.09 num_segments=256 num_words=211
2020-06-10 07:11:48,616: 16) loss=0.457 grad_norm=5.22 num_segments=256 num_words=219
2020-06-10 07:12:57,786: 17) loss=0.216 grad_norm=3.38 num_segments=256 num_words=213
2020-06-10 07:14:07,659: 18) loss=0.200 grad_norm=3.41 num_segments=256 num_words=216
2020-06-10 07:15:16,935: 19) loss=0.376 grad_norm=5.57 num_segments=256 num_words=212
2020-06-10 07:16:25,300: 20) loss=0.375 grad_norm=4.72 num_segments=256 num_words=210
2020-06-10 07:17:33,424: 21) loss=0.356 grad_norm=5.12 num_segments=256 num_words=212
2020-06-10 07:18:42,983: 22) loss=0.196 grad_norm=3.30 num_segments=256 num_words=221
2020-06-10 07:19:52,393: 23) loss=0.367 grad_norm=4.53 num_segments=256 num_words=211
2020-06-10 07:21:01,404: 24) loss=0.271 grad_norm=3.35 num_segments=256 num_words=207
2020-06-10 07:22:10,987: 25) loss=0.250 grad_norm=3.14 num_segments=256 num_words=218
2020-06-10 07:23:48,680: 26) loss=0.297 grad_norm=4.77 num_segments=256 num_words=210
2020-06-10 07:24:57,934: 27) loss=0.316 grad_norm=3.44 num_segments=256 num_words=218
2020-06-10 07:26:07,521: 28) loss=0.347 grad_norm=3.70 num_segments=256 num_words=206
2020-06-10 07:27:16,978: 29) loss=0.418 grad_norm=4.13 num_segments=256 num_words=222
2020-06-10 07:28:26,083: 30) loss=0.211 grad_norm=3.41 num_segments=256 num_words=226
2020-06-10 07:29:35,148: 31) loss=0.258 grad_norm=3.43 num_segments=256 num_words=205
2020-06-10 07:30:44,129: 32) loss=0.432 grad_norm=3.84 num_segments=256 num_words=202
2020-06-10 07:31:53,532: 33) loss=0.345 grad_norm=3.84 num_segments=256 num_words=209
2020-06-10 07:33:02,776: 34) loss=0.207 grad_norm=3.52 num_segments=256 num_words=223
2020-06-10 07:34:12,530: 35) loss=0.441 grad_norm=5.16 num_segments=256 num_words=203
2020-06-10 07:35:22,437: 36) loss=0.547 grad_norm=5.02 num_segments=256 num_words=212
2020-06-10 07:36:32,212: 37) loss=0.263 grad_norm=3.35 num_segments=256 num_words=200
2020-06-10 07:37:35,038: 38) loss=0.318 grad_norm=3.68 num_segments=243 num_words=198
2020-06-10 07:37:35,055: epoch= 45.00
2020-06-10 07:37:35,056:  >> time to evaluate and save:
2020-06-10 07:37:35,087: saved save/MultiViewDataset_IndividualWords.1755.pth
2020-06-10 07:37:35,089: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 07:37:35,107: removed save/MultiViewDataset_IndividualWords.1521.pth
2020-06-10 07:37:35,107: saved MultiViewDataset_IndividualWords successfully
2020-06-10 07:37:36,441: saved save/MultiViewRNN.1755.pth
2020-06-10 07:37:36,448: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 07:37:36,509: removed save/MultiViewRNN.1521.pth
2020-06-10 07:37:36,509: saved MultiViewRNN successfully
2020-06-10 07:37:39,017: saved save/Adam.1755.pth
2020-06-10 07:37:39,026: most_recent linked save/Adam.most_recent.pth
2020-06-10 07:37:39,114: removed save/Adam.1521.pth
2020-06-10 07:37:39,115: saved Adam successfully
2020-06-10 07:37:39,117: saved save/ReduceLROnPlateau.1755.pth
2020-06-10 07:37:39,121: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 07:37:39,130: removed save/ReduceLROnPlateau.1482.pth
2020-06-10 07:37:39,130: saved ReduceLROnPlateau successfully
2020-06-10 07:37:39,132: saved config successfully
2020-06-10 07:39:18,835:   >> crossview_ap=0.615 (10966 x 3921 pairs)
2020-06-10 07:40:23,809:   >> acoustic_ap=0.740 (10966 choose 2 pairs)
2020-06-10 07:40:23,840: best_so_far= 0.615 at 1755
2020-06-10 07:40:23,874: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 07:40:23,878: saved MultiViewDataset_IndividualWords successfully
2020-06-10 07:40:23,906: best linked save/MultiViewRNN.best.pth
2020-06-10 07:40:23,918: saved MultiViewRNN successfully
2020-06-10 07:40:23,934: best linked save/Adam.best.pth
2020-06-10 07:40:23,944: saved Adam successfully
2020-06-10 07:40:23,965: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 07:40:23,974: removed save/ReduceLROnPlateau.1521.pth
2020-06-10 07:40:23,974: saved ReduceLROnPlateau successfully
2020-06-10 07:40:25,056: epoch=45.00 global_step=1755 lr=1e-05 start_iter=0
2020-06-10 07:40:25,056: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 07:41:36,964: 0) loss=0.237 grad_norm=3.71 num_segments=256 num_words=220
2020-06-10 07:42:46,083: 1) loss=0.370 grad_norm=4.61 num_segments=256 num_words=208
2020-06-10 07:43:55,814: 2) loss=0.267 grad_norm=4.22 num_segments=256 num_words=197
2020-06-10 07:45:05,284: 3) loss=0.284 grad_norm=4.16 num_segments=256 num_words=203
2020-06-10 07:46:15,447: 4) loss=0.368 grad_norm=5.31 num_segments=256 num_words=210
2020-06-10 07:47:25,318: 5) loss=0.297 grad_norm=3.56 num_segments=256 num_words=204
2020-06-10 07:48:34,807: 6) loss=0.223 grad_norm=3.84 num_segments=256 num_words=210
2020-06-10 07:49:44,751: 7) loss=0.248 grad_norm=3.38 num_segments=256 num_words=210
2020-06-10 07:50:54,353: 8) loss=0.216 grad_norm=3.46 num_segments=256 num_words=211
2020-06-10 07:52:04,316: 9) loss=0.198 grad_norm=3.77 num_segments=256 num_words=216
2020-06-10 07:53:13,856: 10) loss=0.357 grad_norm=4.54 num_segments=256 num_words=215
2020-06-10 07:54:24,012: 11) loss=0.385 grad_norm=3.79 num_segments=256 num_words=215
2020-06-10 07:55:34,408: 12) loss=0.252 grad_norm=3.63 num_segments=256 num_words=211
2020-06-10 07:56:44,696: 13) loss=0.309 grad_norm=4.01 num_segments=256 num_words=218
2020-06-10 07:58:34,735: 14) loss=0.375 grad_norm=4.93 num_segments=256 num_words=207
2020-06-10 07:59:42,513: 15) loss=0.342 grad_norm=4.02 num_segments=256 num_words=209
2020-06-10 08:00:50,856: 16) loss=0.303 grad_norm=3.77 num_segments=256 num_words=217
2020-06-10 08:01:59,435: 17) loss=0.215 grad_norm=3.95 num_segments=256 num_words=218
2020-06-10 08:03:07,705: 18) loss=0.198 grad_norm=3.16 num_segments=256 num_words=207
2020-06-10 08:04:16,111: 19) loss=0.314 grad_norm=3.81 num_segments=256 num_words=215
2020-06-10 08:05:23,534: 20) loss=0.383 grad_norm=5.14 num_segments=256 num_words=205
2020-06-10 08:06:31,345: 21) loss=0.287 grad_norm=3.54 num_segments=256 num_words=209
2020-06-10 08:07:39,248: 22) loss=0.297 grad_norm=5.02 num_segments=256 num_words=201
2020-06-10 08:08:47,429: 23) loss=0.382 grad_norm=4.30 num_segments=256 num_words=218
2020-06-10 08:09:55,625: 24) loss=0.310 grad_norm=3.64 num_segments=256 num_words=219
2020-06-10 08:11:03,746: 25) loss=0.203 grad_norm=3.34 num_segments=256 num_words=216
2020-06-10 08:12:11,333: 26) loss=0.239 grad_norm=3.45 num_segments=256 num_words=207
2020-06-10 08:13:18,860: 27) loss=0.344 grad_norm=3.80 num_segments=256 num_words=216
2020-06-10 08:14:26,849: 28) loss=0.394 grad_norm=6.86 num_segments=256 num_words=216
2020-06-10 08:15:35,006: 29) loss=0.297 grad_norm=3.97 num_segments=256 num_words=208
2020-06-10 08:16:42,864: 30) loss=0.270 grad_norm=3.47 num_segments=256 num_words=201
2020-06-10 08:17:51,916: 31) loss=0.343 grad_norm=4.27 num_segments=256 num_words=207
2020-06-10 08:19:00,269: 32) loss=0.223 grad_norm=3.23 num_segments=256 num_words=209
2020-06-10 08:20:08,212: 33) loss=0.314 grad_norm=3.64 num_segments=256 num_words=201
2020-06-10 08:21:16,175: 34) loss=0.373 grad_norm=3.85 num_segments=256 num_words=206
2020-06-10 08:22:24,959: 35) loss=0.342 grad_norm=3.57 num_segments=256 num_words=209
2020-06-10 08:23:33,519: 36) loss=0.435 grad_norm=4.19 num_segments=256 num_words=212
2020-06-10 08:24:41,797: 37) loss=0.414 grad_norm=4.96 num_segments=256 num_words=213
2020-06-10 08:25:43,104: 38) loss=0.280 grad_norm=3.62 num_segments=243 num_words=197
2020-06-10 08:25:43,117: epoch= 46.00
2020-06-10 08:25:43,117:  >> time to evaluate and save:
2020-06-10 08:25:43,151: saved save/MultiViewDataset_IndividualWords.1794.pth
2020-06-10 08:25:43,154: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 08:25:43,170: removed save/MultiViewDataset_IndividualWords.1560.pth
2020-06-10 08:25:43,170: saved MultiViewDataset_IndividualWords successfully
2020-06-10 08:25:44,490: saved save/MultiViewRNN.1794.pth
2020-06-10 08:25:44,492: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 08:25:44,537: removed save/MultiViewRNN.1560.pth
2020-06-10 08:25:44,538: saved MultiViewRNN successfully
2020-06-10 08:25:47,062: saved save/Adam.1794.pth
2020-06-10 08:25:47,074: most_recent linked save/Adam.most_recent.pth
2020-06-10 08:25:47,140: removed save/Adam.1560.pth
2020-06-10 08:25:47,140: saved Adam successfully
2020-06-10 08:25:47,142: saved save/ReduceLROnPlateau.1794.pth
2020-06-10 08:25:47,144: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 08:25:47,157: removed save/ReduceLROnPlateau.1560.pth
2020-06-10 08:25:47,157: saved ReduceLROnPlateau successfully
2020-06-10 08:25:47,159: saved config successfully
2020-06-10 08:27:25,467:   >> crossview_ap=0.615 (10966 x 3921 pairs)
2020-06-10 08:28:29,234:   >> acoustic_ap=0.740 (10966 choose 2 pairs)
2020-06-10 08:28:29,239: best_so_far= 0.615 at 1794
2020-06-10 08:28:29,248: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 08:28:29,251: saved MultiViewDataset_IndividualWords successfully
2020-06-10 08:28:29,256: best linked save/MultiViewRNN.best.pth
2020-06-10 08:28:29,265: saved MultiViewRNN successfully
2020-06-10 08:28:29,270: best linked save/Adam.best.pth
2020-06-10 08:28:29,278: saved Adam successfully
2020-06-10 08:28:29,280: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 08:28:29,282: saved ReduceLROnPlateau successfully
2020-06-10 08:28:30,702: epoch=46.00 global_step=1794 lr=1e-05 start_iter=0
2020-06-10 08:28:30,702: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 08:29:40,757: 0) loss=0.207 grad_norm=2.95 num_segments=256 num_words=214
2020-06-10 08:30:48,766: 1) loss=0.493 grad_norm=6.28 num_segments=256 num_words=209
2020-06-10 08:31:56,477: 2) loss=0.229 grad_norm=3.90 num_segments=256 num_words=214
2020-06-10 08:33:04,845: 3) loss=0.329 grad_norm=3.55 num_segments=256 num_words=207
2020-06-10 08:34:11,990: 4) loss=0.378 grad_norm=4.45 num_segments=256 num_words=209
2020-06-10 08:35:20,542: 5) loss=0.373 grad_norm=4.22 num_segments=256 num_words=205
2020-06-10 08:36:28,626: 6) loss=0.271 grad_norm=3.56 num_segments=256 num_words=211
2020-06-10 08:37:37,460: 7) loss=0.286 grad_norm=3.29 num_segments=256 num_words=199
2020-06-10 08:38:46,007: 8) loss=0.444 grad_norm=4.81 num_segments=256 num_words=223
2020-06-10 08:40:50,085: 9) loss=0.269 grad_norm=4.05 num_segments=256 num_words=224
2020-06-10 08:41:59,397: 10) loss=0.369 grad_norm=5.41 num_segments=256 num_words=211
2020-06-10 08:43:12,287: 11) loss=0.362 grad_norm=5.92 num_segments=256 num_words=219
2020-06-10 08:44:19,669: 12) loss=0.365 grad_norm=4.79 num_segments=256 num_words=208
2020-06-10 08:45:28,965: 13) loss=0.541 grad_norm=4.94 num_segments=256 num_words=208
2020-06-10 08:46:38,008: 14) loss=0.318 grad_norm=4.63 num_segments=256 num_words=225
2020-06-10 08:47:46,265: 15) loss=0.234 grad_norm=4.48 num_segments=256 num_words=210
2020-06-10 08:48:54,553: 16) loss=0.398 grad_norm=4.46 num_segments=256 num_words=208
2020-06-10 08:50:03,856: 17) loss=0.216 grad_norm=4.55 num_segments=256 num_words=204
2020-06-10 08:51:14,140: 18) loss=0.216 grad_norm=3.22 num_segments=256 num_words=207
2020-06-10 08:52:22,108: 19) loss=0.486 grad_norm=5.87 num_segments=256 num_words=212
2020-06-10 08:53:30,675: 20) loss=0.206 grad_norm=3.23 num_segments=256 num_words=200
2020-06-10 08:54:39,301: 21) loss=0.238 grad_norm=3.54 num_segments=256 num_words=220
2020-06-10 08:55:47,647: 22) loss=0.385 grad_norm=5.04 num_segments=256 num_words=210
2020-06-10 08:56:56,258: 23) loss=0.343 grad_norm=4.80 num_segments=256 num_words=217
2020-06-10 08:58:04,949: 24) loss=0.297 grad_norm=4.01 num_segments=256 num_words=208
2020-06-10 08:59:13,585: 25) loss=0.238 grad_norm=3.38 num_segments=256 num_words=209
2020-06-10 09:00:22,040: 26) loss=0.315 grad_norm=3.90 num_segments=256 num_words=206
2020-06-10 09:01:29,829: 27) loss=0.249 grad_norm=4.34 num_segments=256 num_words=208
2020-06-10 09:02:38,479: 28) loss=0.210 grad_norm=3.66 num_segments=256 num_words=210
2020-06-10 09:03:47,089: 29) loss=0.274 grad_norm=4.71 num_segments=256 num_words=218
2020-06-10 09:04:55,643: 30) loss=0.454 grad_norm=3.92 num_segments=256 num_words=203
2020-06-10 09:06:04,349: 31) loss=0.329 grad_norm=4.13 num_segments=256 num_words=206
2020-06-10 09:07:12,594: 32) loss=0.224 grad_norm=4.12 num_segments=256 num_words=218
2020-06-10 09:08:21,145: 33) loss=0.240 grad_norm=3.25 num_segments=256 num_words=211
2020-06-10 09:09:29,349: 34) loss=0.329 grad_norm=4.12 num_segments=256 num_words=208
2020-06-10 09:10:37,971: 35) loss=0.440 grad_norm=5.97 num_segments=256 num_words=200
2020-06-10 09:11:45,872: 36) loss=0.356 grad_norm=3.79 num_segments=256 num_words=206
2020-06-10 09:12:54,040: 37) loss=0.261 grad_norm=3.91 num_segments=256 num_words=213
2020-06-10 09:13:28,099: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-10 09:13:28,152: Using 1 GPU(s)
2020-06-10 09:13:28,152: Machine: 0 / 1
2020-06-10 09:13:28,173: Hyperparam tuning-------------------
2020-06-10 09:13:28,173: optim_lr: 0.001
2020-06-10 09:13:28,173: dropout (for both): 0.4
2020-06-10 09:13:28,173: margin: 0.4
2020-06-10 09:13:28,173: ------------------------------------
2020-06-10 09:13:28,175: Calling main function: multiview_trainer.train
2020-06-10 09:13:28,175: Using config file: train_config.json
2020-06-10 09:13:28,175: Using module at multiview_trainer.train
2020-06-10 09:13:29,228: Using module at multiview_vocab.MultiViewVocab
2020-06-10 09:13:29,232: Building vocab_data from config
2020-06-10 09:13:29,548:  >> min_count= 0
2020-06-10 09:13:29,548:  >> # words= 34323 (# removed= 0)
2020-06-10 09:13:29,548:  >> # subwords= 38
2020-06-10 09:13:29,548:      = 1
2020-06-10 09:13:29,548:     '= 2
2020-06-10 09:13:29,549:     -= 3
2020-06-10 09:13:29,549:     .= 4
2020-06-10 09:13:29,549:     <= 5
2020-06-10 09:13:29,549:     >= 6
2020-06-10 09:13:29,549:     [= 7
2020-06-10 09:13:29,549:     [laughter]= 8
2020-06-10 09:13:29,549:     [noise]= 9
2020-06-10 09:13:29,549:     [vocalized-noise]= 10
2020-06-10 09:13:29,549:     ]= 11
2020-06-10 09:13:29,549:     _= 12
2020-06-10 09:13:29,549:     a= 13
2020-06-10 09:13:29,549:     b= 14
2020-06-10 09:13:29,549:     c= 15
2020-06-10 09:13:29,549:     d= 16
2020-06-10 09:13:29,549:     e= 17
2020-06-10 09:13:29,549:     f= 18
2020-06-10 09:13:29,549:     g= 19
2020-06-10 09:13:29,549:     h= 20
2020-06-10 09:13:29,549:     i= 21
2020-06-10 09:13:29,549:     j= 22
2020-06-10 09:13:29,549:     k= 23
2020-06-10 09:13:29,550:     l= 24
2020-06-10 09:13:29,550:     m= 25
2020-06-10 09:13:29,550:     n= 26
2020-06-10 09:13:29,550:     o= 27
2020-06-10 09:13:29,550:     p= 28
2020-06-10 09:13:29,550:     q= 29
2020-06-10 09:13:29,550:     r= 30
2020-06-10 09:13:29,550:     s= 31
2020-06-10 09:13:29,550:     t= 32
2020-06-10 09:13:29,550:     u= 33
2020-06-10 09:13:29,550:     v= 34
2020-06-10 09:13:29,550:     w= 35
2020-06-10 09:13:29,550:     x= 36
2020-06-10 09:13:29,550:     y= 37
2020-06-10 09:13:29,550:     z= 38
2020-06-10 09:13:29,566: Using module at data.batch_samplers.BatchSampler
2020-06-10 09:13:29,568: Building vocab_sampler from config
2020-06-10 09:13:29,568:  >> # examples= 34323
2020-06-10 09:13:29,568:  >> batch_size= 1000
2020-06-10 09:13:29,568:  >> shuffle= False
2020-06-10 09:13:29,575:  >> BatchSampler; 35 batches
2020-06-10 09:13:29,575: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 09:13:29,851: Building train_data from config
2020-06-10 09:13:36,981:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-10 09:13:36,983:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-10 09:13:36,983:  >> stack= False
2020-06-10 09:13:36,983:  >> seg_durs= (1, None)
2020-06-10 09:13:36,983:  >> # words= 9971 (# ignored= 0)
2020-06-10 09:13:36,983:  >> input_feat_dim= 108
2020-06-10 09:13:36,983:  >> input_num_subwords= 38
2020-06-10 09:13:36,983: Using module at data.batch_samplers.BatchSampler
2020-06-10 09:13:36,984: Building train_sampler from config
2020-06-10 09:13:36,984:  >> # examples= 9971
2020-06-10 09:13:36,984:  >> batch_size= 256
2020-06-10 09:13:36,984:  >> shuffle= True
2020-06-10 09:13:36,992:  >> BatchSampler; 39 batches
2020-06-10 09:13:36,992: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 09:13:36,992: Building dev_data from config
2020-06-10 09:13:45,326:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 09:13:45,327:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 09:13:45,327:  >> stack= False
2020-06-10 09:13:45,327:  >> seg_durs= (1, None)
2020-06-10 09:13:45,327:  >> # words= 10966 (# ignored= 0)
2020-06-10 09:13:45,327:  >> input_feat_dim= 108
2020-06-10 09:13:45,327:  >> input_num_subwords= 38
2020-06-10 09:13:45,327: Using module at data.batch_samplers.BatchSampler
2020-06-10 09:13:45,328: Building dev_sampler from config
2020-06-10 09:13:45,328:  >> # examples= 10966
2020-06-10 09:13:45,328:  >> batch_size= 256
2020-06-10 09:13:45,328:  >> shuffle= False
2020-06-10 09:13:45,331:  >> BatchSampler; 43 batches
2020-06-10 09:13:45,331: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 09:13:45,331: Building test_data from config
2020-06-10 09:13:52,826:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 09:13:52,827:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 09:13:52,827:  >> stack= False
2020-06-10 09:13:52,827:  >> seg_durs= (1, None)
2020-06-10 09:13:52,827:  >> # words= 11024 (# ignored= 0)
2020-06-10 09:13:52,827:  >> input_feat_dim= 108
2020-06-10 09:13:52,827:  >> input_num_subwords= 38
2020-06-10 09:13:52,827: Using module at data.batch_samplers.BatchSampler
2020-06-10 09:13:52,827: Building test_sampler from config
2020-06-10 09:13:52,828:  >> # examples= 11024
2020-06-10 09:13:52,828:  >> batch_size= 256
2020-06-10 09:13:52,828:  >> shuffle= False
2020-06-10 09:13:52,830:  >> BatchSampler; 44 batches
2020-06-10 09:13:52,830: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-10 09:13:52,835: Building loss from config
2020-06-10 09:13:52,835:  >> margin= 0.4
2020-06-10 09:13:52,835:  >> k= 16
2020-06-10 09:13:52,835:  >> min_k= 8
2020-06-10 09:13:52,835:  >> extra= 0
2020-06-10 09:13:52,836:  >> average= False
2020-06-10 09:13:52,836:  >> margin_max= 0.5
2020-06-10 09:13:52,836:  >> threshold_max= 9
2020-06-10 09:13:52,836:  >> using obj0
2020-06-10 09:13:52,836: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 09:13:51,685: Building eval from config
2020-06-10 09:13:51,685:  >> acoustic_ap= True
2020-06-10 09:13:51,685:  >> crossview_ap= True
2020-06-10 09:13:51,685:  >> full_vocab= False
2020-06-10 09:13:51,686:  >> metric= crossview_ap
2020-06-10 09:13:51,686:  >> mode= max
2020-06-10 09:13:51,686: Using module at multiview_rnn.MultiViewRNN
2020-06-10 09:13:51,741: Building net from config
2020-06-10 09:13:51,742: view1:
2020-06-10 09:13:51,743:  >> cell= GRU
2020-06-10 09:13:51,743:  >> input_size= 108
2020-06-10 09:13:51,743:  >> hidden_size= 512
2020-06-10 09:13:51,743:  >> bidirectional= True
2020-06-10 09:13:51,743:  >> num_layers= 6
2020-06-10 09:13:51,743:  >> dropout between layers= 0.4
2020-06-10 09:13:51,954: view2:
2020-06-10 09:13:51,955:  >> cell= GRU
2020-06-10 09:13:51,955:  >> input_size= 64
2020-06-10 09:13:51,955:  >> hidden_size= 512
2020-06-10 09:13:51,955:  >> bidirectional= True
2020-06-10 09:13:51,955:  >> num_layers= 2
2020-06-10 09:13:51,955:  >> dropout between layers= 0.4
2020-06-10 09:13:51,955:  >> num input embeddings= 38
2020-06-10 09:13:55,532: Using module at optim.adam.Adam
2020-06-10 09:13:56,203: Building optim from config
2020-06-10 09:13:56,203:  >> lr= 0.001
2020-06-10 09:13:56,204:  >> betas= (0.9, 0.999)
2020-06-10 09:13:56,204:  >> eps= 1e-08
2020-06-10 09:13:56,204:  >> weight_decay= 0
2020-06-10 09:13:56,204:  >> amsgrad= False
2020-06-10 09:13:56,204:  >> min_lr= 1e-07
2020-06-10 09:13:56,223: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-10 09:13:58,398: Building sched from config
2020-06-10 09:13:58,398:  >> optim= Adam
2020-06-10 09:13:58,399:  >> decay lr by 0.1
2020-06-10 09:13:58,399:  >> eval_fn= MultiViewAP
2020-06-10 09:13:58,400:  >> patience=4
2020-06-10 09:13:58,400:  >> revert=True
2020-06-10 09:13:58,411: loaded save/MultiViewDataset_IndividualWords.1794.pth
2020-06-10 09:13:58,411: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-10 09:13:59,578: loaded save/MultiViewRNN.1794.pth
2020-06-10 09:13:59,579: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-10 09:14:01,890: loaded save/Adam.1794.pth
2020-06-10 09:14:01,891: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-10 09:14:01,893: loaded save/ReduceLROnPlateau.1794.pth
2020-06-10 09:14:01,893: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-10 09:14:01,893: epoch=46.00 global_step=1794 lr=1e-05 start_iter=0
2020-06-10 09:14:01,893: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     2020-06-10 09:16:15,257: 0) loss=0.199 grad_norm=2.55 num_segments=256 num_words=214
                                                                                     2020-06-10 09:18:09,055: 1) loss=0.385 grad_norm=4.91 num_segments=256 num_words=209
                                                                                     2020-06-10 09:19:56,354: 2) loss=0.242 grad_norm=3.61 num_segments=256 num_words=214
                                                                                     2020-06-10 09:21:35,731: 3) loss=0.260 grad_norm=3.32 num_segments=256 num_words=207
                                                                                     2020-06-10 09:23:06,270: 4) loss=0.366 grad_norm=4.13 num_segments=256 num_words=209
                                                                                     2020-06-10 09:24:30,743: 5) loss=0.322 grad_norm=3.53 num_segments=256 num_words=205
2020-06-10 09:25:16,645: 5) loss=0.322 grad_norm=3.53 num_segments=256 num_words=205
2020-06-10 09:25:46,557: 6) loss=0.277 grad_norm=3.84 num_segments=256 num_words=211
2020-06-10 09:26:36,040: 6) loss=0.277 grad_norm=3.84 num_segments=256 num_words=211
2020-06-10 09:26:52,222: 7) loss=0.285 grad_norm=3.36 num_segments=256 num_words=199
2020-06-10 09:27:46,260: 7) loss=0.285 grad_norm=3.36 num_segments=256 num_words=199
2020-06-10 09:28:00,005: 8) loss=0.479 grad_norm=5.21 num_segments=256 num_words=223
2020-06-10 09:29:03,403: 8) loss=0.479 grad_norm=5.21 num_segments=256 num_words=223
2020-06-10 09:30:14,365: 9) loss=0.266 grad_norm=4.10 num_segments=256 num_words=224

2020-06-10 09:31:19,946: 11) loss=0.363 grad_norm=5.56 num_segments=256 num_words=219
2020-06-10 09:31:27,819: 10) loss=0.370 grad_norm=5.33 num_segments=256 num_words=211
2020-06-10 09:32:25,863: 12) loss=0.394 grad_norm=5.10 num_segments=256 num_words=208
2020-06-10 09:32:39,263: 11) loss=0.363 grad_norm=5.56 num_segments=256 num_words=219
2020-06-10 09:33:33,844: 13) loss=0.539 grad_norm=5.04 num_segments=256 num_words=208
2020-06-10 09:33:50,792: 12) loss=0.394 grad_norm=5.10 num_segments=256 num_words=208
2020-06-10 09:34:43,747: 14) loss=0.407 grad_norm=5.53 num_segments=256 num_words=225
2020-06-10 09:35:00,935: 13) loss=0.539 grad_norm=5.04 num_segments=256 num_words=208
2020-06-10 09:35:49,612: 15) loss=0.213 grad_norm=3.97 num_segments=256 num_words=210
2020-06-10 09:36:19,594: 14) loss=0.407 grad_norm=5.53 num_segments=256 num_words=225
2020-06-10 09:36:55,661: 16) loss=0.395 grad_norm=4.49 num_segments=256 num_words=208
2020-06-10 09:37:31,296: 15) loss=0.213 grad_norm=3.97 num_segments=256 num_words=210
2020-06-10 09:38:02,202: 17) loss=0.217 grad_norm=3.98 num_segments=256 num_words=204
2020-06-10 09:38:47,578: 16) loss=0.395 grad_norm=4.49 num_segments=256 num_words=208
2020-06-10 09:40:00,753: 17) loss=0.217 grad_norm=3.98 num_segments=256 num_words=204
2020-06-10 09:40:19,693: 19) loss=0.461 grad_norm=5.60 num_segments=256 num_words=212
2020-06-10 09:41:11,342: 18) loss=0.370 grad_norm=4.32 num_segments=256 num_words=207
2020-06-10 09:41:25,418: 20) loss=0.206 grad_norm=3.29 num_segments=256 num_words=200
2020-06-10 09:42:27,780: 19) loss=0.461 grad_norm=5.60 num_segments=256 num_words=212
2020-06-10 09:43:37,795: 20) loss=0.206 grad_norm=3.29 num_segments=256 num_words=200
2020-06-10 09:44:47,755: 21) loss=0.239 grad_norm=3.68 num_segments=256 num_words=220
2020-06-10 09:45:58,491: 22) loss=0.448 grad_norm=5.66 num_segments=256 num_words=210
2020-06-10 09:47:01,119: 25) loss=0.244 grad_norm=3.35 num_segments=256 num_words=209
2020-06-10 09:47:08,555: 23) loss=0.342 grad_norm=4.58 num_segments=256 num_words=217
2020-06-10 09:48:06,992: 26) loss=0.236 grad_norm=3.96 num_segments=256 num_words=206
2020-06-10 09:48:25,048: 24) loss=0.298 grad_norm=4.23 num_segments=256 num_words=208
2020-06-10 09:49:13,222: 27) loss=0.245 grad_norm=4.15 num_segments=256 num_words=208
2020-06-10 09:49:35,232: 25) loss=0.244 grad_norm=3.35 num_segments=256 num_words=209
2020-06-10 09:50:19,342: 28) loss=0.211 grad_norm=3.52 num_segments=256 num_words=210
2020-06-10 09:50:44,811: 26) loss=0.236 grad_norm=3.96 num_segments=256 num_words=206
2020-06-10 09:51:25,547: 29) loss=0.224 grad_norm=3.61 num_segments=256 num_words=218
2020-06-10 09:51:54,807: 27) loss=0.245 grad_norm=4.15 num_segments=256 num_words=208
2020-06-10 09:52:31,538: 30) loss=0.453 grad_norm=3.78 num_segments=256 num_words=203
2020-06-10 09:53:05,947: 28) loss=0.211 grad_norm=3.52 num_segments=256 num_words=210
2020-06-10 09:53:45,572: 31) loss=0.321 grad_norm=4.13 num_segments=256 num_words=206
2020-06-10 09:54:16,062: 29) loss=0.224 grad_norm=3.61 num_segments=256 num_words=218
2020-06-10 09:54:51,666: 32) loss=0.246 grad_norm=4.26 num_segments=256 num_words=218
2020-06-10 09:55:25,637: 30) loss=0.453 grad_norm=3.78 num_segments=256 num_words=203
2020-06-10 09:55:57,347: 33) loss=0.241 grad_norm=3.42 num_segments=256 num_words=211
2020-06-10 09:56:43,522: 31) loss=0.321 grad_norm=4.13 num_segments=256 num_words=206
2020-06-10 09:57:08,395: 34) loss=0.330 grad_norm=4.17 num_segments=256 num_words=208
2020-06-10 09:57:56,208: 32) loss=0.246 grad_norm=4.26 num_segments=256 num_words=218
2020-06-10 09:58:14,592: 35) loss=0.309 grad_norm=4.32 num_segments=256 num_words=200
2020-06-10 09:59:10,934: 33) loss=0.241 grad_norm=3.42 num_segments=256 num_words=211
2020-06-10 09:59:20,493: 36) loss=0.386 grad_norm=4.81 num_segments=256 num_words=206
2020-06-10 10:00:26,027: 37) loss=0.265 grad_norm=3.94 num_segments=256 num_words=213
2020-06-10 10:01:31,569: 38) loss=0.333 grad_norm=4.96 num_segments=243 num_words=206
2020-06-10 10:01:31,580: epoch= 47.00
2020-06-10 10:01:31,580:  >> time to evaluate and save:
2020-06-10 10:01:31,618: saved save/MultiViewDataset_IndividualWords.1833.pth
2020-06-10 10:01:31,639: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 10:01:31,664: removed save/MultiViewDataset_IndividualWords.1599.pth
2020-06-10 10:01:31,664: saved MultiViewDataset_IndividualWords successfully
2020-06-10 10:01:32,994: saved save/MultiViewRNN.1833.pth
2020-06-10 10:01:33,010: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 10:01:33,360: removed save/MultiViewRNN.1599.pth
2020-06-10 10:01:33,361: saved MultiViewRNN successfully
2020-06-10 10:01:35,910: saved save/Adam.1833.pth
2020-06-10 10:01:35,920: most_recent linked save/Adam.most_recent.pth
2020-06-10 10:01:36,280: removed save/Adam.1599.pth
2020-06-10 10:01:36,280: saved Adam successfully
2020-06-10 10:01:36,310: saved save/ReduceLROnPlateau.1833.pth
2020-06-10 10:01:36,329: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 10:01:36,333: saved ReduceLROnPlateau successfully
2020-06-10 10:01:36,335: saved config successfully
2020-06-10 10:02:48,165: 36) loss=0.386 grad_norm=4.81 num_segments=256 num_words=206
2020-06-10 10:03:09,472:   >> crossview_ap=0.615 (10966 x 3921 pairs)
2020-06-10 10:04:00,126: 37) loss=0.265 grad_norm=3.94 num_segments=256 num_words=213
2020-06-10 10:04:12,190:   >> acoustic_ap=0.740 (10966 choose 2 pairs)
2020-06-10 10:04:12,193: best_so_far= 0.615 at 1833
2020-06-10 10:04:12,213: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 10:04:12,215: saved MultiViewDataset_IndividualWords successfully
2020-06-10 10:04:12,227: best linked save/MultiViewRNN.best.pth
2020-06-10 10:04:12,234: saved MultiViewRNN successfully
2020-06-10 10:04:12,248: best linked save/Adam.best.pth
2020-06-10 10:04:12,256: saved Adam successfully
2020-06-10 10:04:12,265: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 10:04:12,268: saved ReduceLROnPlateau successfully
2020-06-10 10:04:12,373: epoch=47.00 global_step=1833 lr=1e-05 start_iter=0
2020-06-10 10:04:12,373: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 10:05:03,239: 38) loss=0.333 grad_norm=4.96 num_segments=243 num_words=206
2020-06-10 10:05:03,260: epoch= 47.00
2020-06-10 10:05:03,261:  >> time to evaluate and save:
2020-06-10 10:05:03,268: saved MultiViewDataset_IndividualWords successfully
2020-06-10 10:05:03,344: saved MultiViewRNN successfully
2020-06-10 10:05:03,418: saved Adam successfully
2020-06-10 10:05:03,429: saved ReduceLROnPlateau successfully
2020-06-10 10:05:03,431: saved config successfully
2020-06-10 10:05:20,259: 0) loss=0.195 grad_norm=3.68 num_segments=256 num_words=217
2020-06-10 10:06:37,732:   >> crossview_ap=0.615 (10966 x 3921 pairs)
 num_words=213
2020-06-10 10:07:39,696:   >> acoustic_ap=0.740 (10966 choose 2 pairs)
2020-06-10 10:07:39,698: best_so_far= 0.615 at 1833
2020-06-10 10:07:39,730: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 10:07:39,735: saved MultiViewDataset_IndividualWords successfully
2020-06-10 10:07:39,761: best linked save/MultiViewRNN.best.pth
2020-06-10 10:07:39,765: saved MultiViewRNN successfully
2020-06-10 10:07:39,795: best linked save/Adam.best.pth
2020-06-10 10:07:39,799: saved Adam successfully
2020-06-10 10:07:39,826: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 10:07:39,829: saved ReduceLROnPlateau successfully
2020-06-10 10:07:44,441: 2) loss=0.406 grad_norm=4.73 num_segments=256 num_words=217
                                                                           2020-06-10 10:08:50,459: 3) loss=0.290 grad_norm=4.64 num_segments=256 num_words=220
                                                                                     2020-06-10 10:09:57,856: 4) loss=0.184 grad_norm=3.05 num_segments=256 num_words=214
                                                                                     2020-06-10 10:11:03,522: 5) loss=0.497 grad_norm=4.95 num_segments=256 num_words=217
                                                                                     2020-06-10 10:12:09,257: 6) loss=0.357 grad_norm=4.06 num_segments=256 num_words=216
                                                                                     2020-06-10 10:13:15,038: 7) loss=0.447 grad_norm=5.16 num_segments=256 num_words=212
                                                                                     2020-06-10 10:14:22,710: 8) loss=0.311 grad_norm=4.24 num_segments=256 num_words=217
                                                                                     2020-06-10 10:15:28,464: 9) loss=0.345 grad_norm=4.43 num_segments=256 num_words=212
                                                                                     2020-06-10 10:16:34,512: 10) loss=0.198 grad_norm=3.46 num_segments=256 num_words=205
2020-06-10 10:17:40,352: 11) loss=0.303 grad_norm=4.57 num_segments=256 num_words=214
                                                                                     2020-06-10 10:18:59,270: 12) loss=0.321 grad_norm=3.94 num_segments=256 num_words=207
                                                                                     2020-06-10 10:20:09,513: 13) loss=0.309 grad_norm=3.30 num_segments=256 num_words=215
                                                                                      2020-06-10 10:21:15,146: 14) loss=0.339 grad_norm=4.17 num_segments=256 num_words=219
                                                                                      2020-06-10 10:22:25,308: 15) loss=0.432 grad_norm=4.50 num_segments=256 num_words=201
2020-06-10 10:23:32,155: 16) loss=0.205 grad_norm=3.63 num_segments=256 num_words=209
                                                                                      2020-06-10 10:24:38,290: 17) loss=0.201 grad_norm=3.04 num_segments=256 num_words=203
                                                                                      2020-06-10 10:25:44,304: 18) loss=0.456 grad_norm=4.32 num_segments=256 num_words=210
                                                                                      2020-06-10 10:26:50,529: 19) loss=0.200 grad_norm=3.00 num_segments=256 num_words=215
                                                                                      2020-06-10 10:27:57,201: 20) loss=0.206 grad_norm=3.07 num_segments=256 num_words=204
                                                                                      2020-06-10 10:29:04,773: 21) loss=0.374 grad_norm=4.32 num_segments=256 num_words=207
                                                                                      2020-06-10 10:30:11,158: 22) loss=0.346 grad_norm=5.09 num_segments=256 num_words=217
                                                                                      2020-06-10 10:31:20,943: 23) loss=0.214 grad_norm=3.45 num_segments=256 num_words=211
                                                                                      2020-06-10 10:32:26,669: 24) loss=0.210 grad_norm=3.33 num_segments=256 num_words=212
                                                                                      2020-06-10 10:33:32,413: 25) loss=0.255 grad_norm=3.62 num_segments=256 num_words=210
                                                                                      2020-06-10 10:34:55,498: 26) loss=0.305 grad_norm=3.77 num_segments=256 num_words=211
2020-06-10 10:35:40,979: 22) loss=0.346 grad_norm=5.09 num_segments=256 num_words=217
2020-06-10 10:36:04,023: 27) loss=0.402 grad_norm=4.34 num_segments=256 num_words=208
2020-06-10 10:36:52,508: 23) loss=0.214 grad_norm=3.45 num_segments=256 num_words=211
2020-06-10 10:37:12,313: 28) loss=0.290 grad_norm=5.10 num_segments=256 num_words=205
2020-06-10 10:38:03,859: 24) loss=0.210 grad_norm=3.33 num_segments=256 num_words=212
2020-06-10 10:38:18,141: 29) loss=0.243 grad_norm=3.59 num_segments=256 num_words=219
2020-06-10 10:39:15,435: 25) loss=0.255 grad_norm=3.62 num_segments=256 num_words=210
2020-06-10 10:39:25,014: 30) loss=0.420 grad_norm=4.30 num_segments=256 num_words=201
2020-06-10 10:40:34,110: 31) loss=0.312 grad_norm=4.41 num_segments=256 num_words=213
2020-06-10 10:40:48,831: 26) loss=0.305 grad_norm=3.77 num_segments=256 num_words=211
2020-06-10 10:41:40,629: 32) loss=0.414 grad_norm=4.79 num_segments=256 num_words=211
2020-06-10 10:41:59,444: 27) loss=0.402 grad_norm=4.34 num_segments=256 num_words=208
2020-06-10 10:42:46,818: 33) loss=0.218 grad_norm=3.69 num_segments=256 num_words=206
2020-06-10 10:43:10,182: 28) loss=0.290 grad_norm=5.10 num_segments=256 num_words=205
2020-06-10 10:43:53,165: 34) loss=0.335 grad_norm=3.77 num_segments=256 num_words=206
2020-06-10 10:44:21,262: 29) loss=0.243 grad_norm=3.59 num_segments=256 num_words=219
2020-06-10 10:44:59,157: 35) loss=0.391 grad_norm=4.89 num_segments=256 num_words=211
2020-06-10 10:45:32,828: 30) loss=0.420 grad_norm=4.30 num_segments=256 num_words=201
2020-06-10 10:46:08,935: 36) loss=0.353 grad_norm=4.38 num_segments=256 num_words=219
2020-06-10 10:46:43,819: 31) loss=0.312 grad_norm=4.41 num_segments=256 num_words=213
2020-06-10 10:47:55,308: 32) loss=0.414 grad_norm=4.79 num_segments=256 num_words=211
2020-06-10 10:48:25,897: 38) loss=0.219 grad_norm=3.25 num_segments=243 num_words=202
2020-06-10 10:48:25,908: epoch= 48.00
2020-06-10 10:48:25,908:  >> time to evaluate and save:
2020-06-10 10:48:25,937: saved save/MultiViewDataset_IndividualWords.1872.pth
2020-06-10 10:48:25,940: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 10:48:25,955: removed save/MultiViewDataset_IndividualWords.1638.pth
2020-06-10 10:48:25,955: saved MultiViewDataset_IndividualWords successfully
2020-06-10 10:48:27,299: saved save/MultiViewRNN.1872.pth
2020-06-10 10:48:27,307: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 10:48:27,454: removed save/MultiViewRNN.1638.pth
2020-06-10 10:48:27,454: saved MultiViewRNN successfully
2020-06-10 10:48:29,983: saved save/Adam.1872.pth
2020-06-10 10:48:30,004: most_recent linked save/Adam.most_recent.pth
2020-06-10 10:48:30,053: removed save/Adam.1638.pth
2020-06-10 10:48:30,054: saved Adam successfully
2020-06-10 10:48:30,056: saved save/ReduceLROnPlateau.1872.pth
2020-06-10 10:48:30,078: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 10:48:30,082: removed save/ReduceLROnPlateau.1599.pth
2020-06-10 10:48:30,082: saved ReduceLROnPlateau successfully
2020-06-10 10:48:30,083: saved config successfully
2020-06-10 10:49:07,249: 33) loss=0.218 grad_norm=3.69 num_segments=256 num_words=206
2020-06-10 10:50:03,284:   >> crossview_ap=0.615 (10966 x 3921 pairs)
2020-06-10 10:50:19,336: 34) loss=0.335 grad_norm=3.77 num_segments=256 num_words=206
2020-06-10 10:51:06,223:   >> acoustic_ap=0.740 (10966 choose 2 pairs)
2020-06-10 10:51:06,226: best_so_far= 0.615 at 1833
2020-06-10 10:51:06,755: epoch=48.00 global_step=1872 lr=1e-05 start_iter=0
2020-06-10 10:51:06,756: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 10:51:30,807: 35) loss=0.391 grad_norm=4.89 num_segments=256 num_words=211
2020-06-10 10:52:15,234: 0) loss=0.259 grad_norm=3.60 num_segments=256 num_words=209
2020-06-10 10:52:42,676: 36) loss=0.353 grad_norm=4.38 num_segments=256 num_words=219
2020-06-10 10:53:22,050: 1) loss=0.363 grad_norm=3.92 num_segments=256 num_words=218
2020-06-10 10:53:53,982: 37) loss=0.372 grad_norm=4.95 num_segments=256 num_words=210
2020-06-10 10:54:28,923: 2) loss=0.202 grad_norm=3.56 num_segments=256 num_words=224
2020-06-10 10:54:58,113: 38) loss=0.219 grad_norm=3.25 num_segments=243 num_words=202
2020-06-10 10:54:58,126: epoch= 48.00
2020-06-10 10:54:58,126:  >> time to evaluate and save:
2020-06-10 10:54:58,132: saved MultiViewDataset_IndividualWords successfully
2020-06-10 10:54:58,156: saved MultiViewRNN successfully
2020-06-10 10:54:58,179: saved Adam successfully
2020-06-10 10:54:58,181: saved ReduceLROnPlateau successfully
2020-06-10 10:54:58,182: saved config successfully
2020-06-10 10:55:35,479: 3) loss=0.260 grad_norm=3.48 num_segments=256 num_words=213
2020-06-10 10:56:27,972:   >> crossview_ap=0.615 (10966 x 3921 pairs)
2020-06-10 10:56:49,432: 4) loss=0.251 grad_norm=3.59 num_segments=256 num_words=214
2020-06-10 10:57:28,922:   >> acoustic_ap=0.740 (10966 choose 2 pairs)
2020-06-10 10:57:28,925: best_so_far= 0.615 at 1833
2020-06-10 10:57:29,500: epoch=48.00 global_step=1872 lr=1e-05 start_iter=0
2020-06-10 10:57:29,500: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 10:58:19,942: 5) loss=0.413 grad_norm=5.21 num_segments=256 num_words=211
2020-06-10 10:58:42,172: 0) loss=0.259 grad_norm=3.60 num_segments=256 num_words=209
2020-06-10 10:59:27,162: 6) loss=0.221 grad_norm=3.77 num_segments=256 num_words=211
2020-06-10 10:59:53,402: 1) loss=0.363 grad_norm=3.92 num_segments=256 num_words=218
2020-06-10 11:00:33,965: 7) loss=0.243 grad_norm=3.32 num_segments=256 num_words=209
2020-06-10 11:01:04,591: 2) loss=0.202 grad_norm=3.56 num_segments=256 num_words=224
2020-06-10 11:01:40,464: 8) loss=0.202 grad_norm=3.47 num_segments=256 num_words=201
2020-06-10 11:02:15,561: 3) loss=0.260 grad_norm=3.48 num_segments=256 num_words=213
2020-06-10 11:02:46,658: 9) loss=0.218 grad_norm=3.17 num_segments=256 num_words=207
2020-06-10 11:03:30,129: 4) loss=0.251 grad_norm=3.59 num_segments=256 num_words=214
2020-06-10 11:03:53,317: 10) loss=0.252 grad_norm=3.40 num_segments=256 num_words=212
2020-06-10 11:04:59,315: 11) loss=0.224 grad_norm=3.38 num_segments=256 num_words=201
2020-06-10 11:05:08,303: 5) loss=0.413 grad_norm=5.21 num_segments=256 num_words=211
2020-06-10 11:06:05,669: 12) loss=0.267 grad_norm=3.70 num_segments=256 num_words=207
2020-06-10 11:06:20,226: 6) loss=0.221 grad_norm=3.77 num_segments=256 num_words=211
2020-06-10 11:07:12,331: 13) loss=0.200 grad_norm=3.25 num_segments=256 num_words=216
2020-06-10 11:07:32,478: 7) loss=0.243 grad_norm=3.32 num_segments=256 num_words=209
2020-06-10 11:08:20,647: 14) loss=0.263 grad_norm=4.06 num_segments=256 num_words=219
2020-06-10 11:08:45,541: 8) loss=0.202 grad_norm=3.47 num_segments=256 num_words=201
2020-06-10 11:09:27,919: 15) loss=0.302 grad_norm=4.26 num_segments=256 num_words=206
2020-06-10 11:09:58,115: 9) loss=0.218 grad_norm=3.17 num_segments=256 num_words=207
2020-06-10 11:10:36,897: 16) loss=0.330 grad_norm=3.77 num_segments=256 num_words=210
2020-06-10 11:11:11,072: 10) loss=0.252 grad_norm=3.40 num_segments=256 num_words=212
2020-06-10 11:11:43,672: 17) loss=0.301 grad_norm=3.97 num_segments=256 num_words=212
2020-06-10 11:12:22,994: 11) loss=0.224 grad_norm=3.38 num_segments=256 num_words=201
2020-06-10 11:12:57,034: 18) loss=0.314 grad_norm=3.74 num_segments=256 num_words=210
2020-06-10 11:13:35,191: 12) loss=0.267 grad_norm=3.70 num_segments=256 num_words=207
2020-06-10 11:14:04,591: 19) loss=0.246 grad_norm=3.30 num_segments=256 num_words=215
2020-06-10 11:14:47,597: 13) loss=0.200 grad_norm=3.25 num_segments=256 num_words=216
2020-06-10 11:15:14,474: 20) loss=0.209 grad_norm=3.08 num_segments=256 num_words=214
2020-06-10 11:15:59,620: 14) loss=0.263 grad_norm=4.06 num_segments=256 num_words=219
2020-06-10 11:16:21,530: 21) loss=0.398 grad_norm=5.07 num_segments=256 num_words=221
2020-06-10 11:17:12,344: 15) loss=0.302 grad_norm=4.26 num_segments=256 num_words=206
2020-06-10 11:17:31,694: 22) loss=0.321 grad_norm=3.14 num_segments=256 num_words=205
2020-06-10 11:18:26,499: 16) loss=0.330 grad_norm=3.77 num_segments=256 num_words=210
2020-06-10 11:18:38,915: 23) loss=0.373 grad_norm=3.97 num_segments=256 num_words=205
2020-06-10 11:19:40,385: 17) loss=0.301 grad_norm=3.97 num_segments=256 num_words=212
2020-06-10 11:19:45,850: 24) loss=0.239 grad_norm=4.84 num_segments=256 num_words=209
2020-06-10 11:20:53,007: 18) loss=0.314 grad_norm=3.74 num_segments=256 num_words=210
2020-06-10 11:22:05,618: 19) loss=0.246 grad_norm=3.30 num_segments=256 num_words=215
2020-06-10 11:22:28,858: 26) loss=0.417 grad_norm=5.70 num_segments=256 num_words=219
2020-06-10 11:23:17,972: 20) loss=0.209 grad_norm=3.08 num_segments=256 num_words=214
2020-06-10 11:23:38,202: 27) loss=0.369 grad_norm=4.16 num_segments=256 num_words=212
2020-06-10 11:24:31,185: 21) loss=0.398 grad_norm=5.07 num_segments=256 num_words=221
2020-06-10 11:24:46,018: 28) loss=0.289 grad_norm=3.51 num_segments=256 num_words=227
2020-06-10 11:25:44,639: 22) loss=0.321 grad_norm=3.14 num_segments=256 num_words=205
2020-06-10 11:25:53,085: 29) loss=0.325 grad_norm=4.84 num_segments=256 num_words=201
2020-06-10 11:26:57,522: 23) loss=0.373 grad_norm=3.97 num_segments=256 num_words=205
2020-06-10 11:27:03,307: 30) loss=0.254 grad_norm=3.10 num_segments=256 num_words=203
2020-06-10 11:28:11,482: 31) loss=0.339 grad_norm=4.23 num_segments=256 num_words=213
2020-06-10 11:29:23,347: 25) loss=0.204 grad_norm=3.03 num_segments=256 num_words=214
2020-06-10 11:30:25,589: 33) loss=0.433 grad_norm=5.79 num_segments=256 num_words=211
2020-06-10 11:31:08,088: 26) loss=0.417 grad_norm=5.70 num_segments=256 num_words=219
2020-06-10 11:31:32,264: 34) loss=0.217 grad_norm=3.08 num_segments=256 num_words=206
2020-06-10 11:32:21,310: 27) loss=0.369 grad_norm=4.16 num_segments=256 num_words=212
2020-06-10 11:32:40,012: 35) loss=0.251 grad_norm=4.03 num_segments=256 num_words=214
2020-06-10 11:33:34,292: 28) loss=0.289 grad_norm=3.51 num_segments=256 num_words=227
2020-06-10 11:33:47,630: 36) loss=0.240 grad_norm=4.13 num_segments=256 num_words=222
2020-06-10 11:34:47,213: 29) loss=0.325 grad_norm=4.84 num_segments=256 num_words=201
2020-06-10 11:34:55,478: 37) loss=0.230 grad_norm=3.51 num_segments=256 num_words=207
2020-06-10 11:36:03,344: 38) loss=0.217 grad_norm=3.65 num_segments=243 num_words=199
2020-06-10 11:36:03,356: epoch= 49.00
2020-06-10 11:36:03,356:  >> time to evaluate and save:
2020-06-10 11:36:03,396: saved save/MultiViewDataset_IndividualWords.1911.pth
2020-06-10 11:36:03,398: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 11:36:03,422: removed save/MultiViewDataset_IndividualWords.1677.pth
2020-06-10 11:36:03,422: saved MultiViewDataset_IndividualWords successfully
2020-06-10 11:36:04,853: saved save/MultiViewRNN.1911.pth
2020-06-10 11:36:04,855: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 11:36:04,888: removed save/MultiViewRNN.1677.pth
2020-06-10 11:36:04,888: saved MultiViewRNN successfully
2020-06-10 11:36:07,426: saved save/Adam.1911.pth
2020-06-10 11:36:07,427: most_recent linked save/Adam.most_recent.pth
2020-06-10 11:36:07,474: removed save/Adam.1677.pth
2020-06-10 11:36:07,474: saved Adam successfully
2020-06-10 11:36:07,476: saved save/ReduceLROnPlateau.1911.pth
2020-06-10 11:36:07,491: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 11:36:07,503: removed save/ReduceLROnPlateau.1638.pth
2020-06-10 11:36:07,503: saved ReduceLROnPlateau successfully
2020-06-10 11:36:07,504: saved config successfully
2020-06-10 11:37:13,592: 31) loss=0.339 grad_norm=4.23 num_segments=256 num_words=213
2020-06-10 11:37:47,716:   >> crossview_ap=0.615 (10966 x 3921 pairs)
2020-06-10 11:38:26,637: 32) loss=0.394 grad_norm=5.33 num_segments=256 num_words=198
2020-06-10 11:38:48,234:   >> acoustic_ap=0.741 (10966 choose 2 pairs)
2020-06-10 11:38:48,240: best_so_far= 0.615 at 1911
2020-06-10 11:38:48,253: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 11:38:48,256: saved MultiViewDataset_IndividualWords successfully
2020-06-10 11:38:48,267: best linked save/MultiViewRNN.best.pth
2020-06-10 11:38:48,277: saved MultiViewRNN successfully
2020-06-10 11:38:48,295: best linked save/Adam.best.pth
2020-06-10 11:38:48,304: saved Adam successfully
2020-06-10 11:38:48,314: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 11:38:48,329: removed save/ReduceLROnPlateau.1677.pth
2020-06-10 11:38:48,330: saved ReduceLROnPlateau successfully
2020-06-10 11:38:49,151: epoch=49.00 global_step=1911 lr=1e-05 start_iter=0
2020-06-10 11:38:49,151: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
                                                                                      2020-06-10 11:39:57,397: 0) loss=0.328 grad_norm=3.81 num_segments=256 num_words=221
                                                                                      2020-06-10 11:41:05,829: 1) loss=0.209 grad_norm=3.42 num_segments=256 num_words=213
                                                                                      2020-06-10 11:42:12,048: 2) loss=0.216 grad_norm=3.10 num_segments=256 num_words=208
2020-06-10 11:43:18,396: 3) loss=0.359 grad_norm=4.41 num_segments=256 num_words=212
                                                                                      2020-06-10 11:44:24,934: 4) loss=0.537 grad_norm=4.31 num_segments=256 num_words=221
 2020-06-10 11:45:31,599: 5) loss=0.391 grad_norm=5.59 num_segments=256 num_words=214
                                                                                                                                                                                                                                                                                                                                                                                                       2020-06-10 11:46:39,468: 6) loss=0.213 grad_norm=3.05 num_segments=256 num_words=204
                                                                      2020-06-10 11:47:46,555: 7) loss=0.344 grad_norm=5.31 num_segments=256 num_words=214
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 2020-06-10 11:48:53,492: 8) loss=0.360 grad_norm=5.20 num_segments=256 num_words=213
                                                                           2020-06-10 11:50:00,385: 9) loss=0.201 grad_norm=4.21 num_segments=256 num_words=216
2020-06-10 11:51:07,093: 10) loss=0.341 grad_norm=5.30 num_segments=256 num_words=202
2020-06-10 11:52:13,803: 11) loss=0.295 grad_norm=3.49 num_segments=256 num_words=210
                                                                                     2020-06-10 11:53:20,507: 12) loss=0.222 grad_norm=3.29 num_segments=256 num_words=210
                                                                                     2020-06-10 11:54:28,191: 13) loss=0.199 grad_norm=3.23 num_segments=256 num_words=204
                                                                                     2020-06-10 11:56:14,588: 14) loss=0.513 grad_norm=5.52 num_segments=256 num_words=216
2020-06-10 11:57:21,455: 15) loss=0.209 grad_norm=3.03 num_segments=256 num_words=213
2020-06-10 11:58:28,483: 16) loss=0.347 grad_norm=3.92 num_segments=256 num_words=199
2020-06-10 11:59:36,631: 17) loss=0.332 grad_norm=3.75 num_segments=256 num_words=214
                                                                                     2020-06-10 12:00:48,307: 18) loss=0.256 grad_norm=3.63 num_segments=256 num_words=209
2020-06-10 12:02:00,954: 19) loss=0.239 grad_norm=3.59 num_segments=256 num_words=217
2020-06-10 12:03:12,620: 20) loss=0.519 grad_norm=5.34 num_segments=256 num_words=211
2020-06-10 12:04:20,842: 21) loss=0.196 grad_norm=2.91 num_segments=256 num_words=213
2020-06-10 12:05:28,079: 22) loss=0.249 grad_norm=3.58 num_segments=256 num_words=211
2020-06-10 12:06:35,395: 23) loss=0.392 grad_norm=4.72 num_segments=256 num_words=210
2020-06-10 12:07:42,974: 24) loss=0.259 grad_norm=4.10 num_segments=256 num_words=220
2020-06-10 12:08:52,165: 25) loss=0.346 grad_norm=4.05 num_segments=256 num_words=211
2020-06-10 12:10:00,129: 26) loss=0.290 grad_norm=4.83 num_segments=256 num_words=209
2020-06-10 12:11:30,650: 17) loss=0.332 grad_norm=3.75 num_segments=256 num_words=214
2020-06-10 12:12:20,845: 28) loss=0.398 grad_norm=4.11 num_segments=256 num_words=197
2020-06-10 12:12:42,215: 18) loss=0.256 grad_norm=3.63 num_segments=256 num_words=209
2020-06-10 12:13:27,482: 29) loss=0.224 grad_norm=5.31 num_segments=256 num_words=212
2020-06-10 12:13:53,547: 19) loss=0.239 grad_norm=3.59 num_segments=256 num_words=217
2020-06-10 12:15:05,552: 20) loss=0.519 grad_norm=5.34 num_segments=256 num_words=211
2020-06-10 12:15:44,817: 31) loss=0.357 grad_norm=4.53 num_segments=256 num_words=200
2020-06-10 12:16:17,589: 21) loss=0.196 grad_norm=2.91 num_segments=256 num_words=213
2020-06-10 12:17:05,645: 32) loss=0.230 grad_norm=3.36 num_segments=256 num_words=216
2020-06-10 12:18:16,907: 33) loss=0.395 grad_norm=4.16 num_segments=256 num_words=206
2020-06-10 12:18:40,409: 23) loss=0.392 grad_norm=4.72 num_segments=256 num_words=210
2020-06-10 12:19:31,534: 34) loss=0.585 grad_norm=4.23 num_segments=256 num_words=214
2020-06-10 12:19:51,646: 24) loss=0.259 grad_norm=4.10 num_segments=256 num_words=220
2020-06-10 12:20:41,598: 35) loss=0.328 grad_norm=3.18 num_segments=256 num_words=205
2020-06-10 12:22:14,821: 26) loss=0.290 grad_norm=4.83 num_segments=256 num_words=209
2020-06-10 12:23:05,662: 37) loss=0.211 grad_norm=3.15 num_segments=256 num_words=203
2020-06-10 12:23:27,111: 27) loss=0.346 grad_norm=5.46 num_segments=256 num_words=211
2020-06-10 12:24:07,087: 38) loss=0.553 grad_norm=4.31 num_segments=243 num_words=206
2020-06-10 12:24:07,097: epoch= 50.00
2020-06-10 12:24:07,098:  >> time to evaluate and save:
2020-06-10 12:24:07,222: saved save/MultiViewDataset_IndividualWords.1950.pth
2020-06-10 12:24:07,224: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 12:24:07,254: removed save/MultiViewDataset_IndividualWords.1716.pth
2020-06-10 12:24:07,255: saved MultiViewDataset_IndividualWords successfully
2020-06-10 12:24:08,699: saved save/MultiViewRNN.1950.pth
2020-06-10 12:24:08,701: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 12:24:08,760: removed save/MultiViewRNN.1716.pth
2020-06-10 12:24:08,760: saved MultiViewRNN successfully
2020-06-10 12:24:11,374: saved save/Adam.1950.pth
2020-06-10 12:24:11,375: most_recent linked save/Adam.most_recent.pth
2020-06-10 12:24:11,462: removed save/Adam.1716.pth
2020-06-10 12:24:11,462: saved Adam successfully
2020-06-10 12:24:11,539: saved save/ReduceLROnPlateau.1950.pth
2020-06-10 12:24:11,541: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 12:24:11,545: removed save/ReduceLROnPlateau.1716.pth
2020-06-10 12:24:11,546: saved ReduceLROnPlateau successfully
2020-06-10 12:24:11,547: saved config successfully
2020-06-10 12:24:39,495: 28) loss=0.398 grad_norm=4.11 num_segments=256 num_words=197
2020-06-10 12:25:51,832: 29) loss=0.224 grad_norm=5.31 num_segments=256 num_words=212
2020-06-10 12:26:00,027:   >> crossview_ap=0.615 (10966 x 3921 pairs)
2020-06-10 12:27:00,530:   >> acoustic_ap=0.740 (10966 choose 2 pairs)
2020-06-10 12:27:00,536: best_so_far= 0.615 at 1911
2020-06-10 12:27:03,966: 30) loss=0.201 grad_norm=3.03 num_segments=256 num_words=215
 12:27:02,014: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 12:28:15,993: 31) loss=0.357 grad_norm=4.53 num_segments=256 num_words=200
2020-06-10 12:29:19,236: 1) loss=0.203 grad_norm=3.00 num_segments=256 num_words=204
2020-06-10 12:29:27,642: 32) loss=0.230 grad_norm=3.36 num_segments=256 num_words=216
2020-06-10 12:30:26,450: 2) loss=0.231 grad_norm=3.35 num_segments=256 num_words=209
2020-06-10 12:30:39,112: 33) loss=0.395 grad_norm=4.16 num_segments=256 num_words=206
2020-06-10 12:31:33,249: 3) loss=0.296 grad_norm=3.62 num_segments=256 num_words=209
2020-06-10 12:31:50,388: 34) loss=0.585 grad_norm=4.23 num_segments=256 num_words=214
2020-06-10 12:32:42,851: 4) loss=0.221 grad_norm=3.59 num_segments=256 num_words=206
2020-06-10 12:33:04,546: 35) loss=0.328 grad_norm=3.18 num_segments=256 num_words=205
2020-06-10 12:33:55,200: 5) loss=0.257 grad_norm=3.21 num_segments=256 num_words=214
2020-06-10 12:34:17,293: 36) loss=0.219 grad_norm=5.02 num_segments=256 num_words=208
2020-06-10 12:35:02,419: 6) loss=0.212 grad_norm=3.45 num_segments=256 num_words=217
2020-06-10 12:35:29,303: 37) loss=0.211 grad_norm=3.15 num_segments=256 num_words=203
2020-06-10 12:36:11,446: 7) loss=0.414 grad_norm=5.11 num_segments=256 num_words=208
2020-06-10 12:36:34,846: 38) loss=0.553 grad_norm=4.31 num_segments=243 num_words=206
2020-06-10 12:36:34,857: epoch= 50.00
2020-06-10 12:36:34,857:  >> time to evaluate and save:
2020-06-10 12:36:34,863: saved MultiViewDataset_IndividualWords successfully
2020-06-10 12:36:34,887: saved MultiViewRNN successfully
2020-06-10 12:36:34,909: saved Adam successfully
2020-06-10 12:36:34,911: saved ReduceLROnPlateau successfully
2020-06-10 12:36:34,912: saved config successfully
2020-06-10 12:37:19,188: 8) loss=0.221 grad_norm=4.08 num_segments=256 num_words=218
2020-06-10 12:38:06,830:   >> crossview_ap=0.615 (10966 x 3921 pairs)
2020-06-10 12:39:10,072:   >> acoustic_ap=0.740 (10966 choose 2 pairs)
2020-06-10 12:39:10,078: best_so_far= 0.615 at 1911
2020-06-10 12:39:11,580: epoch=50.00 global_step=1950 lr=1e-05 start_iter=0
2020-06-10 12:39:11,580: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 12:39:25,574: 9) loss=0.207 grad_norm=3.15 num_segments=256 num_words=206
2020-06-10 12:40:26,345: 0) loss=0.240 grad_norm=3.37 num_segments=256 num_words=210
2020-06-10 12:40:36,136: 10) loss=0.327 grad_norm=4.09 num_segments=256 num_words=189
2020-06-10 12:41:39,064: 1) loss=0.203 grad_norm=3.00 num_segments=256 num_words=204
2020-06-10 12:41:54,239: 11) loss=0.212 grad_norm=3.04 num_segments=256 num_words=205
2020-06-10 12:42:50,938: 2) loss=0.231 grad_norm=3.35 num_segments=256 num_words=209
2020-06-10 12:43:03,386: 12) loss=0.246 grad_norm=4.75 num_segments=256 num_words=219
2020-06-10 12:44:02,615: 3) loss=0.296 grad_norm=3.62 num_segments=256 num_words=209
2020-06-10 12:44:11,120: 13) loss=0.208 grad_norm=2.91 num_segments=256 num_words=215
2020-06-10 12:45:14,386: 4) loss=0.221 grad_norm=3.59 num_segments=256 num_words=206

2020-06-10 12:46:26,335: 5) loss=0.257 grad_norm=3.21 num_segments=256 num_words=214

2020-06-10 12:47:35,545: 16) loss=0.301 grad_norm=4.25 num_segments=256 num_words=221
2020-06-10 12:47:38,251: 6) loss=0.212 grad_norm=3.45 num_segments=256 num_words=217
2020-06-10 12:48:43,444: 17) loss=0.231 grad_norm=3.61 num_segments=256 num_words=207
2020-06-10 12:48:49,706: 7) loss=0.414 grad_norm=5.11 num_segments=256 num_words=208
2020-06-10 12:49:51,172: 18) loss=0.293 grad_norm=3.47 num_segments=256 num_words=200
2020-06-10 12:50:01,757: 8) loss=0.221 grad_norm=4.08 num_segments=256 num_words=218
2020-06-10 12:50:59,343: 19) loss=0.341 grad_norm=4.02 num_segments=256 num_words=205
2020-06-10 12:52:07,960: 20) loss=0.207 grad_norm=3.36 num_segments=256 num_words=218
2020-06-10 12:53:16,637: 21) loss=0.514 grad_norm=5.84 num_segments=256 num_words=209
2020-06-10 12:54:24,826: 22) loss=0.196 grad_norm=3.01 num_segments=256 num_words=216
2020-06-10 12:54:44,375: 11) loss=0.212 grad_norm=3.04 num_segments=256 num_words=205
2020-06-10 12:55:32,985: 23) loss=0.286 grad_norm=3.96 num_segments=256 num_words=218
2020-06-10 12:55:57,657: 12) loss=0.246 grad_norm=4.75 num_segments=256 num_words=219
2020-06-10 12:57:10,199: 13) loss=0.208 grad_norm=2.91 num_segments=256 num_words=215
2020-06-10 12:57:50,902: 25) loss=0.303 grad_norm=3.77 num_segments=256 num_words=215
2020-06-10 12:58:22,864: 14) loss=0.204 grad_norm=3.40 num_segments=256 num_words=215
2020-06-10 12:59:00,069: 26) loss=0.271 grad_norm=4.08 num_segments=256 num_words=215
                                                                                      2020-06-10 13:00:08,274: 27) loss=0.237 grad_norm=3.49 num_segments=256 num_words=210
                                                                                      2020-06-10 13:01:16,565: 28) loss=0.339 grad_norm=4.40 num_segments=256 num_words=216
                                                                                      2020-06-10 13:02:24,677: 29) loss=0.206 grad_norm=3.16 num_segments=256 num_words=204
                                                                                      2020-06-10 13:03:32,823: 30) loss=0.271 grad_norm=4.20 num_segments=256 num_words=210
                                                                                      2020-06-10 13:04:40,902: 31) loss=0.229 grad_norm=3.61 num_segments=256 num_words=204
                                                                                      2020-06-10 13:05:49,318: 32) loss=0.247 grad_norm=3.69 num_segments=256 num_words=218
2020-06-10 13:06:57,104: 33) loss=0.279 grad_norm=4.43 num_segments=256 num_words=223
2020-06-10 13:08:05,233: 34) loss=0.238 grad_norm=3.81 num_segments=256 num_words=214
2020-06-10 13:09:12,569: 35) loss=0.200 grad_norm=3.06 num_segments=256 num_words=205
                                                                                      2020-06-10 13:10:20,453: 36) loss=0.237 grad_norm=4.14 num_segments=256 num_words=217
2020-06-10 13:11:29,833: 37) loss=0.300 grad_norm=4.15 num_segments=256 num_words=215
                                                                                      2020-06-10 13:12:34,030: 38) loss=0.365 grad_norm=3.85 num_segments=243 num_words=200
2020-06-10 13:12:34,047: epoch= 51.00
2020-06-10 13:12:34,047:  >> time to evaluate and save:
2020-06-10 13:12:34,103: saved save/MultiViewDataset_IndividualWords.1989.pth
2020-06-10 13:12:34,105: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 13:12:34,115: removed save/MultiViewDataset_IndividualWords.1755.pth
2020-06-10 13:12:34,115: saved MultiViewDataset_IndividualWords successfully
2020-06-10 13:12:35,586: saved save/MultiViewRNN.1989.pth
2020-06-10 13:12:35,588: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 13:12:35,650: removed save/MultiViewRNN.1755.pth
2020-06-10 13:12:35,650: saved MultiViewRNN successfully
2020-06-10 13:12:38,250: saved save/Adam.1989.pth
2020-06-10 13:12:38,295: most_recent linked save/Adam.most_recent.pth
2020-06-10 13:12:38,339: removed save/Adam.1755.pth
2020-06-10 13:12:38,340: saved Adam successfully
2020-06-10 13:12:38,342: saved save/ReduceLROnPlateau.1989.pth
2020-06-10 13:12:38,343: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 13:12:38,356: removed save/ReduceLROnPlateau.1755.pth
2020-06-10 13:12:38,357: saved ReduceLROnPlateau successfully
2020-06-10 13:12:38,358: saved config successfully
2020-06-10 13:13:09,726: 26) loss=0.271 grad_norm=4.08 num_segments=256 num_words=215
2020-06-10 13:14:14,530: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-10 13:14:14,572: Using 1 GPU(s)
2020-06-10 13:14:14,572: Machine: 0 / 1
2020-06-10 13:14:14,599: Hyperparam tuning-------------------
2020-06-10 13:14:14,600: optim_lr: 0.001
2020-06-10 13:14:14,600: dropout (for both): 0.4
2020-06-10 13:14:14,600: margin: 0.4
2020-06-10 13:14:14,600: ------------------------------------
2020-06-10 13:14:14,602: Calling main function: multiview_trainer.train
2020-06-10 13:14:14,602: Using config file: train_config.json
2020-06-10 13:14:14,602: Using module at multiview_trainer.train
2020-06-10 13:14:15,238: Using module at multiview_vocab.MultiViewVocab
2020-06-10 13:14:15,361: Building vocab_data from config
2020-06-10 13:14:15,658:  >> min_count= 0
2020-06-10 13:14:15,658:  >> # words= 34323 (# removed= 0)
2020-06-10 13:14:15,658:  >> # subwords= 38
2020-06-10 13:14:15,658:      = 1
2020-06-10 13:14:15,658:     '= 2
2020-06-10 13:14:15,658:     -= 3
2020-06-10 13:14:15,659:     .= 4
2020-06-10 13:14:15,659:     <= 5
2020-06-10 13:14:15,659:     >= 6
2020-06-10 13:14:15,659:     [= 7
2020-06-10 13:14:15,659:     [laughter]= 8
2020-06-10 13:14:15,659:     [noise]= 9
2020-06-10 13:14:15,659:     [vocalized-noise]= 10
2020-06-10 13:14:15,659:     ]= 11
2020-06-10 13:14:15,659:     _= 12
2020-06-10 13:14:15,659:     a= 13
2020-06-10 13:14:15,659:     b= 14
2020-06-10 13:14:15,659:     c= 15
2020-06-10 13:14:15,659:     d= 16
2020-06-10 13:14:15,660:     e= 17
2020-06-10 13:14:15,660:     f= 18
2020-06-10 13:14:15,660:     g= 19
2020-06-10 13:14:15,660:     h= 20
2020-06-10 13:14:15,660:     i= 21
2020-06-10 13:14:15,660:     j= 22
2020-06-10 13:14:15,660:     k= 23
2020-06-10 13:14:15,660:     l= 24
2020-06-10 13:14:15,660:     m= 25
2020-06-10 13:14:15,660:     n= 26
2020-06-10 13:14:15,660:     o= 27
2020-06-10 13:14:15,660:     p= 28
2020-06-10 13:14:15,660:     q= 29
2020-06-10 13:14:15,661:     r= 30
2020-06-10 13:14:15,661:     s= 31
2020-06-10 13:14:15,661:     t= 32
2020-06-10 13:14:15,661:     u= 33
2020-06-10 13:14:15,661:     v= 34
2020-06-10 13:14:15,661:     w= 35
2020-06-10 13:14:15,661:     x= 36
2020-06-10 13:14:15,661:     y= 37
2020-06-10 13:14:15,661:     z= 38
2020-06-10 13:14:15,677: Using module at data.batch_samplers.BatchSampler
2020-06-10 13:14:15,693: Building vocab_sampler from config
2020-06-10 13:14:15,693:  >> # examples= 34323
2020-06-10 13:14:15,693:  >> batch_size= 1000
2020-06-10 13:14:15,694:  >> shuffle= False
2020-06-10 13:14:15,701:  >> BatchSampler; 35 batches
2020-06-10 13:14:15,701: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 13:14:16,679: Building train_data from config
2020-06-10 13:14:25,630:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-10 13:14:25,631:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-10 13:14:25,631:  >> stack= False
2020-06-10 13:14:25,631:  >> seg_durs= (1, None)
2020-06-10 13:14:25,631:  >> # words= 9971 (# ignored= 0)
2020-06-10 13:14:25,632:  >> input_feat_dim= 108
2020-06-10 13:14:25,632:  >> input_num_subwords= 38
2020-06-10 13:14:25,632: Using module at data.batch_samplers.BatchSampler
2020-06-10 13:14:25,632: Building train_sampler from config
2020-06-10 13:14:25,634:  >> # examples= 9971
2020-06-10 13:14:25,634:  >> batch_size= 256
2020-06-10 13:14:25,634:  >> shuffle= True
2020-06-10 13:14:25,644:  >> BatchSampler; 39 batches
2020-06-10 13:14:25,644: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 13:14:25,644: Building dev_data from config
2020-06-10 13:14:35,555:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 13:14:35,556:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 13:14:35,556:  >> stack= False
2020-06-10 13:14:35,556:  >> seg_durs= (1, None)
2020-06-10 13:14:35,556:  >> # words= 10966 (# ignored= 0)
2020-06-10 13:14:35,556:  >> input_feat_dim= 108
2020-06-10 13:14:35,556:  >> input_num_subwords= 38
2020-06-10 13:14:35,556: Using module at data.batch_samplers.BatchSampler
2020-06-10 13:14:35,556: Building dev_sampler from config
2020-06-10 13:14:35,557:  >> # examples= 10966
2020-06-10 13:14:35,557:  >> batch_size= 256
2020-06-10 13:14:35,557:  >> shuffle= False
2020-06-10 13:14:35,560:  >> BatchSampler; 43 batches
2020-06-10 13:14:35,560: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 13:14:35,560: Building test_data from config
2020-06-10 13:14:43,991:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 13:14:43,999:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 13:14:44,000:  >> stack= False
2020-06-10 13:14:44,000:  >> seg_durs= (1, None)
2020-06-10 13:14:44,000:  >> # words= 11024 (# ignored= 0)
2020-06-10 13:14:44,000:  >> input_feat_dim= 108
2020-06-10 13:14:44,000:  >> input_num_subwords= 38
2020-06-10 13:14:44,000: Using module at data.batch_samplers.BatchSampler
2020-06-10 13:14:44,000: Building test_sampler from config
2020-06-10 13:14:44,001:  >> # examples= 11024
2020-06-10 13:14:44,001:  >> batch_size= 256
2020-06-10 13:14:44,001:  >> shuffle= False
2020-06-10 13:14:44,004:  >> BatchSampler; 44 batches
2020-06-10 13:14:44,004: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-10 13:14:44,064: Building loss from config
2020-06-10 13:14:44,065:  >> margin= 0.4
2020-06-10 13:14:44,065:  >> k= 16
2020-06-10 13:14:44,065:  >> min_k= 8
2020-06-10 13:14:44,065:  >> extra= 0
2020-06-10 13:14:44,065:  >> average= False
2020-06-10 13:14:44,065:  >> margin_max= 0.5
2020-06-10 13:14:44,065:  >> threshold_max= 9
2020-06-10 13:14:44,065:  >> using obj0
2020-06-10 13:14:44,066: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 13:14:44,177: Building eval from config
2020-06-10 13:14:44,178:  >> acoustic_ap= True
2020-06-10 13:14:44,178:  >> crossview_ap= True
2020-06-10 13:14:44,178:  >> full_vocab= False
2020-06-10 13:14:44,178:  >> metric= crossview_ap
2020-06-10 13:14:44,178:  >> mode= max
2020-06-10 13:14:44,178: Using module at multiview_rnn.MultiViewRNN
2020-06-10 13:14:44,239: Building net from config
2020-06-10 13:14:44,241: view1:
2020-06-10 13:14:44,242:  >> cell= GRU
2020-06-10 13:14:44,242:  >> input_size= 108
2020-06-10 13:14:44,242:  >> hidden_size= 512
2020-06-10 13:14:44,242:  >> bidirectional= True
2020-06-10 13:14:44,242:  >> num_layers= 6
2020-06-10 13:14:44,242:  >> dropout between layers= 0.4
2020-06-10 13:14:44,485: view2:
2020-06-10 13:14:44,486:  >> cell= GRU
2020-06-10 13:14:44,486:  >> input_size= 64
2020-06-10 13:14:44,486:  >> hidden_size= 512
2020-06-10 13:14:44,486:  >> bidirectional= True
2020-06-10 13:14:44,486:  >> num_layers= 2
2020-06-10 13:14:44,487:  >> dropout between layers= 0.4
2020-06-10 13:14:44,487:  >> num input embeddings= 38
2020-06-10 13:14:48,546: Using module at optim.adam.Adam
2020-06-10 13:14:48,581: Building optim from config
2020-06-10 13:14:48,582:  >> lr= 0.001
2020-06-10 13:14:48,582:  >> betas= (0.9, 0.999)
2020-06-10 13:14:48,582:  >> eps= 1e-08
2020-06-10 13:14:48,582:  >> weight_decay= 0
2020-06-10 13:14:48,582:  >> amsgrad= False
2020-06-10 13:14:48,582:  >> min_lr= 1e-07
2020-06-10 13:14:48,584: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-10 13:14:48,619: Building sched from config
2020-06-10 13:14:48,619:  >> optim= Adam
2020-06-10 13:14:48,619:  >> decay lr by 0.1
2020-06-10 13:14:48,619:  >> eval_fn= MultiViewAP
2020-06-10 13:14:48,620:  >> patience=4
2020-06-10 13:14:48,620:  >> revert=True
2020-06-10 13:14:48,631: loaded save/MultiViewDataset_IndividualWords.1989.pth
2020-06-10 13:14:48,631: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-10 13:14:49,795: loaded save/MultiViewRNN.1989.pth
2020-06-10 13:14:49,795: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-10 13:14:52,040: loaded save/Adam.1989.pth
2020-06-10 13:14:52,041: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-10 13:14:52,043: loaded save/ReduceLROnPlateau.1989.pth
2020-06-10 13:14:52,044: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-10 13:14:52,044: epoch=51.00 global_step=1989 lr=1e-05 start_iter=0
2020-06-10 13:14:52,044: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 13:18:24,793: 0) loss=0.235 grad_norm=2.71 num_segments=256 num_words=209
2020-06-10 13:21:38,054: 1) loss=0.280 grad_norm=2.88 num_segments=256 num_words=211
2020-06-10 13:24:38,586: 2) loss=0.238 grad_norm=3.30 num_segments=256 num_words=201
2020-06-10 13:27:25,141: 3) loss=0.228 grad_norm=3.53 num_segments=256 num_words=211
2020-06-10 13:29:58,466: 4) loss=0.244 grad_norm=3.55 num_segments=256 num_words=219
2020-06-10 13:32:17,497: 5) loss=0.419 grad_norm=3.81 num_segments=256 num_words=200
2020-06-10 13:34:20,302: 6) loss=0.371 grad_norm=3.64 num_segments=256 num_words=211
2020-06-10 13:36:11,906: 7) loss=0.335 grad_norm=3.42 num_segments=256 num_words=209
2020-06-10 13:38:04,817: 8) loss=0.440 grad_norm=6.18 num_segments=256 num_words=215
2020-06-10 13:39:54,060: 9) loss=0.415 grad_norm=6.14 num_segments=256 num_words=206
2020-06-10 13:41:47,240: 10) loss=0.246 grad_norm=3.41 num_segments=256 num_words=207
2020-06-10 13:43:36,794: 11) loss=0.251 grad_norm=4.31 num_segments=256 num_words=207
2020-06-10 13:45:25,830: 12) loss=0.251 grad_norm=3.66 num_segments=256 num_words=214
2020-06-10 13:47:16,897: 13) loss=0.233 grad_norm=4.37 num_segments=256 num_words=212
2020-06-10 13:49:12,500: 14) loss=0.308 grad_norm=3.37 num_segments=256 num_words=214
2020-06-10 13:51:02,033: 15) loss=0.229 grad_norm=3.96 num_segments=256 num_words=211
2020-06-10 13:52:51,056: 16) loss=0.369 grad_norm=5.19 num_segments=256 num_words=202
2020-06-10 13:54:40,991: 17) loss=0.418 grad_norm=4.86 num_segments=256 num_words=214
2020-06-10 13:56:29,973: 18) loss=0.251 grad_norm=4.80 num_segments=256 num_words=223
2020-06-10 13:58:24,473: 19) loss=0.286 grad_norm=3.78 num_segments=256 num_words=211
2020-06-10 14:00:13,239: 20) loss=0.277 grad_norm=4.07 num_segments=256 num_words=214
2020-06-10 14:02:02,242: 21) loss=0.324 grad_norm=4.28 num_segments=256 num_words=223
2020-06-10 14:03:51,070: 22) loss=0.418 grad_norm=4.30 num_segments=256 num_words=204
2020-06-10 14:05:37,191: 23) loss=0.352 grad_norm=5.38 num_segments=256 num_words=213
2020-06-10 14:07:29,399: 24) loss=0.230 grad_norm=3.72 num_segments=256 num_words=219
2020-06-10 14:09:14,856: 25) loss=0.350 grad_norm=3.64 num_segments=256 num_words=210
2020-06-10 14:11:00,457: 26) loss=0.287 grad_norm=3.65 num_segments=256 num_words=211
2020-06-10 14:12:46,580: 27) loss=0.486 grad_norm=3.13 num_segments=256 num_words=211
2020-06-10 14:14:33,839: 28) loss=0.328 grad_norm=3.22 num_segments=256 num_words=214
2020-06-10 14:16:20,583: 29) loss=0.599 grad_norm=5.11 num_segments=256 num_words=221
2020-06-10 14:18:07,631: 30) loss=0.337 grad_norm=3.71 num_segments=256 num_words=210
2020-06-10 14:20:01,441: 31) loss=0.221 grad_norm=3.60 num_segments=256 num_words=211
2020-06-10 14:21:45,997: 32) loss=0.278 grad_norm=4.47 num_segments=256 num_words=201
2020-06-10 14:23:34,951: 33) loss=0.337 grad_norm=3.73 num_segments=256 num_words=210
2020-06-10 14:25:25,953: 34) loss=0.273 grad_norm=3.44 num_segments=256 num_words=212
2020-06-10 14:27:18,191: 35) loss=0.562 grad_norm=4.96 num_segments=256 num_words=207
2020-06-10 14:29:09,407: 36) loss=0.204 grad_norm=3.12 num_segments=256 num_words=201
2020-06-10 14:31:01,359: 37) loss=0.356 grad_norm=4.18 num_segments=256 num_words=213
2020-06-10 14:32:42,104: 38) loss=0.258 grad_norm=4.63 num_segments=243 num_words=205
2020-06-10 14:32:42,124: epoch= 52.00
2020-06-10 14:32:42,125:  >> time to evaluate and save:
2020-06-10 14:32:42,177: saved save/MultiViewDataset_IndividualWords.2028.pth
2020-06-10 14:32:42,198: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 14:32:42,237: removed save/MultiViewDataset_IndividualWords.1794.pth
2020-06-10 14:32:42,237: saved MultiViewDataset_IndividualWords successfully
2020-06-10 14:32:43,697: saved save/MultiViewRNN.2028.pth
2020-06-10 14:32:44,156: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 14:32:44,723: removed save/MultiViewRNN.1794.pth
2020-06-10 14:32:44,723: saved MultiViewRNN successfully
2020-06-10 14:32:47,303: saved save/Adam.2028.pth
2020-06-10 14:32:47,318: most_recent linked save/Adam.most_recent.pth
2020-06-10 14:32:47,919: removed save/Adam.1794.pth
2020-06-10 14:32:47,919: saved Adam successfully
2020-06-10 14:32:47,921: saved save/ReduceLROnPlateau.2028.pth
2020-06-10 14:32:47,930: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 14:32:47,965: removed save/ReduceLROnPlateau.1794.pth
2020-06-10 14:32:47,965: saved ReduceLROnPlateau successfully
2020-06-10 14:32:47,968: saved config successfully
2020-06-10 14:34:42,231:   >> crossview_ap=0.615 (10966 x 3921 pairs)
2020-06-10 14:35:54,933:   >> acoustic_ap=0.740 (10966 choose 2 pairs)
2020-06-10 14:35:54,937: best_so_far= 0.615 at 1911
2020-06-10 14:35:54,986: epoch=52.00 global_step=2028 lr=1e-05 start_iter=0
2020-06-10 14:35:54,987: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 14:37:48,319: 0) loss=0.241 grad_norm=3.20 num_segments=256 num_words=197
2020-06-10 14:39:54,488: 1) loss=0.419 grad_norm=5.10 num_segments=256 num_words=208
2020-06-10 14:41:47,030: 2) loss=0.391 grad_norm=4.23 num_segments=256 num_words=221
2020-06-10 14:43:38,238: 3) loss=0.407 grad_norm=4.83 num_segments=256 num_words=209
2020-06-10 14:45:29,409: 4) loss=0.227 grad_norm=3.48 num_segments=256 num_words=218
2020-06-10 14:47:22,636: 5) loss=0.227 grad_norm=3.49 num_segments=256 num_words=218
2020-06-10 14:49:13,359: 6) loss=0.288 grad_norm=4.06 num_segments=256 num_words=208
2020-06-10 14:51:05,000: 7) loss=0.451 grad_norm=4.52 num_segments=256 num_words=213
2020-06-10 14:52:57,804: 8) loss=0.237 grad_norm=3.40 num_segments=256 num_words=209
2020-06-10 14:54:50,541: 9) loss=0.241 grad_norm=3.93 num_segments=256 num_words=213
2020-06-10 14:56:43,666: 10) loss=0.251 grad_norm=3.72 num_segments=256 num_words=218
2020-06-10 14:58:36,784: 11) loss=0.265 grad_norm=4.10 num_segments=256 num_words=213
2020-06-10 15:00:44,433: 12) loss=0.315 grad_norm=4.10 num_segments=256 num_words=210
2020-06-10 15:02:36,038: 13) loss=0.407 grad_norm=4.32 num_segments=256 num_words=204
2020-06-10 15:04:29,284: 14) loss=0.306 grad_norm=3.28 num_segments=256 num_words=216
2020-06-10 15:06:22,939: 15) loss=0.281 grad_norm=5.20 num_segments=256 num_words=208
2020-06-10 15:08:16,453: 16) loss=0.290 grad_norm=4.77 num_segments=256 num_words=204
2020-06-10 15:10:08,995: 17) loss=0.324 grad_norm=4.11 num_segments=256 num_words=212
2020-06-10 15:12:00,977: 18) loss=0.328 grad_norm=4.13 num_segments=256 num_words=215
2020-06-10 15:13:54,482: 19) loss=0.183 grad_norm=3.31 num_segments=256 num_words=206
2020-06-10 15:15:47,532: 20) loss=0.390 grad_norm=4.31 num_segments=256 num_words=209
2020-06-10 15:17:40,216: 21) loss=0.261 grad_norm=4.55 num_segments=256 num_words=219
2020-06-10 15:19:32,823: 22) loss=0.330 grad_norm=3.58 num_segments=256 num_words=204
2020-06-10 15:21:24,120: 23) loss=0.365 grad_norm=3.81 num_segments=256 num_words=217
2020-06-10 15:23:17,549: 24) loss=0.281 grad_norm=4.76 num_segments=256 num_words=209
2020-06-10 15:25:11,262: 25) loss=0.374 grad_norm=4.15 num_segments=256 num_words=196
2020-06-10 15:27:22,270: 26) loss=0.420 grad_norm=4.50 num_segments=256 num_words=204
2020-06-10 15:29:13,474: 27) loss=0.244 grad_norm=3.22 num_segments=256 num_words=213
2020-06-10 15:31:05,845: 28) loss=0.372 grad_norm=4.37 num_segments=256 num_words=216
2020-06-10 15:32:57,837: 29) loss=0.216 grad_norm=3.16 num_segments=256 num_words=216
2020-06-10 15:34:51,643: 30) loss=0.303 grad_norm=3.59 num_segments=256 num_words=204
2020-06-10 15:36:44,941: 31) loss=0.194 grad_norm=3.69 num_segments=256 num_words=211
2020-06-10 15:38:38,221: 32) loss=0.207 grad_norm=3.72 num_segments=256 num_words=205
2020-06-10 15:40:30,710: 33) loss=0.316 grad_norm=3.97 num_segments=256 num_words=205
2020-06-10 15:42:21,678: 34) loss=0.289 grad_norm=3.73 num_segments=256 num_words=228
2020-06-10 15:44:11,965: 35) loss=0.233 grad_norm=3.15 num_segments=256 num_words=214
2020-06-10 15:46:02,299: 36) loss=0.243 grad_norm=3.32 num_segments=256 num_words=210
2020-06-10 15:47:52,895: 37) loss=0.229 grad_norm=3.43 num_segments=256 num_words=209
2020-06-10 15:49:32,502: 38) loss=0.322 grad_norm=4.53 num_segments=243 num_words=203
2020-06-10 15:49:32,521: epoch= 53.00
2020-06-10 15:49:32,522:  >> time to evaluate and save:
2020-06-10 15:49:32,581: saved save/MultiViewDataset_IndividualWords.2067.pth
2020-06-10 15:49:32,607: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 15:49:32,646: removed save/MultiViewDataset_IndividualWords.1833.pth
2020-06-10 15:49:32,646: saved MultiViewDataset_IndividualWords successfully
2020-06-10 15:49:34,026: saved save/MultiViewRNN.2067.pth
2020-06-10 15:49:34,038: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 15:49:34,066: removed save/MultiViewRNN.1833.pth
2020-06-10 15:49:34,066: saved MultiViewRNN successfully
2020-06-10 15:49:36,583: saved save/Adam.2067.pth
2020-06-10 15:49:36,594: most_recent linked save/Adam.most_recent.pth
2020-06-10 15:49:36,644: removed save/Adam.1833.pth
2020-06-10 15:49:36,644: saved Adam successfully
2020-06-10 15:49:36,647: saved save/ReduceLROnPlateau.2067.pth
2020-06-10 15:49:36,661: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 15:49:36,686: removed save/ReduceLROnPlateau.1833.pth
2020-06-10 15:49:36,686: saved ReduceLROnPlateau successfully
2020-06-10 15:49:36,688: saved config successfully
2020-06-10 15:51:34,986:   >> crossview_ap=0.615 (10966 x 3921 pairs)
2020-06-10 15:52:57,995:   >> acoustic_ap=0.740 (10966 choose 2 pairs)
2020-06-10 15:52:58,001: best_so_far= 0.615 at 1911
2020-06-10 15:52:58,756: epoch=53.00 global_step=2067 lr=1e-05 start_iter=0
2020-06-10 15:52:58,756: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 15:54:51,649: 0) loss=0.197 grad_norm=3.14 num_segments=256 num_words=223
2020-06-10 15:56:41,921: 1) loss=0.226 grad_norm=3.31 num_segments=256 num_words=208
2020-06-10 15:58:32,444: 2) loss=0.333 grad_norm=4.47 num_segments=256 num_words=217
2020-06-10 16:00:25,388: 3) loss=0.275 grad_norm=3.75 num_segments=256 num_words=216
2020-06-10 16:02:16,677: 4) loss=0.347 grad_norm=3.88 num_segments=256 num_words=221
2020-06-10 16:04:35,368: 5) loss=0.413 grad_norm=4.26 num_segments=256 num_words=214
2020-06-10 16:06:24,045: 6) loss=0.337 grad_norm=3.58 num_segments=256 num_words=213
2020-06-10 16:08:13,424: 7) loss=0.245 grad_norm=3.03 num_segments=256 num_words=205
2020-06-10 16:10:02,495: 8) loss=0.341 grad_norm=4.68 num_segments=256 num_words=215
2020-06-10 16:11:51,416: 9) loss=0.300 grad_norm=4.60 num_segments=256 num_words=204
2020-06-10 16:13:40,233: 10) loss=0.320 grad_norm=3.93 num_segments=256 num_words=218
2020-06-10 16:15:28,351: 11) loss=0.280 grad_norm=3.59 num_segments=256 num_words=201
2020-06-10 16:17:16,930: 12) loss=0.312 grad_norm=4.19 num_segments=256 num_words=209
2020-06-10 16:19:04,870: 13) loss=0.336 grad_norm=4.17 num_segments=256 num_words=227
2020-06-10 16:20:52,737: 14) loss=0.230 grad_norm=3.43 num_segments=256 num_words=217
2020-06-10 16:22:40,027: 15) loss=0.291 grad_norm=4.41 num_segments=256 num_words=215
2020-06-10 16:24:27,033: 16) loss=0.390 grad_norm=4.65 num_segments=256 num_words=200
2020-06-10 16:26:14,160: 17) loss=0.329 grad_norm=4.08 num_segments=256 num_words=201
2020-06-10 16:28:00,910: 18) loss=0.361 grad_norm=4.75 num_segments=256 num_words=210
2020-06-10 16:29:48,777: 19) loss=0.267 grad_norm=3.37 num_segments=256 num_words=204
2020-06-10 16:31:36,837: 20) loss=0.321 grad_norm=3.48 num_segments=256 num_words=219
2020-06-10 16:33:24,324: 21) loss=0.299 grad_norm=3.86 num_segments=256 num_words=219
2020-06-10 16:35:12,271: 22) loss=0.269 grad_norm=4.05 num_segments=256 num_words=210
2020-06-10 16:36:59,320: 23) loss=0.240 grad_norm=4.22 num_segments=256 num_words=205
2020-06-10 16:38:46,878: 24) loss=0.339 grad_norm=4.61 num_segments=256 num_words=210
2020-06-10 16:40:34,592: 25) loss=0.203 grad_norm=3.22 num_segments=256 num_words=213
2020-06-10 16:43:00,979: 26) loss=0.254 grad_norm=3.40 num_segments=256 num_words=209
2020-06-10 16:44:48,193: 27) loss=0.278 grad_norm=4.05 num_segments=256 num_words=221
2020-06-10 16:46:34,992: 28) loss=0.379 grad_norm=4.51 num_segments=256 num_words=214
2020-06-10 16:48:20,179: 29) loss=0.361 grad_norm=3.81 num_segments=256 num_words=209
2020-06-10 16:50:06,101: 30) loss=0.199 grad_norm=3.13 num_segments=256 num_words=211
2020-06-10 16:51:51,640: 31) loss=0.206 grad_norm=3.26 num_segments=256 num_words=216
2020-06-10 16:53:36,742: 32) loss=0.341 grad_norm=3.77 num_segments=256 num_words=202
2020-06-10 16:55:22,474: 33) loss=0.277 grad_norm=3.78 num_segments=256 num_words=210
2020-06-10 16:57:07,191: 34) loss=0.352 grad_norm=4.52 num_segments=256 num_words=212
2020-06-10 16:58:52,744: 35) loss=0.279 grad_norm=3.92 num_segments=256 num_words=200
2020-06-10 17:00:37,955: 36) loss=0.282 grad_norm=3.61 num_segments=256 num_words=213
2020-06-10 17:02:23,466: 37) loss=0.260 grad_norm=3.79 num_segments=256 num_words=215
2020-06-10 17:03:58,419: 38) loss=0.310 grad_norm=4.35 num_segments=243 num_words=201
2020-06-10 17:03:58,440: epoch= 54.00
2020-06-10 17:03:58,440:  >> time to evaluate and save:
2020-06-10 17:03:58,519: saved save/MultiViewDataset_IndividualWords.2106.pth
2020-06-10 17:03:58,555: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 17:03:58,663: removed save/MultiViewDataset_IndividualWords.1872.pth
2020-06-10 17:03:58,663: saved MultiViewDataset_IndividualWords successfully
2020-06-10 17:04:00,428: saved save/MultiViewRNN.2106.pth
2020-06-10 17:04:00,446: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 17:04:00,490: removed save/MultiViewRNN.1872.pth
2020-06-10 17:04:00,490: saved MultiViewRNN successfully
2020-06-10 17:04:03,679: saved save/Adam.2106.pth
2020-06-10 17:04:03,689: most_recent linked save/Adam.most_recent.pth
2020-06-10 17:04:03,767: removed save/Adam.1872.pth
2020-06-10 17:04:03,767: saved Adam successfully
2020-06-10 17:04:03,770: saved save/ReduceLROnPlateau.2106.pth
2020-06-10 17:04:03,778: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 17:04:03,789: removed save/ReduceLROnPlateau.1872.pth
2020-06-10 17:04:03,789: saved ReduceLROnPlateau successfully
2020-06-10 17:04:03,791: saved config successfully
2020-06-10 17:05:48,419:   >> crossview_ap=0.615 (10966 x 3921 pairs)
2020-06-10 17:06:50,421:   >> acoustic_ap=0.740 (10966 choose 2 pairs)
2020-06-10 17:06:50,428: best_so_far= 0.615 at 1911
2020-06-10 17:06:50,429: Reverting to previous best
2020-06-10 17:06:52,373: loaded save/MultiViewRNN.1911.pth
2020-06-10 17:06:52,373: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-10 17:06:55,164: loaded save/Adam.1911.pth
2020-06-10 17:06:55,166: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-10 17:06:55,166: Reducing group lr from 1e-05 to 1.0000000000000002e-06
2020-06-10 17:06:55,257: best linked save/Adam.best.pth
2020-06-10 17:06:56,510: epoch=54.00 global_step=2106 lr=1.0000000000000002e-06 start_iter=0
2020-06-10 17:06:56,511: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 17:08:36,336: 0) loss=0.252 grad_norm=4.18 num_segments=256 num_words=203
2020-06-10 17:10:13,953: 1) loss=0.221 grad_norm=3.59 num_segments=256 num_words=207
2020-06-10 17:11:50,567: 2) loss=0.225 grad_norm=3.61 num_segments=256 num_words=217
2020-06-10 17:13:27,310: 3) loss=0.241 grad_norm=3.90 num_segments=256 num_words=215
2020-06-10 19:53:18,803: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-10 19:53:18,855: Using 1 GPU(s)
2020-06-10 19:53:18,855: Machine: 0 / 1
2020-06-10 19:53:18,856: Hyperparam tuning-------------------
2020-06-10 19:53:18,857: optim_lr: 0.001
2020-06-10 19:53:18,857: dropout (for both): 0.4
2020-06-10 19:53:18,857: margin: 0.4
2020-06-10 19:53:18,857: ------------------------------------
2020-06-10 19:53:18,857: Calling main function: multiview_evaluator.evaluate
2020-06-10 19:53:18,857: Using config file: eval_config.json
2020-06-10 19:53:18,857: Using module at multiview_evaluator.evaluate
2020-06-10 19:53:18,903: Using module at multiview_vocab.MultiViewVocab
2020-06-10 19:53:18,948: Building vocab_data from config
2020-06-10 19:53:19,203:  >> min_count= 0
2020-06-10 19:53:19,203:  >> # words= 34323 (# removed= 0)
2020-06-10 19:53:19,203:  >> # subwords= 38
2020-06-10 19:53:19,203:      = 1
2020-06-10 19:53:19,203:     '= 2
2020-06-10 19:53:19,203:     -= 3
2020-06-10 19:53:19,203:     .= 4
2020-06-10 19:53:19,203:     <= 5
2020-06-10 19:53:19,203:     >= 6
2020-06-10 19:53:19,203:     [= 7
2020-06-10 19:53:19,203:     [laughter]= 8
2020-06-10 19:53:19,203:     [noise]= 9
2020-06-10 19:53:19,203:     [vocalized-noise]= 10
2020-06-10 19:53:19,203:     ]= 11
2020-06-10 19:53:19,203:     _= 12
2020-06-10 19:53:19,204:     a= 13
2020-06-10 19:53:19,204:     b= 14
2020-06-10 19:53:19,204:     c= 15
2020-06-10 19:53:19,204:     d= 16
2020-06-10 19:53:19,204:     e= 17
2020-06-10 19:53:19,204:     f= 18
2020-06-10 19:53:19,204:     g= 19
2020-06-10 19:53:19,204:     h= 20
2020-06-10 19:53:19,204:     i= 21
2020-06-10 19:53:19,204:     j= 22
2020-06-10 19:53:19,204:     k= 23
2020-06-10 19:53:19,204:     l= 24
2020-06-10 19:53:19,204:     m= 25
2020-06-10 19:53:19,204:     n= 26
2020-06-10 19:53:19,204:     o= 27
2020-06-10 19:53:19,204:     p= 28
2020-06-10 19:53:19,204:     q= 29
2020-06-10 19:53:19,205:     r= 30
2020-06-10 19:53:19,205:     s= 31
2020-06-10 19:53:19,205:     t= 32
2020-06-10 19:53:19,205:     u= 33
2020-06-10 19:53:19,205:     v= 34
2020-06-10 19:53:19,205:     w= 35
2020-06-10 19:53:19,205:     x= 36
2020-06-10 19:53:19,205:     y= 37
2020-06-10 19:53:19,205:     z= 38
2020-06-10 19:53:19,221: Using module at data.batch_samplers.BatchSampler
2020-06-10 19:53:19,223: Building vocab_sampler from config
2020-06-10 19:53:19,223:  >> # examples= 34323
2020-06-10 19:53:19,224:  >> batch_size= 1000
2020-06-10 19:53:19,224:  >> shuffle= False
2020-06-10 19:53:19,231:  >> BatchSampler; 35 batches
2020-06-10 19:53:19,231: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 19:53:19,631: Building dev_data from config
2020-06-10 19:53:26,730:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 19:53:26,732:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 19:53:26,732:  >> stack= False
2020-06-10 19:53:26,732:  >> seg_durs= (1, None)
2020-06-10 19:53:26,732:  >> # words= 10966 (# ignored= 0)
2020-06-10 19:53:26,732:  >> input_feat_dim= 108
2020-06-10 19:53:26,732:  >> input_num_subwords= 38
2020-06-10 19:53:26,732: Using module at data.batch_samplers.BatchSampler
2020-06-10 19:53:26,732: Building dev_sampler from config
2020-06-10 19:53:26,733:  >> # examples= 10966
2020-06-10 19:53:26,733:  >> batch_size= 256
2020-06-10 19:53:26,733:  >> shuffle= False
2020-06-10 19:53:26,735:  >> BatchSampler; 43 batches
2020-06-10 19:53:26,735: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 19:53:26,735: Building test_data from config
2020-06-10 19:53:32,519:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 19:53:32,520:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 19:53:32,520:  >> stack= False
2020-06-10 19:53:32,520:  >> seg_durs= (1, None)
2020-06-10 19:53:32,520:  >> # words= 11024 (# ignored= 0)
2020-06-10 19:53:32,520:  >> input_feat_dim= 108
2020-06-10 19:53:32,520:  >> input_num_subwords= 38
2020-06-10 19:53:32,521: Using module at data.batch_samplers.BatchSampler
2020-06-10 19:53:32,521: Building test_sampler from config
2020-06-10 19:53:32,521:  >> # examples= 11024
2020-06-10 19:53:32,521:  >> batch_size= 256
2020-06-10 19:53:32,521:  >> shuffle= False
2020-06-10 19:53:32,524:  >> BatchSampler; 44 batches
2020-06-10 19:53:32,524: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 19:53:34,649: Building eval from config
2020-06-10 19:53:34,649:  >> acoustic_ap= True
2020-06-10 19:53:34,649:  >> crossview_ap= True
2020-06-10 19:53:34,649:  >> full_vocab= False
2020-06-10 19:53:34,649:  >> metric= crossview_ap
2020-06-10 19:53:34,649:  >> mode= max
2020-06-10 19:53:34,649: Using module at multiview_rnn.MultiViewRNN
2020-06-10 19:53:34,678: Building net from config
2020-06-10 19:53:34,680: view1:
2020-06-10 19:53:34,680:  >> cell= GRU
2020-06-10 19:53:34,680:  >> input_size= 108
2020-06-10 19:53:34,681:  >> hidden_size= 512
2020-06-10 19:53:34,681:  >> bidirectional= True
2020-06-10 19:53:34,681:  >> num_layers= 6
2020-06-10 19:53:34,681:  >> dropout between layers= 0.4
2020-06-10 19:53:34,910: view2:
2020-06-10 19:53:34,911:  >> cell= GRU
2020-06-10 19:53:34,911:  >> input_size= 64
2020-06-10 19:53:34,911:  >> hidden_size= 512
2020-06-10 19:53:34,911:  >> bidirectional= True
2020-06-10 19:53:34,911:  >> num_layers= 2
2020-06-10 19:53:34,911:  >> dropout between layers= 0.4
2020-06-10 19:53:34,912:  >> num input embeddings= 38
2020-06-10 19:53:40,154: loaded save/MultiViewRNN.1911.pth
2020-06-10 19:53:40,155: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-10 19:53:40,155: Evaluating best model on dev and test:
2020-06-10 19:53:40,155: dev score:
2020-06-10 19:55:02,250:   >> crossview_ap=0.615 (10966 x 3921 pairs)
2020-06-10 19:55:52,135:   >> acoustic_ap=0.741 (10966 choose 2 pairs)
2020-06-10 19:55:52,868: saved outputs to npz file successfully
2020-06-10 19:55:52,868: test score:
2020-06-10 19:57:06,474:   >> crossview_ap=0.689 (11024 x 3392 pairs)
2020-06-10 19:57:56,791:   >> acoustic_ap=0.806 (11024 choose 2 pairs)
2020-06-10 19:57:57,500: saved outputs to npz file successfully
2020-06-10 19:57:57,504: Hyperparam tuning-------------------
2020-06-10 19:57:57,504: optim_lr: 0.001
2020-06-10 19:57:57,504: dropout (for both): 0.4
2020-06-10 19:57:57,504: margin: 0.5
2020-06-10 19:57:57,504: ------------------------------------
2020-06-10 19:57:57,504: Calling main function: multiview_evaluator.evaluate
2020-06-10 19:57:57,504: Using config file: eval_config.json
2020-06-10 19:57:57,505: Using module at multiview_evaluator.evaluate
2020-06-10 19:57:57,505: Using module at multiview_vocab.MultiViewVocab
2020-06-10 19:57:57,505: Building vocab_data from config
2020-06-10 19:57:57,839:  >> min_count= 0
2020-06-10 19:57:57,839:  >> # words= 34323 (# removed= 0)
2020-06-10 19:57:57,839:  >> # subwords= 38
2020-06-10 19:57:57,839:      = 1
2020-06-10 19:57:57,839:     '= 2
2020-06-10 19:57:57,839:     -= 3
2020-06-10 19:57:57,839:     .= 4
2020-06-10 19:57:57,839:     <= 5
2020-06-10 19:57:57,839:     >= 6
2020-06-10 19:57:57,839:     [= 7
2020-06-10 19:57:57,839:     [laughter]= 8
2020-06-10 19:57:57,839:     [noise]= 9
2020-06-10 19:57:57,839:     [vocalized-noise]= 10
2020-06-10 19:57:57,840:     ]= 11
2020-06-10 19:57:57,840:     _= 12
2020-06-10 19:57:57,840:     a= 13
2020-06-10 19:57:57,840:     b= 14
2020-06-10 19:57:57,840:     c= 15
2020-06-10 19:57:57,840:     d= 16
2020-06-10 19:57:57,840:     e= 17
2020-06-10 19:57:57,840:     f= 18
2020-06-10 19:57:57,840:     g= 19
2020-06-10 19:57:57,840:     h= 20
2020-06-10 19:57:57,840:     i= 21
2020-06-10 19:57:57,840:     j= 22
2020-06-10 19:57:57,840:     k= 23
2020-06-10 19:57:57,840:     l= 24
2020-06-10 19:57:57,840:     m= 25
2020-06-10 19:57:57,840:     n= 26
2020-06-10 19:57:57,840:     o= 27
2020-06-10 19:57:57,840:     p= 28
2020-06-10 19:57:57,841:     q= 29
2020-06-10 19:57:57,841:     r= 30
2020-06-10 19:57:57,841:     s= 31
2020-06-10 19:57:57,841:     t= 32
2020-06-10 19:57:57,841:     u= 33
2020-06-10 19:57:57,841:     v= 34
2020-06-10 19:57:57,841:     w= 35
2020-06-10 19:57:57,841:     x= 36
2020-06-10 19:57:57,841:     y= 37
2020-06-10 19:57:57,841:     z= 38
2020-06-10 19:57:57,856: Using module at data.batch_samplers.BatchSampler
2020-06-10 19:57:57,856: Building vocab_sampler from config
2020-06-10 19:57:57,856:  >> # examples= 34323
2020-06-10 19:57:57,856:  >> batch_size= 1000
2020-06-10 19:57:57,856:  >> shuffle= False
2020-06-10 19:57:57,864:  >> BatchSampler; 35 batches
2020-06-10 19:57:57,864: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 19:57:57,864: Building dev_data from config
2020-06-10 19:58:04,898:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 19:58:04,899:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 19:58:04,899:  >> stack= False
2020-06-10 19:58:04,899:  >> seg_durs= (1, None)
2020-06-10 19:58:04,899:  >> # words= 10966 (# ignored= 0)
2020-06-10 19:58:04,899:  >> input_feat_dim= 108
2020-06-10 19:58:04,899:  >> input_num_subwords= 38
2020-06-10 19:58:04,899: Using module at data.batch_samplers.BatchSampler
2020-06-10 19:58:04,899: Building dev_sampler from config
2020-06-10 19:58:04,900:  >> # examples= 10966
2020-06-10 19:58:04,900:  >> batch_size= 256
2020-06-10 19:58:04,900:  >> shuffle= False
2020-06-10 19:58:04,902:  >> BatchSampler; 43 batches
2020-06-10 19:58:04,902: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 19:58:04,902: Building test_data from config
2020-06-10 19:58:10,924:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 19:58:10,925:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 19:58:10,925:  >> stack= False
2020-06-10 19:58:10,925:  >> seg_durs= (1, None)
2020-06-10 19:58:10,925:  >> # words= 11024 (# ignored= 0)
2020-06-10 19:58:10,925:  >> input_feat_dim= 108
2020-06-10 19:58:10,925:  >> input_num_subwords= 38
2020-06-10 19:58:10,925: Using module at data.batch_samplers.BatchSampler
2020-06-10 19:58:10,925: Building test_sampler from config
2020-06-10 19:58:10,926:  >> # examples= 11024
2020-06-10 19:58:10,926:  >> batch_size= 256
2020-06-10 19:58:10,926:  >> shuffle= False
2020-06-10 19:58:10,927:  >> BatchSampler; 44 batches
2020-06-10 19:58:10,928: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 19:58:10,928: Building eval from config
2020-06-10 19:58:10,928:  >> acoustic_ap= True
2020-06-10 19:58:10,928:  >> crossview_ap= True
2020-06-10 19:58:10,928:  >> full_vocab= False
2020-06-10 19:58:10,928:  >> metric= crossview_ap
2020-06-10 19:58:10,928:  >> mode= max
2020-06-10 19:58:10,928: Using module at multiview_rnn.MultiViewRNN
2020-06-10 19:58:10,928: Building net from config
2020-06-10 19:58:10,929: view1:
2020-06-10 19:58:10,930:  >> cell= GRU
2020-06-10 19:58:10,930:  >> input_size= 108
2020-06-10 19:58:10,930:  >> hidden_size= 512
2020-06-10 19:58:10,930:  >> bidirectional= True
2020-06-10 19:58:10,930:  >> num_layers= 6
2020-06-10 19:58:10,930:  >> dropout between layers= 0.4
2020-06-10 19:58:11,179: view2:
2020-06-10 19:58:11,180:  >> cell= GRU
2020-06-10 19:58:11,180:  >> input_size= 64
2020-06-10 19:58:11,180:  >> hidden_size= 512
2020-06-10 19:58:11,180:  >> bidirectional= True
2020-06-10 19:58:11,180:  >> num_layers= 2
2020-06-10 19:58:11,181:  >> dropout between layers= 0.4
2020-06-10 19:58:11,181:  >> num input embeddings= 38
2020-06-10 19:58:11,366: loaded save/MultiViewRNN.1911.pth
2020-06-10 19:58:11,366: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-10 19:58:11,366: Evaluating best model on dev and test:
2020-06-10 19:58:11,366: dev score:
2020-06-10 19:59:34,172:   >> crossview_ap=0.615 (10966 x 3921 pairs)
2020-06-10 20:00:24,358:   >> acoustic_ap=0.741 (10966 choose 2 pairs)
2020-06-10 20:00:25,066: saved outputs to npz file successfully
2020-06-10 20:00:25,066: test score:
2020-06-10 20:01:37,902:   >> crossview_ap=0.689 (11024 x 3392 pairs)
2020-06-10 20:02:28,264:   >> acoustic_ap=0.806 (11024 choose 2 pairs)
2020-06-10 20:02:28,965: saved outputs to npz file successfully
2020-06-10 20:02:28,974: Hyperparam tuning-------------------
2020-06-10 20:02:28,974: optim_lr: 0.0005
2020-06-10 20:02:28,974: dropout (for both): 0.4
2020-06-10 20:02:28,974: margin: 0.4
2020-06-10 20:02:28,974: ------------------------------------
2020-06-10 20:02:28,974: Calling main function: multiview_evaluator.evaluate
2020-06-10 20:02:28,974: Using config file: eval_config.json
2020-06-10 20:02:28,974: Using module at multiview_evaluator.evaluate
2020-06-10 20:02:28,975: Using module at multiview_vocab.MultiViewVocab
2020-06-10 20:02:28,975: Building vocab_data from config
2020-06-10 20:02:29,341:  >> min_count= 0
2020-06-10 20:02:29,341:  >> # words= 34323 (# removed= 0)
2020-06-10 20:02:29,341:  >> # subwords= 38
2020-06-10 20:02:29,341:      = 1
2020-06-10 20:02:29,341:     '= 2
2020-06-10 20:02:29,342:     -= 3
2020-06-10 20:02:29,342:     .= 4
2020-06-10 20:02:29,342:     <= 5
2020-06-10 20:02:29,342:     >= 6
2020-06-10 20:02:29,342:     [= 7
2020-06-10 20:02:29,342:     [laughter]= 8
2020-06-10 20:02:29,342:     [noise]= 9
2020-06-10 20:02:29,342:     [vocalized-noise]= 10
2020-06-10 20:02:29,342:     ]= 11
2020-06-10 20:02:29,342:     _= 12
2020-06-10 20:02:29,342:     a= 13
2020-06-10 20:02:29,342:     b= 14
2020-06-10 20:02:29,342:     c= 15
2020-06-10 20:02:29,342:     d= 16
2020-06-10 20:02:29,342:     e= 17
2020-06-10 20:02:29,342:     f= 18
2020-06-10 20:02:29,342:     g= 19
2020-06-10 20:02:29,343:     h= 20
2020-06-10 20:02:29,343:     i= 21
2020-06-10 20:02:29,343:     j= 22
2020-06-10 20:02:29,343:     k= 23
2020-06-10 20:02:29,343:     l= 24
2020-06-10 20:02:29,343:     m= 25
2020-06-10 20:02:29,343:     n= 26
2020-06-10 20:02:29,343:     o= 27
2020-06-10 20:02:29,343:     p= 28
2020-06-10 20:02:29,343:     q= 29
2020-06-10 20:02:29,343:     r= 30
2020-06-10 20:02:29,343:     s= 31
2020-06-10 20:02:29,343:     t= 32
2020-06-10 20:02:29,343:     u= 33
2020-06-10 20:02:29,343:     v= 34
2020-06-10 20:02:29,343:     w= 35
2020-06-10 20:02:29,343:     x= 36
2020-06-10 20:02:29,343:     y= 37
2020-06-10 20:02:29,344:     z= 38
2020-06-10 20:02:29,359: Using module at data.batch_samplers.BatchSampler
2020-06-10 20:02:29,359: Building vocab_sampler from config
2020-06-10 20:02:29,359:  >> # examples= 34323
2020-06-10 20:02:29,359:  >> batch_size= 1000
2020-06-10 20:02:29,359:  >> shuffle= False
2020-06-10 20:02:29,367:  >> BatchSampler; 35 batches
2020-06-10 20:02:29,367: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 20:02:29,368: Building dev_data from config
2020-06-10 20:02:36,849:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 20:02:36,850:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 20:02:36,850:  >> stack= False
2020-06-10 20:02:36,850:  >> seg_durs= (1, None)
2020-06-10 20:02:36,850:  >> # words= 10966 (# ignored= 0)
2020-06-10 20:02:36,850:  >> input_feat_dim= 108
2020-06-10 20:02:36,850:  >> input_num_subwords= 38
2020-06-10 20:02:36,851: Using module at data.batch_samplers.BatchSampler
2020-06-10 20:02:36,851: Building dev_sampler from config
2020-06-10 20:02:36,851:  >> # examples= 10966
2020-06-10 20:02:36,851:  >> batch_size= 256
2020-06-10 20:02:36,851:  >> shuffle= False
2020-06-10 20:02:36,853:  >> BatchSampler; 43 batches
2020-06-10 20:02:36,853: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 20:02:36,853: Building test_data from config
2020-06-10 20:02:42,988:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 20:02:43,003:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 20:02:43,003:  >> stack= False
2020-06-10 20:02:43,003:  >> seg_durs= (1, None)
2020-06-10 20:02:43,003:  >> # words= 11024 (# ignored= 0)
2020-06-10 20:02:43,003:  >> input_feat_dim= 108
2020-06-10 20:02:43,003:  >> input_num_subwords= 38
2020-06-10 20:02:43,003: Using module at data.batch_samplers.BatchSampler
2020-06-10 20:02:43,003: Building test_sampler from config
2020-06-10 20:02:43,003:  >> # examples= 11024
2020-06-10 20:02:43,003:  >> batch_size= 256
2020-06-10 20:02:43,004:  >> shuffle= False
2020-06-10 20:02:43,005:  >> BatchSampler; 44 batches
2020-06-10 20:02:43,005: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 20:02:43,005: Building eval from config
2020-06-10 20:02:43,006:  >> acoustic_ap= True
2020-06-10 20:02:43,006:  >> crossview_ap= True
2020-06-10 20:02:43,006:  >> full_vocab= False
2020-06-10 20:02:43,006:  >> metric= crossview_ap
2020-06-10 20:02:43,006:  >> mode= max
2020-06-10 20:02:43,006: Using module at multiview_rnn.MultiViewRNN
2020-06-10 20:02:43,006: Building net from config
2020-06-10 20:02:43,007: view1:
2020-06-10 20:02:43,007:  >> cell= GRU
2020-06-10 20:02:43,007:  >> input_size= 108
2020-06-10 20:02:43,007:  >> hidden_size= 512
2020-06-10 20:02:43,007:  >> bidirectional= True
2020-06-10 20:02:43,007:  >> num_layers= 6
2020-06-10 20:02:43,007:  >> dropout between layers= 0.4
2020-06-10 20:02:43,184: view2:
2020-06-10 20:02:43,185:  >> cell= GRU
2020-06-10 20:02:43,185:  >> input_size= 64
2020-06-10 20:02:43,185:  >> hidden_size= 512
2020-06-10 20:02:43,185:  >> bidirectional= True
2020-06-10 20:02:43,185:  >> num_layers= 2
2020-06-10 20:02:43,185:  >> dropout between layers= 0.4
2020-06-10 20:02:43,185:  >> num input embeddings= 38
2020-06-10 20:02:43,338: loaded save/MultiViewRNN.1911.pth
2020-06-10 20:02:43,338: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-10 20:02:43,338: Evaluating best model on dev and test:
2020-06-10 20:02:43,338: dev score:
2020-06-10 20:04:05,393:   >> crossview_ap=0.615 (10966 x 3921 pairs)
2020-06-10 20:04:55,484:   >> acoustic_ap=0.741 (10966 choose 2 pairs)
2020-06-10 20:04:56,242: saved outputs to npz file successfully
2020-06-10 20:04:56,242: test score:
2020-06-10 20:06:09,880:   >> crossview_ap=0.689 (11024 x 3392 pairs)
2020-06-10 20:07:00,337:   >> acoustic_ap=0.806 (11024 choose 2 pairs)
2020-06-10 20:07:01,113: saved outputs to npz file successfully
2020-06-10 20:07:01,116: Hyperparam tuning-------------------
2020-06-10 20:07:01,116: optim_lr: 0.0005
2020-06-10 20:07:01,116: dropout (for both): 0.4
2020-06-10 20:07:01,116: margin: 0.5
2020-06-10 20:07:01,116: ------------------------------------
2020-06-10 20:07:01,116: Calling main function: multiview_evaluator.evaluate
2020-06-10 20:07:01,116: Using config file: eval_config.json
2020-06-10 20:07:01,116: Using module at multiview_evaluator.evaluate
2020-06-10 20:07:01,117: Using module at multiview_vocab.MultiViewVocab
2020-06-10 20:07:01,117: Building vocab_data from config
2020-06-10 20:07:01,470:  >> min_count= 0
2020-06-10 20:07:01,470:  >> # words= 34323 (# removed= 0)
2020-06-10 20:07:01,470:  >> # subwords= 38
2020-06-10 20:07:01,470:      = 1
2020-06-10 20:07:01,470:     '= 2
2020-06-10 20:07:01,471:     -= 3
2020-06-10 20:07:01,471:     .= 4
2020-06-10 20:07:01,471:     <= 5
2020-06-10 20:07:01,471:     >= 6
2020-06-10 20:07:01,471:     [= 7
2020-06-10 20:07:01,471:     [laughter]= 8
2020-06-10 20:07:01,471:     [noise]= 9
2020-06-10 20:07:01,471:     [vocalized-noise]= 10
2020-06-10 20:07:01,471:     ]= 11
2020-06-10 20:07:01,471:     _= 12
2020-06-10 20:07:01,471:     a= 13
2020-06-10 20:07:01,471:     b= 14
2020-06-10 20:07:01,471:     c= 15
2020-06-10 20:07:01,471:     d= 16
2020-06-10 20:07:01,471:     e= 17
2020-06-10 20:07:01,471:     f= 18
2020-06-10 20:07:01,471:     g= 19
2020-06-10 20:07:01,471:     h= 20
2020-06-10 20:07:01,472:     i= 21
2020-06-10 20:07:01,472:     j= 22
2020-06-10 20:07:01,472:     k= 23
2020-06-10 20:07:01,472:     l= 24
2020-06-10 20:07:01,472:     m= 25
2020-06-10 20:07:01,472:     n= 26
2020-06-10 20:07:01,472:     o= 27
2020-06-10 20:07:01,472:     p= 28
2020-06-10 20:07:01,472:     q= 29
2020-06-10 20:07:01,472:     r= 30
2020-06-10 20:07:01,472:     s= 31
2020-06-10 20:07:01,472:     t= 32
2020-06-10 20:07:01,472:     u= 33
2020-06-10 20:07:01,472:     v= 34
2020-06-10 20:07:01,472:     w= 35
2020-06-10 20:07:01,472:     x= 36
2020-06-10 20:07:01,472:     y= 37
2020-06-10 20:07:01,472:     z= 38
2020-06-10 20:07:01,489: Using module at data.batch_samplers.BatchSampler
2020-06-10 20:07:01,489: Building vocab_sampler from config
2020-06-10 20:07:01,489:  >> # examples= 34323
2020-06-10 20:07:01,489:  >> batch_size= 1000
2020-06-10 20:07:01,489:  >> shuffle= False
2020-06-10 20:07:01,497:  >> BatchSampler; 35 batches
2020-06-10 20:07:01,497: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 20:07:01,497: Building dev_data from config
2020-06-10 20:07:08,425:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 20:07:08,426:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 20:07:08,426:  >> stack= False
2020-06-10 20:07:08,426:  >> seg_durs= (1, None)
2020-06-10 20:07:08,426:  >> # words= 10966 (# ignored= 0)
2020-06-10 20:07:08,426:  >> input_feat_dim= 108
2020-06-10 20:07:08,426:  >> input_num_subwords= 38
2020-06-10 20:07:08,426: Using module at data.batch_samplers.BatchSampler
2020-06-10 20:07:08,427: Building dev_sampler from config
2020-06-10 20:07:08,427:  >> # examples= 10966
2020-06-10 20:07:08,427:  >> batch_size= 256
2020-06-10 20:07:08,427:  >> shuffle= False
2020-06-10 20:07:08,429:  >> BatchSampler; 43 batches
2020-06-10 20:07:08,429: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 20:07:08,429: Building test_data from config
2020-06-10 20:07:14,419:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 20:07:14,420:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 20:07:14,420:  >> stack= False
2020-06-10 20:07:14,420:  >> seg_durs= (1, None)
2020-06-10 20:07:14,420:  >> # words= 11024 (# ignored= 0)
2020-06-10 20:07:14,420:  >> input_feat_dim= 108
2020-06-10 20:07:14,420:  >> input_num_subwords= 38
2020-06-10 20:07:14,420: Using module at data.batch_samplers.BatchSampler
2020-06-10 20:07:14,421: Building test_sampler from config
2020-06-10 20:07:14,421:  >> # examples= 11024
2020-06-10 20:07:14,421:  >> batch_size= 256
2020-06-10 20:07:14,421:  >> shuffle= False
2020-06-10 20:07:14,425:  >> BatchSampler; 44 batches
2020-06-10 20:07:14,425: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 20:07:14,426: Building eval from config
2020-06-10 20:07:14,426:  >> acoustic_ap= True
2020-06-10 20:07:14,426:  >> crossview_ap= True
2020-06-10 20:07:14,426:  >> full_vocab= False
2020-06-10 20:07:14,426:  >> metric= crossview_ap
2020-06-10 20:07:14,426:  >> mode= max
2020-06-10 20:07:14,426: Using module at multiview_rnn.MultiViewRNN
2020-06-10 20:07:14,426: Building net from config
2020-06-10 20:07:14,428: view1:
2020-06-10 20:07:14,428:  >> cell= GRU
2020-06-10 20:07:14,429:  >> input_size= 108
2020-06-10 20:07:14,429:  >> hidden_size= 512
2020-06-10 20:07:14,429:  >> bidirectional= True
2020-06-10 20:07:14,429:  >> num_layers= 6
2020-06-10 20:07:14,429:  >> dropout between layers= 0.4
2020-06-10 20:07:14,683: view2:
2020-06-10 20:07:14,683:  >> cell= GRU
2020-06-10 20:07:14,683:  >> input_size= 64
2020-06-10 20:07:14,684:  >> hidden_size= 512
2020-06-10 20:07:14,684:  >> bidirectional= True
2020-06-10 20:07:14,684:  >> num_layers= 2
2020-06-10 20:07:14,684:  >> dropout between layers= 0.4
2020-06-10 20:07:14,684:  >> num input embeddings= 38
2020-06-10 20:07:14,865: loaded save/MultiViewRNN.1911.pth
2020-06-10 20:07:14,865: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-chars-edit
2020-06-10 20:07:14,865: Evaluating best model on dev and test:
2020-06-10 20:07:14,865: dev score:
2020-06-10 20:08:35,261:   >> crossview_ap=0.615 (10966 x 3921 pairs)
2020-06-10 20:09:25,313:   >> acoustic_ap=0.741 (10966 choose 2 pairs)
2020-06-10 20:09:26,085: saved outputs to npz file successfully
2020-06-10 20:09:26,085: test score:
2020-06-10 20:10:41,740:   >> crossview_ap=0.689 (11024 x 3392 pairs)
2020-06-10 20:11:32,335:   >> acoustic_ap=0.806 (11024 choose 2 pairs)
2020-06-10 20:11:33,087: saved outputs to npz file successfully
