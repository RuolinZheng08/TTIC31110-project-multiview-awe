2020-06-07 14:51:50,080: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-07 14:51:50,559: Using 1 GPU(s)
2020-06-07 14:51:50,560: Machine: 0 / 1
2020-06-07 14:51:50,586: Hyperparam tuning-------------------
2020-06-07 14:51:50,586: optim_lr: 0.001
2020-06-07 14:51:50,586: dropout (for both): 0.4
2020-06-07 14:51:50,586: margin: 0.4
2020-06-07 14:51:50,586: ------------------------------------
2020-06-07 14:51:50,648: Calling main function: multiview_trainer.train
2020-06-07 14:51:50,648: Using config file: train_config.json
2020-06-07 14:51:50,648: Using module at multiview_trainer.train
2020-06-07 14:52:01,681: Using module at multiview_vocab.MultiViewVocab
2020-06-07 14:52:01,762: Building vocab_data from config
2020-06-07 14:52:02,159:  >> min_count= 0
2020-06-07 14:52:02,160:  >> # words= 34323 (# removed= 0)
2020-06-07 14:52:02,160:  >> # subwords= 45
2020-06-07 14:52:02,160:     [laughter]= 1
2020-06-07 14:52:02,160:     [noise]= 2
2020-06-07 14:52:02,160:     [vocalized-noise]= 3
2020-06-07 14:52:02,160:     aa= 4
2020-06-07 14:52:02,160:     ae= 5
2020-06-07 14:52:02,161:     ah= 6
2020-06-07 14:52:02,161:     ao= 7
2020-06-07 14:52:02,161:     aw= 8
2020-06-07 14:52:02,161:     ax= 9
2020-06-07 14:52:02,161:     ay= 10
2020-06-07 14:52:02,161:     b= 11
2020-06-07 14:52:02,161:     ch= 12
2020-06-07 14:52:02,161:     d= 13
2020-06-07 14:52:02,161:     dh= 14
2020-06-07 14:52:02,161:     eh= 15
2020-06-07 14:52:02,162:     el= 16
2020-06-07 14:52:02,162:     en= 17
2020-06-07 14:52:02,162:     er= 18
2020-06-07 14:52:02,162:     ey= 19
2020-06-07 14:52:02,162:     f= 20
2020-06-07 14:52:02,162:     g= 21
2020-06-07 14:52:02,162:     hh= 22
2020-06-07 14:52:02,162:     ih= 23
2020-06-07 14:52:02,162:     iy= 24
2020-06-07 14:52:02,162:     jh= 25
2020-06-07 14:52:02,163:     k= 26
2020-06-07 14:52:02,163:     l= 27
2020-06-07 14:52:02,163:     m= 28
2020-06-07 14:52:02,163:     n= 29
2020-06-07 14:52:02,163:     ng= 30
2020-06-07 14:52:02,163:     ow= 31
2020-06-07 14:52:02,163:     oy= 32
2020-06-07 14:52:02,163:     p= 33
2020-06-07 14:52:02,163:     r= 34
2020-06-07 14:52:02,164:     s= 35
2020-06-07 14:52:02,164:     sh= 36
2020-06-07 14:52:02,164:     t= 37
2020-06-07 14:52:02,164:     th= 38
2020-06-07 14:52:02,164:     uh= 39
2020-06-07 14:52:02,164:     uw= 40
2020-06-07 14:52:02,164:     v= 41
2020-06-07 14:52:02,164:     w= 42
2020-06-07 14:52:02,164:     y= 43
2020-06-07 14:52:02,164:     z= 44
2020-06-07 14:52:02,165:     zh= 45
2020-06-07 14:52:02,182: Using module at data.batch_samplers.BatchSampler
2020-06-07 14:52:02,204: Building vocab_sampler from config
2020-06-07 14:52:02,204:  >> # examples= 34323
2020-06-07 14:52:02,204:  >> batch_size= 1000
2020-06-07 14:52:02,205:  >> shuffle= False
2020-06-07 14:52:02,214:  >> BatchSampler; 35 batches
2020-06-07 14:52:02,214: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 14:52:06,521: Building train_data from config
2020-06-07 14:52:15,435:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-07 14:52:15,437:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-07 14:52:15,437:  >> stack= False
2020-06-07 14:52:15,437:  >> seg_durs= (1, None)
2020-06-07 14:52:15,437:  >> # words= 9971 (# ignored= 0)
2020-06-07 14:52:15,437:  >> input_feat_dim= 108
2020-06-07 14:52:15,437:  >> input_num_subwords= 45
2020-06-07 14:52:15,437: Using module at data.batch_samplers.BatchSampler
2020-06-07 14:52:15,438: Building train_sampler from config
2020-06-07 14:52:15,438:  >> # examples= 9971
2020-06-07 14:52:15,438:  >> batch_size= 256
2020-06-07 14:52:15,438:  >> shuffle= True
2020-06-07 14:52:15,448:  >> BatchSampler; 39 batches
2020-06-07 14:52:15,448: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 14:52:15,448: Building dev_data from config
2020-06-07 14:52:25,625:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-07 14:52:25,626:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-07 14:52:25,626:  >> stack= False
2020-06-07 14:52:25,626:  >> seg_durs= (1, None)
2020-06-07 14:52:25,626:  >> # words= 10966 (# ignored= 0)
2020-06-07 14:52:25,626:  >> input_feat_dim= 108
2020-06-07 14:52:25,626:  >> input_num_subwords= 45
2020-06-07 14:52:25,627: Using module at data.batch_samplers.BatchSampler
2020-06-07 14:52:25,627: Building dev_sampler from config
2020-06-07 14:52:25,627:  >> # examples= 10966
2020-06-07 14:52:25,628:  >> batch_size= 256
2020-06-07 14:52:25,628:  >> shuffle= False
2020-06-07 14:52:25,630:  >> BatchSampler; 43 batches
2020-06-07 14:52:25,630: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 14:52:25,630: Building test_data from config
2020-06-07 14:52:34,492:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-07 14:52:34,494:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-07 14:52:34,494:  >> stack= False
2020-06-07 14:52:34,494:  >> seg_durs= (1, None)
2020-06-07 14:52:34,494:  >> # words= 11024 (# ignored= 0)
2020-06-07 14:52:34,494:  >> input_feat_dim= 108
2020-06-07 14:52:34,494:  >> input_num_subwords= 45
2020-06-07 14:52:34,495: Using module at data.batch_samplers.BatchSampler
2020-06-07 14:52:34,495: Building test_sampler from config
2020-06-07 14:52:34,495:  >> # examples= 11024
2020-06-07 14:52:34,495:  >> batch_size= 256
2020-06-07 14:52:34,496:  >> shuffle= False
2020-06-07 14:52:34,498:  >> BatchSampler; 44 batches
2020-06-07 14:52:34,498: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-07 14:52:34,943: Building loss from config
2020-06-07 14:52:34,944:  >> margin= 0.4
2020-06-07 14:52:34,944:  >> k= 16
2020-06-07 14:52:34,944:  >> min_k= 8
2020-06-07 14:52:34,945:  >> extra= 0
2020-06-07 14:52:34,945:  >> average= False
2020-06-07 14:52:34,945: Using module at metric.multiview_ap.MultiViewAP
2020-06-07 14:52:36,481: Building eval from config
2020-06-07 14:52:36,481:  >> acoustic_ap= True
2020-06-07 14:52:36,482:  >> crossview_ap= True
2020-06-07 14:52:36,482:  >> full_vocab= False
2020-06-07 14:52:36,482:  >> metric= crossview_ap
2020-06-07 14:52:36,482:  >> mode= max
2020-06-07 14:52:36,482: Using module at multiview_rnn.MultiViewRNN
2020-06-07 14:52:36,712: Building net from config
2020-06-07 14:52:36,714: view1:
2020-06-07 14:52:36,716:  >> cell= GRU
2020-06-07 14:52:36,716:  >> input_size= 108
2020-06-07 14:52:36,716:  >> hidden_size= 512
2020-06-07 14:52:36,717:  >> bidirectional= True
2020-06-07 14:52:36,717:  >> num_layers= 6
2020-06-07 14:52:36,717:  >> dropout between layers= 0.4
2020-06-07 14:52:37,070: view2:
2020-06-07 14:52:37,071:  >> cell= GRU
2020-06-07 14:52:37,071:  >> input_size= 64
2020-06-07 14:52:37,071:  >> hidden_size= 512
2020-06-07 14:52:37,071:  >> bidirectional= True
2020-06-07 14:52:37,071:  >> num_layers= 2
2020-06-07 14:52:37,071:  >> dropout between layers= 0.4
2020-06-07 14:52:37,072:  >> num input embeddings= 45
2020-06-07 14:52:46,571: Using module at optim.adam.Adam
2020-06-07 14:52:46,625: Building optim from config
2020-06-07 14:52:46,625:  >> lr= 0.001
2020-06-07 14:52:46,626:  >> betas= (0.9, 0.999)
2020-06-07 14:52:46,626:  >> eps= 1e-08
2020-06-07 14:52:46,626:  >> weight_decay= 0
2020-06-07 14:52:46,626:  >> amsgrad= False
2020-06-07 14:52:46,626:  >> min_lr= 1e-07
2020-06-07 14:52:46,628: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-07 14:52:46,816: Building sched from config
2020-06-07 14:52:46,817:  >> optim= Adam
2020-06-07 14:52:46,817:  >> decay lr by 0.1
2020-06-07 14:52:46,817:  >> eval_fn= MultiViewAP
2020-06-07 14:52:46,819:  >> patience=4
2020-06-07 14:52:46,819:  >> revert=True
2020-06-07 14:52:46,820: epoch=0.00 global_step=0 lr=0.001 start_iter=0
2020-06-07 14:52:46,820: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 14:54:54,783: 0) loss=0.504 grad_norm=51.17 num_segments=256 num_words=204
2020-06-07 14:56:51,081: 1) loss=0.493 grad_norm=46.04 num_segments=256 num_words=211
2020-06-07 14:58:40,531: 2) loss=0.515 grad_norm=68.04 num_segments=256 num_words=202
2020-06-07 15:00:20,822: 3) loss=0.476 grad_norm=43.04 num_segments=256 num_words=218
2020-06-07 15:01:53,548: 4) loss=0.484 grad_norm=55.96 num_segments=256 num_words=204
2020-06-07 15:03:17,363: 5) loss=0.473 grad_norm=67.83 num_segments=256 num_words=194
2020-06-07 15:04:32,174: 6) loss=0.474 grad_norm=59.91 num_segments=256 num_words=218
2020-06-07 15:05:38,856: 7) loss=0.469 grad_norm=53.25 num_segments=256 num_words=207
2020-06-07 15:06:47,009: 8) loss=0.479 grad_norm=48.21 num_segments=256 num_words=207
2020-06-07 15:07:54,066: 9) loss=0.471 grad_norm=41.84 num_segments=256 num_words=217
2020-06-07 15:09:00,053: 10) loss=0.465 grad_norm=43.66 num_segments=256 num_words=218
2020-06-07 15:10:06,203: 11) loss=0.461 grad_norm=41.29 num_segments=256 num_words=208
2020-06-07 15:11:13,337: 12) loss=0.459 grad_norm=40.71 num_segments=256 num_words=223
2020-06-07 15:12:20,630: 13) loss=0.457 grad_norm=36.59 num_segments=256 num_words=211
2020-06-07 15:13:28,414: 14) loss=0.447 grad_norm=38.86 num_segments=256 num_words=216
2020-06-07 15:14:35,263: 15) loss=0.446 grad_norm=46.62 num_segments=256 num_words=198
2020-06-07 15:15:43,212: 16) loss=0.442 grad_norm=46.69 num_segments=256 num_words=209
2020-06-07 15:16:50,876: 17) loss=0.464 grad_norm=44.51 num_segments=256 num_words=210
2020-06-07 15:17:58,490: 18) loss=0.441 grad_norm=42.60 num_segments=256 num_words=209
2020-06-07 15:19:03,638: 19) loss=0.436 grad_norm=35.04 num_segments=256 num_words=210
2020-06-07 15:20:09,853: 20) loss=0.429 grad_norm=33.68 num_segments=256 num_words=212
2020-06-07 15:21:15,810: 21) loss=0.431 grad_norm=31.84 num_segments=256 num_words=216
2020-06-07 15:22:21,968: 22) loss=0.504 grad_norm=45.62 num_segments=256 num_words=209
2020-06-07 15:23:28,176: 23) loss=0.427 grad_norm=34.84 num_segments=256 num_words=220
2020-06-07 15:24:36,029: 24) loss=0.422 grad_norm=34.55 num_segments=256 num_words=202
2020-06-07 15:25:44,014: 25) loss=0.417 grad_norm=33.62 num_segments=256 num_words=207
2020-06-07 15:26:51,335: 26) loss=0.418 grad_norm=37.06 num_segments=256 num_words=209
2020-06-07 15:27:58,813: 27) loss=0.407 grad_norm=38.44 num_segments=256 num_words=204
2020-06-07 15:29:06,508: 28) loss=0.413 grad_norm=33.93 num_segments=256 num_words=216
2020-06-07 15:30:13,916: 29) loss=0.435 grad_norm=40.27 num_segments=256 num_words=207
2020-06-07 15:31:20,333: 30) loss=0.425 grad_norm=33.14 num_segments=256 num_words=220
2020-06-07 15:32:27,919: 31) loss=0.427 grad_norm=38.03 num_segments=256 num_words=212
2020-06-07 15:33:34,609: 32) loss=0.394 grad_norm=43.05 num_segments=256 num_words=210
2020-06-07 15:34:41,782: 33) loss=0.402 grad_norm=43.81 num_segments=256 num_words=202
2020-06-07 15:35:48,832: 34) loss=0.395 grad_norm=48.80 num_segments=256 num_words=213
2020-06-07 15:36:55,278: 35) loss=0.393 grad_norm=45.94 num_segments=256 num_words=205
2020-06-07 15:38:00,520: 36) loss=0.398 grad_norm=57.03 num_segments=256 num_words=208
2020-06-07 15:39:06,041: 37) loss=0.401 grad_norm=54.53 num_segments=256 num_words=209
2020-06-07 15:40:05,059: 38) loss=0.399 grad_norm=44.88 num_segments=243 num_words=211
2020-06-07 15:40:05,078: epoch= 1.00
2020-06-07 15:40:05,078:  >> time to evaluate and save:
2020-06-07 15:40:05,153: saved save/MultiViewDataset_IndividualWords.39.pth
2020-06-07 15:40:05,155: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 15:40:05,157: saved MultiViewDataset_IndividualWords successfully
2020-06-07 15:40:07,476: saved save/MultiViewRNN.39.pth
2020-06-07 15:40:07,478: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 15:40:07,480: saved MultiViewRNN successfully
2020-06-07 15:40:11,695: saved save/Adam.39.pth
2020-06-07 15:40:11,698: most_recent linked save/Adam.most_recent.pth
2020-06-07 15:40:11,701: saved Adam successfully
2020-06-07 15:40:11,745: saved save/ReduceLROnPlateau.39.pth
2020-06-07 15:40:11,747: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 15:40:11,750: saved ReduceLROnPlateau successfully
2020-06-07 15:40:11,753: saved config successfully
2020-06-07 15:41:58,638:   >> crossview_ap=0.051 (10966 x 3921 pairs)
2020-06-07 15:43:05,221:   >> acoustic_ap=0.087 (10966 choose 2 pairs)
2020-06-07 15:43:05,224: best_so_far= 0.051 at 39
2020-06-07 15:43:05,228: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 15:43:05,230: saved MultiViewDataset_IndividualWords successfully
2020-06-07 15:43:05,231: best linked save/MultiViewRNN.best.pth
2020-06-07 15:43:05,233: saved MultiViewRNN successfully
2020-06-07 15:43:05,234: best linked save/Adam.best.pth
2020-06-07 15:43:05,236: saved Adam successfully
2020-06-07 15:43:05,237: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 15:43:05,239: saved ReduceLROnPlateau successfully
2020-06-07 15:43:05,268: epoch=1.00 global_step=39 lr=0.001 start_iter=0
2020-06-07 15:43:05,268: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 15:44:12,150: 0) loss=0.389 grad_norm=50.08 num_segments=256 num_words=218
2020-06-07 15:45:18,448: 1) loss=0.387 grad_norm=69.39 num_segments=256 num_words=212
2020-06-07 15:46:26,071: 2) loss=0.399 grad_norm=54.32 num_segments=256 num_words=209
2020-06-07 15:47:33,932: 3) loss=0.385 grad_norm=45.42 num_segments=256 num_words=211
2020-06-07 15:48:40,783: 4) loss=0.395 grad_norm=48.30 num_segments=256 num_words=215
2020-06-07 15:49:47,068: 5) loss=0.388 grad_norm=40.79 num_segments=256 num_words=213
2020-06-07 15:50:52,817: 6) loss=0.381 grad_norm=44.25 num_segments=256 num_words=216
2020-06-07 15:51:59,532: 7) loss=0.366 grad_norm=40.89 num_segments=256 num_words=203
2020-06-07 15:53:06,176: 8) loss=0.372 grad_norm=30.65 num_segments=256 num_words=218
2020-06-07 15:54:12,783: 9) loss=0.399 grad_norm=33.47 num_segments=256 num_words=212
2020-06-07 15:55:20,197: 10) loss=0.378 grad_norm=40.00 num_segments=256 num_words=208
2020-06-07 15:56:26,525: 11) loss=0.375 grad_norm=65.44 num_segments=256 num_words=213
2020-06-07 15:57:32,086: 12) loss=0.365 grad_norm=44.74 num_segments=256 num_words=218
2020-06-07 15:58:37,597: 13) loss=0.366 grad_norm=39.19 num_segments=256 num_words=208
2020-06-07 15:59:43,064: 14) loss=0.359 grad_norm=36.16 num_segments=256 num_words=213
2020-06-07 16:00:48,557: 15) loss=0.366 grad_norm=50.07 num_segments=256 num_words=200
2020-06-07 16:01:54,481: 16) loss=0.350 grad_norm=40.09 num_segments=256 num_words=208
2020-06-07 16:02:59,619: 17) loss=0.360 grad_norm=45.41 num_segments=256 num_words=210
2020-06-07 16:04:04,972: 18) loss=0.349 grad_norm=48.12 num_segments=256 num_words=200
2020-06-07 16:05:11,907: 19) loss=0.442 grad_norm=51.48 num_segments=256 num_words=221
2020-06-07 16:06:18,831: 20) loss=0.358 grad_norm=39.66 num_segments=256 num_words=209
2020-06-07 16:07:26,339: 21) loss=0.338 grad_norm=34.62 num_segments=256 num_words=203
2020-06-07 16:08:32,654: 22) loss=0.335 grad_norm=36.02 num_segments=256 num_words=210
2020-06-07 16:09:39,336: 23) loss=0.369 grad_norm=32.11 num_segments=256 num_words=222
2020-06-07 16:10:47,233: 24) loss=0.336 grad_norm=31.52 num_segments=256 num_words=215
2020-06-07 16:11:55,080: 25) loss=0.342 grad_norm=38.56 num_segments=256 num_words=205
2020-06-07 16:13:02,838: 26) loss=0.349 grad_norm=30.62 num_segments=256 num_words=215
2020-06-07 16:14:10,258: 27) loss=0.358 grad_norm=52.36 num_segments=256 num_words=213
2020-06-07 16:15:16,891: 28) loss=0.351 grad_norm=54.25 num_segments=256 num_words=214
2020-06-07 16:16:24,419: 29) loss=0.331 grad_norm=50.73 num_segments=256 num_words=205
2020-06-07 16:17:31,078: 30) loss=0.358 grad_norm=46.15 num_segments=256 num_words=209
2020-06-07 16:18:37,847: 31) loss=0.333 grad_norm=47.66 num_segments=256 num_words=209
2020-06-07 16:19:45,505: 32) loss=0.362 grad_norm=43.05 num_segments=256 num_words=200
2020-06-07 16:20:51,114: 33) loss=0.318 grad_norm=58.36 num_segments=256 num_words=201
2020-06-07 16:21:56,746: 34) loss=0.326 grad_norm=46.79 num_segments=256 num_words=211
2020-06-07 16:23:02,064: 35) loss=0.339 grad_norm=32.31 num_segments=256 num_words=206
2020-06-07 16:24:07,596: 36) loss=0.327 grad_norm=40.25 num_segments=256 num_words=210
2020-06-07 16:25:14,313: 37) loss=0.331 grad_norm=46.09 num_segments=256 num_words=204
2020-06-07 16:26:14,473: 38) loss=0.320 grad_norm=40.87 num_segments=243 num_words=196
2020-06-07 16:26:14,491: epoch= 2.00
2020-06-07 16:26:14,491:  >> time to evaluate and save:
2020-06-07 16:26:14,547: saved save/MultiViewDataset_IndividualWords.78.pth
2020-06-07 16:26:14,550: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 16:26:14,552: saved MultiViewDataset_IndividualWords successfully
2020-06-07 16:26:16,706: saved save/MultiViewRNN.78.pth
2020-06-07 16:26:16,708: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 16:26:16,717: saved MultiViewRNN successfully
2020-06-07 16:26:21,097: saved save/Adam.78.pth
2020-06-07 16:26:21,099: most_recent linked save/Adam.most_recent.pth
2020-06-07 16:26:21,107: saved Adam successfully
2020-06-07 16:26:21,139: saved save/ReduceLROnPlateau.78.pth
2020-06-07 16:26:21,144: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 16:26:21,147: saved ReduceLROnPlateau successfully
2020-06-07 16:26:21,212: saved config successfully
2020-06-07 16:28:02,471:   >> crossview_ap=0.164 (10966 x 3921 pairs)
2020-06-07 16:29:09,111:   >> acoustic_ap=0.202 (10966 choose 2 pairs)
2020-06-07 16:29:09,115: best_so_far= 0.164 at 78
2020-06-07 16:29:09,132: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 16:29:09,134: saved MultiViewDataset_IndividualWords successfully
2020-06-07 16:29:09,136: best linked save/MultiViewRNN.best.pth
2020-06-07 16:29:09,141: saved MultiViewRNN successfully
2020-06-07 16:29:09,143: best linked save/Adam.best.pth
2020-06-07 16:29:09,148: saved Adam successfully
2020-06-07 16:29:09,150: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 16:29:09,152: saved ReduceLROnPlateau successfully
2020-06-07 16:29:09,201: epoch=2.00 global_step=78 lr=0.001 start_iter=0
2020-06-07 16:29:09,201: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 16:30:16,984: 0) loss=0.316 grad_norm=42.28 num_segments=256 num_words=199
2020-06-07 16:31:23,018: 1) loss=0.311 grad_norm=35.99 num_segments=256 num_words=217
2020-06-07 16:32:30,815: 2) loss=0.314 grad_norm=56.78 num_segments=256 num_words=208
2020-06-07 16:33:36,863: 3) loss=0.304 grad_norm=54.98 num_segments=256 num_words=209
2020-06-07 16:34:42,216: 4) loss=0.315 grad_norm=34.99 num_segments=256 num_words=210
2020-06-07 16:35:47,721: 5) loss=0.311 grad_norm=33.60 num_segments=256 num_words=208
2020-06-07 16:36:53,417: 6) loss=0.320 grad_norm=47.92 num_segments=256 num_words=212
2020-06-07 16:37:59,383: 7) loss=0.313 grad_norm=36.49 num_segments=256 num_words=218
2020-06-07 16:39:06,034: 8) loss=0.308 grad_norm=37.15 num_segments=256 num_words=210
2020-06-07 16:40:13,953: 9) loss=0.307 grad_norm=29.12 num_segments=256 num_words=217
2020-06-07 16:41:19,937: 10) loss=0.295 grad_norm=38.32 num_segments=256 num_words=208
2020-06-07 16:42:26,120: 11) loss=0.290 grad_norm=42.39 num_segments=256 num_words=197
2020-06-07 16:43:32,218: 12) loss=0.304 grad_norm=45.72 num_segments=256 num_words=219
2020-06-07 16:44:37,914: 13) loss=0.293 grad_norm=49.06 num_segments=256 num_words=200
2020-06-07 16:45:44,676: 14) loss=0.300 grad_norm=45.90 num_segments=256 num_words=212
2020-06-07 16:46:51,996: 15) loss=0.298 grad_norm=41.77 num_segments=256 num_words=211
2020-06-07 16:47:58,943: 16) loss=0.310 grad_norm=37.00 num_segments=256 num_words=209
2020-06-07 16:49:05,756: 17) loss=0.402 grad_norm=37.58 num_segments=256 num_words=218
2020-06-07 16:50:13,470: 18) loss=0.302 grad_norm=40.83 num_segments=256 num_words=214
2020-06-07 16:51:20,817: 19) loss=0.300 grad_norm=39.58 num_segments=256 num_words=206
2020-06-07 16:52:28,266: 20) loss=0.284 grad_norm=31.02 num_segments=256 num_words=209
2020-06-07 16:53:34,585: 21) loss=0.290 grad_norm=40.07 num_segments=256 num_words=212
2020-06-07 16:54:39,976: 22) loss=0.288 grad_norm=52.05 num_segments=256 num_words=212
2020-06-07 16:55:46,802: 23) loss=0.282 grad_norm=31.76 num_segments=256 num_words=217
2020-06-07 16:56:52,820: 24) loss=0.290 grad_norm=33.39 num_segments=256 num_words=214
2020-06-07 16:57:59,527: 25) loss=0.283 grad_norm=40.24 num_segments=256 num_words=227
2020-06-07 16:59:04,925: 26) loss=0.296 grad_norm=29.32 num_segments=256 num_words=202
2020-06-07 17:00:10,197: 27) loss=0.280 grad_norm=34.31 num_segments=256 num_words=206
2020-06-07 17:01:15,664: 28) loss=0.278 grad_norm=28.98 num_segments=256 num_words=210
2020-06-07 17:02:22,440: 29) loss=0.270 grad_norm=35.61 num_segments=256 num_words=206
2020-06-07 17:03:30,368: 30) loss=0.282 grad_norm=34.56 num_segments=256 num_words=210
2020-06-07 17:04:38,716: 31) loss=0.303 grad_norm=31.96 num_segments=256 num_words=219
2020-06-07 17:05:44,633: 32) loss=0.275 grad_norm=34.85 num_segments=256 num_words=216
2020-06-07 17:06:52,316: 33) loss=0.274 grad_norm=43.78 num_segments=256 num_words=221
2020-06-07 17:07:58,984: 34) loss=0.269 grad_norm=27.52 num_segments=256 num_words=199
2020-06-07 17:09:04,465: 35) loss=0.267 grad_norm=37.08 num_segments=256 num_words=206
2020-06-07 17:10:10,178: 36) loss=0.279 grad_norm=39.36 num_segments=256 num_words=210
2020-06-07 17:11:15,783: 37) loss=0.293 grad_norm=33.72 num_segments=256 num_words=212
2020-06-07 17:12:14,798: 38) loss=0.284 grad_norm=38.49 num_segments=243 num_words=200
2020-06-07 17:12:14,817: epoch= 3.00
2020-06-07 17:12:14,817:  >> time to evaluate and save:
2020-06-07 17:12:14,883: saved save/MultiViewDataset_IndividualWords.117.pth
2020-06-07 17:12:14,886: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 17:12:14,888: saved MultiViewDataset_IndividualWords successfully
2020-06-07 17:12:17,184: saved save/MultiViewRNN.117.pth
2020-06-07 17:12:17,187: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 17:12:17,196: saved MultiViewRNN successfully
2020-06-07 17:12:21,217: saved save/Adam.117.pth
2020-06-07 17:12:21,220: most_recent linked save/Adam.most_recent.pth
2020-06-07 17:12:21,228: saved Adam successfully
2020-06-07 17:12:21,271: saved save/ReduceLROnPlateau.117.pth
2020-06-07 17:12:21,276: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 17:12:21,279: saved ReduceLROnPlateau successfully
2020-06-07 17:12:21,344: saved config successfully
2020-06-07 17:14:03,015:   >> crossview_ap=0.316 (10966 x 3921 pairs)
2020-06-07 17:15:09,463:   >> acoustic_ap=0.322 (10966 choose 2 pairs)
2020-06-07 17:15:09,467: best_so_far= 0.316 at 117
2020-06-07 17:15:09,473: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 17:15:09,475: saved MultiViewDataset_IndividualWords successfully
2020-06-07 17:15:09,477: best linked save/MultiViewRNN.best.pth
2020-06-07 17:15:09,484: saved MultiViewRNN successfully
2020-06-07 17:15:09,486: best linked save/Adam.best.pth
2020-06-07 17:15:09,492: saved Adam successfully
2020-06-07 17:15:09,494: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 17:15:09,496: saved ReduceLROnPlateau successfully
2020-06-07 17:15:09,547: epoch=3.00 global_step=117 lr=0.001 start_iter=0
2020-06-07 17:15:09,547: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 17:16:17,712: 0) loss=0.261 grad_norm=46.78 num_segments=256 num_words=203
2020-06-07 17:17:26,356: 1) loss=0.279 grad_norm=46.74 num_segments=256 num_words=215
2020-06-07 17:18:33,313: 2) loss=0.278 grad_norm=33.57 num_segments=256 num_words=209
2020-06-07 17:19:41,164: 3) loss=0.256 grad_norm=52.76 num_segments=256 num_words=209
2020-06-07 17:20:47,120: 4) loss=0.257 grad_norm=44.60 num_segments=256 num_words=209
2020-06-07 17:21:53,118: 5) loss=0.282 grad_norm=34.87 num_segments=256 num_words=210
2020-06-07 17:22:59,001: 6) loss=0.279 grad_norm=42.07 num_segments=256 num_words=207
2020-06-07 17:24:06,540: 7) loss=0.264 grad_norm=38.74 num_segments=256 num_words=223
2020-06-07 17:25:13,668: 8) loss=0.252 grad_norm=35.80 num_segments=256 num_words=212
2020-06-07 17:26:20,444: 9) loss=0.254 grad_norm=36.40 num_segments=256 num_words=214
2020-06-07 17:27:27,531: 10) loss=0.245 grad_norm=46.67 num_segments=256 num_words=212
2020-06-07 17:28:34,523: 11) loss=0.235 grad_norm=32.97 num_segments=256 num_words=211
2020-06-07 17:29:41,288: 12) loss=0.258 grad_norm=30.97 num_segments=256 num_words=206
2020-06-07 17:30:47,410: 13) loss=0.251 grad_norm=39.39 num_segments=256 num_words=219
2020-06-07 17:31:53,026: 14) loss=0.236 grad_norm=38.78 num_segments=256 num_words=212
2020-06-07 17:32:59,270: 15) loss=0.238 grad_norm=36.11 num_segments=256 num_words=205
2020-06-07 17:34:04,969: 16) loss=0.253 grad_norm=41.17 num_segments=256 num_words=211
2020-06-07 17:35:10,790: 17) loss=0.264 grad_norm=36.95 num_segments=256 num_words=210
2020-06-07 17:36:16,921: 18) loss=0.241 grad_norm=39.37 num_segments=256 num_words=218
2020-06-07 17:37:23,146: 19) loss=0.237 grad_norm=43.57 num_segments=256 num_words=207
2020-06-07 17:38:30,503: 20) loss=0.242 grad_norm=36.99 num_segments=256 num_words=208
2020-06-07 17:39:37,294: 21) loss=0.246 grad_norm=27.75 num_segments=256 num_words=213
2020-06-07 17:40:44,264: 22) loss=0.267 grad_norm=34.30 num_segments=256 num_words=207
2020-06-07 17:41:50,811: 23) loss=0.237 grad_norm=47.65 num_segments=256 num_words=214
2020-06-07 17:42:57,680: 24) loss=0.240 grad_norm=39.65 num_segments=256 num_words=212
2020-06-07 17:44:04,878: 25) loss=0.244 grad_norm=46.80 num_segments=256 num_words=212
2020-06-07 17:45:11,898: 26) loss=0.244 grad_norm=42.89 num_segments=256 num_words=210
2020-06-07 17:46:18,775: 27) loss=0.319 grad_norm=32.85 num_segments=256 num_words=209
2020-06-07 17:47:25,806: 28) loss=0.224 grad_norm=38.41 num_segments=256 num_words=213
2020-06-07 17:48:32,938: 29) loss=0.246 grad_norm=56.11 num_segments=256 num_words=218
2020-06-07 17:49:39,719: 30) loss=0.232 grad_norm=38.47 num_segments=256 num_words=199
2020-06-07 17:50:46,712: 31) loss=0.221 grad_norm=33.35 num_segments=256 num_words=202
2020-06-07 17:51:53,384: 32) loss=0.232 grad_norm=36.25 num_segments=256 num_words=210
2020-06-07 17:53:00,385: 33) loss=0.213 grad_norm=26.25 num_segments=256 num_words=213
2020-06-07 17:54:07,550: 34) loss=0.223 grad_norm=38.01 num_segments=256 num_words=208
2020-06-07 17:55:14,593: 35) loss=0.213 grad_norm=35.95 num_segments=256 num_words=203
2020-06-07 17:56:21,527: 36) loss=0.315 grad_norm=34.42 num_segments=256 num_words=213
2020-06-07 17:57:29,003: 37) loss=0.210 grad_norm=46.29 num_segments=256 num_words=195
2020-06-07 17:58:28,816: 38) loss=0.211 grad_norm=30.55 num_segments=243 num_words=203
2020-06-07 17:58:28,835: epoch= 4.00
2020-06-07 17:58:28,835:  >> time to evaluate and save:
2020-06-07 17:58:28,926: saved save/MultiViewDataset_IndividualWords.156.pth
2020-06-07 17:58:28,929: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 17:58:28,932: saved MultiViewDataset_IndividualWords successfully
2020-06-07 17:58:31,185: saved save/MultiViewRNN.156.pth
2020-06-07 17:58:34,710: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 17:58:34,720: saved MultiViewRNN successfully
2020-06-07 17:58:40,217: saved save/Adam.156.pth
2020-06-07 17:58:40,221: most_recent linked save/Adam.most_recent.pth
2020-06-07 17:58:40,229: saved Adam successfully
2020-06-07 17:58:40,281: saved save/ReduceLROnPlateau.156.pth
2020-06-07 17:58:40,330: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 17:58:40,333: saved ReduceLROnPlateau successfully
2020-06-07 17:58:40,337: saved config successfully
2020-06-07 18:00:23,767:   >> crossview_ap=0.448 (10966 x 3921 pairs)
2020-06-07 18:01:30,464:   >> acoustic_ap=0.465 (10966 choose 2 pairs)
2020-06-07 18:01:30,468: best_so_far= 0.448 at 156
2020-06-07 18:01:30,482: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 18:01:30,485: saved MultiViewDataset_IndividualWords successfully
2020-06-07 18:01:30,487: best linked save/MultiViewRNN.best.pth
2020-06-07 18:01:30,498: saved MultiViewRNN successfully
2020-06-07 18:01:30,500: best linked save/Adam.best.pth
2020-06-07 18:01:30,510: saved Adam successfully
2020-06-07 18:01:30,511: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 18:01:30,514: saved ReduceLROnPlateau successfully
2020-06-07 18:01:30,563: epoch=4.00 global_step=156 lr=0.001 start_iter=0
2020-06-07 18:01:30,563: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 18:02:37,500: 0) loss=0.213 grad_norm=32.51 num_segments=256 num_words=204
2020-06-07 18:03:44,307: 1) loss=0.226 grad_norm=28.38 num_segments=256 num_words=215
2020-06-07 18:04:52,139: 2) loss=0.238 grad_norm=43.91 num_segments=256 num_words=214
2020-06-07 18:06:00,192: 3) loss=0.216 grad_norm=28.91 num_segments=256 num_words=203
2020-06-07 18:07:07,298: 4) loss=0.204 grad_norm=29.15 num_segments=256 num_words=216
2020-06-07 18:08:14,094: 5) loss=0.226 grad_norm=51.24 num_segments=256 num_words=212
2020-06-07 18:09:21,216: 6) loss=0.211 grad_norm=38.68 num_segments=256 num_words=206
2020-06-07 18:10:27,149: 7) loss=0.198 grad_norm=35.81 num_segments=256 num_words=205
2020-06-07 18:11:34,812: 8) loss=0.208 grad_norm=28.27 num_segments=256 num_words=213
2020-06-07 18:12:41,931: 9) loss=0.227 grad_norm=35.61 num_segments=256 num_words=219
2020-06-07 18:13:48,839: 10) loss=0.210 grad_norm=33.93 num_segments=256 num_words=217
2020-06-07 18:14:54,737: 11) loss=0.202 grad_norm=29.44 num_segments=256 num_words=214
2020-06-07 18:16:01,445: 12) loss=0.202 grad_norm=32.39 num_segments=256 num_words=207
2020-06-07 18:17:07,834: 13) loss=0.199 grad_norm=25.69 num_segments=256 num_words=210
2020-06-07 18:18:15,290: 14) loss=0.206 grad_norm=33.84 num_segments=256 num_words=204
2020-06-07 18:19:22,621: 15) loss=0.201 grad_norm=27.81 num_segments=256 num_words=211
2020-06-07 18:20:29,228: 16) loss=0.194 grad_norm=30.96 num_segments=256 num_words=201
2020-06-07 18:21:35,875: 17) loss=0.209 grad_norm=28.35 num_segments=256 num_words=210
2020-06-07 18:22:42,999: 18) loss=0.200 grad_norm=32.76 num_segments=256 num_words=217
2020-06-07 18:23:49,717: 19) loss=0.198 grad_norm=29.79 num_segments=256 num_words=212
2020-06-07 18:24:56,871: 20) loss=0.174 grad_norm=28.37 num_segments=256 num_words=194
2020-06-07 18:26:03,905: 21) loss=0.185 grad_norm=37.10 num_segments=256 num_words=203
2020-06-07 18:27:11,781: 22) loss=0.218 grad_norm=42.42 num_segments=256 num_words=219
2020-06-07 18:28:17,766: 23) loss=0.193 grad_norm=26.62 num_segments=256 num_words=207
2020-06-07 18:29:23,581: 24) loss=0.196 grad_norm=24.38 num_segments=256 num_words=196
2020-06-07 18:30:29,958: 25) loss=0.199 grad_norm=26.11 num_segments=256 num_words=220
2020-06-07 18:31:36,042: 26) loss=0.218 grad_norm=27.51 num_segments=256 num_words=213
2020-06-07 18:32:42,951: 27) loss=0.187 grad_norm=34.33 num_segments=256 num_words=214
2020-06-07 18:33:50,486: 28) loss=0.187 grad_norm=27.05 num_segments=256 num_words=207
2020-06-07 18:34:57,005: 29) loss=0.226 grad_norm=33.53 num_segments=256 num_words=210
2020-06-07 18:36:03,475: 30) loss=0.207 grad_norm=24.98 num_segments=256 num_words=208
2020-06-07 18:37:10,934: 31) loss=0.236 grad_norm=47.17 num_segments=256 num_words=216
2020-06-07 18:38:17,313: 32) loss=0.193 grad_norm=32.85 num_segments=256 num_words=202
2020-06-07 18:39:23,809: 33) loss=0.243 grad_norm=47.02 num_segments=256 num_words=220
2020-06-07 18:40:30,804: 34) loss=0.188 grad_norm=40.82 num_segments=256 num_words=218
2020-06-07 18:41:36,806: 35) loss=0.198 grad_norm=32.90 num_segments=256 num_words=213
2020-06-07 18:42:43,690: 36) loss=0.186 grad_norm=45.35 num_segments=256 num_words=205
2020-06-07 18:43:50,852: 37) loss=0.189 grad_norm=34.40 num_segments=256 num_words=204
2020-06-07 18:44:52,691: 38) loss=0.206 grad_norm=27.47 num_segments=243 num_words=206
2020-06-07 18:44:52,711: epoch= 5.00
2020-06-07 18:44:52,711:  >> time to evaluate and save:
2020-06-07 18:44:52,824: saved save/MultiViewDataset_IndividualWords.195.pth
2020-06-07 18:44:52,880: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 18:44:52,895: saved MultiViewDataset_IndividualWords successfully
2020-06-07 18:44:55,085: saved save/MultiViewRNN.195.pth
2020-06-07 18:44:55,087: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 18:44:55,097: saved MultiViewRNN successfully
2020-06-07 18:44:59,555: saved save/Adam.195.pth
2020-06-07 18:44:59,559: most_recent linked save/Adam.most_recent.pth
2020-06-07 18:44:59,567: saved Adam successfully
2020-06-07 18:44:59,603: saved save/ReduceLROnPlateau.195.pth
2020-06-07 18:44:59,609: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 18:44:59,613: saved ReduceLROnPlateau successfully
2020-06-07 18:44:59,677: saved config successfully
2020-06-07 18:46:42,372:   >> crossview_ap=0.525 (10966 x 3921 pairs)
2020-06-07 18:47:48,814:   >> acoustic_ap=0.533 (10966 choose 2 pairs)
2020-06-07 18:47:48,818: best_so_far= 0.525 at 195
2020-06-07 18:47:48,831: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 18:47:48,834: saved MultiViewDataset_IndividualWords successfully
2020-06-07 18:47:48,836: best linked save/MultiViewRNN.best.pth
2020-06-07 18:47:48,848: saved MultiViewRNN successfully
2020-06-07 18:47:48,850: best linked save/Adam.best.pth
2020-06-07 18:47:48,860: saved Adam successfully
2020-06-07 18:47:48,862: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 18:47:48,865: saved ReduceLROnPlateau successfully
2020-06-07 18:47:48,987: epoch=5.00 global_step=195 lr=0.001 start_iter=0
2020-06-07 18:47:48,987: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 18:48:58,321: 0) loss=0.177 grad_norm=27.83 num_segments=256 num_words=208
2020-06-07 18:50:04,408: 1) loss=0.187 grad_norm=36.95 num_segments=256 num_words=212
2020-06-07 18:51:11,153: 2) loss=0.162 grad_norm=52.16 num_segments=256 num_words=209
2020-06-07 19:49:41,186: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-07 19:49:41,218: Using 1 GPU(s)
2020-06-07 19:49:41,219: Machine: 0 / 1
2020-06-07 19:49:41,240: Hyperparam tuning-------------------
2020-06-07 19:49:41,240: optim_lr: 0.001
2020-06-07 19:49:41,240: dropout (for both): 0.4
2020-06-07 19:49:41,240: margin: 0.4
2020-06-07 19:49:41,240: ------------------------------------
2020-06-07 19:49:41,242: Calling main function: multiview_trainer.train
2020-06-07 19:49:41,242: Using config file: train_config.json
2020-06-07 19:49:41,242: Using module at multiview_trainer.train
2020-06-07 19:49:41,662: Using module at multiview_vocab.MultiViewVocab
2020-06-07 19:49:41,810: Building vocab_data from config
2020-06-07 19:49:42,039:  >> min_count= 0
2020-06-07 19:49:42,040:  >> # words= 34323 (# removed= 0)
2020-06-07 19:49:42,040:  >> # subwords= 45
2020-06-07 19:49:42,040:     [laughter]= 1
2020-06-07 19:49:42,040:     [noise]= 2
2020-06-07 19:49:42,040:     [vocalized-noise]= 3
2020-06-07 19:49:42,040:     aa= 4
2020-06-07 19:49:42,040:     ae= 5
2020-06-07 19:49:42,040:     ah= 6
2020-06-07 19:49:42,040:     ao= 7
2020-06-07 19:49:42,040:     aw= 8
2020-06-07 19:49:42,040:     ax= 9
2020-06-07 19:49:42,040:     ay= 10
2020-06-07 19:49:42,041:     b= 11
2020-06-07 19:49:42,041:     ch= 12
2020-06-07 19:49:42,041:     d= 13
2020-06-07 19:49:42,041:     dh= 14
2020-06-07 19:49:42,041:     eh= 15
2020-06-07 19:49:42,041:     el= 16
2020-06-07 19:49:42,041:     en= 17
2020-06-07 19:49:42,041:     er= 18
2020-06-07 19:49:42,041:     ey= 19
2020-06-07 19:49:42,041:     f= 20
2020-06-07 19:49:42,041:     g= 21
2020-06-07 19:49:42,041:     hh= 22
2020-06-07 19:49:42,041:     ih= 23
2020-06-07 19:49:42,041:     iy= 24
2020-06-07 19:49:42,041:     jh= 25
2020-06-07 19:49:42,041:     k= 26
2020-06-07 19:49:42,042:     l= 27
2020-06-07 19:49:42,042:     m= 28
2020-06-07 19:49:42,042:     n= 29
2020-06-07 19:49:42,042:     ng= 30
2020-06-07 19:49:42,042:     ow= 31
2020-06-07 19:49:42,042:     oy= 32
2020-06-07 19:49:42,042:     p= 33
2020-06-07 19:49:42,042:     r= 34
2020-06-07 19:49:42,042:     s= 35
2020-06-07 19:49:42,042:     sh= 36
2020-06-07 19:49:42,042:     t= 37
2020-06-07 19:49:42,042:     th= 38
2020-06-07 19:49:42,042:     uh= 39
2020-06-07 19:49:42,042:     uw= 40
2020-06-07 19:49:42,042:     v= 41
2020-06-07 19:49:42,043:     w= 42
2020-06-07 19:49:42,043:     y= 43
2020-06-07 19:49:42,043:     z= 44
2020-06-07 19:49:42,043:     zh= 45
2020-06-07 19:49:42,054: Using module at data.batch_samplers.BatchSampler
2020-06-07 19:49:42,071: Building vocab_sampler from config
2020-06-07 19:49:42,072:  >> # examples= 34323
2020-06-07 19:49:42,072:  >> batch_size= 1000
2020-06-07 19:49:42,072:  >> shuffle= False
2020-06-07 19:49:42,078:  >> BatchSampler; 35 batches
2020-06-07 19:49:42,078: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 19:49:42,245: Building train_data from config
2020-06-07 19:49:49,738:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-07 19:49:49,739:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-07 19:49:49,739:  >> stack= False
2020-06-07 19:49:49,739:  >> seg_durs= (1, None)
2020-06-07 19:49:49,739:  >> # words= 9971 (# ignored= 0)
2020-06-07 19:49:49,739:  >> input_feat_dim= 108
2020-06-07 19:49:49,740:  >> input_num_subwords= 45
2020-06-07 19:49:49,740: Using module at data.batch_samplers.BatchSampler
2020-06-07 19:49:49,740: Building train_sampler from config
2020-06-07 19:49:49,741:  >> # examples= 9971
2020-06-07 19:49:49,741:  >> batch_size= 256
2020-06-07 19:49:49,741:  >> shuffle= True
2020-06-07 19:49:49,748:  >> BatchSampler; 39 batches
2020-06-07 19:49:49,748: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 19:49:49,748: Building dev_data from config
2020-06-07 19:49:58,389:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-07 19:49:58,390:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-07 19:49:58,390:  >> stack= False
2020-06-07 19:49:58,390:  >> seg_durs= (1, None)
2020-06-07 19:49:58,390:  >> # words= 10966 (# ignored= 0)
2020-06-07 19:49:58,390:  >> input_feat_dim= 108
2020-06-07 19:49:58,390:  >> input_num_subwords= 45
2020-06-07 19:49:58,390: Using module at data.batch_samplers.BatchSampler
2020-06-07 19:49:58,390: Building dev_sampler from config
2020-06-07 19:49:58,391:  >> # examples= 10966
2020-06-07 19:49:58,391:  >> batch_size= 256
2020-06-07 19:49:58,391:  >> shuffle= False
2020-06-07 19:49:58,393:  >> BatchSampler; 43 batches
2020-06-07 19:49:58,393: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 19:49:58,393: Building test_data from config
2020-06-07 19:50:05,832:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-07 19:50:05,833:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-07 19:50:05,833:  >> stack= False
2020-06-07 19:50:05,833:  >> seg_durs= (1, None)
2020-06-07 19:50:05,833:  >> # words= 11024 (# ignored= 0)
2020-06-07 19:50:05,833:  >> input_feat_dim= 108
2020-06-07 19:50:05,833:  >> input_num_subwords= 45
2020-06-07 19:50:05,833: Using module at data.batch_samplers.BatchSampler
2020-06-07 19:50:05,833: Building test_sampler from config
2020-06-07 19:50:05,834:  >> # examples= 11024
2020-06-07 19:50:05,834:  >> batch_size= 256
2020-06-07 19:50:05,834:  >> shuffle= False
2020-06-07 19:50:05,836:  >> BatchSampler; 44 batches
2020-06-07 19:50:05,836: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-07 19:50:05,950: Building loss from config
2020-06-07 19:50:05,951:  >> margin= 0.4
2020-06-07 19:50:05,951:  >> k= 16
2020-06-07 19:50:05,951:  >> min_k= 8
2020-06-07 19:50:05,951:  >> extra= 0
2020-06-07 19:50:05,951:  >> average= False
2020-06-07 19:50:05,951: Using module at metric.multiview_ap.MultiViewAP
2020-06-07 19:50:06,056: Building eval from config
2020-06-07 19:50:06,057:  >> acoustic_ap= True
2020-06-07 19:50:06,057:  >> crossview_ap= True
2020-06-07 19:50:06,057:  >> full_vocab= False
2020-06-07 19:50:06,057:  >> metric= crossview_ap
2020-06-07 19:50:06,057:  >> mode= max
2020-06-07 19:50:06,057: Using module at multiview_rnn.MultiViewRNN
2020-06-07 19:50:06,238: Building net from config
2020-06-07 19:50:06,239: view1:
2020-06-07 19:50:06,240:  >> cell= GRU
2020-06-07 19:50:06,240:  >> input_size= 108
2020-06-07 19:50:06,240:  >> hidden_size= 512
2020-06-07 19:50:06,240:  >> bidirectional= True
2020-06-07 19:50:06,240:  >> num_layers= 6
2020-06-07 19:50:06,240:  >> dropout between layers= 0.4
2020-06-07 19:50:06,454: view2:
2020-06-07 19:50:06,455:  >> cell= GRU
2020-06-07 19:50:06,455:  >> input_size= 64
2020-06-07 19:50:06,455:  >> hidden_size= 512
2020-06-07 19:50:06,455:  >> bidirectional= True
2020-06-07 19:50:06,455:  >> num_layers= 2
2020-06-07 19:50:06,455:  >> dropout between layers= 0.4
2020-06-07 19:50:06,455:  >> num input embeddings= 45
2020-06-07 19:50:09,841: Using module at optim.adam.Adam
2020-06-07 19:50:09,926: Building optim from config
2020-06-07 19:50:09,927:  >> lr= 0.001
2020-06-07 19:50:09,927:  >> betas= (0.9, 0.999)
2020-06-07 19:50:09,927:  >> eps= 1e-08
2020-06-07 19:50:09,927:  >> weight_decay= 0
2020-06-07 19:50:09,927:  >> amsgrad= False
2020-06-07 19:50:09,927:  >> min_lr= 1e-07
2020-06-07 19:50:09,929: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-07 19:50:10,153: Building sched from config
2020-06-07 19:50:10,153:  >> optim= Adam
2020-06-07 19:50:10,153:  >> decay lr by 0.1
2020-06-07 19:50:10,154:  >> eval_fn= MultiViewAP
2020-06-07 19:50:10,154:  >> patience=4
2020-06-07 19:50:10,154:  >> revert=True
2020-06-07 19:50:10,220: loaded save/MultiViewDataset_IndividualWords.195.pth
2020-06-07 19:50:10,220: note: relative to /home-nfs/ruolinzheng/obj0-phones-edit
2020-06-07 19:50:11,876: loaded save/MultiViewRNN.195.pth
2020-06-07 19:50:11,877: note: relative to /home-nfs/ruolinzheng/obj0-phones-edit
2020-06-07 19:50:15,016: loaded save/Adam.195.pth
2020-06-07 19:50:15,017: note: relative to /home-nfs/ruolinzheng/obj0-phones-edit
2020-06-07 19:50:15,042: loaded save/ReduceLROnPlateau.195.pth
2020-06-07 19:50:15,042: note: relative to /home-nfs/ruolinzheng/obj0-phones-edit
2020-06-07 19:50:15,042: epoch=5.00 global_step=195 lr=0.001 start_iter=0
2020-06-07 19:50:15,042: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 19:52:01,976: 0) loss=0.115 grad_norm=25.90 num_segments=256 num_words=208
2020-06-07 19:53:39,868: 1) loss=0.126 grad_norm=33.30 num_segments=256 num_words=212
2020-06-07 19:55:10,884: 2) loss=0.118 grad_norm=46.73 num_segments=256 num_words=209
2020-06-07 19:56:35,094: 3) loss=0.139 grad_norm=42.56 num_segments=256 num_words=206
2020-06-07 19:57:51,930: 4) loss=0.153 grad_norm=28.41 num_segments=256 num_words=209
2020-06-07 19:59:02,222: 5) loss=0.159 grad_norm=29.52 num_segments=256 num_words=214
2020-06-07 20:00:05,355: 6) loss=0.168 grad_norm=30.39 num_segments=256 num_words=209
2020-06-07 20:01:01,921: 7) loss=0.158 grad_norm=26.14 num_segments=256 num_words=212
2020-06-07 20:01:58,420: 8) loss=0.166 grad_norm=28.31 num_segments=256 num_words=198
2020-06-07 20:02:54,678: 9) loss=0.181 grad_norm=36.60 num_segments=256 num_words=210
2020-06-07 20:03:50,653: 10) loss=0.159 grad_norm=32.27 num_segments=256 num_words=205
2020-06-07 20:04:47,396: 11) loss=0.167 grad_norm=23.66 num_segments=256 num_words=217
2020-06-07 20:05:43,567: 12) loss=0.188 grad_norm=36.92 num_segments=256 num_words=221
2020-06-07 20:06:40,056: 13) loss=0.171 grad_norm=28.45 num_segments=256 num_words=212
2020-06-07 20:07:36,865: 14) loss=0.179 grad_norm=27.56 num_segments=256 num_words=207
2020-06-07 20:08:33,231: 15) loss=0.165 grad_norm=34.45 num_segments=256 num_words=205
2020-06-07 20:09:29,382: 16) loss=0.171 grad_norm=28.65 num_segments=256 num_words=210
2020-06-07 20:10:26,433: 17) loss=0.177 grad_norm=31.98 num_segments=256 num_words=203
2020-06-07 20:11:23,311: 18) loss=0.164 grad_norm=26.36 num_segments=256 num_words=206
2020-06-07 20:12:19,956: 19) loss=0.176 grad_norm=35.08 num_segments=256 num_words=211
2020-06-07 20:13:16,831: 20) loss=0.201 grad_norm=37.35 num_segments=256 num_words=209
2020-06-07 20:14:13,142: 21) loss=0.180 grad_norm=24.94 num_segments=256 num_words=202
2020-06-07 20:15:09,685: 22) loss=0.177 grad_norm=29.68 num_segments=256 num_words=210
2020-06-07 20:16:06,246: 23) loss=0.257 grad_norm=28.40 num_segments=256 num_words=216
2020-06-07 20:17:02,791: 24) loss=0.170 grad_norm=26.82 num_segments=256 num_words=206
2020-06-07 20:17:59,128: 25) loss=0.174 grad_norm=31.81 num_segments=256 num_words=216
2020-06-07 20:18:55,776: 26) loss=0.169 grad_norm=27.96 num_segments=256 num_words=210
2020-06-07 20:19:52,381: 27) loss=0.163 grad_norm=33.02 num_segments=256 num_words=208
2020-06-07 20:20:49,028: 28) loss=0.171 grad_norm=39.78 num_segments=256 num_words=210
2020-06-07 20:21:45,413: 29) loss=0.172 grad_norm=29.74 num_segments=256 num_words=213
2020-06-07 20:22:41,112: 30) loss=0.184 grad_norm=47.07 num_segments=256 num_words=212
2020-06-07 20:23:37,669: 31) loss=0.171 grad_norm=38.04 num_segments=256 num_words=209
2020-06-07 20:24:33,833: 32) loss=0.176 grad_norm=35.77 num_segments=256 num_words=219
2020-06-07 20:25:30,547: 33) loss=0.245 grad_norm=44.82 num_segments=256 num_words=203
2020-06-07 20:26:27,284: 34) loss=0.185 grad_norm=29.32 num_segments=256 num_words=215
2020-06-07 20:27:23,719: 35) loss=0.173 grad_norm=28.43 num_segments=256 num_words=214
2020-06-07 20:28:20,334: 36) loss=0.194 grad_norm=31.45 num_segments=256 num_words=212
2020-06-07 20:29:17,205: 37) loss=0.184 grad_norm=30.41 num_segments=256 num_words=208
2020-06-07 20:30:08,243: 38) loss=0.162 grad_norm=22.04 num_segments=243 num_words=205
2020-06-07 20:30:08,259: epoch= 6.00
2020-06-07 20:30:08,260:  >> time to evaluate and save:
2020-06-07 20:30:08,293: saved save/MultiViewDataset_IndividualWords.234.pth
2020-06-07 20:30:08,295: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 20:30:08,299: saved MultiViewDataset_IndividualWords successfully
2020-06-07 20:30:10,480: saved save/MultiViewRNN.234.pth
2020-06-07 20:30:10,481: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 20:30:11,101: saved MultiViewRNN successfully
2020-06-07 20:30:15,319: saved save/Adam.234.pth
2020-06-07 20:30:15,321: most_recent linked save/Adam.most_recent.pth
2020-06-07 20:30:15,851: saved Adam successfully
2020-06-07 20:30:15,853: saved save/ReduceLROnPlateau.234.pth
2020-06-07 20:30:15,872: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 20:30:15,876: saved ReduceLROnPlateau successfully
2020-06-07 20:30:15,880: saved config successfully
2020-06-07 20:31:45,913:   >> crossview_ap=0.583 (10966 x 3921 pairs)
2020-06-07 20:32:45,097:   >> acoustic_ap=0.597 (10966 choose 2 pairs)
2020-06-07 20:32:45,100: best_so_far= 0.583 at 234
2020-06-07 20:32:45,122: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 20:32:45,124: saved MultiViewDataset_IndividualWords successfully
2020-06-07 20:32:45,126: best linked save/MultiViewRNN.best.pth
2020-06-07 20:32:45,134: saved MultiViewRNN successfully
2020-06-07 20:32:45,135: best linked save/Adam.best.pth
2020-06-07 20:32:45,144: saved Adam successfully
2020-06-07 20:32:45,145: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 20:32:45,148: saved ReduceLROnPlateau successfully
2020-06-07 20:32:45,174: epoch=6.00 global_step=234 lr=0.001 start_iter=0
2020-06-07 20:32:45,174: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 20:33:42,383: 0) loss=0.145 grad_norm=41.20 num_segments=256 num_words=210
2020-06-07 20:34:38,937: 1) loss=0.154 grad_norm=30.82 num_segments=256 num_words=211
2020-06-07 20:35:35,655: 2) loss=0.176 grad_norm=25.72 num_segments=256 num_words=206
2020-06-07 20:36:32,234: 3) loss=0.176 grad_norm=32.30 num_segments=256 num_words=217
2020-06-07 20:37:29,219: 4) loss=0.153 grad_norm=47.23 num_segments=256 num_words=216
2020-06-07 20:38:26,128: 5) loss=0.153 grad_norm=30.00 num_segments=256 num_words=209
2020-06-07 20:39:22,266: 6) loss=0.156 grad_norm=27.41 num_segments=256 num_words=214
2020-06-07 20:40:18,733: 7) loss=0.151 grad_norm=37.69 num_segments=256 num_words=209
2020-06-07 20:41:15,527: 8) loss=0.157 grad_norm=24.25 num_segments=256 num_words=210
2020-06-07 20:42:11,789: 9) loss=0.162 grad_norm=31.00 num_segments=256 num_words=214
2020-06-07 20:43:08,451: 10) loss=0.146 grad_norm=28.36 num_segments=256 num_words=202
2020-06-07 20:44:05,160: 11) loss=0.138 grad_norm=22.58 num_segments=256 num_words=207
2020-06-07 20:45:01,625: 12) loss=0.147 grad_norm=20.37 num_segments=256 num_words=208
2020-06-07 20:45:58,162: 13) loss=0.148 grad_norm=29.01 num_segments=256 num_words=213
2020-06-07 20:46:54,806: 14) loss=0.140 grad_norm=23.86 num_segments=256 num_words=206
2020-06-07 20:47:51,080: 15) loss=0.146 grad_norm=28.99 num_segments=256 num_words=215
2020-06-07 20:48:46,842: 16) loss=0.150 grad_norm=36.81 num_segments=256 num_words=211
2020-06-07 20:49:42,415: 17) loss=0.151 grad_norm=34.12 num_segments=256 num_words=214
2020-06-07 20:50:37,984: 18) loss=0.170 grad_norm=27.49 num_segments=256 num_words=212
2020-06-07 20:51:33,557: 19) loss=0.168 grad_norm=29.87 num_segments=256 num_words=202
2020-06-07 20:52:27,855: 20) loss=0.170 grad_norm=28.52 num_segments=256 num_words=213
2020-06-07 20:53:22,457: 21) loss=0.137 grad_norm=22.54 num_segments=256 num_words=207
2020-06-07 20:54:18,886: 22) loss=0.142 grad_norm=26.70 num_segments=256 num_words=209
2020-06-07 20:55:15,385: 23) loss=0.154 grad_norm=31.49 num_segments=256 num_words=207
2020-06-07 20:56:12,017: 24) loss=0.165 grad_norm=34.37 num_segments=256 num_words=209
2020-06-07 20:57:08,843: 25) loss=0.139 grad_norm=29.02 num_segments=256 num_words=203
2020-06-07 20:58:04,843: 26) loss=0.140 grad_norm=30.68 num_segments=256 num_words=208
2020-06-07 20:59:01,479: 27) loss=0.150 grad_norm=24.76 num_segments=256 num_words=210
2020-06-07 20:59:57,719: 28) loss=0.130 grad_norm=25.15 num_segments=256 num_words=200
2020-06-07 21:00:54,528: 29) loss=0.154 grad_norm=36.39 num_segments=256 num_words=204
2020-06-07 21:01:50,803: 30) loss=0.143 grad_norm=32.40 num_segments=256 num_words=208
2020-06-07 21:02:47,265: 31) loss=0.153 grad_norm=28.62 num_segments=256 num_words=215
2020-06-07 21:03:43,902: 32) loss=0.164 grad_norm=27.55 num_segments=256 num_words=214
2020-06-07 21:04:40,452: 33) loss=0.157 grad_norm=32.18 num_segments=256 num_words=215
2020-06-07 21:05:36,919: 34) loss=0.151 grad_norm=28.27 num_segments=256 num_words=212
2020-06-07 21:06:33,546: 35) loss=0.142 grad_norm=32.91 num_segments=256 num_words=203
2020-06-07 21:07:29,952: 36) loss=0.171 grad_norm=28.08 num_segments=256 num_words=217
2020-06-07 21:08:26,674: 37) loss=0.159 grad_norm=28.58 num_segments=256 num_words=206
2020-06-07 21:09:16,808: 38) loss=0.146 grad_norm=27.50 num_segments=243 num_words=200
2020-06-07 21:09:16,828: epoch= 7.00
2020-06-07 21:09:16,828:  >> time to evaluate and save:
2020-06-07 21:09:16,986: saved save/MultiViewDataset_IndividualWords.273.pth
2020-06-07 21:09:16,988: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 21:09:17,000: removed save/MultiViewDataset_IndividualWords.39.pth
2020-06-07 21:09:17,000: saved MultiViewDataset_IndividualWords successfully
2020-06-07 21:09:19,165: saved save/MultiViewRNN.273.pth
2020-06-07 21:09:19,167: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 21:09:19,329: removed save/MultiViewRNN.39.pth
2020-06-07 21:09:19,330: saved MultiViewRNN successfully
2020-06-07 21:09:23,668: saved save/Adam.273.pth
2020-06-07 21:09:23,705: most_recent linked save/Adam.most_recent.pth
2020-06-07 21:09:23,840: removed save/Adam.39.pth
2020-06-07 21:09:23,840: saved Adam successfully
2020-06-07 21:09:23,913: saved save/ReduceLROnPlateau.273.pth
2020-06-07 21:09:23,915: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 21:09:23,918: saved ReduceLROnPlateau successfully
2020-06-07 21:09:23,921: saved config successfully
2020-06-07 21:10:44,816:   >> crossview_ap=0.587 (10966 x 3921 pairs)
2020-06-07 21:11:46,105:   >> acoustic_ap=0.600 (10966 choose 2 pairs)
2020-06-07 21:11:46,107: best_so_far= 0.587 at 273
2020-06-07 21:11:46,110: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 21:11:46,113: saved MultiViewDataset_IndividualWords successfully
2020-06-07 21:11:46,114: best linked save/MultiViewRNN.best.pth
2020-06-07 21:11:46,122: saved MultiViewRNN successfully
2020-06-07 21:11:46,124: best linked save/Adam.best.pth
2020-06-07 21:11:46,126: saved Adam successfully
2020-06-07 21:11:46,127: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 21:11:46,138: removed save/ReduceLROnPlateau.39.pth
2020-06-07 21:11:46,138: saved ReduceLROnPlateau successfully
2020-06-07 21:11:46,189: epoch=7.00 global_step=273 lr=0.001 start_iter=0
2020-06-07 21:11:46,189: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 21:12:42,591: 0) loss=0.131 grad_norm=25.28 num_segments=256 num_words=202
2020-06-07 21:13:36,822: 1) loss=0.136 grad_norm=23.45 num_segments=256 num_words=217
2020-06-07 21:14:30,879: 2) loss=0.131 grad_norm=19.72 num_segments=256 num_words=212
2020-06-07 21:15:26,699: 3) loss=0.134 grad_norm=35.46 num_segments=256 num_words=211
2020-06-07 21:16:20,841: 4) loss=0.137 grad_norm=28.18 num_segments=256 num_words=207
2020-06-07 21:17:15,204: 5) loss=0.138 grad_norm=27.67 num_segments=256 num_words=208
2020-06-07 21:18:07,918: 6) loss=0.125 grad_norm=26.12 num_segments=256 num_words=208
2020-06-07 21:19:01,584: 7) loss=0.122 grad_norm=31.39 num_segments=256 num_words=207
2020-06-07 21:19:54,369: 8) loss=0.129 grad_norm=21.67 num_segments=256 num_words=218
2020-06-07 21:20:47,742: 9) loss=0.134 grad_norm=37.50 num_segments=256 num_words=215
2020-06-07 21:21:41,086: 10) loss=0.136 grad_norm=35.71 num_segments=256 num_words=207
2020-06-07 21:22:34,284: 11) loss=0.143 grad_norm=24.27 num_segments=256 num_words=210
2020-06-07 21:23:27,419: 12) loss=0.128 grad_norm=30.66 num_segments=256 num_words=217
2020-06-07 21:24:20,872: 13) loss=0.138 grad_norm=32.13 num_segments=256 num_words=209
2020-06-07 21:25:13,845: 14) loss=0.131 grad_norm=29.93 num_segments=256 num_words=209
2020-06-07 21:26:06,538: 15) loss=0.138 grad_norm=40.48 num_segments=256 num_words=218
2020-06-07 21:26:59,586: 16) loss=0.121 grad_norm=27.39 num_segments=256 num_words=205
2020-06-07 21:27:52,363: 17) loss=0.130 grad_norm=24.59 num_segments=256 num_words=213
2020-06-07 21:28:45,582: 18) loss=0.126 grad_norm=24.60 num_segments=256 num_words=214
2020-06-07 21:29:39,004: 19) loss=0.134 grad_norm=36.13 num_segments=256 num_words=208
2020-06-07 21:30:32,450: 20) loss=0.200 grad_norm=27.53 num_segments=256 num_words=206
2020-06-07 21:31:26,062: 21) loss=0.144 grad_norm=26.93 num_segments=256 num_words=211
2020-06-07 21:32:19,343: 22) loss=0.131 grad_norm=26.04 num_segments=256 num_words=206
2020-06-07 21:33:12,835: 23) loss=0.143 grad_norm=29.25 num_segments=256 num_words=214
2020-06-07 21:34:06,745: 24) loss=0.157 grad_norm=30.22 num_segments=256 num_words=221
2020-06-07 21:35:00,134: 25) loss=0.202 grad_norm=20.57 num_segments=256 num_words=207
2020-06-07 21:35:53,277: 26) loss=0.137 grad_norm=30.08 num_segments=256 num_words=207
2020-06-07 21:36:46,609: 27) loss=0.136 grad_norm=28.10 num_segments=256 num_words=216
2020-06-07 21:37:39,322: 28) loss=0.135 grad_norm=23.40 num_segments=256 num_words=225
2020-06-07 21:38:32,535: 29) loss=0.141 grad_norm=25.59 num_segments=256 num_words=210
2020-06-07 21:39:25,783: 30) loss=0.124 grad_norm=27.26 num_segments=256 num_words=213
2020-06-07 21:40:18,522: 31) loss=0.130 grad_norm=33.40 num_segments=256 num_words=219
2020-06-07 21:41:12,099: 32) loss=0.136 grad_norm=20.72 num_segments=256 num_words=204
2020-06-07 21:42:05,271: 33) loss=0.127 grad_norm=24.97 num_segments=256 num_words=199
2020-06-07 21:42:58,121: 34) loss=0.149 grad_norm=27.05 num_segments=256 num_words=216
2020-06-07 21:43:52,103: 35) loss=0.125 grad_norm=21.59 num_segments=256 num_words=212
2020-06-07 21:44:45,418: 36) loss=0.126 grad_norm=28.51 num_segments=256 num_words=211
2020-06-07 21:45:38,856: 37) loss=0.136 grad_norm=30.25 num_segments=256 num_words=221
2020-06-07 21:46:26,763: 38) loss=0.139 grad_norm=29.88 num_segments=243 num_words=211
2020-06-07 21:46:26,778: epoch= 8.00
2020-06-07 21:46:26,778:  >> time to evaluate and save:
2020-06-07 21:46:26,868: saved save/MultiViewDataset_IndividualWords.312.pth
2020-06-07 21:46:26,870: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 21:46:26,881: removed save/MultiViewDataset_IndividualWords.78.pth
2020-06-07 21:46:26,881: saved MultiViewDataset_IndividualWords successfully
2020-06-07 21:46:29,067: saved save/MultiViewRNN.312.pth
2020-06-07 21:46:29,069: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 21:46:29,163: removed save/MultiViewRNN.78.pth
2020-06-07 21:46:29,163: saved MultiViewRNN successfully
2020-06-07 21:46:32,876: saved save/Adam.312.pth
2020-06-07 21:46:32,879: most_recent linked save/Adam.most_recent.pth
2020-06-07 21:46:32,946: removed save/Adam.78.pth
2020-06-07 21:46:32,946: saved Adam successfully
2020-06-07 21:46:32,996: saved save/ReduceLROnPlateau.312.pth
2020-06-07 21:46:33,019: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 21:46:33,023: removed save/ReduceLROnPlateau.78.pth
2020-06-07 21:46:33,024: saved ReduceLROnPlateau successfully
2020-06-07 21:46:33,026: saved config successfully
2020-06-07 21:47:54,011:   >> crossview_ap=0.613 (10966 x 3921 pairs)
2020-06-07 21:48:47,712:   >> acoustic_ap=0.624 (10966 choose 2 pairs)
2020-06-07 21:48:47,717: best_so_far= 0.613 at 312
2020-06-07 21:48:47,721: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 21:48:47,723: saved MultiViewDataset_IndividualWords successfully
2020-06-07 21:48:47,724: best linked save/MultiViewRNN.best.pth
2020-06-07 21:48:47,734: saved MultiViewRNN successfully
2020-06-07 21:48:47,736: best linked save/Adam.best.pth
2020-06-07 21:48:47,740: saved Adam successfully
2020-06-07 21:48:47,741: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 21:48:47,743: saved ReduceLROnPlateau successfully
2020-06-07 21:48:47,786: epoch=8.00 global_step=312 lr=0.001 start_iter=0
2020-06-07 21:48:47,787: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 21:49:42,265: 0) loss=0.129 grad_norm=23.67 num_segments=256 num_words=208
2020-06-07 21:50:35,703: 1) loss=0.113 grad_norm=20.07 num_segments=256 num_words=208
2020-06-07 21:51:28,788: 2) loss=0.128 grad_norm=26.99 num_segments=256 num_words=213
2020-06-07 21:52:23,317: 3) loss=0.139 grad_norm=17.52 num_segments=256 num_words=208
2020-06-07 21:53:16,512: 4) loss=0.125 grad_norm=31.19 num_segments=256 num_words=205
2020-06-07 21:54:10,797: 5) loss=0.128 grad_norm=23.81 num_segments=256 num_words=213
2020-06-07 21:55:03,716: 6) loss=0.141 grad_norm=22.73 num_segments=256 num_words=218
2020-06-07 21:55:56,616: 7) loss=0.134 grad_norm=21.76 num_segments=256 num_words=205
2020-06-07 21:56:50,127: 8) loss=0.109 grad_norm=24.31 num_segments=256 num_words=206
2020-06-07 21:57:43,592: 9) loss=0.119 grad_norm=27.43 num_segments=256 num_words=219
2020-06-07 21:58:37,222: 10) loss=0.112 grad_norm=22.56 num_segments=256 num_words=205
2020-06-07 21:59:30,368: 11) loss=0.127 grad_norm=34.59 num_segments=256 num_words=199
2020-06-07 22:00:23,583: 12) loss=0.153 grad_norm=33.58 num_segments=256 num_words=214
2020-06-07 22:01:16,898: 13) loss=0.126 grad_norm=25.98 num_segments=256 num_words=210
2020-06-07 22:02:10,416: 14) loss=0.117 grad_norm=28.23 num_segments=256 num_words=198
2020-06-07 22:03:03,721: 15) loss=0.124 grad_norm=27.11 num_segments=256 num_words=216
2020-06-07 22:03:57,227: 16) loss=0.125 grad_norm=26.74 num_segments=256 num_words=215
2020-06-07 22:04:50,729: 17) loss=0.143 grad_norm=22.39 num_segments=256 num_words=217
2020-06-07 22:05:44,131: 18) loss=0.122 grad_norm=22.69 num_segments=256 num_words=215
2020-06-07 22:06:37,789: 19) loss=0.122 grad_norm=21.49 num_segments=256 num_words=214
2020-06-07 22:07:30,798: 20) loss=0.187 grad_norm=22.99 num_segments=256 num_words=210
2020-06-07 22:08:23,683: 21) loss=0.159 grad_norm=26.35 num_segments=256 num_words=217
2020-06-07 22:09:16,961: 22) loss=0.121 grad_norm=22.63 num_segments=256 num_words=219
2020-06-07 22:10:10,582: 23) loss=0.138 grad_norm=28.70 num_segments=256 num_words=204
2020-06-07 22:11:03,404: 24) loss=0.158 grad_norm=28.90 num_segments=256 num_words=219
2020-06-07 22:11:56,657: 25) loss=0.134 grad_norm=21.70 num_segments=256 num_words=213
2020-06-07 22:12:50,115: 26) loss=0.125 grad_norm=30.18 num_segments=256 num_words=203
2020-06-07 22:13:43,774: 27) loss=0.138 grad_norm=23.27 num_segments=256 num_words=208
2020-06-07 22:14:37,190: 28) loss=0.119 grad_norm=33.24 num_segments=256 num_words=211
2020-06-07 22:15:30,416: 29) loss=0.122 grad_norm=17.45 num_segments=256 num_words=214
2020-06-07 22:16:23,687: 30) loss=0.122 grad_norm=23.54 num_segments=256 num_words=204
2020-06-07 22:17:17,153: 31) loss=0.118 grad_norm=29.65 num_segments=256 num_words=204
2020-06-07 22:18:10,244: 32) loss=0.126 grad_norm=22.85 num_segments=256 num_words=202
2020-06-07 22:19:03,933: 33) loss=0.115 grad_norm=22.17 num_segments=256 num_words=214
2020-06-07 22:19:57,183: 34) loss=0.137 grad_norm=38.90 num_segments=256 num_words=208
2020-06-07 22:20:50,678: 35) loss=0.200 grad_norm=26.99 num_segments=256 num_words=214
2020-06-07 22:21:43,814: 36) loss=0.118 grad_norm=41.60 num_segments=256 num_words=205
2020-06-07 22:22:36,736: 37) loss=0.108 grad_norm=28.90 num_segments=256 num_words=207
2020-06-07 22:23:24,965: 38) loss=0.210 grad_norm=33.34 num_segments=243 num_words=210
2020-06-07 22:23:24,981: epoch= 9.00
2020-06-07 22:23:24,981:  >> time to evaluate and save:
2020-06-07 22:23:25,431: saved save/MultiViewDataset_IndividualWords.351.pth
2020-06-07 22:23:25,433: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 22:23:25,503: removed save/MultiViewDataset_IndividualWords.117.pth
2020-06-07 22:23:25,503: saved MultiViewDataset_IndividualWords successfully
2020-06-07 22:23:27,737: saved save/MultiViewRNN.351.pth
2020-06-07 22:23:27,739: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 22:23:27,905: removed save/MultiViewRNN.117.pth
2020-06-07 22:23:27,905: saved MultiViewRNN successfully
2020-06-07 22:23:33,070: saved save/Adam.351.pth
2020-06-07 22:23:33,073: most_recent linked save/Adam.most_recent.pth
2020-06-07 22:23:33,290: removed save/Adam.117.pth
2020-06-07 22:23:33,291: saved Adam successfully
2020-06-07 22:23:33,357: saved save/ReduceLROnPlateau.351.pth
2020-06-07 22:23:33,358: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 22:23:33,366: removed save/ReduceLROnPlateau.117.pth
2020-06-07 22:23:33,366: saved ReduceLROnPlateau successfully
2020-06-07 22:23:33,397: saved config successfully
2020-06-07 22:24:58,035:   >> crossview_ap=0.636 (10966 x 3921 pairs)
2020-06-07 22:25:51,589:   >> acoustic_ap=0.677 (10966 choose 2 pairs)
2020-06-07 22:25:51,595: best_so_far= 0.636 at 351
2020-06-07 22:25:51,599: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 22:25:51,601: saved MultiViewDataset_IndividualWords successfully
2020-06-07 22:25:51,603: best linked save/MultiViewRNN.best.pth
2020-06-07 22:25:51,613: saved MultiViewRNN successfully
2020-06-07 22:25:51,615: best linked save/Adam.best.pth
2020-06-07 22:25:51,620: saved Adam successfully
2020-06-07 22:25:51,622: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 22:25:51,626: saved ReduceLROnPlateau successfully
2020-06-07 22:25:51,664: epoch=9.00 global_step=351 lr=0.001 start_iter=0
2020-06-07 22:25:51,664: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 22:26:45,163: 0) loss=0.145 grad_norm=25.54 num_segments=256 num_words=223
2020-06-07 22:27:38,406: 1) loss=0.114 grad_norm=28.11 num_segments=256 num_words=198
2020-06-07 22:28:31,225: 2) loss=0.118 grad_norm=22.88 num_segments=256 num_words=209
2020-06-07 22:29:24,439: 3) loss=0.118 grad_norm=39.21 num_segments=256 num_words=217
2020-06-07 22:30:18,069: 4) loss=0.105 grad_norm=21.88 num_segments=256 num_words=207
2020-06-07 22:31:11,314: 5) loss=0.108 grad_norm=16.04 num_segments=256 num_words=209
2020-06-07 22:32:04,686: 6) loss=0.115 grad_norm=20.53 num_segments=256 num_words=213
2020-06-07 22:32:57,343: 7) loss=0.128 grad_norm=29.18 num_segments=256 num_words=209
2020-06-07 22:33:50,636: 8) loss=0.119 grad_norm=17.77 num_segments=256 num_words=213
2020-06-07 22:34:44,211: 9) loss=0.131 grad_norm=27.82 num_segments=256 num_words=212
2020-06-07 22:35:37,712: 10) loss=0.119 grad_norm=23.80 num_segments=256 num_words=202
2020-06-07 22:36:31,301: 11) loss=0.108 grad_norm=18.70 num_segments=256 num_words=215
2020-06-07 22:37:24,195: 12) loss=0.115 grad_norm=22.62 num_segments=256 num_words=220
2020-06-07 22:38:17,393: 13) loss=0.114 grad_norm=29.54 num_segments=256 num_words=211
2020-06-07 22:39:10,983: 14) loss=0.108 grad_norm=17.74 num_segments=256 num_words=204
2020-06-07 22:40:04,381: 15) loss=0.113 grad_norm=19.73 num_segments=256 num_words=208
2020-06-07 22:40:56,892: 16) loss=0.115 grad_norm=23.49 num_segments=256 num_words=209
2020-06-07 22:41:50,076: 17) loss=0.100 grad_norm=25.71 num_segments=256 num_words=212
2020-06-07 22:42:43,445: 18) loss=0.113 grad_norm=24.91 num_segments=256 num_words=211
2020-06-07 22:43:36,930: 19) loss=0.126 grad_norm=28.06 num_segments=256 num_words=204
2020-06-07 22:44:30,067: 20) loss=0.183 grad_norm=29.03 num_segments=256 num_words=201
2020-06-07 22:45:23,225: 21) loss=0.121 grad_norm=16.13 num_segments=256 num_words=211
2020-06-07 22:46:16,257: 22) loss=0.123 grad_norm=21.23 num_segments=256 num_words=208
2020-06-07 22:47:09,087: 23) loss=0.105 grad_norm=17.16 num_segments=256 num_words=197
2020-06-07 22:48:01,850: 24) loss=0.107 grad_norm=21.27 num_segments=256 num_words=213
2020-06-07 22:48:55,556: 25) loss=0.112 grad_norm=16.84 num_segments=256 num_words=204
2020-06-07 22:49:48,968: 26) loss=0.111 grad_norm=19.98 num_segments=256 num_words=211
2020-06-07 22:50:42,420: 27) loss=0.108 grad_norm=30.10 num_segments=256 num_words=203
2020-06-07 22:51:35,393: 28) loss=0.102 grad_norm=25.77 num_segments=256 num_words=202
2020-06-07 22:52:27,778: 29) loss=0.111 grad_norm=30.07 num_segments=256 num_words=218
2020-06-07 22:53:20,683: 30) loss=0.123 grad_norm=22.56 num_segments=256 num_words=209
2020-06-07 22:54:14,018: 31) loss=0.108 grad_norm=19.09 num_segments=256 num_words=212
2020-06-07 22:55:07,968: 32) loss=0.109 grad_norm=19.80 num_segments=256 num_words=214
2020-06-07 22:56:02,298: 33) loss=0.127 grad_norm=24.75 num_segments=256 num_words=202
2020-06-07 22:56:55,825: 34) loss=0.125 grad_norm=21.30 num_segments=256 num_words=206
2020-06-08 18:31:19,163: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-08 18:31:19,170: Using CPU
2020-06-08 18:31:19,171: Machine: 0 / 1
2020-06-08 18:31:19,172: Hyperparam tuning-------------------
2020-06-08 18:31:19,172: optim_lr: 0.001
2020-06-08 18:31:19,172: dropout (for both): 0.4
2020-06-08 18:31:19,172: margin: 0.4
2020-06-08 18:31:19,172: ------------------------------------
2020-06-08 18:31:19,285: Calling main function: multiview_trainer.train
2020-06-08 18:31:19,286: Using config file: train_config.json
2020-06-08 18:31:19,286: Using module at multiview_trainer.train
2020-06-08 18:31:31,109: Using module at multiview_vocab.MultiViewVocab
2020-06-08 18:31:31,128: Building vocab_data from config
2020-06-08 18:31:31,533:  >> min_count= 0
2020-06-08 18:31:31,534:  >> # words= 34323 (# removed= 0)
2020-06-08 18:31:31,534:  >> # subwords= 45
2020-06-08 18:31:31,534:     [laughter]= 1
2020-06-08 18:31:31,534:     [noise]= 2
2020-06-08 18:31:31,534:     [vocalized-noise]= 3
2020-06-08 18:31:31,534:     aa= 4
2020-06-08 18:31:31,534:     ae= 5
2020-06-08 18:31:31,534:     ah= 6
2020-06-08 18:31:31,535:     ao= 7
2020-06-08 18:31:31,535:     aw= 8
2020-06-08 18:31:31,535:     ax= 9
2020-06-08 18:31:31,535:     ay= 10
2020-06-08 18:31:31,535:     b= 11
2020-06-08 18:31:31,535:     ch= 12
2020-06-08 18:31:31,535:     d= 13
2020-06-08 18:31:31,535:     dh= 14
2020-06-08 18:31:31,535:     eh= 15
2020-06-08 18:31:31,536:     el= 16
2020-06-08 18:31:31,536:     en= 17
2020-06-08 18:31:31,536:     er= 18
2020-06-08 18:31:31,536:     ey= 19
2020-06-08 18:31:31,536:     f= 20
2020-06-08 18:31:31,536:     g= 21
2020-06-08 18:31:31,536:     hh= 22
2020-06-08 18:31:31,536:     ih= 23
2020-06-08 18:31:31,536:     iy= 24
2020-06-08 18:31:31,536:     jh= 25
2020-06-08 18:31:31,536:     k= 26
2020-06-08 18:31:31,537:     l= 27
2020-06-08 18:31:31,537:     m= 28
2020-06-08 18:31:31,537:     n= 29
2020-06-08 18:31:31,537:     ng= 30
2020-06-08 18:31:31,537:     ow= 31
2020-06-08 18:31:31,537:     oy= 32
2020-06-08 18:31:31,537:     p= 33
2020-06-08 18:31:31,537:     r= 34
2020-06-08 18:31:31,537:     s= 35
2020-06-08 18:31:31,537:     sh= 36
2020-06-08 18:31:31,538:     t= 37
2020-06-08 18:31:31,538:     th= 38
2020-06-08 18:31:31,538:     uh= 39
2020-06-08 18:31:31,538:     uw= 40
2020-06-08 18:31:31,538:     v= 41
2020-06-08 18:31:31,538:     w= 42
2020-06-08 18:31:31,538:     y= 43
2020-06-08 18:31:31,538:     z= 44
2020-06-08 18:31:31,538:     zh= 45
2020-06-08 18:31:31,555: Using module at data.batch_samplers.BatchSampler
2020-06-08 18:31:31,561: Building vocab_sampler from config
2020-06-08 18:31:31,561:  >> # examples= 34323
2020-06-08 18:31:31,562:  >> batch_size= 1000
2020-06-08 18:31:31,562:  >> shuffle= False
2020-06-08 18:31:31,571:  >> BatchSampler; 35 batches
2020-06-08 18:31:31,571: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 18:31:34,860: Building train_data from config
2020-06-08 18:31:46,022:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-08 18:31:46,023:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-08 18:31:46,023:  >> stack= False
2020-06-08 18:31:46,023:  >> seg_durs= (1, None)
2020-06-08 18:31:46,023:  >> # words= 9971 (# ignored= 0)
2020-06-08 18:31:46,023:  >> input_feat_dim= 108
2020-06-08 18:31:46,023:  >> input_num_subwords= 45
2020-06-08 18:31:46,023: Using module at data.batch_samplers.BatchSampler
2020-06-08 18:31:46,023: Building train_sampler from config
2020-06-08 18:31:46,024:  >> # examples= 9971
2020-06-08 18:31:46,024:  >> batch_size= 256
2020-06-08 18:31:46,024:  >> shuffle= True
2020-06-08 18:31:46,036:  >> BatchSampler; 39 batches
2020-06-08 18:31:46,036: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 18:31:46,036: Building dev_data from config
2020-06-08 18:31:57,416:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-08 18:31:57,416:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-08 18:31:57,416:  >> stack= False
2020-06-08 18:31:57,416:  >> seg_durs= (1, None)
2020-06-08 18:31:57,416:  >> # words= 10966 (# ignored= 0)
2020-06-08 18:31:57,416:  >> input_feat_dim= 108
2020-06-08 18:31:57,417:  >> input_num_subwords= 45
2020-06-08 18:31:57,417: Using module at data.batch_samplers.BatchSampler
2020-06-08 18:31:57,417: Building dev_sampler from config
2020-06-08 18:31:57,417:  >> # examples= 10966
2020-06-08 18:31:57,418:  >> batch_size= 256
2020-06-08 18:31:57,418:  >> shuffle= False
2020-06-08 18:31:57,421:  >> BatchSampler; 43 batches
2020-06-08 18:31:57,421: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 18:31:57,421: Building test_data from config
2020-06-08 18:32:07,340:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-08 18:32:07,341:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-08 18:32:07,341:  >> stack= False
2020-06-08 18:32:07,341:  >> seg_durs= (1, None)
2020-06-08 18:32:07,341:  >> # words= 11024 (# ignored= 0)
2020-06-08 18:32:07,341:  >> input_feat_dim= 108
2020-06-08 18:32:07,341:  >> input_num_subwords= 45
2020-06-08 18:32:07,341: Using module at data.batch_samplers.BatchSampler
2020-06-08 18:32:07,341: Building test_sampler from config
2020-06-08 18:32:07,342:  >> # examples= 11024
2020-06-08 18:32:07,342:  >> batch_size= 256
2020-06-08 18:32:07,342:  >> shuffle= False
2020-06-08 18:32:07,345:  >> BatchSampler; 44 batches
2020-06-08 18:32:07,345: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-08 18:32:07,544: Building loss from config
2020-06-08 18:32:07,545:  >> margin= 0.4
2020-06-08 18:32:07,545:  >> k= 16
2020-06-08 18:32:07,545:  >> min_k= 8
2020-06-08 18:32:07,545:  >> extra= 0
2020-06-08 18:32:07,546:  >> average= False
2020-06-08 18:32:07,546: Using module at metric.multiview_ap.MultiViewAP
2020-06-08 18:32:09,483: Building eval from config
2020-06-08 18:32:09,484:  >> acoustic_ap= True
2020-06-08 18:32:09,484:  >> crossview_ap= True
2020-06-08 18:32:09,484:  >> full_vocab= False
2020-06-08 18:32:09,484:  >> metric= crossview_ap
2020-06-08 18:32:09,484:  >> mode= max
2020-06-08 18:32:09,484: Using module at multiview_rnn.MultiViewRNN
2020-06-08 18:32:09,524: Building net from config
2020-06-08 18:32:09,525: view1:
2020-06-08 18:32:09,527:  >> cell= GRU
2020-06-08 18:32:09,527:  >> input_size= 108
2020-06-08 18:32:09,527:  >> hidden_size= 512
2020-06-08 18:32:09,527:  >> bidirectional= True
2020-06-08 18:32:09,527:  >> num_layers= 6
2020-06-08 18:32:09,527:  >> dropout between layers= 0.4
2020-06-08 18:32:09,838: view2:
2020-06-08 18:32:09,839:  >> cell= GRU
2020-06-08 18:32:09,839:  >> input_size= 64
2020-06-08 18:32:09,839:  >> hidden_size= 512
2020-06-08 18:32:09,839:  >> bidirectional= True
2020-06-08 18:32:09,839:  >> num_layers= 2
2020-06-08 18:32:09,839:  >> dropout between layers= 0.4
2020-06-08 18:32:09,840:  >> num input embeddings= 45
2020-06-08 18:32:09,927: Using module at optim.adam.Adam
2020-06-08 18:32:09,938: Building optim from config
2020-06-08 18:32:09,938:  >> lr= 0.001
2020-06-08 18:32:09,939:  >> betas= (0.9, 0.999)
2020-06-08 18:32:09,939:  >> eps= 1e-08
2020-06-08 18:32:09,939:  >> weight_decay= 0
2020-06-08 18:32:09,939:  >> amsgrad= False
2020-06-08 18:32:09,939:  >> min_lr= 1e-07
2020-06-08 18:32:09,941: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-08 18:32:09,965: Building sched from config
2020-06-08 18:32:09,965:  >> optim= Adam
2020-06-08 18:32:09,965:  >> decay lr by 0.1
2020-06-08 18:32:09,965:  >> eval_fn= MultiViewAP
2020-06-08 18:32:09,967:  >> patience=4
2020-06-08 18:32:09,967:  >> revert=True
2020-06-08 18:32:09,967: epoch=0.00 global_step=0 lr=0.001 start_iter=0
2020-06-08 18:32:09,967: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-08 18:32:58,510:  >> margin_max= 0.5
2020-06-08 18:32:58,520:  >> threshold_max= 9
2020-06-08 18:42:35,740: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-08 18:42:35,783: Using 1 GPU(s)
2020-06-08 18:42:35,783: Machine: 0 / 1
2020-06-08 18:42:35,785: Hyperparam tuning-------------------
2020-06-08 18:42:35,785: optim_lr: 0.001
2020-06-08 18:42:35,785: dropout (for both): 0.4
2020-06-08 18:42:35,785: margin: 0.4
2020-06-08 18:42:35,785: ------------------------------------
2020-06-08 18:42:35,787: Calling main function: multiview_trainer.train
2020-06-08 18:42:35,787: Using config file: train_config.json
2020-06-08 18:42:35,787: Using module at multiview_trainer.train
2020-06-08 18:42:36,020: Using module at multiview_vocab.MultiViewVocab
2020-06-08 18:42:36,043: Building vocab_data from config
2020-06-08 18:42:36,285:  >> min_count= 0
2020-06-08 18:42:36,285:  >> # words= 34323 (# removed= 0)
2020-06-08 18:42:36,285:  >> # subwords= 45
2020-06-08 18:42:36,285:     [laughter]= 1
2020-06-08 18:42:36,285:     [noise]= 2
2020-06-08 18:42:36,285:     [vocalized-noise]= 3
2020-06-08 18:42:36,285:     aa= 4
2020-06-08 18:42:36,285:     ae= 5
2020-06-08 18:42:36,285:     ah= 6
2020-06-08 18:42:36,285:     ao= 7
2020-06-08 18:42:36,285:     aw= 8
2020-06-08 18:42:36,285:     ax= 9
2020-06-08 18:42:36,285:     ay= 10
2020-06-08 18:42:36,285:     b= 11
2020-06-08 18:42:36,285:     ch= 12
2020-06-08 18:42:36,285:     d= 13
2020-06-08 18:42:36,285:     dh= 14
2020-06-08 18:42:36,285:     eh= 15
2020-06-08 18:42:36,286:     el= 16
2020-06-08 18:42:36,286:     en= 17
2020-06-08 18:42:36,286:     er= 18
2020-06-08 18:42:36,286:     ey= 19
2020-06-08 18:42:36,286:     f= 20
2020-06-08 18:42:36,286:     g= 21
2020-06-08 18:42:36,286:     hh= 22
2020-06-08 18:42:36,286:     ih= 23
2020-06-08 18:42:36,286:     iy= 24
2020-06-08 18:42:36,286:     jh= 25
2020-06-08 18:42:36,286:     k= 26
2020-06-08 18:42:36,286:     l= 27
2020-06-08 18:42:36,286:     m= 28
2020-06-08 18:42:36,286:     n= 29
2020-06-08 18:42:36,286:     ng= 30
2020-06-08 18:42:36,286:     ow= 31
2020-06-08 18:42:36,286:     oy= 32
2020-06-08 18:42:36,286:     p= 33
2020-06-08 18:42:36,286:     r= 34
2020-06-08 18:42:36,286:     s= 35
2020-06-08 18:42:36,286:     sh= 36
2020-06-08 18:42:36,286:     t= 37
2020-06-08 18:42:36,287:     th= 38
2020-06-08 18:42:36,287:     uh= 39
2020-06-08 18:42:36,287:     uw= 40
2020-06-08 18:42:36,287:     v= 41
2020-06-08 18:42:36,287:     w= 42
2020-06-08 18:42:36,287:     y= 43
2020-06-08 18:42:36,287:     z= 44
2020-06-08 18:42:36,287:     zh= 45
2020-06-08 18:42:36,300: Using module at data.batch_samplers.BatchSampler
2020-06-08 18:42:36,306: Building vocab_sampler from config
2020-06-08 18:42:36,306:  >> # examples= 34323
2020-06-08 18:42:36,306:  >> batch_size= 1000
2020-06-08 18:42:36,306:  >> shuffle= False
2020-06-08 18:42:36,313:  >> BatchSampler; 35 batches
2020-06-08 18:42:36,313: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 18:42:36,392: Building train_data from config
2020-06-08 18:42:43,435:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-08 18:42:43,436:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-08 18:42:43,436:  >> stack= False
2020-06-08 18:42:43,436:  >> seg_durs= (1, None)
2020-06-08 18:42:43,436:  >> # words= 9971 (# ignored= 0)
2020-06-08 18:42:43,436:  >> input_feat_dim= 108
2020-06-08 18:42:43,436:  >> input_num_subwords= 45
2020-06-08 18:42:43,436: Using module at data.batch_samplers.BatchSampler
2020-06-08 18:42:43,436: Building train_sampler from config
2020-06-08 18:42:43,437:  >> # examples= 9971
2020-06-08 18:42:43,437:  >> batch_size= 256
2020-06-08 18:42:43,437:  >> shuffle= True
2020-06-08 18:42:43,445:  >> BatchSampler; 39 batches
2020-06-08 18:42:43,445: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 18:42:43,445: Building dev_data from config
2020-06-08 18:42:51,375:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-08 18:42:51,375:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-08 18:42:51,376:  >> stack= False
2020-06-08 18:42:51,376:  >> seg_durs= (1, None)
2020-06-08 18:42:51,376:  >> # words= 10966 (# ignored= 0)
2020-06-08 18:42:51,376:  >> input_feat_dim= 108
2020-06-08 18:42:51,376:  >> input_num_subwords= 45
2020-06-08 18:42:51,376: Using module at data.batch_samplers.BatchSampler
2020-06-08 18:42:51,376: Building dev_sampler from config
2020-06-08 18:42:51,377:  >> # examples= 10966
2020-06-08 18:42:51,377:  >> batch_size= 256
2020-06-08 18:42:51,377:  >> shuffle= False
2020-06-08 18:42:51,380:  >> BatchSampler; 43 batches
2020-06-08 18:42:51,380: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 18:42:51,380: Building test_data from config
2020-06-08 18:42:58,276:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-08 18:42:58,276:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-08 18:42:58,276:  >> stack= False
2020-06-08 18:42:58,276:  >> seg_durs= (1, None)
2020-06-08 18:42:58,276:  >> # words= 11024 (# ignored= 0)
2020-06-08 18:42:58,276:  >> input_feat_dim= 108
2020-06-08 18:42:58,276:  >> input_num_subwords= 45
2020-06-08 18:42:58,276: Using module at data.batch_samplers.BatchSampler
2020-06-08 18:42:58,277: Building test_sampler from config
2020-06-08 18:42:58,277:  >> # examples= 11024
2020-06-08 18:42:58,277:  >> batch_size= 256
2020-06-08 18:42:58,277:  >> shuffle= False
2020-06-08 18:42:58,280:  >> BatchSampler; 44 batches
2020-06-08 18:42:58,280: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-08 18:42:58,294: Building loss from config
2020-06-08 18:42:58,295:  >> margin= 0.4
2020-06-08 18:42:58,295:  >> k= 16
2020-06-08 18:42:58,295:  >> min_k= 8
2020-06-08 18:42:58,295:  >> extra= 0
2020-06-08 18:42:58,295:  >> average= False
2020-06-08 18:42:58,295:  >> margin_max= 0.5
2020-06-08 18:42:58,295:  >> threshold_max= 9
2020-06-08 18:42:58,295:  >> using obj0
2020-06-08 18:42:58,295: Using module at metric.multiview_ap.MultiViewAP
2020-06-08 18:42:58,339: Building eval from config
2020-06-08 18:42:58,340:  >> acoustic_ap= True
2020-06-08 18:42:58,340:  >> crossview_ap= True
2020-06-08 18:42:58,340:  >> full_vocab= False
2020-06-08 18:42:58,340:  >> metric= crossview_ap
2020-06-08 18:42:58,340:  >> mode= max
2020-06-08 18:42:58,340: Using module at multiview_rnn.MultiViewRNN
2020-06-08 18:42:58,367: Building net from config
2020-06-08 18:42:58,368: view1:
2020-06-08 18:42:58,369:  >> cell= GRU
2020-06-08 18:42:58,369:  >> input_size= 108
2020-06-08 18:42:58,369:  >> hidden_size= 512
2020-06-08 18:42:58,369:  >> bidirectional= True
2020-06-08 18:42:58,369:  >> num_layers= 6
2020-06-08 18:42:58,369:  >> dropout between layers= 0.4
2020-06-08 18:42:58,611: view2:
2020-06-08 18:42:58,612:  >> cell= GRU
2020-06-08 18:42:58,612:  >> input_size= 64
2020-06-08 18:42:58,612:  >> hidden_size= 512
2020-06-08 18:42:58,612:  >> bidirectional= True
2020-06-08 18:42:58,612:  >> num_layers= 2
2020-06-08 18:42:58,612:  >> dropout between layers= 0.4
2020-06-08 18:42:58,613:  >> num input embeddings= 45
2020-06-08 18:43:02,406: Using module at optim.adam.Adam
2020-06-08 18:43:02,414: Building optim from config
2020-06-08 18:43:02,415:  >> lr= 0.001
2020-06-08 18:43:02,415:  >> betas= (0.9, 0.999)
2020-06-08 18:43:02,415:  >> eps= 1e-08
2020-06-08 18:43:02,415:  >> weight_decay= 0
2020-06-08 18:43:02,415:  >> amsgrad= False
2020-06-08 18:43:02,415:  >> min_lr= 1e-07
2020-06-08 18:43:02,416: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-08 18:43:02,434: Building sched from config
2020-06-08 18:43:02,434:  >> optim= Adam
2020-06-08 18:43:02,434:  >> decay lr by 0.1
2020-06-08 18:43:02,434:  >> eval_fn= MultiViewAP
2020-06-08 18:43:02,435:  >> patience=4
2020-06-08 18:43:02,435:  >> revert=True
2020-06-08 18:43:02,435: epoch=0.00 global_step=0 lr=0.001 start_iter=0
2020-06-08 18:43:02,435: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-08 18:45:09,374: 0) loss=0.494 grad_norm=52.53 num_segments=256 num_words=204
44:57,095: Using 1 GPU(s)
2020-06-08 18:44:57,095: Machine: 0 / 1
2020-06-08 18:44:57,097: Hyperparam tuning-------------------
2020-06-08 18:44:57,098: optim_lr: 0.001
2020-06-08 18:44:57,098: dropout (for both): 0.4
2020-06-08 18:44:57,098: margin: 0.4
2020-06-08 18:44:57,098: ------------------------------------
2020-06-08 18:44:57,227: Calling main function: multiview_trainer.train
2020-06-08 18:44:57,227: Using config file: train_config.json
2020-06-08 18:44:57,227: Using module at multiview_trainer.train
2020-06-08 18:45:09,103: Using module at multiview_vocab.MultiViewVocab
2020-06-08 18:45:09,112: Building vocab_data from config
2020-06-08 18:45:09,468:  >> min_count= 0
2020-06-08 18:45:09,468:  >> # words= 34323 (# removed= 0)
2020-06-08 18:45:09,469:  >> # subwords= 45
2020-06-08 18:45:09,469:     [laughter]= 1
2020-06-08 18:45:09,469:     [noise]= 2
2020-06-08 18:45:09,469:     [vocalized-noise]= 3
2020-06-08 18:45:09,469:     aa= 4
2020-06-08 18:45:09,469:     ae= 5
2020-06-08 18:45:09,469:     ah= 6
2020-06-08 18:45:09,469:     ao= 7
2020-06-08 18:45:09,469:     aw= 8
2020-06-08 18:45:09,469:     ax= 9
2020-06-08 18:45:09,469:     ay= 10
2020-06-08 18:45:09,469:     b= 11
2020-06-08 18:45:09,469:     ch= 12
2020-06-08 18:45:09,469:     d= 13
2020-06-08 18:45:09,469:     dh= 14
2020-06-08 18:45:09,469:     eh= 15
2020-06-08 18:45:09,469:     el= 16
2020-06-08 18:45:09,469:     en= 17
2020-06-08 18:45:09,469:     er= 18
2020-06-08 18:45:09,469:     ey= 19
2020-06-08 18:45:09,469:     f= 20
2020-06-08 18:45:09,469:     g= 21
2020-06-08 18:45:09,469:     hh= 22
2020-06-08 18:45:09,470:     ih= 23
2020-06-08 18:45:09,470:     iy= 24
2020-06-08 18:45:09,470:     jh= 25
2020-06-08 18:45:09,470:     k= 26
2020-06-08 18:45:09,470:     l= 27
2020-06-08 18:45:09,470:     m= 28
2020-06-08 18:45:09,470:     n= 29
2020-06-08 18:45:09,470:     ng= 30
2020-06-08 18:45:09,470:     ow= 31
2020-06-08 18:45:09,470:     oy= 32
2020-06-08 18:45:09,470:     p= 33
2020-06-08 18:45:09,470:     r= 34
2020-06-08 18:45:09,470:     s= 35
2020-06-08 18:45:09,470:     sh= 36
2020-06-08 18:45:09,470:     t= 37
2020-06-08 18:45:09,470:     th= 38
2020-06-08 18:45:09,470:     uh= 39
2020-06-08 18:45:09,470:     uw= 40
2020-06-08 18:45:09,470:     v= 41
2020-06-08 18:45:09,470:     w= 42
2020-06-08 18:45:09,470:     y= 43
2020-06-08 18:45:09,470:     z= 44
2020-06-08 18:45:09,470:     zh= 45
2020-06-08 18:45:09,483: Using module at data.batch_samplers.BatchSampler
2020-06-08 18:45:09,485: Building vocab_sampler from config
2020-06-08 18:45:09,486:  >> # examples= 34323
2020-06-08 18:45:09,486:  >> batch_size= 1000
2020-06-08 18:45:09,486:  >> shuffle= False
2020-06-08 18:45:09,493:  >> BatchSampler; 35 batches
2020-06-08 18:45:09,493: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 18:45:13,635: Building train_data from config
2020-06-08 18:45:18,917:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-08 18:45:18,917:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-08 18:45:18,917:  >> stack= False
2020-06-08 18:45:18,917:  >> seg_durs= (1, None)
2020-06-08 18:45:18,917:  >> # words= 9971 (# ignored= 0)
2020-06-08 18:45:18,918:  >> input_feat_dim= 108
2020-06-08 18:45:18,918:  >> input_num_subwords= 45
2020-06-08 18:45:18,918: Using module at data.batch_samplers.BatchSampler
2020-06-08 18:45:18,918: Building train_sampler from config
2020-06-08 18:45:18,919:  >> # examples= 9971
2020-06-08 18:45:18,919:  >> batch_size= 256
2020-06-08 18:45:18,919:  >> shuffle= True
2020-06-08 18:45:18,925:  >> BatchSampler; 39 batches
2020-06-08 18:45:18,925: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 18:45:18,925: Building dev_data from config
2020-06-08 18:45:24,682:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-08 18:45:24,683:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-08 18:45:24,683:  >> stack= False
2020-06-08 18:45:24,683:  >> seg_durs= (1, None)
2020-06-08 18:45:24,683:  >> # words= 10966 (# ignored= 0)
2020-06-08 18:45:24,683:  >> input_feat_dim= 108
2020-06-08 18:45:24,683:  >> input_num_subwords= 45
2020-06-08 18:45:24,683: Using module at data.batch_samplers.BatchSampler
2020-06-08 18:45:24,684: Building dev_sampler from config
2020-06-08 18:45:24,685:  >> # examples= 10966
2020-06-08 18:45:24,685:  >> batch_size= 256
2020-06-08 18:45:24,685:  >> shuffle= False
2020-06-08 18:45:24,688:  >> BatchSampler; 43 batches
2020-06-08 18:45:24,688: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 18:45:24,688: Building test_data from config
2020-06-08 18:45:29,678:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-08 18:45:29,679:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-08 18:45:29,679:  >> stack= False
2020-06-08 18:45:29,679:  >> seg_durs= (1, None)
2020-06-08 18:45:29,679:  >> # words= 11024 (# ignored= 0)
2020-06-08 18:45:29,679:  >> input_feat_dim= 108
2020-06-08 18:45:29,679:  >> input_num_subwords= 45
2020-06-08 18:45:29,679: Using module at data.batch_samplers.BatchSampler
2020-06-08 18:45:29,679: Building test_sampler from config
2020-06-08 18:45:29,680:  >> # examples= 11024
2020-06-08 18:45:29,680:  >> batch_size= 256
2020-06-08 18:45:29,680:  >> shuffle= False
2020-06-08 18:45:29,682:  >> BatchSampler; 44 batches
2020-06-08 18:45:29,682: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-08 18:45:29,856: Building loss from config
2020-06-08 18:45:29,857:  >> margin= 0.4
2020-06-08 18:45:29,857:  >> k= 16
2020-06-08 18:45:29,858:  >> min_k= 8
2020-06-08 18:45:29,858:  >> extra= 0
2020-06-08 18:45:29,858:  >> average= False
2020-06-08 18:45:29,858:  >> margin_max= 0.5
2020-06-08 18:45:29,858:  >> threshold_max= 9
2020-06-08 18:45:29,858:  >> using obj0
2020-06-08 18:45:29,859: Using module at metric.multiview_ap.MultiViewAP
2020-06-08 18:45:32,308: Building eval from config
2020-06-08 18:45:32,309:  >> acoustic_ap= True
2020-06-08 18:45:32,309:  >> crossview_ap= True
2020-06-08 18:45:32,310:  >> full_vocab= False
2020-06-08 18:45:32,310:  >> metric= crossview_ap
2020-06-08 18:45:32,310:  >> mode= max
2020-06-08 18:45:32,310: Using module at multiview_rnn.MultiViewRNN
2020-06-08 18:45:32,322: Building net from config
2020-06-08 18:45:32,325: view1:
2020-06-08 18:45:32,326:  >> cell= GRU
2020-06-08 18:45:32,326:  >> input_size= 108
2020-06-08 18:45:32,326:  >> hidden_size= 512
2020-06-08 18:45:32,327:  >> bidirectional= True
2020-06-08 18:45:32,327:  >> num_layers= 6
2020-06-08 18:45:32,327:  >> dropout between layers= 0.4
2020-06-08 18:45:32,597: view2:
2020-06-08 18:45:32,598:  >> cell= GRU
2020-06-08 18:45:32,598:  >> input_size= 64
2020-06-08 18:45:32,598:  >> hidden_size= 512
2020-06-08 18:45:32,598:  >> bidirectional= True
2020-06-08 18:45:32,598:  >> num_layers= 2
2020-06-08 18:45:32,598:  >> dropout between layers= 0.4
2020-06-08 18:45:32,599:  >> num input embeddings= 45
2020-06-08 18:45:45,511: Using module at optim.adam.Adam
2020-06-08 18:45:45,515: Building optim from config
2020-06-08 18:45:45,516:  >> lr= 0.001
2020-06-08 18:45:45,516:  >> betas= (0.9, 0.999)
2020-06-08 18:45:45,516:  >> eps= 1e-08
2020-06-08 18:45:45,516:  >> weight_decay= 0
2020-06-08 18:45:45,516:  >> amsgrad= False
2020-06-08 18:45:45,516:  >> min_lr= 1e-07
2020-06-08 18:45:45,517: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-08 18:45:45,523: Building sched from config
2020-06-08 18:45:45,523:  >> optim= Adam
2020-06-08 18:45:45,523:  >> decay lr by 0.1
2020-06-08 18:45:45,523:  >> eval_fn= MultiViewAP
2020-06-08 18:45:45,524:  >> patience=4
2020-06-08 18:45:45,524:  >> revert=True
2020-06-08 18:45:45,524: epoch=0.00 global_step=0 lr=0.001 start_iter=0
2020-06-08 18:45:45,524: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-08 18:47:19,572: 0) loss=0.504 grad_norm=51.17 num_segments=256 num_words=204
2020-06-08 18:48:57,012: 2) loss=0.494 grad_norm=59.77 num_segments=256 num_words=202
2020-06-08 18:50:37,004: 3) loss=0.485 grad_norm=45.20 num_segments=256 num_words=218
2020-06-08 18:52:08,487: 4) loss=0.474 grad_norm=46.28 num_segments=256 num_words=204
2020-06-08 18:53:33,300: 5) loss=0.473 grad_norm=94.10 num_segments=256 num_words=194
2020-06-08 18:54:47,859: 6) loss=0.479 grad_norm=52.75 num_segments=256 num_words=218
2020-06-08 18:55:55,770: 7) loss=0.477 grad_norm=58.02 num_segments=256 num_words=207
2020-06-08 18:57:04,195: 8) loss=0.500 grad_norm=43.04 num_segments=256 num_words=207
2020-06-08 18:58:10,718: 9) loss=0.485 grad_norm=45.04 num_segments=256 num_words=217
2020-06-08 18:59:20,617: 10) loss=0.464 grad_norm=60.48 num_segments=256 num_words=218
2020-06-08 19:00:27,805: 11) loss=0.460 grad_norm=52.18 num_segments=256 num_words=208
2020-06-08 19:01:34,324: 12) loss=0.458 grad_norm=38.46 num_segments=256 num_words=223
2020-06-08 19:02:40,457: 13) loss=0.454 grad_norm=44.18 num_segments=256 num_words=211
2020-06-08 19:03:51,296: 14) loss=0.461 grad_norm=39.40 num_segments=256 num_words=216
2020-06-08 19:04:57,716: 15) loss=0.444 grad_norm=50.76 num_segments=256 num_words=198
2020-06-08 19:06:04,686: 16) loss=0.442 grad_norm=29.83 num_segments=256 num_words=209
2020-06-08 19:07:12,243: 17) loss=0.471 grad_norm=41.25 num_segments=256 num_words=210
2020-06-08 19:08:19,264: 18) loss=0.439 grad_norm=36.37 num_segments=256 num_words=209
2020-06-08 19:09:29,234: 19) loss=0.433 grad_norm=31.34 num_segments=256 num_words=210
2020-06-08 19:10:46,843: 20) loss=0.428 grad_norm=30.74 num_segments=256 num_words=212
2020-06-08 19:12:03,453: 21) loss=0.429 grad_norm=37.65 num_segments=256 num_words=216
2020-06-08 19:13:16,548: 22) loss=0.503 grad_norm=38.03 num_segments=256 num_words=209
2020-06-08 19:14:28,875: 23) loss=0.425 grad_norm=39.57 num_segments=256 num_words=220
2020-06-08 19:15:41,365: 24) loss=0.423 grad_norm=39.16 num_segments=256 num_words=202
2020-06-08 19:16:50,402: 25) loss=0.415 grad_norm=37.26 num_segments=256 num_words=207
2020-06-08 19:17:56,106: 26) loss=0.413 grad_norm=36.41 num_segments=256 num_words=209
2020-06-08 19:19:01,012: 27) loss=0.407 grad_norm=37.19 num_segments=256 num_words=204
2020-06-08 19:20:13,525: 28) loss=0.415 grad_norm=39.94 num_segments=256 num_words=216
2020-06-08 19:21:19,547: 29) loss=0.420 grad_norm=36.22 num_segments=256 num_words=207
2020-06-08 19:22:26,352: 30) loss=0.439 grad_norm=37.54 num_segments=256 num_words=220
2020-06-08 19:23:44,291: 31) loss=0.424 grad_norm=36.77 num_segments=256 num_words=212
2020-06-08 19:24:52,043: 32) loss=0.392 grad_norm=55.63 num_segments=256 num_words=210
2020-06-08 19:25:59,074: 33) loss=0.408 grad_norm=41.41 num_segments=256 num_words=202
2020-06-08 19:27:05,870: 34) loss=0.412 grad_norm=57.47 num_segments=256 num_words=213
2020-06-08 19:28:11,360: 35) loss=0.390 grad_norm=47.41 num_segments=256 num_words=205
2020-06-08 19:29:20,718: 36) loss=0.401 grad_norm=47.32 num_segments=256 num_words=208
2020-06-08 19:30:26,727: 37) loss=0.389 grad_norm=68.14 num_segments=256 num_words=209
2020-06-08 19:31:25,359: 38) loss=0.385 grad_norm=39.96 num_segments=243 num_words=211
2020-06-08 19:31:25,378: epoch= 1.00
2020-06-08 19:31:25,378:  >> time to evaluate and save:
2020-06-08 19:31:25,427: saved save/MultiViewDataset_IndividualWords.39.pth
2020-06-08 19:31:25,428: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-08 19:31:25,429: saved MultiViewDataset_IndividualWords successfully
2020-06-08 19:31:26,833: saved save/MultiViewRNN.39.pth
2020-06-08 19:31:26,834: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-08 19:31:26,836: saved MultiViewRNN successfully
2020-06-08 19:31:29,408: saved save/Adam.39.pth
2020-06-08 19:31:29,410: most_recent linked save/Adam.most_recent.pth
2020-06-08 19:31:29,410: saved Adam successfully
2020-06-08 19:31:29,412: saved save/ReduceLROnPlateau.39.pth
2020-06-08 19:31:29,413: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-08 19:31:29,414: saved ReduceLROnPlateau successfully
2020-06-08 19:31:29,415: saved config successfully
2020-06-08 19:33:12,053:   >> crossview_ap=0.057 (10966 x 3921 pairs)
2020-06-08 19:34:16,942:   >> acoustic_ap=0.087 (10966 choose 2 pairs)
2020-06-08 19:34:16,945: best_so_far= 0.057 at 39
2020-06-08 19:34:16,960: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-08 19:34:16,961: saved MultiViewDataset_IndividualWords successfully
2020-06-08 19:34:16,962: best linked save/MultiViewRNN.best.pth
2020-06-08 19:34:16,963: saved MultiViewRNN successfully
2020-06-08 19:34:16,964: best linked save/Adam.best.pth
2020-06-08 19:34:16,965: saved Adam successfully
2020-06-08 19:34:16,966: best linked save/ReduceLROnPlateau.best.pth
2020-06-08 19:34:16,967: saved ReduceLROnPlateau successfully
2020-06-08 19:34:17,022: epoch=1.00 global_step=39 lr=0.001 start_iter=0
2020-06-08 19:34:17,023: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-08 19:35:33,849: 0) loss=0.387 grad_norm=38.79 num_segments=256 num_words=218
2020-06-08 19:36:57,110: 1) loss=0.385 grad_norm=58.01 num_segments=256 num_words=212
2020-06-08 19:38:03,933: 2) loss=0.391 grad_norm=48.34 num_segments=256 num_words=209
2020-06-08 19:39:06,987: 3) loss=0.378 grad_norm=37.40 num_segments=256 num_words=211
2020-06-08 19:40:10,155: 4) loss=0.385 grad_norm=56.71 num_segments=256 num_words=215
2020-06-08 19:41:13,200: 5) loss=0.399 grad_norm=46.44 num_segments=256 num_words=213
2020-06-08 19:42:17,334: 6) loss=0.378 grad_norm=50.66 num_segments=256 num_words=216
2020-06-08 19:43:19,102: 7) loss=0.370 grad_norm=44.43 num_segments=256 num_words=203
2020-06-08 19:44:19,706: 8) loss=0.376 grad_norm=35.67 num_segments=256 num_words=218
2020-06-08 19:45:18,834: 9) loss=0.373 grad_norm=34.31 num_segments=256 num_words=212
2020-06-08 19:46:18,131: 10) loss=0.399 grad_norm=46.36 num_segments=256 num_words=208
2020-06-08 19:47:17,005: 11) loss=0.380 grad_norm=65.03 num_segments=256 num_words=213
2020-06-08 19:48:29,571: 12) loss=0.387 grad_norm=38.95 num_segments=256 num_words=218
2020-06-08 19:49:26,342: 13) loss=0.359 grad_norm=34.44 num_segments=256 num_words=208
2020-06-08 19:50:22,857: 14) loss=0.366 grad_norm=46.64 num_segments=256 num_words=213
2020-06-08 19:51:19,512: 15) loss=0.363 grad_norm=40.14 num_segments=256 num_words=200
2020-06-08 19:52:16,543: 16) loss=0.352 grad_norm=37.48 num_segments=256 num_words=208
2020-06-08 19:53:13,270: 17) loss=0.353 grad_norm=42.12 num_segments=256 num_words=210
2020-06-08 19:54:10,246: 18) loss=0.351 grad_norm=33.32 num_segments=256 num_words=200
2020-06-08 19:55:07,138: 19) loss=0.434 grad_norm=36.87 num_segments=256 num_words=221
2020-06-08 19:56:03,707: 20) loss=0.354 grad_norm=36.53 num_segments=256 num_words=209
2020-06-08 19:57:00,073: 21) loss=0.341 grad_norm=30.93 num_segments=256 num_words=203
2020-06-08 19:57:56,578: 22) loss=0.335 grad_norm=39.74 num_segments=256 num_words=210
2020-06-08 19:58:53,224: 23) loss=0.363 grad_norm=28.85 num_segments=256 num_words=222
2020-06-08 19:59:49,682: 24) loss=0.333 grad_norm=30.15 num_segments=256 num_words=215
2020-06-08 20:00:46,062: 25) loss=0.340 grad_norm=35.94 num_segments=256 num_words=205
2020-06-08 20:01:56,341: 26) loss=0.346 grad_norm=33.13 num_segments=256 num_words=215
2020-06-08 20:02:53,055: 27) loss=0.358 grad_norm=32.85 num_segments=256 num_words=213
2020-06-08 20:03:49,432: 28) loss=0.347 grad_norm=41.91 num_segments=256 num_words=214
2020-06-08 20:04:46,186: 29) loss=0.332 grad_norm=40.95 num_segments=256 num_words=205
2020-06-08 20:05:42,595: 30) loss=0.342 grad_norm=36.56 num_segments=256 num_words=209
2020-06-08 20:06:39,152: 31) loss=0.328 grad_norm=44.96 num_segments=256 num_words=209
2020-06-08 20:07:35,092: 32) loss=0.334 grad_norm=41.13 num_segments=256 num_words=200
2020-06-08 20:08:31,154: 33) loss=0.316 grad_norm=45.86 num_segments=256 num_words=201
2020-06-08 20:09:27,295: 34) loss=0.324 grad_norm=49.16 num_segments=256 num_words=211
2020-06-08 20:10:23,743: 35) loss=0.336 grad_norm=33.92 num_segments=256 num_words=206
2020-06-08 20:11:20,113: 36) loss=0.323 grad_norm=40.81 num_segments=256 num_words=210
2020-06-08 20:12:16,830: 37) loss=0.326 grad_norm=40.80 num_segments=256 num_words=204
2020-06-08 20:13:07,533: 38) loss=0.317 grad_norm=32.93 num_segments=243 num_words=196
2020-06-08 20:13:07,542: epoch= 2.00
2020-06-08 20:13:07,543:  >> time to evaluate and save:
2020-06-08 20:13:07,581: saved save/MultiViewDataset_IndividualWords.78.pth
2020-06-08 20:13:07,583: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-08 20:13:07,584: saved MultiViewDataset_IndividualWords successfully
2020-06-08 20:13:08,869: saved save/MultiViewRNN.78.pth
2020-06-08 20:13:08,871: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-08 20:13:08,877: saved MultiViewRNN successfully
2020-06-08 20:13:11,449: saved save/Adam.78.pth
2020-06-08 20:13:11,451: most_recent linked save/Adam.most_recent.pth
2020-06-08 20:13:11,456: saved Adam successfully
2020-06-08 20:13:11,458: saved save/ReduceLROnPlateau.78.pth
2020-06-08 20:13:11,460: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-08 20:13:11,462: saved ReduceLROnPlateau successfully
2020-06-08 20:13:11,464: saved config successfully
2020-06-08 20:14:31,718:   >> crossview_ap=0.171 (10966 x 3921 pairs)
2020-06-08 20:15:24,028:   >> acoustic_ap=0.216 (10966 choose 2 pairs)
2020-06-08 20:15:24,031: best_so_far= 0.171 at 78
2020-06-08 20:15:24,034: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-08 20:15:24,036: saved MultiViewDataset_IndividualWords successfully
2020-06-08 20:15:24,037: best linked save/MultiViewRNN.best.pth
2020-06-08 20:15:24,040: saved MultiViewRNN successfully
2020-06-08 20:15:24,041: best linked save/Adam.best.pth
2020-06-08 20:15:24,043: saved Adam successfully
2020-06-08 20:15:24,045: best linked save/ReduceLROnPlateau.best.pth
2020-06-08 20:15:24,046: saved ReduceLROnPlateau successfully
2020-06-08 20:15:24,533: epoch=2.00 global_step=78 lr=0.001 start_iter=0
2020-06-08 20:15:24,533: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-08 20:16:22,528: 0) loss=0.310 grad_norm=41.29 num_segments=256 num_words=199
2020-06-08 20:17:18,431: 1) loss=0.303 grad_norm=38.87 num_segments=256 num_words=217
2020-06-08 20:18:14,704: 2) loss=0.306 grad_norm=49.56 num_segments=256 num_words=208
2020-06-08 20:19:18,736: 3) loss=0.299 grad_norm=52.28 num_segments=256 num_words=209
2020-06-08 20:20:40,752: 4) loss=0.322 grad_norm=38.22 num_segments=256 num_words=210
2020-06-08 20:22:15,519: 5) loss=0.312 grad_norm=37.93 num_segments=256 num_words=208
2020-06-08 20:23:20,259: 6) loss=0.316 grad_norm=52.47 num_segments=256 num_words=212
2020-06-08 20:24:22,844: 7) loss=0.322 grad_norm=26.89 num_segments=256 num_words=218
2020-06-08 20:25:26,426: 8) loss=0.300 grad_norm=27.23 num_segments=256 num_words=210
2020-06-08 20:26:42,675: 9) loss=0.300 grad_norm=35.48 num_segments=256 num_words=217
2020-06-08 20:27:57,241: 10) loss=0.297 grad_norm=31.52 num_segments=256 num_words=208
2020-06-08 20:29:11,987: 11) loss=0.360 grad_norm=32.02 num_segments=256 num_words=197
2020-06-08 20:30:27,654: 12) loss=0.291 grad_norm=44.32 num_segments=256 num_words=219
2020-06-08 20:31:45,157: 13) loss=0.282 grad_norm=43.02 num_segments=256 num_words=200
2020-06-08 20:33:01,483: 14) loss=0.295 grad_norm=34.87 num_segments=256 num_words=212
2020-06-08 20:34:11,624: 15) loss=0.298 grad_norm=51.31 num_segments=256 num_words=211
2020-06-08 20:35:30,759: 16) loss=0.299 grad_norm=33.82 num_segments=256 num_words=209
2020-06-08 20:36:46,639: 17) loss=0.396 grad_norm=53.83 num_segments=256 num_words=218
2020-06-08 20:38:00,549: 18) loss=0.303 grad_norm=48.05 num_segments=256 num_words=214
2020-06-08 20:39:20,038: 19) loss=0.299 grad_norm=43.44 num_segments=256 num_words=206
2020-06-08 20:40:30,037: 20) loss=0.291 grad_norm=47.25 num_segments=256 num_words=209
2020-06-08 20:41:37,335: 21) loss=0.289 grad_norm=33.14 num_segments=256 num_words=212
2020-06-08 20:42:55,376: 22) loss=0.288 grad_norm=48.10 num_segments=256 num_words=212
2020-06-08 20:44:08,537: 23) loss=0.284 grad_norm=65.12 num_segments=256 num_words=217
2020-06-08 20:45:25,681: 24) loss=0.305 grad_norm=38.19 num_segments=256 num_words=214
2020-06-08 20:46:42,942: 25) loss=0.292 grad_norm=42.92 num_segments=256 num_words=227
2020-06-08 20:48:30,009: 26) loss=0.305 grad_norm=32.79 num_segments=256 num_words=202
2020-06-08 20:49:45,389: 27) loss=0.272 grad_norm=29.91 num_segments=256 num_words=206
2020-06-08 20:50:57,066: 28) loss=0.274 grad_norm=33.25 num_segments=256 num_words=210
2020-06-08 20:52:13,394: 29) loss=0.289 grad_norm=40.63 num_segments=256 num_words=206
2020-06-08 20:53:24,824: 30) loss=0.282 grad_norm=37.83 num_segments=256 num_words=210
2020-06-08 20:54:41,696: 31) loss=0.302 grad_norm=40.22 num_segments=256 num_words=219
2020-06-08 20:55:53,413: 32) loss=0.280 grad_norm=36.59 num_segments=256 num_words=216
2020-06-08 20:57:04,981: 33) loss=0.275 grad_norm=45.53 num_segments=256 num_words=221
2020-06-08 20:58:23,381: 34) loss=0.261 grad_norm=33.69 num_segments=256 num_words=199
2020-06-08 20:59:37,436: 35) loss=0.265 grad_norm=35.03 num_segments=256 num_words=206
2020-06-08 21:00:46,003: 36) loss=0.281 grad_norm=46.85 num_segments=256 num_words=210
2020-06-08 21:01:58,757: 37) loss=0.278 grad_norm=42.37 num_segments=256 num_words=212
2020-06-08 21:03:12,572: 38) loss=0.291 grad_norm=33.71 num_segments=243 num_words=200
2020-06-08 21:03:12,584: epoch= 3.00
2020-06-08 21:03:12,584:  >> time to evaluate and save:
2020-06-08 21:03:12,615: saved save/MultiViewDataset_IndividualWords.117.pth
2020-06-08 21:03:12,617: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-08 21:03:12,619: saved MultiViewDataset_IndividualWords successfully
2020-06-08 21:03:13,948: saved save/MultiViewRNN.117.pth
2020-06-08 21:03:13,950: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-08 21:03:13,955: saved MultiViewRNN successfully
2020-06-08 21:03:16,521: saved save/Adam.117.pth
2020-06-08 21:03:16,523: most_recent linked save/Adam.most_recent.pth
2020-06-08 21:03:16,528: saved Adam successfully
2020-06-08 21:03:16,531: saved save/ReduceLROnPlateau.117.pth
2020-06-08 21:03:16,532: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-08 21:03:16,535: saved ReduceLROnPlateau successfully
2020-06-08 21:03:16,537: saved config successfully
2020-06-08 21:04:55,193:   >> crossview_ap=0.318 (10966 x 3921 pairs)
2020-06-08 21:06:04,287:   >> acoustic_ap=0.327 (10966 choose 2 pairs)
2020-06-08 21:06:04,291: best_so_far= 0.318 at 117
2020-06-08 21:06:04,294: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-08 21:06:04,295: saved MultiViewDataset_IndividualWords successfully
2020-06-08 21:06:04,297: best linked save/MultiViewRNN.best.pth
2020-06-08 21:06:04,301: saved MultiViewRNN successfully
2020-06-08 21:06:04,302: best linked save/Adam.best.pth
2020-06-08 21:06:04,305: saved Adam successfully
2020-06-08 21:06:04,307: best linked save/ReduceLROnPlateau.best.pth
2020-06-08 21:06:04,308: saved ReduceLROnPlateau successfully
2020-06-08 21:06:05,043: epoch=3.00 global_step=117 lr=0.001 start_iter=0
2020-06-08 21:06:05,043: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-08 21:07:24,559: 0) loss=0.260 grad_norm=63.92 num_segments=256 num_words=203
2020-06-08 21:08:46,756: 1) loss=0.262 grad_norm=52.30 num_segments=256 num_words=215
2020-06-08 21:09:50,750: 2) loss=0.275 grad_norm=42.14 num_segments=256 num_words=209
2020-06-08 21:11:04,947: 3) loss=0.247 grad_norm=38.03 num_segments=256 num_words=209
2020-06-08 21:12:21,126: 4) loss=0.254 grad_norm=43.93 num_segments=256 num_words=209
2020-06-08 21:13:41,131: 5) loss=0.279 grad_norm=36.62 num_segments=256 num_words=210
2020-06-08 21:14:58,688: 6) loss=0.260 grad_norm=37.24 num_segments=256 num_words=207
2020-06-08 21:16:14,661: 7) loss=0.261 grad_norm=33.61 num_segments=256 num_words=223
2020-06-08 21:17:33,901: 8) loss=0.247 grad_norm=31.79 num_segments=256 num_words=212
2020-06-08 21:18:51,254: 9) loss=0.260 grad_norm=27.60 num_segments=256 num_words=214
2020-06-08 21:20:08,523: 10) loss=0.235 grad_norm=40.05 num_segments=256 num_words=212
2020-06-08 21:21:15,600: 11) loss=0.234 grad_norm=39.83 num_segments=256 num_words=211
2020-06-08 21:22:12,739: 12) loss=0.257 grad_norm=37.44 num_segments=256 num_words=206
2020-06-08 21:23:09,486: 13) loss=0.327 grad_norm=44.91 num_segments=256 num_words=219
2020-06-08 21:24:38,219: 14) loss=0.233 grad_norm=27.61 num_segments=256 num_words=212
2020-06-08 21:25:34,419: 15) loss=0.237 grad_norm=36.80 num_segments=256 num_words=205
2020-06-08 21:26:30,658: 16) loss=0.251 grad_norm=47.12 num_segments=256 num_words=211
2020-06-08 21:27:26,945: 17) loss=0.265 grad_norm=42.18 num_segments=256 num_words=210
2020-06-08 21:28:23,113: 18) loss=0.246 grad_norm=37.30 num_segments=256 num_words=218
2020-06-08 21:29:19,314: 19) loss=0.244 grad_norm=39.57 num_segments=256 num_words=207
2020-06-08 21:30:15,834: 20) loss=0.239 grad_norm=32.68 num_segments=256 num_words=208
2020-06-08 21:31:12,776: 21) loss=0.246 grad_norm=35.95 num_segments=256 num_words=213
2020-06-08 21:32:09,378: 22) loss=0.238 grad_norm=30.39 num_segments=256 num_words=207
2020-06-08 21:33:05,513: 23) loss=0.233 grad_norm=43.62 num_segments=256 num_words=214
2020-06-08 21:34:01,754: 24) loss=0.238 grad_norm=34.91 num_segments=256 num_words=212
2020-06-08 21:34:58,145: 25) loss=0.242 grad_norm=58.16 num_segments=256 num_words=212
2020-06-08 21:35:54,492: 26) loss=0.243 grad_norm=54.10 num_segments=256 num_words=210
2020-06-08 21:36:51,042: 27) loss=0.242 grad_norm=33.68 num_segments=256 num_words=209
2020-06-08 21:37:48,166: 28) loss=0.223 grad_norm=49.03 num_segments=256 num_words=213
2020-06-08 21:38:44,949: 29) loss=0.254 grad_norm=65.17 num_segments=256 num_words=218
2020-06-08 21:39:42,086: 30) loss=0.224 grad_norm=51.20 num_segments=256 num_words=199
2020-06-08 21:40:38,283: 31) loss=0.219 grad_norm=27.98 num_segments=256 num_words=202
2020-06-08 21:41:34,693: 32) loss=0.230 grad_norm=37.04 num_segments=256 num_words=210
2020-06-08 21:42:30,847: 33) loss=0.218 grad_norm=31.81 num_segments=256 num_words=213
2020-06-08 21:43:27,390: 34) loss=0.220 grad_norm=33.22 num_segments=256 num_words=208
2020-06-08 21:44:23,777: 35) loss=0.214 grad_norm=36.77 num_segments=256 num_words=203
2020-06-08 21:45:20,043: 36) loss=0.311 grad_norm=37.12 num_segments=256 num_words=213
2020-06-08 21:46:16,181: 37) loss=0.222 grad_norm=41.00 num_segments=256 num_words=195
2020-06-08 21:47:06,986: 38) loss=0.209 grad_norm=41.41 num_segments=243 num_words=203
2020-06-08 21:47:06,996: epoch= 4.00
2020-06-08 21:47:06,996:  >> time to evaluate and save:
2020-06-08 21:47:07,020: saved save/MultiViewDataset_IndividualWords.156.pth
2020-06-08 21:47:07,022: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-08 21:47:07,024: saved MultiViewDataset_IndividualWords successfully
2020-06-08 21:47:08,306: saved save/MultiViewRNN.156.pth
2020-06-08 21:47:08,308: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-08 21:47:08,313: saved MultiViewRNN successfully
2020-06-08 21:47:10,791: saved save/Adam.156.pth
2020-06-08 21:47:10,792: most_recent linked save/Adam.most_recent.pth
2020-06-08 21:47:10,797: saved Adam successfully
2020-06-08 21:47:10,800: saved save/ReduceLROnPlateau.156.pth
2020-06-08 21:47:10,801: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-08 21:47:10,804: saved ReduceLROnPlateau successfully
2020-06-08 21:47:10,805: saved config successfully
2020-06-08 21:48:37,450:   >> crossview_ap=0.455 (10966 x 3921 pairs)
2020-06-08 21:49:26,862:   >> acoustic_ap=0.455 (10966 choose 2 pairs)
2020-06-08 21:49:26,867: best_so_far= 0.455 at 156
2020-06-08 21:49:26,871: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-08 21:49:26,873: saved MultiViewDataset_IndividualWords successfully
2020-06-08 21:49:26,874: best linked save/MultiViewRNN.best.pth
2020-06-08 21:49:26,880: saved MultiViewRNN successfully
2020-06-08 21:49:26,882: best linked save/Adam.best.pth
2020-06-08 21:49:26,887: saved Adam successfully
2020-06-08 21:49:26,889: best linked save/ReduceLROnPlateau.best.pth
2020-06-08 21:49:26,891: saved ReduceLROnPlateau successfully
2020-06-08 21:49:30,924: epoch=4.00 global_step=156 lr=0.001 start_iter=0
2020-06-08 21:49:30,924: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-08 21:50:29,308: 0) loss=0.210 grad_norm=29.61 num_segments=256 num_words=204
2020-06-08 21:51:25,619: 1) loss=0.226 grad_norm=27.35 num_segments=256 num_words=215
2020-06-08 21:52:22,063: 2) loss=0.240 grad_norm=49.66 num_segments=256 num_words=214
2020-06-08 21:53:19,169: 3) loss=0.211 grad_norm=32.70 num_segments=256 num_words=203
2020-06-08 21:54:16,050: 4) loss=0.204 grad_norm=25.93 num_segments=256 num_words=216
2020-06-08 21:55:12,437: 5) loss=0.225 grad_norm=37.45 num_segments=256 num_words=212
2020-06-08 21:56:08,943: 6) loss=0.208 grad_norm=33.05 num_segments=256 num_words=206
2020-06-08 21:57:05,374: 7) loss=0.194 grad_norm=35.06 num_segments=256 num_words=205
2020-06-08 21:58:01,907: 8) loss=0.205 grad_norm=28.60 num_segments=256 num_words=213
2020-06-08 21:59:40,827: 9) loss=0.217 grad_norm=31.02 num_segments=256 num_words=219
2020-06-08 22:00:37,353: 10) loss=0.206 grad_norm=33.08 num_segments=256 num_words=217
2020-06-08 22:01:38,072: 11) loss=0.214 grad_norm=33.54 num_segments=256 num_words=214
2020-06-08 22:02:34,443: 12) loss=0.204 grad_norm=34.54 num_segments=256 num_words=207
2020-06-08 22:03:30,873: 13) loss=0.196 grad_norm=28.66 num_segments=256 num_words=210
2020-06-08 22:04:27,019: 14) loss=0.203 grad_norm=37.94 num_segments=256 num_words=204
2020-06-08 22:05:23,298: 15) loss=0.196 grad_norm=26.65 num_segments=256 num_words=211
2020-06-08 22:06:19,509: 16) loss=0.200 grad_norm=31.73 num_segments=256 num_words=201
2020-06-08 22:07:16,589: 17) loss=0.205 grad_norm=27.99 num_segments=256 num_words=210
2020-06-08 22:08:13,283: 18) loss=0.219 grad_norm=30.06 num_segments=256 num_words=217
2020-06-08 22:09:09,555: 19) loss=0.221 grad_norm=31.77 num_segments=256 num_words=212
2020-06-08 22:10:05,892: 20) loss=0.175 grad_norm=33.56 num_segments=256 num_words=194
2020-06-08 22:11:02,606: 21) loss=0.204 grad_norm=37.40 num_segments=256 num_words=203
2020-06-08 22:11:58,847: 22) loss=0.215 grad_norm=33.77 num_segments=256 num_words=219
2020-06-08 22:12:55,602: 23) loss=0.189 grad_norm=26.22 num_segments=256 num_words=207
2020-06-08 22:13:52,163: 24) loss=0.198 grad_norm=27.24 num_segments=256 num_words=196
2020-06-08 22:14:48,512: 25) loss=0.202 grad_norm=35.36 num_segments=256 num_words=220
2020-06-08 22:15:44,979: 26) loss=0.241 grad_norm=38.05 num_segments=256 num_words=213
2020-06-08 22:16:41,469: 27) loss=0.184 grad_norm=28.63 num_segments=256 num_words=214
2020-06-08 22:17:38,195: 28) loss=0.182 grad_norm=28.21 num_segments=256 num_words=207
2020-06-08 22:18:34,943: 29) loss=0.218 grad_norm=38.26 num_segments=256 num_words=210
2020-06-08 22:19:31,618: 30) loss=0.232 grad_norm=29.42 num_segments=256 num_words=208
2020-06-08 22:20:28,556: 31) loss=0.230 grad_norm=41.07 num_segments=256 num_words=216
2020-06-08 22:21:25,328: 32) loss=0.198 grad_norm=56.84 num_segments=256 num_words=202
2020-06-08 22:22:22,115: 33) loss=0.222 grad_norm=40.94 num_segments=256 num_words=220
2020-06-08 22:23:18,692: 34) loss=0.193 grad_norm=41.72 num_segments=256 num_words=218
2020-06-08 22:24:15,556: 35) loss=0.197 grad_norm=33.84 num_segments=256 num_words=213
2020-06-08 22:25:12,362: 36) loss=0.192 grad_norm=42.55 num_segments=256 num_words=205
2020-06-08 22:26:09,133: 37) loss=0.189 grad_norm=43.43 num_segments=256 num_words=204
2020-06-08 22:27:00,564: 38) loss=0.210 grad_norm=32.84 num_segments=243 num_words=206
2020-06-08 22:27:00,574: epoch= 5.00
2020-06-08 22:27:00,575:  >> time to evaluate and save:
2020-06-08 22:27:00,600: saved save/MultiViewDataset_IndividualWords.195.pth
2020-06-08 22:27:00,602: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-08 22:27:00,604: saved MultiViewDataset_IndividualWords successfully
2020-06-08 22:27:02,019: saved save/MultiViewRNN.195.pth
2020-06-08 22:27:02,021: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-08 22:27:02,028: saved MultiViewRNN successfully
2020-06-08 22:27:04,634: saved save/Adam.195.pth
2020-06-08 22:27:04,636: most_recent linked save/Adam.most_recent.pth
2020-06-08 22:27:04,642: saved Adam successfully
2020-06-08 22:27:04,644: saved save/ReduceLROnPlateau.195.pth
2020-06-08 22:27:04,646: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-08 22:27:04,648: saved ReduceLROnPlateau successfully
2020-06-08 22:27:04,650: saved config successfully
2020-06-08 22:28:40,254:   >> crossview_ap=0.516 (10966 x 3921 pairs)
2020-06-08 22:29:56,419:   >> acoustic_ap=0.525 (10966 choose 2 pairs)
2020-06-08 22:29:56,422: best_so_far= 0.516 at 195
2020-06-08 22:29:56,425: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-08 22:29:56,430: saved MultiViewDataset_IndividualWords successfully
2020-06-08 22:29:56,431: best linked save/MultiViewRNN.best.pth
2020-06-08 22:29:56,437: saved MultiViewRNN successfully
2020-06-08 22:29:56,439: best linked save/Adam.best.pth
2020-06-08 22:29:56,445: saved Adam successfully
2020-06-08 22:29:56,446: best linked save/ReduceLROnPlateau.best.pth
2020-06-08 22:29:56,448: saved ReduceLROnPlateau successfully
2020-06-08 22:29:57,593: epoch=5.00 global_step=195 lr=0.001 start_iter=0
2020-06-08 22:29:57,593: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-08 22:30:57,318: 0) loss=0.177 grad_norm=29.77 num_segments=256 num_words=208
2020-06-08 22:31:54,317: 1) loss=0.187 grad_norm=44.68 num_segments=256 num_words=212
2020-06-08 22:32:51,432: 2) loss=0.161 grad_norm=37.44 num_segments=256 num_words=209
2020-06-08 22:33:47,857: 3) loss=0.180 grad_norm=36.21 num_segments=256 num_words=206
2020-06-08 22:34:44,397: 4) loss=0.181 grad_norm=34.71 num_segments=256 num_words=209
2020-06-08 22:35:41,115: 5) loss=0.185 grad_norm=34.39 num_segments=256 num_words=214
2020-06-08 22:36:37,916: 6) loss=0.198 grad_norm=37.73 num_segments=256 num_words=209
2020-06-08 22:37:34,678: 7) loss=0.171 grad_norm=30.08 num_segments=256 num_words=212
2020-06-08 22:38:31,509: 8) loss=0.173 grad_norm=40.01 num_segments=256 num_words=198
2020-06-08 22:39:28,218: 9) loss=0.179 grad_norm=32.63 num_segments=256 num_words=210
2020-06-08 22:40:25,066: 10) loss=0.162 grad_norm=24.16 num_segments=256 num_words=205
2020-06-08 23:12:25,299: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-08 23:12:25,351: Using 1 GPU(s)
2020-06-08 23:12:25,351: Machine: 0 / 1
2020-06-08 23:12:25,366: Hyperparam tuning-------------------
2020-06-08 23:12:25,366: optim_lr: 0.001
2020-06-08 23:12:25,366: dropout (for both): 0.4
2020-06-08 23:12:25,366: margin: 0.4
2020-06-08 23:12:25,366: ------------------------------------
2020-06-08 23:12:25,452: Calling main function: multiview_trainer.train
2020-06-08 23:12:25,452: Using config file: train_config.json
2020-06-08 23:12:25,452: Using module at multiview_trainer.train
2020-06-08 23:12:34,493: Using module at multiview_vocab.MultiViewVocab
2020-06-08 23:12:34,523: Building vocab_data from config
2020-06-08 23:12:34,843:  >> min_count= 0
2020-06-08 23:12:34,843:  >> # words= 34323 (# removed= 0)
2020-06-08 23:12:34,843:  >> # subwords= 45
2020-06-08 23:12:34,843:     [laughter]= 1
2020-06-08 23:12:34,843:     [noise]= 2
2020-06-08 23:12:34,843:     [vocalized-noise]= 3
2020-06-08 23:12:34,843:     aa= 4
2020-06-08 23:12:34,843:     ae= 5
2020-06-08 23:12:34,844:     ah= 6
2020-06-08 23:12:34,844:     ao= 7
2020-06-08 23:12:34,844:     aw= 8
2020-06-08 23:12:34,844:     ax= 9
2020-06-08 23:12:34,844:     ay= 10
2020-06-08 23:12:34,844:     b= 11
2020-06-08 23:12:34,844:     ch= 12
2020-06-08 23:12:34,844:     d= 13
2020-06-08 23:12:34,844:     dh= 14
2020-06-08 23:12:34,844:     eh= 15
2020-06-08 23:12:34,844:     el= 16
2020-06-08 23:12:34,845:     en= 17
2020-06-08 23:12:34,845:     er= 18
2020-06-08 23:12:34,845:     ey= 19
2020-06-08 23:12:34,845:     f= 20
2020-06-08 23:12:34,845:     g= 21
2020-06-08 23:12:34,845:     hh= 22
2020-06-08 23:12:34,845:     ih= 23
2020-06-08 23:12:34,845:     iy= 24
2020-06-08 23:12:34,845:     jh= 25
2020-06-08 23:12:34,845:     k= 26
2020-06-08 23:12:34,845:     l= 27
2020-06-08 23:12:34,845:     m= 28
2020-06-08 23:12:34,846:     n= 29
2020-06-08 23:12:34,846:     ng= 30
2020-06-08 23:12:34,846:     ow= 31
2020-06-08 23:12:34,846:     oy= 32
2020-06-08 23:12:34,846:     p= 33
2020-06-08 23:12:34,846:     r= 34
2020-06-08 23:12:34,846:     s= 35
2020-06-08 23:12:34,846:     sh= 36
2020-06-08 23:12:34,846:     t= 37
2020-06-08 23:12:34,846:     th= 38
2020-06-08 23:12:34,846:     uh= 39
2020-06-08 23:12:34,847:     uw= 40
2020-06-08 23:12:34,847:     v= 41
2020-06-08 23:12:34,847:     w= 42
2020-06-08 23:12:34,847:     y= 43
2020-06-08 23:12:34,847:     z= 44
2020-06-08 23:12:34,847:     zh= 45
2020-06-08 23:12:34,862: Using module at data.batch_samplers.BatchSampler
2020-06-08 23:12:34,893: Building vocab_sampler from config
2020-06-08 23:12:34,894:  >> # examples= 34323
2020-06-08 23:12:34,894:  >> batch_size= 1000
2020-06-08 23:12:34,894:  >> shuffle= False
2020-06-08 23:12:34,908:  >> BatchSampler; 35 batches
2020-06-08 23:12:34,908: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 23:12:37,754: Building train_data from config
2020-06-08 23:12:45,569:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-08 23:12:45,570:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-08 23:12:45,570:  >> stack= False
2020-06-08 23:12:45,570:  >> seg_durs= (1, None)
2020-06-08 23:12:45,570:  >> # words= 9971 (# ignored= 0)
2020-06-08 23:12:45,570:  >> input_feat_dim= 108
2020-06-08 23:12:45,570:  >> input_num_subwords= 45
2020-06-08 23:12:45,571: Using module at data.batch_samplers.BatchSampler
2020-06-08 23:12:45,571: Building train_sampler from config
2020-06-08 23:12:45,572:  >> # examples= 9971
2020-06-08 23:12:45,572:  >> batch_size= 256
2020-06-08 23:12:45,572:  >> shuffle= True
2020-06-08 23:12:45,584:  >> BatchSampler; 39 batches
2020-06-08 23:12:45,584: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 23:12:45,585: Building dev_data from config
2020-06-08 23:12:54,128:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-08 23:12:54,129:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-08 23:12:54,129:  >> stack= False
2020-06-08 23:12:54,129:  >> seg_durs= (1, None)
2020-06-08 23:12:54,129:  >> # words= 10966 (# ignored= 0)
2020-06-08 23:12:54,129:  >> input_feat_dim= 108
2020-06-08 23:12:54,129:  >> input_num_subwords= 45
2020-06-08 23:12:54,129: Using module at data.batch_samplers.BatchSampler
2020-06-08 23:12:54,129: Building dev_sampler from config
2020-06-08 23:12:54,130:  >> # examples= 10966
2020-06-08 23:12:54,130:  >> batch_size= 256
2020-06-08 23:12:54,130:  >> shuffle= False
2020-06-08 23:12:54,132:  >> BatchSampler; 43 batches
2020-06-08 23:12:54,132: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 23:12:54,132: Building test_data from config
2020-06-08 23:13:01,546:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-08 23:13:01,547:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-08 23:13:01,547:  >> stack= False
2020-06-08 23:13:01,547:  >> seg_durs= (1, None)
2020-06-08 23:13:01,548:  >> # words= 11024 (# ignored= 0)
2020-06-08 23:13:01,548:  >> input_feat_dim= 108
2020-06-08 23:13:01,548:  >> input_num_subwords= 45
2020-06-08 23:13:01,548: Using module at data.batch_samplers.BatchSampler
2020-06-08 23:13:01,548: Building test_sampler from config
2020-06-08 23:13:01,548:  >> # examples= 11024
2020-06-08 23:13:01,548:  >> batch_size= 256
2020-06-08 23:13:01,548:  >> shuffle= False
2020-06-08 23:13:01,550:  >> BatchSampler; 44 batches
2020-06-08 23:13:01,550: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-08 23:13:01,757: Building loss from config
2020-06-08 23:13:01,758:  >> margin= 0.4
2020-06-08 23:13:01,758:  >> k= 16
2020-06-08 23:13:01,758:  >> min_k= 8
2020-06-08 23:13:01,758:  >> extra= 0
2020-06-08 23:13:01,758:  >> average= False
2020-06-08 23:13:01,759:  >> margin_max= 0.5
2020-06-08 23:13:01,759:  >> threshold_max= 9
2020-06-08 23:13:01,759:  >> using obj0
2020-06-08 23:13:01,759: Using module at metric.multiview_ap.MultiViewAP
2020-06-08 23:13:03,668: Building eval from config
2020-06-08 23:13:03,668:  >> acoustic_ap= True
2020-06-08 23:13:03,669:  >> crossview_ap= True
2020-06-08 23:13:03,669:  >> full_vocab= False
2020-06-08 23:13:03,669:  >> metric= crossview_ap
2020-06-08 23:13:03,669:  >> mode= max
2020-06-08 23:13:03,669: Using module at multiview_rnn.MultiViewRNN
2020-06-08 23:13:03,738: Building net from config
2020-06-08 23:13:03,740: view1:
2020-06-08 23:13:03,742:  >> cell= GRU
2020-06-08 23:13:03,742:  >> input_size= 108
2020-06-08 23:13:03,742:  >> hidden_size= 512
2020-06-08 23:13:03,742:  >> bidirectional= True
2020-06-08 23:13:03,742:  >> num_layers= 6
2020-06-08 23:13:03,743:  >> dropout between layers= 0.4
2020-06-08 23:13:04,031: view2:
2020-06-08 23:13:04,032:  >> cell= GRU
2020-06-08 23:13:04,032:  >> input_size= 64
2020-06-08 23:13:04,032:  >> hidden_size= 512
2020-06-08 23:13:04,032:  >> bidirectional= True
2020-06-08 23:13:04,032:  >> num_layers= 2
2020-06-08 23:13:04,033:  >> dropout between layers= 0.4
2020-06-08 23:13:04,033:  >> num input embeddings= 45
2020-06-08 23:13:15,594: Using module at optim.adam.Adam
2020-06-08 23:13:15,613: Building optim from config
2020-06-08 23:13:15,614:  >> lr= 0.001
2020-06-08 23:13:15,614:  >> betas= (0.9, 0.999)
2020-06-08 23:13:15,614:  >> eps= 1e-08
2020-06-08 23:13:15,614:  >> weight_decay= 0
2020-06-08 23:13:15,614:  >> amsgrad= False
2020-06-08 23:13:15,614:  >> min_lr= 1e-07
2020-06-08 23:13:15,615: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-08 23:13:15,649: Building sched from config
2020-06-08 23:13:15,649:  >> optim= Adam
2020-06-08 23:13:15,649:  >> decay lr by 0.1
2020-06-08 23:13:15,650:  >> eval_fn= MultiViewAP
2020-06-08 23:13:15,651:  >> patience=4
2020-06-08 23:13:15,651:  >> revert=True
2020-06-08 23:13:15,678: loaded save/MultiViewDataset_IndividualWords.195.pth
2020-06-08 23:13:15,678: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-08 23:13:17,045: loaded save/MultiViewRNN.195.pth
2020-06-08 23:13:17,045: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-08 23:13:19,287: loaded save/Adam.195.pth
2020-06-08 23:13:19,287: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-08 23:13:19,290: loaded save/ReduceLROnPlateau.195.pth
2020-06-08 23:13:19,290: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-08 23:13:19,291: epoch=5.00 global_step=195 lr=0.001 start_iter=0
2020-06-08 23:13:19,291: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-08 23:16:19,732: 0) loss=0.115 grad_norm=28.91 num_segments=256 num_words=208
2020-06-08 23:19:03,978: 1) loss=0.128 grad_norm=39.24 num_segments=256 num_words=212
2020-06-08 23:21:35,776: 2) loss=0.116 grad_norm=34.87 num_segments=256 num_words=209
2020-06-08 23:23:56,235: 3) loss=0.137 grad_norm=39.69 num_segments=256 num_words=206
2020-06-08 23:26:07,982: 4) loss=0.153 grad_norm=32.67 num_segments=256 num_words=209
2020-06-08 23:28:09,040: 5) loss=0.162 grad_norm=33.14 num_segments=256 num_words=214
2020-06-08 23:29:56,531: 6) loss=0.178 grad_norm=35.24 num_segments=256 num_words=209
2020-06-08 23:31:32,008: 7) loss=0.161 grad_norm=28.56 num_segments=256 num_words=212
2020-06-08 23:33:09,456: 8) loss=0.174 grad_norm=46.39 num_segments=256 num_words=198
2020-06-08 23:34:45,035: 9) loss=0.177 grad_norm=32.77 num_segments=256 num_words=210
2020-06-08 23:36:22,051: 10) loss=0.163 grad_norm=27.02 num_segments=256 num_words=205
2020-06-08 23:37:55,812: 11) loss=0.170 grad_norm=23.13 num_segments=256 num_words=217
2020-06-08 23:39:29,759: 12) loss=0.191 grad_norm=30.61 num_segments=256 num_words=221
2020-06-08 23:41:05,658: 13) loss=0.174 grad_norm=32.35 num_segments=256 num_words=212
2020-06-08 23:42:42,604: 14) loss=0.174 grad_norm=22.63 num_segments=256 num_words=207
2020-06-08 23:44:16,549: 15) loss=0.167 grad_norm=32.21 num_segments=256 num_words=205
2020-06-08 23:45:50,609: 16) loss=0.169 grad_norm=27.52 num_segments=256 num_words=210
2020-06-08 23:47:25,287: 17) loss=0.173 grad_norm=29.38 num_segments=256 num_words=203
2020-06-08 23:48:59,412: 18) loss=0.163 grad_norm=25.94 num_segments=256 num_words=206
2020-06-08 23:50:37,305: 19) loss=0.176 grad_norm=28.17 num_segments=256 num_words=211
2020-06-08 23:52:11,418: 20) loss=0.193 grad_norm=37.90 num_segments=256 num_words=209
2020-06-08 23:53:47,299: 21) loss=0.185 grad_norm=28.94 num_segments=256 num_words=202
2020-06-08 23:55:21,257: 22) loss=0.182 grad_norm=26.79 num_segments=256 num_words=210
2020-06-08 23:56:55,084: 23) loss=0.263 grad_norm=23.71 num_segments=256 num_words=216
2020-06-08 23:58:34,408: 24) loss=0.175 grad_norm=38.79 num_segments=256 num_words=206
2020-06-09 00:00:09,711: 25) loss=0.176 grad_norm=37.66 num_segments=256 num_words=216
2020-06-09 00:01:45,133: 26) loss=0.169 grad_norm=27.45 num_segments=256 num_words=210
2020-06-09 00:03:19,539: 27) loss=0.168 grad_norm=30.51 num_segments=256 num_words=208
2020-06-09 00:04:53,911: 28) loss=0.174 grad_norm=44.08 num_segments=256 num_words=210
2020-06-09 00:06:27,640: 29) loss=0.171 grad_norm=35.88 num_segments=256 num_words=213
2020-06-09 00:08:03,171: 30) loss=0.191 grad_norm=43.11 num_segments=256 num_words=212
2020-06-09 00:09:45,493: 31) loss=0.173 grad_norm=38.55 num_segments=256 num_words=209
2020-06-09 00:11:21,048: 32) loss=0.177 grad_norm=35.42 num_segments=256 num_words=219
2020-06-09 00:12:54,907: 33) loss=0.261 grad_norm=42.50 num_segments=256 num_words=203
2020-06-09 00:14:29,076: 34) loss=0.185 grad_norm=36.86 num_segments=256 num_words=215
2020-06-09 00:16:03,587: 35) loss=0.178 grad_norm=30.31 num_segments=256 num_words=214
2020-06-09 00:17:37,948: 36) loss=0.202 grad_norm=37.10 num_segments=256 num_words=212
2020-06-09 00:19:11,515: 37) loss=0.185 grad_norm=37.67 num_segments=256 num_words=208
2020-06-09 00:20:37,739: 38) loss=0.164 grad_norm=23.01 num_segments=243 num_words=205
2020-06-09 00:20:37,757: epoch= 6.00
2020-06-09 00:20:37,757:  >> time to evaluate and save:
2020-06-09 00:20:37,823: saved save/MultiViewDataset_IndividualWords.234.pth
2020-06-09 00:20:37,826: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 00:20:37,832: saved MultiViewDataset_IndividualWords successfully
2020-06-09 00:20:39,201: saved save/MultiViewRNN.234.pth
2020-06-09 00:20:39,203: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 00:20:39,422: saved MultiViewRNN successfully
2020-06-09 00:20:42,039: saved save/Adam.234.pth
2020-06-09 00:20:42,041: most_recent linked save/Adam.most_recent.pth
2020-06-09 00:20:42,303: saved Adam successfully
2020-06-09 00:20:42,307: saved save/ReduceLROnPlateau.234.pth
2020-06-09 00:20:42,364: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 00:20:42,371: saved ReduceLROnPlateau successfully
2020-06-09 00:20:42,374: saved config successfully
2020-06-09 00:22:19,807:   >> crossview_ap=0.573 (10966 x 3921 pairs)
2020-06-09 00:23:13,552:   >> acoustic_ap=0.584 (10966 choose 2 pairs)
2020-06-09 00:23:13,556: best_so_far= 0.573 at 234
2020-06-09 00:23:13,664: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 00:23:13,671: saved MultiViewDataset_IndividualWords successfully
2020-06-09 00:23:13,679: best linked save/MultiViewRNN.best.pth
2020-06-09 00:23:13,693: saved MultiViewRNN successfully
2020-06-09 00:23:14,424: best linked save/Adam.best.pth
2020-06-09 00:23:14,441: saved Adam successfully
2020-06-09 00:23:14,516: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 00:23:14,523: saved ReduceLROnPlateau successfully
2020-06-09 00:23:14,586: epoch=6.00 global_step=234 lr=0.001 start_iter=0
2020-06-09 00:23:14,586: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 00:24:50,257: 0) loss=0.151 grad_norm=29.42 num_segments=256 num_words=210
2020-06-09 00:26:33,590: 1) loss=0.159 grad_norm=40.05 num_segments=256 num_words=211
2020-06-09 00:28:07,547: 2) loss=0.175 grad_norm=24.57 num_segments=256 num_words=206
2020-06-09 00:29:40,917: 3) loss=0.163 grad_norm=24.98 num_segments=256 num_words=217
2020-06-09 00:31:14,515: 4) loss=0.150 grad_norm=35.39 num_segments=256 num_words=216
2020-06-09 00:32:49,251: 5) loss=0.151 grad_norm=23.83 num_segments=256 num_words=209
2020-06-09 00:34:23,928: 6) loss=0.156 grad_norm=27.80 num_segments=256 num_words=214
2020-06-09 00:35:58,520: 7) loss=0.155 grad_norm=29.45 num_segments=256 num_words=209
2020-06-09 00:37:33,437: 8) loss=0.158 grad_norm=26.17 num_segments=256 num_words=210
2020-06-09 00:39:08,104: 9) loss=0.159 grad_norm=22.79 num_segments=256 num_words=214
2020-06-09 00:40:43,133: 10) loss=0.146 grad_norm=22.79 num_segments=256 num_words=202
2020-06-09 00:42:18,002: 11) loss=0.142 grad_norm=29.11 num_segments=256 num_words=207
2020-06-09 00:44:03,205: 12) loss=0.148 grad_norm=25.31 num_segments=256 num_words=208
2020-06-09 00:45:38,249: 13) loss=0.150 grad_norm=23.99 num_segments=256 num_words=213
2020-06-09 00:47:12,787: 14) loss=0.145 grad_norm=29.96 num_segments=256 num_words=206
2020-06-09 00:48:47,693: 15) loss=0.152 grad_norm=29.83 num_segments=256 num_words=215
2020-06-09 00:50:24,288: 16) loss=0.161 grad_norm=33.63 num_segments=256 num_words=211
2020-06-09 00:52:00,552: 17) loss=0.154 grad_norm=34.46 num_segments=256 num_words=214
2020-06-09 00:53:36,799: 18) loss=0.151 grad_norm=30.38 num_segments=256 num_words=212
2020-06-09 00:55:13,544: 19) loss=0.178 grad_norm=40.10 num_segments=256 num_words=202
2020-06-09 00:56:49,760: 20) loss=0.171 grad_norm=29.83 num_segments=256 num_words=213
2020-06-09 00:58:26,067: 21) loss=0.139 grad_norm=25.85 num_segments=256 num_words=207
2020-06-09 01:00:02,317: 22) loss=0.144 grad_norm=29.22 num_segments=256 num_words=209
2020-06-09 01:01:38,823: 23) loss=0.149 grad_norm=26.72 num_segments=256 num_words=207
2020-06-09 01:03:15,091: 24) loss=0.166 grad_norm=28.33 num_segments=256 num_words=209
2020-06-09 01:04:51,746: 25) loss=0.138 grad_norm=28.56 num_segments=256 num_words=203
2020-06-09 01:06:42,125: 26) loss=0.152 grad_norm=31.08 num_segments=256 num_words=208
2020-06-09 01:08:18,778: 27) loss=0.156 grad_norm=32.16 num_segments=256 num_words=210
2020-06-09 01:09:55,683: 28) loss=0.136 grad_norm=27.16 num_segments=256 num_words=200
2020-06-09 01:11:32,690: 29) loss=0.160 grad_norm=38.29 num_segments=256 num_words=204
2020-06-09 01:13:09,971: 30) loss=0.143 grad_norm=31.34 num_segments=256 num_words=208
2020-06-09 01:14:46,921: 31) loss=0.159 grad_norm=26.89 num_segments=256 num_words=215
2020-06-09 01:16:22,877: 32) loss=0.161 grad_norm=32.53 num_segments=256 num_words=214
2020-06-09 01:17:59,370: 33) loss=0.162 grad_norm=42.38 num_segments=256 num_words=215
2020-06-09 01:19:35,898: 34) loss=0.156 grad_norm=33.55 num_segments=256 num_words=212
2020-06-09 01:21:12,789: 35) loss=0.143 grad_norm=28.50 num_segments=256 num_words=203
2020-06-09 01:22:50,322: 36) loss=0.170 grad_norm=22.68 num_segments=256 num_words=217
2020-06-09 01:24:27,701: 37) loss=0.155 grad_norm=28.48 num_segments=256 num_words=206
2020-06-09 01:25:54,594: 38) loss=0.146 grad_norm=34.22 num_segments=243 num_words=200
2020-06-09 01:25:54,631: epoch= 7.00
2020-06-09 01:25:54,631:  >> time to evaluate and save:
2020-06-09 01:25:54,713: saved save/MultiViewDataset_IndividualWords.273.pth
2020-06-09 01:25:54,738: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 01:25:54,759: removed save/MultiViewDataset_IndividualWords.39.pth
2020-06-09 01:25:54,759: saved MultiViewDataset_IndividualWords successfully
2020-06-09 01:25:57,288: saved save/MultiViewRNN.273.pth
2020-06-09 01:25:57,327: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 01:25:57,402: removed save/MultiViewRNN.39.pth
2020-06-09 01:25:57,402: saved MultiViewRNN successfully
2020-06-09 01:26:01,918: saved save/Adam.273.pth
2020-06-09 01:26:01,923: most_recent linked save/Adam.most_recent.pth
2020-06-09 01:26:02,057: removed save/Adam.39.pth
2020-06-09 01:26:02,058: saved Adam successfully
2020-06-09 01:26:02,060: saved save/ReduceLROnPlateau.273.pth
2020-06-09 01:26:02,067: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 01:26:02,073: saved ReduceLROnPlateau successfully
2020-06-09 01:26:02,075: saved config successfully
2020-06-09 01:27:44,844:   >> crossview_ap=0.598 (10966 x 3921 pairs)
2020-06-09 01:29:09,381:   >> acoustic_ap=0.619 (10966 choose 2 pairs)
2020-06-09 01:29:09,385: best_so_far= 0.598 at 273
2020-06-09 01:29:09,394: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 01:29:09,397: saved MultiViewDataset_IndividualWords successfully
2020-06-09 01:29:09,416: best linked save/MultiViewRNN.best.pth
2020-06-09 01:29:09,430: saved MultiViewRNN successfully
2020-06-09 01:29:09,435: best linked save/Adam.best.pth
2020-06-09 01:29:09,438: saved Adam successfully
2020-06-09 01:29:09,454: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 01:29:09,461: removed save/ReduceLROnPlateau.39.pth
2020-06-09 01:29:09,461: saved ReduceLROnPlateau successfully
2020-06-09 01:29:09,839: epoch=7.00 global_step=273 lr=0.001 start_iter=0
2020-06-09 01:29:09,839: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 01:30:47,728: 0) loss=0.127 grad_norm=25.63 num_segments=256 num_words=202
2020-06-09 01:32:24,180: 1) loss=0.133 grad_norm=19.01 num_segments=256 num_words=217
2020-06-09 01:34:00,284: 2) loss=0.135 grad_norm=30.28 num_segments=256 num_words=212
2020-06-09 01:35:35,808: 3) loss=0.137 grad_norm=28.06 num_segments=256 num_words=211
2020-06-09 01:37:14,864: 4) loss=0.141 grad_norm=26.16 num_segments=256 num_words=207
2020-06-09 01:39:16,028: 5) loss=0.130 grad_norm=24.50 num_segments=256 num_words=208
2020-06-09 01:40:52,655: 6) loss=0.123 grad_norm=28.51 num_segments=256 num_words=208
2020-06-09 01:42:29,295: 7) loss=0.121 grad_norm=19.33 num_segments=256 num_words=207
2020-06-09 01:44:06,815: 8) loss=0.131 grad_norm=24.86 num_segments=256 num_words=218
2020-06-09 01:45:44,587: 9) loss=0.142 grad_norm=32.85 num_segments=256 num_words=215
2020-06-09 01:47:22,792: 10) loss=0.131 grad_norm=27.91 num_segments=256 num_words=207
2020-06-09 01:49:01,143: 11) loss=0.141 grad_norm=32.66 num_segments=256 num_words=210
2020-06-09 01:50:38,094: 12) loss=0.129 grad_norm=25.68 num_segments=256 num_words=217
2020-06-09 01:52:15,796: 13) loss=0.136 grad_norm=24.82 num_segments=256 num_words=209
2020-06-09 01:53:53,599: 14) loss=0.130 grad_norm=25.61 num_segments=256 num_words=209
2020-06-09 01:55:31,769: 15) loss=0.129 grad_norm=21.98 num_segments=256 num_words=218
2020-06-09 01:57:08,470: 16) loss=0.125 grad_norm=26.68 num_segments=256 num_words=205
2020-06-09 01:58:45,968: 17) loss=0.129 grad_norm=25.72 num_segments=256 num_words=213
2020-06-09 02:00:22,232: 18) loss=0.132 grad_norm=32.02 num_segments=256 num_words=214
2020-06-09 02:01:58,812: 19) loss=0.135 grad_norm=34.53 num_segments=256 num_words=208
2020-06-09 02:03:34,984: 20) loss=0.206 grad_norm=29.99 num_segments=256 num_words=206
2020-06-09 02:05:11,401: 21) loss=0.161 grad_norm=44.75 num_segments=256 num_words=211
2020-06-09 02:06:48,405: 22) loss=0.138 grad_norm=34.13 num_segments=256 num_words=206
2020-06-09 02:08:26,439: 23) loss=0.142 grad_norm=29.08 num_segments=256 num_words=214
2020-06-09 02:10:04,018: 24) loss=0.172 grad_norm=25.36 num_segments=256 num_words=221
2020-06-09 02:11:41,867: 25) loss=0.203 grad_norm=21.58 num_segments=256 num_words=207
2020-06-09 02:13:49,579: 26) loss=0.134 grad_norm=24.58 num_segments=256 num_words=207
2020-06-09 02:15:27,875: 27) loss=0.142 grad_norm=27.28 num_segments=256 num_words=216
2020-06-09 02:17:05,548: 28) loss=0.140 grad_norm=27.23 num_segments=256 num_words=225
2020-06-09 02:18:42,894: 29) loss=0.145 grad_norm=28.72 num_segments=256 num_words=210
2020-06-09 02:20:20,725: 30) loss=0.129 grad_norm=29.99 num_segments=256 num_words=213
2020-06-09 02:21:58,089: 31) loss=0.132 grad_norm=28.43 num_segments=256 num_words=219
2020-06-09 02:23:34,805: 32) loss=0.137 grad_norm=24.85 num_segments=256 num_words=204
2020-06-09 02:25:12,251: 33) loss=0.131 grad_norm=22.29 num_segments=256 num_words=199
2020-06-09 02:26:49,675: 34) loss=0.152 grad_norm=25.30 num_segments=256 num_words=216
2020-06-09 02:28:27,408: 35) loss=0.128 grad_norm=23.03 num_segments=256 num_words=212
2020-06-09 02:30:05,445: 36) loss=0.135 grad_norm=40.07 num_segments=256 num_words=211
2020-06-09 02:31:42,865: 37) loss=0.139 grad_norm=38.01 num_segments=256 num_words=221
2020-06-09 02:33:10,570: 38) loss=0.146 grad_norm=40.84 num_segments=243 num_words=211
2020-06-09 02:33:10,587: epoch= 8.00
2020-06-09 02:33:10,587:  >> time to evaluate and save:
2020-06-09 02:33:10,616: saved save/MultiViewDataset_IndividualWords.312.pth
2020-06-09 02:33:10,649: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 02:33:10,668: removed save/MultiViewDataset_IndividualWords.78.pth
2020-06-09 02:33:10,669: saved MultiViewDataset_IndividualWords successfully
2020-06-09 02:33:12,142: saved save/MultiViewRNN.312.pth
2020-06-09 02:33:12,151: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 02:33:12,201: removed save/MultiViewRNN.78.pth
2020-06-09 02:33:12,201: saved MultiViewRNN successfully
2020-06-09 02:33:14,916: saved save/Adam.312.pth
2020-06-09 02:33:14,918: most_recent linked save/Adam.most_recent.pth
2020-06-09 02:33:15,024: removed save/Adam.78.pth
2020-06-09 02:33:15,024: saved Adam successfully
2020-06-09 02:33:15,027: saved save/ReduceLROnPlateau.312.pth
2020-06-09 02:33:15,028: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 02:33:15,037: removed save/ReduceLROnPlateau.78.pth
2020-06-09 02:33:15,037: saved ReduceLROnPlateau successfully
2020-06-09 02:33:15,039: saved config successfully
2020-06-09 02:34:59,047:   >> crossview_ap=0.614 (10966 x 3921 pairs)
2020-06-09 02:36:23,511:   >> acoustic_ap=0.626 (10966 choose 2 pairs)
2020-06-09 02:36:23,519: best_so_far= 0.614 at 312
2020-06-09 02:36:23,526: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 02:36:23,529: saved MultiViewDataset_IndividualWords successfully
2020-06-09 02:36:23,531: best linked save/MultiViewRNN.best.pth
2020-06-09 02:36:23,545: saved MultiViewRNN successfully
2020-06-09 02:36:23,547: best linked save/Adam.best.pth
2020-06-09 02:36:23,552: saved Adam successfully
2020-06-09 02:36:23,554: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 02:36:23,558: saved ReduceLROnPlateau successfully
2020-06-09 02:36:24,113: epoch=8.00 global_step=312 lr=0.001 start_iter=0
2020-06-09 02:36:24,114: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 02:38:04,167: 0) loss=0.127 grad_norm=25.77 num_segments=256 num_words=208
2020-06-09 02:39:40,963: 1) loss=0.115 grad_norm=21.99 num_segments=256 num_words=208
2020-06-09 02:41:19,128: 2) loss=0.133 grad_norm=31.21 num_segments=256 num_words=213
2020-06-09 02:42:57,984: 3) loss=0.149 grad_norm=31.55 num_segments=256 num_words=208
2020-06-09 02:44:37,561: 4) loss=0.124 grad_norm=20.82 num_segments=256 num_words=205
2020-06-09 02:46:17,557: 5) loss=0.130 grad_norm=32.74 num_segments=256 num_words=213
2020-06-09 02:47:55,502: 6) loss=0.120 grad_norm=21.71 num_segments=256 num_words=218
2020-06-09 02:49:32,031: 7) loss=0.128 grad_norm=22.48 num_segments=256 num_words=205
2020-06-09 02:51:10,248: 8) loss=0.105 grad_norm=25.27 num_segments=256 num_words=206
2020-06-09 02:52:48,833: 9) loss=0.119 grad_norm=23.96 num_segments=256 num_words=219
2020-06-09 02:54:31,692: 10) loss=0.117 grad_norm=23.52 num_segments=256 num_words=205
2020-06-09 02:56:11,765: 11) loss=0.126 grad_norm=30.30 num_segments=256 num_words=199
2020-06-09 02:57:52,830: 12) loss=0.127 grad_norm=33.85 num_segments=256 num_words=214
2020-06-09 02:59:35,529: 13) loss=0.128 grad_norm=23.86 num_segments=256 num_words=210
2020-06-09 03:02:07,643: 14) loss=0.121 grad_norm=25.95 num_segments=256 num_words=198
2020-06-09 03:03:50,514: 15) loss=0.121 grad_norm=21.56 num_segments=256 num_words=216
2020-06-09 03:05:32,883: 16) loss=0.116 grad_norm=20.94 num_segments=256 num_words=215
2020-06-09 03:07:13,523: 17) loss=0.138 grad_norm=29.42 num_segments=256 num_words=217
2020-06-09 03:08:55,071: 18) loss=0.126 grad_norm=24.75 num_segments=256 num_words=215
2020-06-09 03:10:35,560: 19) loss=0.122 grad_norm=25.61 num_segments=256 num_words=214
2020-06-09 03:11:45,266: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-09 03:11:45,301: Using 1 GPU(s)
2020-06-09 03:11:45,301: Machine: 0 / 1
2020-06-09 03:11:45,303: Hyperparam tuning-------------------
2020-06-09 03:11:45,303: optim_lr: 0.001
2020-06-09 03:11:45,303: dropout (for both): 0.4
2020-06-09 03:11:45,303: margin: 0.4
2020-06-09 03:11:45,303: ------------------------------------
2020-06-09 03:11:45,306: Calling main function: multiview_trainer.train
2020-06-09 03:11:45,306: Using config file: train_config.json
2020-06-09 03:11:45,306: Using module at multiview_trainer.train
2020-06-09 03:11:45,577: Using module at multiview_vocab.MultiViewVocab
2020-06-09 03:11:45,584: Building vocab_data from config
2020-06-09 03:11:45,856:  >> min_count= 0
2020-06-09 03:11:45,856:  >> # words= 34323 (# removed= 0)
2020-06-09 03:11:45,856:  >> # subwords= 45
2020-06-09 03:11:45,856:     [laughter]= 1
2020-06-09 03:11:45,857:     [noise]= 2
2020-06-09 03:11:45,857:     [vocalized-noise]= 3
2020-06-09 03:11:45,857:     aa= 4
2020-06-09 03:11:45,857:     ae= 5
2020-06-09 03:11:45,857:     ah= 6
2020-06-09 03:11:45,857:     ao= 7
2020-06-09 03:11:45,857:     aw= 8
2020-06-09 03:11:45,857:     ax= 9
2020-06-09 03:11:45,857:     ay= 10
2020-06-09 03:11:45,857:     b= 11
2020-06-09 03:11:45,858:     ch= 12
2020-06-09 03:11:45,858:     d= 13
2020-06-09 03:11:45,858:     dh= 14
2020-06-09 03:11:45,858:     eh= 15
2020-06-09 03:11:45,858:     el= 16
2020-06-09 03:11:45,858:     en= 17
2020-06-09 03:11:45,858:     er= 18
2020-06-09 03:11:45,858:     ey= 19
2020-06-09 03:11:45,858:     f= 20
2020-06-09 03:11:45,858:     g= 21
2020-06-09 03:11:45,858:     hh= 22
2020-06-09 03:11:45,859:     ih= 23
2020-06-09 03:11:45,859:     iy= 24
2020-06-09 03:11:45,859:     jh= 25
2020-06-09 03:11:45,859:     k= 26
2020-06-09 03:11:45,859:     l= 27
2020-06-09 03:11:45,859:     m= 28
2020-06-09 03:11:45,859:     n= 29
2020-06-09 03:11:45,859:     ng= 30
2020-06-09 03:11:45,859:     ow= 31
2020-06-09 03:11:45,859:     oy= 32
2020-06-09 03:11:45,859:     p= 33
2020-06-09 03:11:45,860:     r= 34
2020-06-09 03:11:45,860:     s= 35
2020-06-09 03:11:45,860:     sh= 36
2020-06-09 03:11:45,860:     t= 37
2020-06-09 03:11:45,860:     th= 38
2020-06-09 03:11:45,860:     uh= 39
2020-06-09 03:11:45,860:     uw= 40
2020-06-09 03:11:45,860:     v= 41
2020-06-09 03:11:45,860:     w= 42
2020-06-09 03:11:45,860:     y= 43
2020-06-09 03:11:45,860:     z= 44
2020-06-09 03:11:45,861:     zh= 45
2020-06-09 03:11:45,876: Using module at data.batch_samplers.BatchSampler
2020-06-09 03:11:45,878: Building vocab_sampler from config
2020-06-09 03:11:45,878:  >> # examples= 34323
2020-06-09 03:11:45,879:  >> batch_size= 1000
2020-06-09 03:11:45,879:  >> shuffle= False
2020-06-09 03:11:45,887:  >> BatchSampler; 35 batches
2020-06-09 03:11:45,887: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 03:11:45,998: Building train_data from config
2020-06-09 03:11:54,125:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-09 03:11:54,127:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-09 03:11:54,127:  >> stack= False
2020-06-09 03:11:54,127:  >> seg_durs= (1, None)
2020-06-09 03:11:54,127:  >> # words= 9971 (# ignored= 0)
2020-06-09 03:11:54,128:  >> input_feat_dim= 108
2020-06-09 03:11:54,128:  >> input_num_subwords= 45
2020-06-09 03:11:54,128: Using module at data.batch_samplers.BatchSampler
2020-06-09 03:11:54,128: Building train_sampler from config
2020-06-09 03:11:54,129:  >> # examples= 9971
2020-06-09 03:11:54,129:  >> batch_size= 256
2020-06-09 03:11:54,129:  >> shuffle= True
2020-06-09 03:11:54,137:  >> BatchSampler; 39 batches
2020-06-09 03:11:54,138: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 03:11:54,138: Building dev_data from config
2020-06-09 03:12:03,169:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-09 03:12:03,171:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-09 03:12:03,171:  >> stack= False
2020-06-09 03:12:03,171:  >> seg_durs= (1, None)
2020-06-09 03:12:03,171:  >> # words= 10966 (# ignored= 0)
2020-06-09 03:12:03,171:  >> input_feat_dim= 108
2020-06-09 03:12:03,171:  >> input_num_subwords= 45
2020-06-09 03:12:03,171: Using module at data.batch_samplers.BatchSampler
2020-06-09 03:12:03,172: Building dev_sampler from config
2020-06-09 03:12:03,172:  >> # examples= 10966
2020-06-09 03:12:03,172:  >> batch_size= 256
2020-06-09 03:12:03,172:  >> shuffle= False
2020-06-09 03:12:03,174:  >> BatchSampler; 43 batches
2020-06-09 03:12:03,174: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 03:12:03,174: Building test_data from config
2020-06-09 03:12:10,884:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-09 03:12:10,885:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-09 03:12:10,885:  >> stack= False
2020-06-09 03:12:10,885:  >> seg_durs= (1, None)
2020-06-09 03:12:10,885:  >> # words= 11024 (# ignored= 0)
2020-06-09 03:12:10,885:  >> input_feat_dim= 108
2020-06-09 03:12:10,885:  >> input_num_subwords= 45
2020-06-09 03:12:10,885: Using module at data.batch_samplers.BatchSampler
2020-06-09 03:12:10,885: Building test_sampler from config
2020-06-09 03:12:10,886:  >> # examples= 11024
2020-06-09 03:12:10,886:  >> batch_size= 256
2020-06-09 03:12:10,886:  >> shuffle= False
2020-06-09 03:12:10,888:  >> BatchSampler; 44 batches
2020-06-09 03:12:10,888: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-09 03:12:10,901: Building loss from config
2020-06-09 03:12:10,901:  >> margin= 0.4
2020-06-09 03:12:10,901:  >> k= 16
2020-06-09 03:12:10,901:  >> min_k= 8
2020-06-09 03:12:10,901:  >> extra= 0
2020-06-09 03:12:10,901:  >> average= False
2020-06-09 03:12:10,901:  >> margin_max= 0.5
2020-06-09 03:12:10,902:  >> threshold_max= 9
2020-06-09 03:12:10,902:  >> using obj0
2020-06-09 03:12:10,902: Using module at metric.multiview_ap.MultiViewAP
2020-06-09 03:12:10,975: Building eval from config
2020-06-09 03:12:10,976:  >> acoustic_ap= True
2020-06-09 03:12:10,976:  >> crossview_ap= True
2020-06-09 03:12:10,976:  >> full_vocab= False
2020-06-09 03:12:10,976:  >> metric= crossview_ap
2020-06-09 03:12:10,976:  >> mode= max
2020-06-09 03:12:10,976: Using module at multiview_rnn.MultiViewRNN
2020-06-09 03:12:10,988: Building net from config
2020-06-09 03:12:10,990: view1:
2020-06-09 03:12:10,991:  >> cell= GRU
2020-06-09 03:12:10,991:  >> input_size= 108
2020-06-09 03:12:10,991:  >> hidden_size= 512
2020-06-09 03:12:10,991:  >> bidirectional= True
2020-06-09 03:12:10,991:  >> num_layers= 6
2020-06-09 03:12:10,991:  >> dropout between layers= 0.4
2020-06-09 03:12:11,202: view2:
2020-06-09 03:12:11,203:  >> cell= GRU
2020-06-09 03:12:11,203:  >> input_size= 64
2020-06-09 03:12:11,203:  >> hidden_size= 512
2020-06-09 03:12:11,203:  >> bidirectional= True
2020-06-09 03:12:11,203:  >> num_layers= 2
2020-06-09 03:12:11,203:  >> dropout between layers= 0.4
2020-06-09 03:12:11,203:  >> num input embeddings= 45
2020-06-09 03:12:15,363: Using module at optim.adam.Adam
2020-06-09 03:12:15,367: Building optim from config
2020-06-09 03:12:15,368:  >> lr= 0.001
2020-06-09 03:12:15,368:  >> betas= (0.9, 0.999)
2020-06-09 03:12:15,368:  >> eps= 1e-08
2020-06-09 03:12:15,368:  >> weight_decay= 0
2020-06-09 03:12:15,368:  >> amsgrad= False
2020-06-09 03:12:15,368:  >> min_lr= 1e-07
2020-06-09 03:12:15,370: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-09 03:12:15,378: Building sched from config
2020-06-09 03:12:15,379:  >> optim= Adam
2020-06-09 03:12:15,379:  >> decay lr by 0.1
2020-06-09 03:12:15,379:  >> eval_fn= MultiViewAP
2020-06-09 03:12:15,380:  >> patience=4
2020-06-09 03:12:15,380:  >> revert=True
2020-06-09 03:12:15,388: loaded save/MultiViewDataset_IndividualWords.312.pth
2020-06-09 03:12:15,389: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 03:12:15,507: loaded save/MultiViewRNN.312.pth
2020-06-09 03:12:15,507: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 03:12:15,701: loaded save/Adam.312.pth
2020-06-09 03:12:15,701: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 03:12:15,703: loaded save/ReduceLROnPlateau.312.pth
2020-06-09 03:12:15,704: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 03:12:15,704: epoch=8.00 global_step=312 lr=0.001 start_iter=0
2020-06-09 03:12:15,704: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 03:15:26,289: 0) loss=0.083 grad_norm=21.44 num_segments=256 num_words=208
2020-06-09 03:18:15,195: 1) loss=0.072 grad_norm=16.71 num_segments=256 num_words=208
2020-06-09 03:20:53,636: 2) loss=0.097 grad_norm=26.65 num_segments=256 num_words=213
2020-06-09 03:23:21,105: 3) loss=0.105 grad_norm=27.21 num_segments=256 num_words=208
2020-06-09 03:25:33,745: 4) loss=0.096 grad_norm=17.88 num_segments=256 num_words=205
2020-06-09 03:27:34,240: 5) loss=0.109 grad_norm=25.79 num_segments=256 num_words=213
2020-06-09 03:29:21,687: 6) loss=0.110 grad_norm=20.55 num_segments=256 num_words=218
2020-06-09 03:31:00,531: 7) loss=0.129 grad_norm=24.29 num_segments=256 num_words=205
2020-06-09 03:32:39,426: 8) loss=0.109 grad_norm=31.87 num_segments=256 num_words=206
2020-06-09 03:34:16,278: 9) loss=0.121 grad_norm=24.28 num_segments=256 num_words=219
2020-06-09 03:35:56,445: 10) loss=0.121 grad_norm=17.72 num_segments=256 num_words=205
2020-06-09 03:37:32,204: 11) loss=0.125 grad_norm=25.57 num_segments=256 num_words=199
2020-06-09 03:39:08,696: 12) loss=0.130 grad_norm=37.86 num_segments=256 num_words=214
2020-06-09 03:40:47,641: 13) loss=0.127 grad_norm=21.65 num_segments=256 num_words=210
2020-06-09 03:42:29,411: 14) loss=0.120 grad_norm=22.94 num_segments=256 num_words=198
2020-06-09 03:44:07,586: 15) loss=0.119 grad_norm=21.46 num_segments=256 num_words=216
2020-06-09 03:45:47,712: 16) loss=0.122 grad_norm=20.09 num_segments=256 num_words=215
2020-06-09 03:47:26,443: 17) loss=0.143 grad_norm=31.95 num_segments=256 num_words=217
2020-06-09 03:49:06,252: 18) loss=0.126 grad_norm=22.67 num_segments=256 num_words=215
2020-06-09 03:50:47,772: 19) loss=0.123 grad_norm=26.66 num_segments=256 num_words=214
2020-06-09 03:52:27,197: 20) loss=0.182 grad_norm=23.18 num_segments=256 num_words=210
2020-06-09 03:54:07,376: 21) loss=0.157 grad_norm=17.53 num_segments=256 num_words=217
2020-06-09 03:55:45,982: 22) loss=0.120 grad_norm=25.40 num_segments=256 num_words=219
2020-06-09 03:57:25,561: 23) loss=0.136 grad_norm=22.81 num_segments=256 num_words=204
2020-06-09 03:59:10,963: 24) loss=0.148 grad_norm=23.42 num_segments=256 num_words=219
2020-06-09 04:00:49,595: 25) loss=0.132 grad_norm=25.59 num_segments=256 num_words=213
2020-06-09 04:02:30,271: 26) loss=0.130 grad_norm=25.14 num_segments=256 num_words=203
2020-06-09 04:04:10,434: 27) loss=0.137 grad_norm=28.84 num_segments=256 num_words=208
2020-06-09 04:05:47,903: 28) loss=0.116 grad_norm=27.59 num_segments=256 num_words=211
2020-06-09 04:07:24,036: 29) loss=0.128 grad_norm=20.05 num_segments=256 num_words=214
2020-06-09 04:09:01,128: 30) loss=0.125 grad_norm=28.29 num_segments=256 num_words=204
2020-06-09 04:10:44,129: 31) loss=0.108 grad_norm=20.59 num_segments=256 num_words=204
2020-06-09 04:12:19,882: 32) loss=0.128 grad_norm=22.27 num_segments=256 num_words=202
2020-06-09 04:13:55,747: 33) loss=0.113 grad_norm=16.22 num_segments=256 num_words=214
2020-06-09 04:15:32,534: 34) loss=0.138 grad_norm=34.97 num_segments=256 num_words=208
2020-06-09 04:17:09,756: 35) loss=0.136 grad_norm=28.42 num_segments=256 num_words=214
2020-06-09 04:18:47,416: 36) loss=0.126 grad_norm=33.61 num_segments=256 num_words=205
2020-06-09 04:20:25,725: 37) loss=0.111 grad_norm=28.27 num_segments=256 num_words=207
2020-06-09 04:21:56,342: 38) loss=0.131 grad_norm=27.75 num_segments=243 num_words=210
2020-06-09 04:21:56,360: epoch= 9.00
2020-06-09 04:21:56,360:  >> time to evaluate and save:
2020-06-09 04:21:56,429: saved save/MultiViewDataset_IndividualWords.351.pth
2020-06-09 04:21:56,444: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 04:21:56,475: removed save/MultiViewDataset_IndividualWords.117.pth
2020-06-09 04:21:56,476: saved MultiViewDataset_IndividualWords successfully
2020-06-09 04:21:57,888: saved save/MultiViewRNN.351.pth
2020-06-09 04:21:57,901: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 04:21:57,951: removed save/MultiViewRNN.117.pth
2020-06-09 04:21:57,952: saved MultiViewRNN successfully
2020-06-09 04:22:00,515: saved save/Adam.351.pth
2020-06-09 04:22:00,521: most_recent linked save/Adam.most_recent.pth
2020-06-09 04:22:00,616: removed save/Adam.117.pth
2020-06-09 04:22:00,616: saved Adam successfully
2020-06-09 04:22:00,619: saved save/ReduceLROnPlateau.351.pth
2020-06-09 04:22:00,620: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 04:22:00,626: saved ReduceLROnPlateau successfully
2020-06-09 04:22:00,627: saved config successfully
2020-06-09 04:23:28,968:   >> crossview_ap=0.643 (10966 x 3921 pairs)
2020-06-09 04:24:23,876:   >> acoustic_ap=0.679 (10966 choose 2 pairs)
2020-06-09 04:24:23,879: best_so_far= 0.643 at 351
2020-06-09 04:24:23,901: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 04:24:23,904: saved MultiViewDataset_IndividualWords successfully
2020-06-09 04:24:23,913: best linked save/MultiViewRNN.best.pth
2020-06-09 04:24:23,925: saved MultiViewRNN successfully
2020-06-09 04:24:23,937: best linked save/Adam.best.pth
2020-06-09 04:24:23,944: saved Adam successfully
2020-06-09 04:24:23,954: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 04:24:23,959: saved ReduceLROnPlateau successfully
2020-06-09 04:24:24,006: epoch=9.00 global_step=351 lr=0.001 start_iter=0
2020-06-09 04:24:24,007: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 04:26:01,700: 0) loss=0.109 grad_norm=23.61 num_segments=256 num_words=219
2020-06-09 04:27:50,245: 1) loss=0.105 grad_norm=22.64 num_segments=256 num_words=208
2020-06-09 04:29:33,330: 2) loss=0.124 grad_norm=22.53 num_segments=256 num_words=220
2020-06-09 04:31:11,229: 3) loss=0.105 grad_norm=17.63 num_segments=256 num_words=210
2020-06-09 04:32:49,954: 4) loss=0.116 grad_norm=19.05 num_segments=256 num_words=217
2020-06-09 04:34:29,040: 5) loss=0.125 grad_norm=23.71 num_segments=256 num_words=219
2020-06-09 04:36:08,450: 6) loss=0.115 grad_norm=23.30 num_segments=256 num_words=202
2020-06-09 04:37:47,070: 7) loss=0.188 grad_norm=25.57 num_segments=256 num_words=225
2020-06-09 04:39:26,335: 8) loss=0.127 grad_norm=25.77 num_segments=256 num_words=213
2020-06-09 04:41:05,257: 9) loss=0.185 grad_norm=24.81 num_segments=256 num_words=209
2020-06-09 04:42:43,355: 10) loss=0.101 grad_norm=19.46 num_segments=256 num_words=208
2020-06-09 04:44:21,913: 11) loss=0.106 grad_norm=18.79 num_segments=256 num_words=202
2020-06-09 04:46:17,768: 12) loss=0.110 grad_norm=18.69 num_segments=256 num_words=206
2020-06-09 04:47:57,319: 13) loss=0.109 grad_norm=16.42 num_segments=256 num_words=210
2020-06-09 04:49:36,298: 14) loss=0.108 grad_norm=17.01 num_segments=256 num_words=206
2020-06-09 04:51:14,870: 15) loss=0.104 grad_norm=18.11 num_segments=256 num_words=205
2020-06-09 04:52:53,295: 16) loss=0.116 grad_norm=21.76 num_segments=256 num_words=205
2020-06-09 04:54:30,904: 17) loss=0.109 grad_norm=18.39 num_segments=256 num_words=212
2020-06-09 04:56:10,083: 18) loss=0.123 grad_norm=28.85 num_segments=256 num_words=215
2020-06-09 04:57:49,464: 19) loss=0.118 grad_norm=17.18 num_segments=256 num_words=221
2020-06-09 04:59:29,093: 20) loss=0.111 grad_norm=24.95 num_segments=256 num_words=211
2020-06-09 05:01:08,367: 21) loss=0.106 grad_norm=25.95 num_segments=256 num_words=204
2020-06-09 05:02:46,926: 22) loss=0.120 grad_norm=26.82 num_segments=256 num_words=208
2020-06-09 05:04:25,843: 23) loss=0.110 grad_norm=27.30 num_segments=256 num_words=194
2020-06-09 05:06:04,400: 24) loss=0.104 grad_norm=19.50 num_segments=256 num_words=215
2020-06-09 05:07:40,443: 25) loss=0.112 grad_norm=22.91 num_segments=256 num_words=208
2020-06-09 05:09:37,885: 26) loss=0.105 grad_norm=26.87 num_segments=256 num_words=199
2020-06-09 05:11:16,719: 27) loss=0.114 grad_norm=24.70 num_segments=256 num_words=214
2020-06-09 05:12:55,824: 28) loss=0.123 grad_norm=22.12 num_segments=256 num_words=207
2020-06-09 05:14:34,298: 29) loss=0.113 grad_norm=25.71 num_segments=256 num_words=213
2020-06-09 05:16:11,725: 30) loss=0.125 grad_norm=23.89 num_segments=256 num_words=209
2020-06-09 05:17:48,559: 31) loss=0.102 grad_norm=18.60 num_segments=256 num_words=210
2020-06-09 05:19:28,070: 32) loss=0.116 grad_norm=27.12 num_segments=256 num_words=212
2020-06-09 05:21:06,848: 33) loss=0.115 grad_norm=22.72 num_segments=256 num_words=210
2020-06-09 05:22:44,126: 34) loss=0.127 grad_norm=25.37 num_segments=256 num_words=220
2020-06-09 05:24:23,329: 35) loss=0.135 grad_norm=24.41 num_segments=256 num_words=222
2020-06-09 05:26:02,199: 36) loss=0.115 grad_norm=18.42 num_segments=256 num_words=212
2020-06-09 05:27:40,735: 37) loss=0.129 grad_norm=23.43 num_segments=256 num_words=198
2020-06-09 05:29:09,982: 38) loss=0.113 grad_norm=17.35 num_segments=243 num_words=207
2020-06-09 05:29:10,000: epoch= 10.00
2020-06-09 05:29:10,000:  >> time to evaluate and save:
2020-06-09 05:29:10,029: saved save/MultiViewDataset_IndividualWords.390.pth
2020-06-09 05:29:10,031: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 05:29:10,106: removed save/MultiViewDataset_IndividualWords.156.pth
2020-06-09 05:29:10,107: saved MultiViewDataset_IndividualWords successfully
2020-06-09 05:29:11,477: saved save/MultiViewRNN.390.pth
2020-06-09 05:29:11,490: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 05:29:11,515: removed save/MultiViewRNN.156.pth
2020-06-09 05:29:11,515: saved MultiViewRNN successfully
2020-06-09 05:29:14,077: saved save/Adam.390.pth
2020-06-09 05:29:14,087: most_recent linked save/Adam.most_recent.pth
2020-06-09 05:29:14,127: removed save/Adam.156.pth
2020-06-09 05:29:14,127: saved Adam successfully
2020-06-09 05:29:14,130: saved save/ReduceLROnPlateau.390.pth
2020-06-09 05:29:14,143: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 05:29:14,155: removed save/ReduceLROnPlateau.117.pth
2020-06-09 05:29:14,155: saved ReduceLROnPlateau successfully
2020-06-09 05:29:14,157: saved config successfully
2020-06-09 05:30:37,879:   >> crossview_ap=0.656 (10966 x 3921 pairs)
2020-06-09 05:31:31,865:   >> acoustic_ap=0.692 (10966 choose 2 pairs)
2020-06-09 05:31:31,869: best_so_far= 0.656 at 390
2020-06-09 05:31:31,892: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 05:31:31,896: saved MultiViewDataset_IndividualWords successfully
2020-06-09 05:31:31,927: best linked save/MultiViewRNN.best.pth
2020-06-09 05:31:31,948: saved MultiViewRNN successfully
2020-06-09 05:31:31,958: best linked save/Adam.best.pth
2020-06-09 05:31:31,968: saved Adam successfully
2020-06-09 05:31:31,978: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 05:31:31,996: removed save/ReduceLROnPlateau.156.pth
2020-06-09 05:31:31,996: saved ReduceLROnPlateau successfully
2020-06-09 05:31:32,426: epoch=10.00 global_step=390 lr=0.001 start_iter=0
2020-06-09 05:31:32,426: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 05:33:12,930: 0) loss=0.106 grad_norm=16.00 num_segments=256 num_words=214
2020-06-09 05:34:50,819: 1) loss=0.112 grad_norm=24.57 num_segments=256 num_words=215
2020-06-09 05:36:28,955: 2) loss=0.115 grad_norm=18.26 num_segments=256 num_words=210
2020-06-09 05:38:08,050: 3) loss=0.106 grad_norm=15.60 num_segments=256 num_words=218
2020-06-09 05:39:49,669: 4) loss=0.102 grad_norm=16.71 num_segments=256 num_words=211
2020-06-09 05:41:49,809: 5) loss=0.104 grad_norm=14.72 num_segments=256 num_words=209
2020-06-09 05:43:29,116: 6) loss=0.095 grad_norm=18.14 num_segments=256 num_words=201
2020-06-09 05:45:07,880: 7) loss=0.113 grad_norm=20.76 num_segments=256 num_words=209
2020-06-09 05:46:46,651: 8) loss=0.109 grad_norm=16.81 num_segments=256 num_words=225
2020-06-09 05:48:25,625: 9) loss=0.094 grad_norm=16.66 num_segments=256 num_words=201
2020-06-09 05:50:04,019: 10) loss=0.107 grad_norm=20.12 num_segments=256 num_words=218
2020-06-09 05:51:42,524: 11) loss=0.099 grad_norm=13.93 num_segments=256 num_words=210
2020-06-09 05:53:21,526: 12) loss=0.110 grad_norm=19.66 num_segments=256 num_words=217
2020-06-09 05:55:00,918: 13) loss=0.101 grad_norm=19.07 num_segments=256 num_words=210
2020-06-09 05:56:39,894: 14) loss=0.099 grad_norm=14.69 num_segments=256 num_words=204
2020-06-09 05:58:19,322: 15) loss=0.107 grad_norm=15.39 num_segments=256 num_words=222
2020-06-09 05:59:59,049: 16) loss=0.109 grad_norm=17.36 num_segments=256 num_words=218
2020-06-09 06:01:38,024: 17) loss=0.103 grad_norm=20.00 num_segments=256 num_words=208
2020-06-09 06:03:17,329: 18) loss=0.097 grad_norm=16.30 num_segments=256 num_words=217
2020-06-09 06:04:57,013: 19) loss=0.102 grad_norm=20.67 num_segments=256 num_words=199
2020-06-09 06:06:36,422: 20) loss=0.108 grad_norm=17.45 num_segments=256 num_words=213
2020-06-09 06:08:15,867: 21) loss=0.101 grad_norm=20.08 num_segments=256 num_words=206
2020-06-09 06:09:55,637: 22) loss=0.107 grad_norm=27.27 num_segments=256 num_words=210
2020-06-09 06:11:35,050: 23) loss=0.097 grad_norm=18.59 num_segments=256 num_words=206
2020-06-09 06:13:14,222: 24) loss=0.109 grad_norm=26.40 num_segments=256 num_words=221
2020-06-09 06:14:53,761: 25) loss=0.105 grad_norm=21.59 num_segments=256 num_words=209
2020-06-09 06:16:55,998: 26) loss=0.107 grad_norm=17.75 num_segments=256 num_words=214
2020-06-09 06:18:34,652: 27) loss=0.108 grad_norm=21.21 num_segments=256 num_words=221
2020-06-09 06:20:14,505: 28) loss=0.106 grad_norm=34.38 num_segments=256 num_words=211
2020-06-09 06:21:53,692: 29) loss=0.116 grad_norm=29.46 num_segments=256 num_words=203
2020-06-09 06:23:33,283: 30) loss=0.106 grad_norm=20.47 num_segments=256 num_words=200
2020-06-09 06:25:13,079: 31) loss=0.198 grad_norm=20.73 num_segments=256 num_words=217
2020-06-09 06:26:52,217: 32) loss=0.108 grad_norm=23.15 num_segments=256 num_words=211
2020-06-09 06:28:31,493: 33) loss=0.114 grad_norm=31.32 num_segments=256 num_words=204
2020-06-09 06:30:11,062: 34) loss=0.124 grad_norm=18.22 num_segments=256 num_words=203
2020-06-09 06:31:49,768: 35) loss=0.102 grad_norm=20.90 num_segments=256 num_words=200
2020-06-09 06:33:27,930: 36) loss=0.116 grad_norm=27.05 num_segments=256 num_words=207
2020-06-09 06:35:07,644: 37) loss=0.101 grad_norm=24.17 num_segments=256 num_words=214
2020-06-09 06:36:37,392: 38) loss=0.111 grad_norm=26.30 num_segments=243 num_words=200
2020-06-09 06:36:37,409: epoch= 11.00
2020-06-09 06:36:37,410:  >> time to evaluate and save:
2020-06-09 06:36:37,438: saved save/MultiViewDataset_IndividualWords.429.pth
2020-06-09 06:36:37,476: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 06:36:37,548: removed save/MultiViewDataset_IndividualWords.195.pth
2020-06-09 06:36:37,548: saved MultiViewDataset_IndividualWords successfully
2020-06-09 06:36:38,986: saved save/MultiViewRNN.429.pth
2020-06-09 06:36:39,000: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 06:36:39,111: removed save/MultiViewRNN.195.pth
2020-06-09 06:36:39,112: saved MultiViewRNN successfully
2020-06-09 06:36:41,707: saved save/Adam.429.pth
2020-06-09 06:36:41,710: most_recent linked save/Adam.most_recent.pth
2020-06-09 06:36:41,784: removed save/Adam.195.pth
2020-06-09 06:36:41,784: saved Adam successfully
2020-06-09 06:36:41,786: saved save/ReduceLROnPlateau.429.pth
2020-06-09 06:36:41,788: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 06:36:41,793: removed save/ReduceLROnPlateau.195.pth
2020-06-09 06:36:41,793: saved ReduceLROnPlateau successfully
2020-06-09 06:36:41,795: saved config successfully
2020-06-09 06:38:07,032:   >> crossview_ap=0.657 (10966 x 3921 pairs)
2020-06-09 06:39:08,904:   >> acoustic_ap=0.693 (10966 choose 2 pairs)
2020-06-09 06:39:08,906: best_so_far= 0.657 at 429
2020-06-09 06:39:08,912: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 06:39:08,915: saved MultiViewDataset_IndividualWords successfully
2020-06-09 06:39:08,916: best linked save/MultiViewRNN.best.pth
2020-06-09 06:39:08,928: saved MultiViewRNN successfully
2020-06-09 06:39:08,930: best linked save/Adam.best.pth
2020-06-09 06:39:08,940: saved Adam successfully
2020-06-09 06:39:08,941: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 06:39:08,944: saved ReduceLROnPlateau successfully
2020-06-09 06:39:09,811: epoch=11.00 global_step=429 lr=0.001 start_iter=0
2020-06-09 06:39:09,811: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 06:40:51,109: 0) loss=0.097 grad_norm=27.04 num_segments=256 num_words=210
2020-06-09 06:42:30,724: 1) loss=0.122 grad_norm=16.51 num_segments=256 num_words=203
2020-06-09 06:44:10,318: 2) loss=0.100 grad_norm=18.14 num_segments=256 num_words=213
2020-06-09 06:45:48,860: 3) loss=0.107 grad_norm=18.99 num_segments=256 num_words=203
2020-06-09 06:47:26,523: 4) loss=0.103 grad_norm=13.14 num_segments=256 num_words=216
2020-06-09 06:49:05,902: 5) loss=0.112 grad_norm=26.70 num_segments=256 num_words=209
2020-06-09 06:50:45,239: 6) loss=0.112 grad_norm=27.66 num_segments=256 num_words=212
2020-06-09 06:52:24,353: 7) loss=0.112 grad_norm=16.99 num_segments=256 num_words=223
2020-06-09 06:54:04,204: 8) loss=0.101 grad_norm=18.38 num_segments=256 num_words=218
2020-06-09 06:55:43,697: 9) loss=0.092 grad_norm=15.13 num_segments=256 num_words=216
2020-06-09 06:57:23,097: 10) loss=0.094 grad_norm=17.95 num_segments=256 num_words=213
2020-06-09 06:59:01,392: 11) loss=0.095 grad_norm=14.00 num_segments=256 num_words=205
2020-06-09 07:00:37,619: 12) loss=0.099 grad_norm=15.19 num_segments=256 num_words=207
2020-06-09 07:02:15,249: 13) loss=0.106 grad_norm=18.90 num_segments=256 num_words=204
2020-06-09 07:04:31,262: 14) loss=0.095 grad_norm=16.20 num_segments=256 num_words=213
2020-06-09 07:06:11,483: 15) loss=0.089 grad_norm=17.51 num_segments=256 num_words=207
2020-06-09 07:07:50,525: 16) loss=0.178 grad_norm=15.22 num_segments=256 num_words=224
2020-06-09 07:09:29,362: 17) loss=0.093 grad_norm=19.15 num_segments=256 num_words=209
2020-06-09 07:11:07,711: 18) loss=0.172 grad_norm=22.53 num_segments=256 num_words=209
2020-06-09 07:12:27,524: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-09 07:12:27,565: Using 1 GPU(s)
2020-06-09 07:12:27,565: Machine: 0 / 1
2020-06-09 07:12:27,566: Hyperparam tuning-------------------
2020-06-09 07:12:27,567: optim_lr: 0.001
2020-06-09 07:12:27,567: dropout (for both): 0.4
2020-06-09 07:12:27,567: margin: 0.4
2020-06-09 07:12:27,567: ------------------------------------
2020-06-09 07:12:27,569: Calling main function: multiview_trainer.train
2020-06-09 07:12:27,569: Using config file: train_config.json
2020-06-09 07:12:27,570: Using module at multiview_trainer.train
2020-06-09 07:12:28,550: Using module at multiview_vocab.MultiViewVocab
2020-06-09 07:12:28,563: Building vocab_data from config
2020-06-09 07:12:28,886:  >> min_count= 0
2020-06-09 07:12:28,887:  >> # words= 34323 (# removed= 0)
2020-06-09 07:12:28,887:  >> # subwords= 45
2020-06-09 07:12:28,887:     [laughter]= 1
2020-06-09 07:12:28,887:     [noise]= 2
2020-06-09 07:12:28,887:     [vocalized-noise]= 3
2020-06-09 07:12:28,887:     aa= 4
2020-06-09 07:12:28,887:     ae= 5
2020-06-09 07:12:28,887:     ah= 6
2020-06-09 07:12:28,887:     ao= 7
2020-06-09 07:12:28,887:     aw= 8
2020-06-09 07:12:28,888:     ax= 9
2020-06-09 07:12:28,888:     ay= 10
2020-06-09 07:12:28,888:     b= 11
2020-06-09 07:12:28,888:     ch= 12
2020-06-09 07:12:28,888:     d= 13
2020-06-09 07:12:28,888:     dh= 14
2020-06-09 07:12:28,888:     eh= 15
2020-06-09 07:12:28,888:     el= 16
2020-06-09 07:12:28,888:     en= 17
2020-06-09 07:12:28,888:     er= 18
2020-06-09 07:12:28,889:     ey= 19
2020-06-09 07:12:28,889:     f= 20
2020-06-09 07:12:28,889:     g= 21
2020-06-09 07:12:28,889:     hh= 22
2020-06-09 07:12:28,889:     ih= 23
2020-06-09 07:12:28,889:     iy= 24
2020-06-09 07:12:28,889:     jh= 25
2020-06-09 07:12:28,889:     k= 26
2020-06-09 07:12:28,889:     l= 27
2020-06-09 07:12:28,889:     m= 28
2020-06-09 07:12:28,889:     n= 29
2020-06-09 07:12:28,890:     ng= 30
2020-06-09 07:12:28,890:     ow= 31
2020-06-09 07:12:28,890:     oy= 32
2020-06-09 07:12:28,890:     p= 33
2020-06-09 07:12:28,890:     r= 34
2020-06-09 07:12:28,890:     s= 35
2020-06-09 07:12:28,890:     sh= 36
2020-06-09 07:12:28,890:     t= 37
2020-06-09 07:12:28,890:     th= 38
2020-06-09 07:12:28,890:     uh= 39
2020-06-09 07:12:28,890:     uw= 40
2020-06-09 07:12:28,891:     v= 41
2020-06-09 07:12:28,891:     w= 42
2020-06-09 07:12:28,891:     y= 43
2020-06-09 07:12:28,891:     z= 44
2020-06-09 07:12:28,891:     zh= 45
2020-06-09 07:12:28,907: Using module at data.batch_samplers.BatchSampler
2020-06-09 07:12:28,911: Building vocab_sampler from config
2020-06-09 07:12:28,912:  >> # examples= 34323
2020-06-09 07:12:28,912:  >> batch_size= 1000
2020-06-09 07:12:28,912:  >> shuffle= False
2020-06-09 07:12:28,920:  >> BatchSampler; 35 batches
2020-06-09 07:12:28,920: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 07:12:29,314: Building train_data from config
2020-06-09 07:12:37,208:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-09 07:12:37,210:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-09 07:12:37,210:  >> stack= False
2020-06-09 07:12:37,210:  >> seg_durs= (1, None)
2020-06-09 07:12:37,210:  >> # words= 9971 (# ignored= 0)
2020-06-09 07:12:37,210:  >> input_feat_dim= 108
2020-06-09 07:12:37,210:  >> input_num_subwords= 45
2020-06-09 07:12:37,210: Using module at data.batch_samplers.BatchSampler
2020-06-09 07:12:37,210: Building train_sampler from config
2020-06-09 07:12:37,211:  >> # examples= 9971
2020-06-09 07:12:37,211:  >> batch_size= 256
2020-06-09 07:12:37,211:  >> shuffle= True
2020-06-09 07:12:37,218:  >> BatchSampler; 39 batches
2020-06-09 07:12:37,218: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 07:12:37,218: Building dev_data from config
2020-06-09 07:12:46,013:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-09 07:12:46,014:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-09 07:12:46,014:  >> stack= False
2020-06-09 07:12:46,014:  >> seg_durs= (1, None)
2020-06-09 07:12:46,014:  >> # words= 10966 (# ignored= 0)
2020-06-09 07:12:46,014:  >> input_feat_dim= 108
2020-06-09 07:12:46,014:  >> input_num_subwords= 45
2020-06-09 07:12:46,015: Using module at data.batch_samplers.BatchSampler
2020-06-09 07:12:46,015: Building dev_sampler from config
2020-06-09 07:12:46,015:  >> # examples= 10966
2020-06-09 07:12:46,015:  >> batch_size= 256
2020-06-09 07:12:46,015:  >> shuffle= False
2020-06-09 07:12:46,017:  >> BatchSampler; 43 batches
2020-06-09 07:12:46,018: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 07:12:46,018: Building test_data from config
2020-06-09 07:12:53,553:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-09 07:12:53,553:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-09 07:12:53,553:  >> stack= False
2020-06-09 07:12:53,554:  >> seg_durs= (1, None)
2020-06-09 07:12:53,554:  >> # words= 11024 (# ignored= 0)
2020-06-09 07:12:53,554:  >> input_feat_dim= 108
2020-06-09 07:12:53,554:  >> input_num_subwords= 45
2020-06-09 07:12:53,554: Using module at data.batch_samplers.BatchSampler
2020-06-09 07:12:53,554: Building test_sampler from config
2020-06-09 07:12:53,554:  >> # examples= 11024
2020-06-09 07:12:53,554:  >> batch_size= 256
2020-06-09 07:12:53,554:  >> shuffle= False
2020-06-09 07:12:53,556:  >> BatchSampler; 44 batches
2020-06-09 07:12:53,556: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-09 07:12:53,579: Building loss from config
2020-06-09 07:12:53,579:  >> margin= 0.4
2020-06-09 07:12:53,579:  >> k= 16
2020-06-09 07:12:53,579:  >> min_k= 8
2020-06-09 07:12:53,579:  >> extra= 0
2020-06-09 07:12:53,579:  >> average= False
2020-06-09 07:12:53,579:  >> margin_max= 0.5
2020-06-09 07:12:53,580:  >> threshold_max= 9
2020-06-09 07:12:53,580:  >> using obj0
2020-06-09 07:12:53,580: Using module at metric.multiview_ap.MultiViewAP
2020-06-09 07:12:53,629: Building eval from config
2020-06-09 07:12:53,629:  >> acoustic_ap= True
2020-06-09 07:12:53,630:  >> crossview_ap= True
2020-06-09 07:12:53,630:  >> full_vocab= False
2020-06-09 07:12:53,630:  >> metric= crossview_ap
2020-06-09 07:12:53,630:  >> mode= max
2020-06-09 07:12:53,630: Using module at multiview_rnn.MultiViewRNN
2020-06-09 07:12:53,641: Building net from config
2020-06-09 07:12:53,642: view1:
2020-06-09 07:12:53,643:  >> cell= GRU
2020-06-09 07:12:53,643:  >> input_size= 108
2020-06-09 07:12:53,643:  >> hidden_size= 512
2020-06-09 07:12:53,643:  >> bidirectional= True
2020-06-09 07:12:53,644:  >> num_layers= 6
2020-06-09 07:12:53,644:  >> dropout between layers= 0.4
2020-06-09 07:12:53,855: view2:
2020-06-09 07:12:53,855:  >> cell= GRU
2020-06-09 07:12:53,856:  >> input_size= 64
2020-06-09 07:12:53,856:  >> hidden_size= 512
2020-06-09 07:12:53,856:  >> bidirectional= True
2020-06-09 07:12:53,856:  >> num_layers= 2
2020-06-09 07:12:53,856:  >> dropout between layers= 0.4
2020-06-09 07:12:53,856:  >> num input embeddings= 45
2020-06-09 07:12:57,693: Using module at optim.adam.Adam
2020-06-09 07:12:57,696: Building optim from config
2020-06-09 07:12:57,697:  >> lr= 0.001
2020-06-09 07:12:57,697:  >> betas= (0.9, 0.999)
2020-06-09 07:12:57,697:  >> eps= 1e-08
2020-06-09 07:12:57,697:  >> weight_decay= 0
2020-06-09 07:12:57,697:  >> amsgrad= False
2020-06-09 07:12:57,697:  >> min_lr= 1e-07
2020-06-09 07:12:57,698: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-09 07:12:57,705: Building sched from config
2020-06-09 07:12:57,706:  >> optim= Adam
2020-06-09 07:12:57,706:  >> decay lr by 0.1
2020-06-09 07:12:57,706:  >> eval_fn= MultiViewAP
2020-06-09 07:12:57,707:  >> patience=4
2020-06-09 07:12:57,707:  >> revert=True
2020-06-09 07:12:57,713: loaded save/MultiViewDataset_IndividualWords.429.pth
2020-06-09 07:12:57,713: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 07:12:57,840: loaded save/MultiViewRNN.429.pth
2020-06-09 07:12:57,840: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 07:12:58,057: loaded save/Adam.429.pth
2020-06-09 07:12:58,057: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 07:12:58,060: loaded save/ReduceLROnPlateau.429.pth
2020-06-09 07:12:58,060: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 07:12:58,060: epoch=11.00 global_step=429 lr=0.001 start_iter=0
2020-06-09 07:12:58,060: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 07:16:06,966: 0) loss=0.056 grad_norm=18.73 num_segments=256 num_words=210
2020-06-09 07:18:55,929: 1) loss=0.072 grad_norm=14.39 num_segments=256 num_words=203
2020-06-09 07:21:31,009: 2) loss=0.064 grad_norm=13.60 num_segments=256 num_words=213
2020-06-09 07:23:53,131: 3) loss=0.076 grad_norm=17.76 num_segments=256 num_words=203
2020-06-09 07:26:04,042: 4) loss=0.077 grad_norm=10.86 num_segments=256 num_words=216
2020-06-09 07:28:03,698: 5) loss=0.093 grad_norm=24.39 num_segments=256 num_words=209
2020-06-09 07:29:52,626: 6) loss=0.102 grad_norm=28.11 num_segments=256 num_words=212
2020-06-09 07:31:29,458: 7) loss=0.112 grad_norm=19.45 num_segments=256 num_words=223
2020-06-09 07:33:07,956: 8) loss=0.101 grad_norm=21.53 num_segments=256 num_words=218
2020-06-09 07:34:45,069: 9) loss=0.092 grad_norm=16.76 num_segments=256 num_words=216
2020-06-09 07:36:24,678: 10) loss=0.095 grad_norm=18.78 num_segments=256 num_words=213
2020-06-09 07:38:00,021: 11) loss=0.095 grad_norm=15.05 num_segments=256 num_words=205
2020-06-09 07:39:35,400: 12) loss=0.099 grad_norm=20.04 num_segments=256 num_words=207
2020-06-09 07:41:12,551: 13) loss=0.102 grad_norm=18.39 num_segments=256 num_words=204
2020-06-09 07:42:52,985: 14) loss=0.094 grad_norm=15.19 num_segments=256 num_words=213
2020-06-09 07:44:30,042: 15) loss=0.087 grad_norm=14.14 num_segments=256 num_words=207
2020-06-09 07:46:07,172: 16) loss=0.177 grad_norm=14.44 num_segments=256 num_words=224
2020-06-09 07:47:44,884: 17) loss=0.091 grad_norm=16.12 num_segments=256 num_words=209
2020-06-09 07:49:21,986: 18) loss=0.168 grad_norm=16.20 num_segments=256 num_words=209
2020-06-09 07:51:03,760: 19) loss=0.090 grad_norm=15.19 num_segments=256 num_words=201
2020-06-09 07:52:40,459: 20) loss=0.098 grad_norm=18.26 num_segments=256 num_words=207
2020-06-09 07:54:17,656: 21) loss=0.094 grad_norm=18.62 num_segments=256 num_words=202
2020-06-09 07:55:54,375: 22) loss=0.091 grad_norm=14.76 num_segments=256 num_words=214
2020-06-09 07:57:31,788: 23) loss=0.099 grad_norm=23.77 num_segments=256 num_words=213
2020-06-09 07:59:14,545: 24) loss=0.098 grad_norm=26.09 num_segments=256 num_words=203
2020-06-09 08:00:51,844: 25) loss=0.105 grad_norm=23.89 num_segments=256 num_words=211
2020-06-09 08:02:29,802: 26) loss=0.119 grad_norm=28.38 num_segments=256 num_words=214
2020-06-09 08:04:07,039: 27) loss=0.100 grad_norm=21.63 num_segments=256 num_words=210
2020-06-09 08:05:43,726: 28) loss=0.105 grad_norm=18.66 num_segments=256 num_words=206
2020-06-09 08:07:20,874: 29) loss=0.095 grad_norm=19.45 num_segments=256 num_words=209
2020-06-09 08:08:58,172: 30) loss=0.095 grad_norm=20.24 num_segments=256 num_words=220
2020-06-09 08:10:42,361: 31) loss=0.091 grad_norm=16.39 num_segments=256 num_words=208
2020-06-09 08:12:19,895: 32) loss=0.094 grad_norm=17.02 num_segments=256 num_words=212
2020-06-09 08:13:56,776: 33) loss=0.105 grad_norm=21.46 num_segments=256 num_words=210
2020-06-09 08:15:34,055: 34) loss=0.100 grad_norm=28.13 num_segments=256 num_words=220
2020-06-09 08:17:10,835: 35) loss=0.099 grad_norm=19.98 num_segments=256 num_words=203
2020-06-09 08:18:47,757: 36) loss=0.098 grad_norm=18.56 num_segments=256 num_words=217
2020-06-09 08:20:24,431: 37) loss=0.099 grad_norm=18.75 num_segments=256 num_words=215
2020-06-09 08:21:51,905: 38) loss=0.093 grad_norm=15.52 num_segments=243 num_words=203
2020-06-09 08:21:51,927: epoch= 12.00
2020-06-09 08:21:51,927:  >> time to evaluate and save:
2020-06-09 08:21:51,976: saved save/MultiViewDataset_IndividualWords.468.pth
2020-06-09 08:21:52,009: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 08:21:52,044: removed save/MultiViewDataset_IndividualWords.234.pth
2020-06-09 08:21:52,044: saved MultiViewDataset_IndividualWords successfully
2020-06-09 08:21:54,485: saved save/MultiViewRNN.468.pth
2020-06-09 08:21:54,498: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 08:21:54,593: removed save/MultiViewRNN.234.pth
2020-06-09 08:21:54,594: saved MultiViewRNN successfully
2020-06-09 08:21:59,355: saved save/Adam.468.pth
2020-06-09 08:21:59,364: most_recent linked save/Adam.most_recent.pth
2020-06-09 08:21:59,438: removed save/Adam.234.pth
2020-06-09 08:21:59,439: saved Adam successfully
2020-06-09 08:21:59,442: saved save/ReduceLROnPlateau.468.pth
2020-06-09 08:21:59,462: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 08:21:59,472: saved ReduceLROnPlateau successfully
2020-06-09 08:21:59,475: saved config successfully
2020-06-09 08:23:35,706:   >> crossview_ap=0.668 (10966 x 3921 pairs)
2020-06-09 08:24:30,325:   >> acoustic_ap=0.715 (10966 choose 2 pairs)
2020-06-09 08:24:30,328: best_so_far= 0.668 at 468
2020-06-09 08:24:30,361: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 08:24:30,364: saved MultiViewDataset_IndividualWords successfully
2020-06-09 08:24:30,392: best linked save/MultiViewRNN.best.pth
2020-06-09 08:24:30,407: saved MultiViewRNN successfully
2020-06-09 08:24:30,468: best linked save/Adam.best.pth
2020-06-09 08:24:30,484: saved Adam successfully
2020-06-09 08:24:30,539: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 08:24:30,546: saved ReduceLROnPlateau successfully
2020-06-09 08:24:30,608: epoch=12.00 global_step=468 lr=0.001 start_iter=0
2020-06-09 08:24:30,608: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 08:26:10,399: 0) loss=0.104 grad_norm=19.94 num_segments=256 num_words=216
2020-06-09 08:27:58,008: 1) loss=0.082 grad_norm=12.40 num_segments=256 num_words=206
2020-06-09 08:29:35,930: 2) loss=0.178 grad_norm=16.89 num_segments=256 num_words=214
2020-06-09 08:31:11,200: 3) loss=0.100 grad_norm=19.80 num_segments=256 num_words=205
2020-06-09 08:32:46,473: 4) loss=0.097 grad_norm=16.75 num_segments=256 num_words=221
2020-06-09 08:34:21,994: 5) loss=0.088 grad_norm=16.68 num_segments=256 num_words=204
2020-06-09 08:35:59,254: 6) loss=0.091 grad_norm=15.25 num_segments=256 num_words=206
2020-06-09 08:37:37,307: 7) loss=0.103 grad_norm=13.88 num_segments=256 num_words=214
2020-06-09 08:39:15,296: 8) loss=0.171 grad_norm=13.27 num_segments=256 num_words=209
2020-06-09 08:40:52,988: 9) loss=0.091 grad_norm=11.53 num_segments=256 num_words=209
2020-06-09 08:42:29,734: 10) loss=0.094 grad_norm=16.39 num_segments=256 num_words=205
2020-06-09 08:44:06,910: 11) loss=0.089 grad_norm=18.59 num_segments=256 num_words=211
2020-06-09 08:45:55,778: 12) loss=0.089 grad_norm=20.47 num_segments=256 num_words=204
2020-06-09 08:47:33,371: 13) loss=0.091 grad_norm=16.98 num_segments=256 num_words=220
2020-06-09 08:49:10,342: 14) loss=0.095 grad_norm=12.91 num_segments=256 num_words=201
2020-06-09 08:50:48,727: 15) loss=0.085 grad_norm=19.75 num_segments=256 num_words=209
2020-06-09 08:52:25,199: 16) loss=0.106 grad_norm=16.64 num_segments=256 num_words=210
2020-06-09 08:54:03,114: 17) loss=0.095 grad_norm=20.52 num_segments=256 num_words=211
2020-06-09 08:55:40,356: 18) loss=0.098 grad_norm=14.46 num_segments=256 num_words=209
2020-06-09 08:57:18,747: 19) loss=0.090 grad_norm=12.17 num_segments=256 num_words=208
2020-06-09 08:58:59,879: 20) loss=0.089 grad_norm=20.78 num_segments=256 num_words=208
2020-06-09 09:00:41,828: 21) loss=0.097 grad_norm=19.87 num_segments=256 num_words=213
2020-06-09 09:02:23,749: 22) loss=0.099 grad_norm=19.11 num_segments=256 num_words=219
2020-06-09 09:04:04,986: 23) loss=0.086 grad_norm=14.39 num_segments=256 num_words=215
2020-06-09 09:05:46,375: 24) loss=0.109 grad_norm=19.87 num_segments=256 num_words=205
2020-06-09 09:07:28,871: 25) loss=0.087 grad_norm=12.87 num_segments=256 num_words=198
2020-06-09 09:09:26,147: 26) loss=0.093 grad_norm=14.97 num_segments=256 num_words=214
2020-06-09 09:11:08,239: 27) loss=0.101 grad_norm=13.88 num_segments=256 num_words=220
2020-06-09 09:12:50,700: 28) loss=0.094 grad_norm=14.59 num_segments=256 num_words=206
2020-06-09 09:14:33,495: 29) loss=0.098 grad_norm=14.77 num_segments=256 num_words=200
2020-06-09 09:16:16,344: 30) loss=0.103 grad_norm=16.64 num_segments=256 num_words=219
2020-06-09 09:17:58,540: 31) loss=0.097 grad_norm=17.14 num_segments=256 num_words=220
2020-06-09 09:19:41,876: 32) loss=0.093 grad_norm=15.61 num_segments=256 num_words=205
2020-06-09 09:21:24,819: 33) loss=0.088 grad_norm=17.68 num_segments=256 num_words=208
2020-06-09 09:23:06,456: 34) loss=0.093 grad_norm=23.99 num_segments=256 num_words=214
2020-06-09 09:24:48,301: 35) loss=0.109 grad_norm=27.08 num_segments=256 num_words=213
2020-06-09 09:26:30,499: 36) loss=0.098 grad_norm=17.94 num_segments=256 num_words=212
2020-06-09 09:28:12,488: 37) loss=0.108 grad_norm=19.55 num_segments=256 num_words=222
2020-06-09 09:29:44,561: 38) loss=0.092 grad_norm=17.90 num_segments=243 num_words=200
2020-06-09 09:29:44,579: epoch= 13.00
2020-06-09 09:29:44,580:  >> time to evaluate and save:
2020-06-09 09:29:44,608: saved save/MultiViewDataset_IndividualWords.507.pth
2020-06-09 09:29:44,649: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 09:29:44,674: removed save/MultiViewDataset_IndividualWords.273.pth
2020-06-09 09:29:44,675: saved MultiViewDataset_IndividualWords successfully
2020-06-09 09:29:46,019: saved save/MultiViewRNN.507.pth
2020-06-09 09:29:46,036: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 09:29:46,093: removed save/MultiViewRNN.273.pth
2020-06-09 09:29:46,093: saved MultiViewRNN successfully
2020-06-09 09:29:48,640: saved save/Adam.507.pth
2020-06-09 09:29:48,651: most_recent linked save/Adam.most_recent.pth
2020-06-09 09:29:48,740: removed save/Adam.273.pth
2020-06-09 09:29:48,740: saved Adam successfully
2020-06-09 09:29:48,743: saved save/ReduceLROnPlateau.507.pth
2020-06-09 09:29:48,754: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 09:29:48,769: removed save/ReduceLROnPlateau.234.pth
2020-06-09 09:29:48,769: saved ReduceLROnPlateau successfully
2020-06-09 09:29:48,771: saved config successfully
2020-06-09 09:31:17,903:   >> crossview_ap=0.673 (10966 x 3921 pairs)
2020-06-09 09:32:13,834:   >> acoustic_ap=0.725 (10966 choose 2 pairs)
2020-06-09 09:32:13,838: best_so_far= 0.673 at 507
2020-06-09 09:32:13,857: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 09:32:13,863: saved MultiViewDataset_IndividualWords successfully
2020-06-09 09:32:13,878: best linked save/MultiViewRNN.best.pth
2020-06-09 09:32:13,891: saved MultiViewRNN successfully
2020-06-09 09:32:13,899: best linked save/Adam.best.pth
2020-06-09 09:32:13,910: saved Adam successfully
2020-06-09 09:32:13,930: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 09:32:13,948: removed save/ReduceLROnPlateau.273.pth
2020-06-09 09:32:13,948: saved ReduceLROnPlateau successfully
2020-06-09 09:32:14,386: epoch=13.00 global_step=507 lr=0.001 start_iter=0
2020-06-09 09:32:14,386: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 09:33:56,457: 0) loss=0.088 grad_norm=12.51 num_segments=256 num_words=204
2020-06-09 09:35:34,247: 1) loss=0.089 grad_norm=11.60 num_segments=256 num_words=208
2020-06-09 09:37:12,182: 2) loss=0.084 grad_norm=17.36 num_segments=256 num_words=203
2020-06-09 09:38:52,234: 3) loss=0.093 grad_norm=17.44 num_segments=256 num_words=215
2020-06-09 09:40:35,491: 4) loss=0.091 grad_norm=13.81 num_segments=256 num_words=206
2020-06-09 09:42:35,393: 5) loss=0.091 grad_norm=14.06 num_segments=256 num_words=219
2020-06-09 09:44:15,921: 6) loss=0.084 grad_norm=15.22 num_segments=256 num_words=218
2020-06-09 09:45:58,826: 7) loss=0.097 grad_norm=15.85 num_segments=256 num_words=216
2020-06-09 09:47:37,954: 8) loss=0.085 grad_norm=14.03 num_segments=256 num_words=208
2020-06-09 09:49:17,906: 9) loss=0.097 grad_norm=22.87 num_segments=256 num_words=207
2020-06-09 09:50:59,004: 10) loss=0.097 grad_norm=16.25 num_segments=256 num_words=215
2020-06-09 09:52:40,902: 11) loss=0.093 grad_norm=14.94 num_segments=256 num_words=205
2020-06-09 09:54:23,126: 12) loss=0.088 grad_norm=11.79 num_segments=256 num_words=220
2020-06-09 09:56:02,527: 13) loss=0.088 grad_norm=15.50 num_segments=256 num_words=221
2020-06-09 09:57:46,065: 14) loss=0.088 grad_norm=12.98 num_segments=256 num_words=219
2020-06-09 09:59:30,072: 15) loss=0.167 grad_norm=17.32 num_segments=256 num_words=211
2020-06-09 10:01:13,020: 16) loss=0.085 grad_norm=18.43 num_segments=256 num_words=211
2020-06-09 10:02:56,089: 17) loss=0.088 grad_norm=17.88 num_segments=256 num_words=205
2020-06-09 10:04:35,437: 18) loss=0.094 grad_norm=15.97 num_segments=256 num_words=212
2020-06-09 10:06:14,014: 19) loss=0.116 grad_norm=27.63 num_segments=256 num_words=204
2020-06-09 10:07:57,437: 20) loss=0.172 grad_norm=14.68 num_segments=256 num_words=224
2020-06-09 10:09:38,077: 21) loss=0.090 grad_norm=14.75 num_segments=256 num_words=207
2020-06-09 10:11:20,342: 22) loss=0.082 grad_norm=12.50 num_segments=256 num_words=205
2020-06-09 10:13:02,954: 23) loss=0.088 grad_norm=14.14 num_segments=256 num_words=216
2020-06-09 10:14:42,210: 24) loss=0.083 grad_norm=13.90 num_segments=256 num_words=203
2020-06-09 10:16:20,845: 25) loss=0.087 grad_norm=13.86 num_segments=256 num_words=200
2020-06-09 10:18:21,381: 26) loss=0.090 grad_norm=11.33 num_segments=256 num_words=204
2020-06-09 10:20:00,192: 27) loss=0.086 grad_norm=19.07 num_segments=256 num_words=202
2020-06-09 10:21:36,418: 28) loss=0.094 grad_norm=20.72 num_segments=256 num_words=208
2020-06-09 10:23:12,721: 29) loss=0.110 grad_norm=19.80 num_segments=256 num_words=214
2020-06-09 10:24:49,585: 30) loss=0.095 grad_norm=18.71 num_segments=256 num_words=208
2020-06-09 10:26:31,221: 31) loss=0.091 grad_norm=32.96 num_segments=256 num_words=218
2020-06-09 10:28:14,841: 32) loss=0.102 grad_norm=17.68 num_segments=256 num_words=216
2020-06-09 10:29:54,667: 33) loss=0.159 grad_norm=16.65 num_segments=256 num_words=210
2020-06-09 10:31:34,486: 34) loss=0.093 grad_norm=14.70 num_segments=256 num_words=213
2020-06-09 10:33:14,082: 35) loss=0.089 grad_norm=18.53 num_segments=256 num_words=211
2020-06-09 10:34:53,679: 36) loss=0.112 grad_norm=19.57 num_segments=256 num_words=213
2020-06-09 10:36:31,920: 37) loss=0.154 grad_norm=16.07 num_segments=256 num_words=204
2020-06-09 10:38:00,778: 38) loss=0.097 grad_norm=20.98 num_segments=243 num_words=199
2020-06-09 10:38:00,795: epoch= 14.00
2020-06-09 10:38:00,795:  >> time to evaluate and save:
2020-06-09 10:38:00,825: saved save/MultiViewDataset_IndividualWords.546.pth
2020-06-09 10:38:00,851: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 10:38:00,904: removed save/MultiViewDataset_IndividualWords.312.pth
2020-06-09 10:38:00,904: saved MultiViewDataset_IndividualWords successfully
2020-06-09 10:38:02,375: saved save/MultiViewRNN.546.pth
2020-06-09 10:38:02,384: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 10:38:02,448: removed save/MultiViewRNN.312.pth
2020-06-09 10:38:02,448: saved MultiViewRNN successfully
2020-06-09 10:38:05,070: saved save/Adam.546.pth
2020-06-09 10:38:05,078: most_recent linked save/Adam.most_recent.pth
2020-06-09 10:38:05,167: removed save/Adam.312.pth
2020-06-09 10:38:05,167: saved Adam successfully
2020-06-09 10:38:05,170: saved save/ReduceLROnPlateau.546.pth
2020-06-09 10:38:05,186: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 10:38:05,199: removed save/ReduceLROnPlateau.312.pth
2020-06-09 10:38:05,199: saved ReduceLROnPlateau successfully
2020-06-09 10:38:05,201: saved config successfully
2020-06-09 10:39:36,880:   >> crossview_ap=0.659 (10966 x 3921 pairs)
2020-06-09 10:40:39,208:   >> acoustic_ap=0.704 (10966 choose 2 pairs)
2020-06-09 10:40:39,211: best_so_far= 0.673 at 507
2020-06-09 10:40:39,778: epoch=14.00 global_step=546 lr=0.001 start_iter=0
2020-06-09 10:40:39,778: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 10:42:20,986: 0) loss=0.083 grad_norm=13.07 num_segments=256 num_words=215
2020-06-09 10:43:59,513: 1) loss=0.077 grad_norm=10.76 num_segments=256 num_words=203
2020-06-09 10:45:37,969: 2) loss=0.089 grad_norm=16.11 num_segments=256 num_words=199
2020-06-09 10:47:17,374: 3) loss=0.082 grad_norm=16.19 num_segments=256 num_words=207
2020-06-09 10:48:56,215: 4) loss=0.086 grad_norm=16.92 num_segments=256 num_words=201
2020-06-09 10:50:34,362: 5) loss=0.093 grad_norm=16.46 num_segments=256 num_words=211
2020-06-09 10:52:10,783: 6) loss=0.085 grad_norm=13.05 num_segments=256 num_words=215
2020-06-09 10:53:51,335: 7) loss=0.087 grad_norm=12.08 num_segments=256 num_words=207
2020-06-09 10:55:32,713: 8) loss=0.086 grad_norm=16.45 num_segments=256 num_words=215
2020-06-09 10:57:13,727: 9) loss=0.089 grad_norm=10.14 num_segments=256 num_words=208
2020-06-09 10:58:55,159: 10) loss=0.112 grad_norm=14.69 num_segments=256 num_words=203
2020-06-09 11:00:34,984: 11) loss=0.089 grad_norm=9.81 num_segments=256 num_words=218
2020-06-09 11:02:14,437: 12) loss=0.088 grad_norm=14.12 num_segments=256 num_words=210
2020-06-09 11:03:57,327: 13) loss=0.086 grad_norm=12.29 num_segments=256 num_words=218
2020-06-09 11:06:21,077: 14) loss=0.086 grad_norm=13.47 num_segments=256 num_words=215
2020-06-09 11:08:05,289: 15) loss=0.084 grad_norm=15.39 num_segments=256 num_words=215
2020-06-09 11:09:48,121: 16) loss=0.087 grad_norm=12.32 num_segments=256 num_words=207
2020-06-09 11:11:31,178: 17) loss=0.083 grad_norm=11.83 num_segments=256 num_words=212
2020-06-09 11:19:24,345: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-09 11:19:24,387: Using 1 GPU(s)
2020-06-09 11:19:24,388: Machine: 0 / 1
2020-06-09 11:19:24,389: Hyperparam tuning-------------------
2020-06-09 11:19:24,389: optim_lr: 0.001
2020-06-09 11:19:24,389: dropout (for both): 0.4
2020-06-09 11:19:24,389: margin: 0.4
2020-06-09 11:19:24,389: ------------------------------------
2020-06-09 11:19:24,391: Calling main function: multiview_trainer.train
2020-06-09 11:19:24,391: Using config file: train_config.json
2020-06-09 11:19:24,391: Using module at multiview_trainer.train
2020-06-09 11:19:25,376: Using module at multiview_vocab.MultiViewVocab
2020-06-09 11:19:25,440: Building vocab_data from config
2020-06-09 11:19:25,722:  >> min_count= 0
2020-06-09 11:19:25,722:  >> # words= 34323 (# removed= 0)
2020-06-09 11:19:25,722:  >> # subwords= 45
2020-06-09 11:19:25,722:     [laughter]= 1
2020-06-09 11:19:25,723:     [noise]= 2
2020-06-09 11:19:25,723:     [vocalized-noise]= 3
2020-06-09 11:19:25,723:     aa= 4
2020-06-09 11:19:25,723:     ae= 5
2020-06-09 11:19:25,723:     ah= 6
2020-06-09 11:19:25,723:     ao= 7
2020-06-09 11:19:25,723:     aw= 8
2020-06-09 11:19:25,723:     ax= 9
2020-06-09 11:19:25,723:     ay= 10
2020-06-09 11:19:25,723:     b= 11
2020-06-09 11:19:25,723:     ch= 12
2020-06-09 11:19:25,723:     d= 13
2020-06-09 11:19:25,723:     dh= 14
2020-06-09 11:19:25,723:     eh= 15
2020-06-09 11:19:25,723:     el= 16
2020-06-09 11:19:25,723:     en= 17
2020-06-09 11:19:25,723:     er= 18
2020-06-09 11:19:25,723:     ey= 19
2020-06-09 11:19:25,723:     f= 20
2020-06-09 11:19:25,724:     g= 21
2020-06-09 11:19:25,724:     hh= 22
2020-06-09 11:19:25,724:     ih= 23
2020-06-09 11:19:25,724:     iy= 24
2020-06-09 11:19:25,724:     jh= 25
2020-06-09 11:19:25,724:     k= 26
2020-06-09 11:19:25,724:     l= 27
2020-06-09 11:19:25,724:     m= 28
2020-06-09 11:19:25,724:     n= 29
2020-06-09 11:19:25,724:     ng= 30
2020-06-09 11:19:25,724:     ow= 31
2020-06-09 11:19:25,724:     oy= 32
2020-06-09 11:19:25,724:     p= 33
2020-06-09 11:19:25,724:     r= 34
2020-06-09 11:19:25,724:     s= 35
2020-06-09 11:19:25,724:     sh= 36
2020-06-09 11:19:25,724:     t= 37
2020-06-09 11:19:25,724:     th= 38
2020-06-09 11:19:25,724:     uh= 39
2020-06-09 11:19:25,725:     uw= 40
2020-06-09 11:19:25,725:     v= 41
2020-06-09 11:19:25,725:     w= 42
2020-06-09 11:19:25,725:     y= 43
2020-06-09 11:19:25,725:     z= 44
2020-06-09 11:19:25,725:     zh= 45
2020-06-09 11:19:25,739: Using module at data.batch_samplers.BatchSampler
2020-06-09 11:19:25,752: Building vocab_sampler from config
2020-06-09 11:19:25,753:  >> # examples= 34323
2020-06-09 11:19:25,753:  >> batch_size= 1000
2020-06-09 11:19:25,753:  >> shuffle= False
2020-06-09 11:19:25,761:  >> BatchSampler; 35 batches
2020-06-09 11:19:25,761: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 11:19:25,995: Building train_data from config
2020-06-09 11:19:32,729:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-09 11:19:32,730:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-09 11:19:32,730:  >> stack= False
2020-06-09 11:19:32,730:  >> seg_durs= (1, None)
2020-06-09 11:19:32,730:  >> # words= 9971 (# ignored= 0)
2020-06-09 11:19:32,730:  >> input_feat_dim= 108
2020-06-09 11:19:32,730:  >> input_num_subwords= 45
2020-06-09 11:19:32,730: Using module at data.batch_samplers.BatchSampler
2020-06-09 11:19:32,730: Building train_sampler from config
2020-06-09 11:19:32,731:  >> # examples= 9971
2020-06-09 11:19:32,731:  >> batch_size= 256
2020-06-09 11:19:32,731:  >> shuffle= True
2020-06-09 11:19:32,738:  >> BatchSampler; 39 batches
2020-06-09 11:19:32,738: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 11:19:32,738: Building dev_data from config
2020-06-09 11:19:40,172:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-09 11:19:40,172:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-09 11:19:40,172:  >> stack= False
2020-06-09 11:19:40,172:  >> seg_durs= (1, None)
2020-06-09 11:19:40,172:  >> # words= 10966 (# ignored= 0)
2020-06-09 11:19:40,172:  >> input_feat_dim= 108
2020-06-09 11:19:40,172:  >> input_num_subwords= 45
2020-06-09 11:19:40,172: Using module at data.batch_samplers.BatchSampler
2020-06-09 11:19:40,173: Building dev_sampler from config
2020-06-09 11:19:40,173:  >> # examples= 10966
2020-06-09 11:19:40,173:  >> batch_size= 256
2020-06-09 11:19:40,173:  >> shuffle= False
2020-06-09 11:19:40,175:  >> BatchSampler; 43 batches
2020-06-09 11:19:40,175: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 11:19:40,175: Building test_data from config
2020-06-09 11:19:46,532:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-09 11:19:46,532:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-09 11:19:46,532:  >> stack= False
2020-06-09 11:19:46,533:  >> seg_durs= (1, None)
2020-06-09 11:19:46,533:  >> # words= 11024 (# ignored= 0)
2020-06-09 11:19:46,533:  >> input_feat_dim= 108
2020-06-09 11:19:46,533:  >> input_num_subwords= 45
2020-06-09 11:19:46,533: Using module at data.batch_samplers.BatchSampler
2020-06-09 11:19:46,533: Building test_sampler from config
2020-06-09 11:19:46,533:  >> # examples= 11024
2020-06-09 11:19:46,533:  >> batch_size= 256
2020-06-09 11:19:46,533:  >> shuffle= False
2020-06-09 11:19:46,535:  >> BatchSampler; 44 batches
2020-06-09 11:19:46,535: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-09 11:19:46,586: Building loss from config
2020-06-09 11:19:46,586:  >> margin= 0.4
2020-06-09 11:19:46,586:  >> k= 16
2020-06-09 11:19:46,586:  >> min_k= 8
2020-06-09 11:19:46,586:  >> extra= 0
2020-06-09 11:19:46,587:  >> average= False
2020-06-09 11:19:46,587:  >> margin_max= 0.5
2020-06-09 11:19:46,587:  >> threshold_max= 9
2020-06-09 11:19:46,587:  >> using obj0
2020-06-09 11:19:46,587: Using module at metric.multiview_ap.MultiViewAP
2020-06-09 11:19:46,636: Building eval from config
2020-06-09 11:19:46,637:  >> acoustic_ap= True
2020-06-09 11:19:46,637:  >> crossview_ap= True
2020-06-09 11:19:46,637:  >> full_vocab= False
2020-06-09 11:19:46,637:  >> metric= crossview_ap
2020-06-09 11:19:46,637:  >> mode= max
2020-06-09 11:19:46,637: Using module at multiview_rnn.MultiViewRNN
2020-06-09 11:19:46,658: Building net from config
2020-06-09 11:19:46,659: view1:
2020-06-09 11:19:46,660:  >> cell= GRU
2020-06-09 11:19:46,660:  >> input_size= 108
2020-06-09 11:19:46,660:  >> hidden_size= 512
2020-06-09 11:19:46,660:  >> bidirectional= True
2020-06-09 11:19:46,660:  >> num_layers= 6
2020-06-09 11:19:46,660:  >> dropout between layers= 0.4
2020-06-09 11:19:46,865: view2:
2020-06-09 11:19:46,866:  >> cell= GRU
2020-06-09 11:19:46,866:  >> input_size= 64
2020-06-09 11:19:46,866:  >> hidden_size= 512
2020-06-09 11:19:46,866:  >> bidirectional= True
2020-06-09 11:19:46,866:  >> num_layers= 2
2020-06-09 11:19:46,866:  >> dropout between layers= 0.4
2020-06-09 11:19:46,866:  >> num input embeddings= 45
2020-06-09 11:19:49,448: Using module at optim.adam.Adam
2020-06-09 11:19:49,468: Building optim from config
2020-06-09 11:19:49,468:  >> lr= 0.001
2020-06-09 11:19:49,468:  >> betas= (0.9, 0.999)
2020-06-09 11:19:49,468:  >> eps= 1e-08
2020-06-09 11:19:49,468:  >> weight_decay= 0
2020-06-09 11:19:49,468:  >> amsgrad= False
2020-06-09 11:19:49,468:  >> min_lr= 1e-07
2020-06-09 11:19:49,469: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-09 11:19:49,506: Building sched from config
2020-06-09 11:19:49,506:  >> optim= Adam
2020-06-09 11:19:49,506:  >> decay lr by 0.1
2020-06-09 11:19:49,506:  >> eval_fn= MultiViewAP
2020-06-09 11:19:49,507:  >> patience=4
2020-06-09 11:19:49,507:  >> revert=True
2020-06-09 11:19:49,516: loaded save/MultiViewDataset_IndividualWords.546.pth
2020-06-09 11:19:49,516: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 11:19:50,623: loaded save/MultiViewRNN.546.pth
2020-06-09 11:19:50,623: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 11:19:52,821: loaded save/Adam.546.pth
2020-06-09 11:19:52,821: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 11:19:52,823: loaded save/ReduceLROnPlateau.546.pth
2020-06-09 11:19:52,824: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 11:19:52,824: epoch=14.00 global_step=546 lr=0.001 start_iter=0
2020-06-09 11:19:52,824: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 11:21:42,828: 0) loss=0.047 grad_norm=10.11 num_segments=256 num_words=215
2020-06-09 11:23:21,594: 1) loss=0.045 grad_norm=7.96 num_segments=256 num_words=203
2020-06-09 11:24:54,254: 2) loss=0.057 grad_norm=12.03 num_segments=256 num_words=199
2020-06-09 11:26:29,007: 3) loss=0.057 grad_norm=16.84 num_segments=256 num_words=207
2020-06-09 11:27:49,143: 4) loss=0.065 grad_norm=19.26 num_segments=256 num_words=201
2020-06-09 11:29:02,857: 5) loss=0.075 grad_norm=16.34 num_segments=256 num_words=211
2020-06-09 11:30:07,547: 6) loss=0.076 grad_norm=11.67 num_segments=256 num_words=215
2020-06-09 11:31:04,061: 7) loss=0.086 grad_norm=17.20 num_segments=256 num_words=207
2020-06-09 11:32:03,822: 8) loss=0.085 grad_norm=15.90 num_segments=256 num_words=215
2020-06-09 11:33:01,021: 9) loss=0.089 grad_norm=10.50 num_segments=256 num_words=208
2020-06-09 11:34:00,277: 10) loss=0.106 grad_norm=14.53 num_segments=256 num_words=203
2020-06-09 11:34:57,130: 11) loss=0.090 grad_norm=12.03 num_segments=256 num_words=218
2020-06-09 11:35:53,480: 12) loss=0.087 grad_norm=11.90 num_segments=256 num_words=210
2020-06-09 11:36:52,059: 13) loss=0.085 grad_norm=13.62 num_segments=256 num_words=218
2020-06-09 11:37:54,222: 14) loss=0.086 grad_norm=11.50 num_segments=256 num_words=215
2020-06-09 11:38:58,340: 15) loss=0.085 grad_norm=16.95 num_segments=256 num_words=215
2020-06-09 11:39:57,908: 16) loss=0.084 grad_norm=16.18 num_segments=256 num_words=207
2020-06-09 11:40:55,599: 17) loss=0.086 grad_norm=17.11 num_segments=256 num_words=212
2020-06-09 11:41:55,436: 18) loss=0.094 grad_norm=13.57 num_segments=256 num_words=214
2020-06-09 11:43:07,746: 19) loss=0.109 grad_norm=14.07 num_segments=256 num_words=212
2020-06-09 11:44:04,658: 20) loss=0.164 grad_norm=14.37 num_segments=256 num_words=213
2020-06-09 11:45:03,445: 21) loss=0.084 grad_norm=18.65 num_segments=256 num_words=211
2020-06-09 11:46:00,179: 22) loss=0.107 grad_norm=15.87 num_segments=256 num_words=203
2020-06-09 11:46:57,747: 23) loss=0.095 grad_norm=14.35 num_segments=256 num_words=209
2020-06-09 11:48:00,695: 24) loss=0.086 grad_norm=12.62 num_segments=256 num_words=208
2020-06-09 11:48:58,522: 25) loss=0.076 grad_norm=15.04 num_segments=256 num_words=202
2020-06-09 11:49:56,246: 26) loss=0.084 grad_norm=17.71 num_segments=256 num_words=212
2020-06-09 11:50:54,504: 27) loss=0.085 grad_norm=13.30 num_segments=256 num_words=211
2020-06-09 11:51:53,827: 28) loss=0.086 grad_norm=15.09 num_segments=256 num_words=214
2020-06-09 11:52:50,270: 29) loss=0.096 grad_norm=12.72 num_segments=256 num_words=211
2020-06-09 11:53:47,072: 30) loss=0.094 grad_norm=18.12 num_segments=256 num_words=222
2020-06-09 11:54:49,996: 31) loss=0.091 grad_norm=12.96 num_segments=256 num_words=206
2020-06-09 11:55:49,738: 32) loss=0.087 grad_norm=16.12 num_segments=256 num_words=213
2020-06-09 11:56:47,653: 33) loss=0.082 grad_norm=12.68 num_segments=256 num_words=206
2020-06-09 11:57:45,729: 34) loss=0.102 grad_norm=16.42 num_segments=256 num_words=203
2020-06-09 11:58:43,493: 35) loss=0.091 grad_norm=19.09 num_segments=256 num_words=211
2020-06-09 11:59:42,076: 36) loss=0.087 grad_norm=16.34 num_segments=256 num_words=207
2020-06-09 12:00:40,804: 37) loss=0.087 grad_norm=14.19 num_segments=256 num_words=200
2020-06-09 12:01:34,209: 38) loss=0.087 grad_norm=12.49 num_segments=243 num_words=197
2020-06-09 12:01:34,220: epoch= 15.00
2020-06-09 12:01:34,220:  >> time to evaluate and save:
2020-06-09 12:01:34,248: saved save/MultiViewDataset_IndividualWords.585.pth
2020-06-09 12:01:34,250: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 12:01:34,341: removed save/MultiViewDataset_IndividualWords.351.pth
2020-06-09 12:01:34,342: saved MultiViewDataset_IndividualWords successfully
2020-06-09 12:01:35,641: saved save/MultiViewRNN.585.pth
2020-06-09 12:01:35,642: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 12:01:35,843: removed save/MultiViewRNN.351.pth
2020-06-09 12:01:35,843: saved MultiViewRNN successfully
2020-06-09 12:01:38,376: saved save/Adam.585.pth
2020-06-09 12:01:38,387: most_recent linked save/Adam.most_recent.pth
2020-06-09 12:01:38,580: removed save/Adam.351.pth
2020-06-09 12:01:38,581: saved Adam successfully
2020-06-09 12:01:38,583: saved save/ReduceLROnPlateau.585.pth
2020-06-09 12:01:38,584: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 12:01:38,615: removed save/ReduceLROnPlateau.351.pth
2020-06-09 12:01:38,615: saved ReduceLROnPlateau successfully
2020-06-09 12:01:38,616: saved config successfully
2020-06-09 12:03:02,255:   >> crossview_ap=0.675 (10966 x 3921 pairs)
2020-06-09 12:03:53,873:   >> acoustic_ap=0.711 (10966 choose 2 pairs)
2020-06-09 12:03:53,875: best_so_far= 0.675 at 585
2020-06-09 12:03:53,878: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 12:03:53,881: saved MultiViewDataset_IndividualWords successfully
2020-06-09 12:03:53,882: best linked save/MultiViewRNN.best.pth
2020-06-09 12:03:53,890: saved MultiViewRNN successfully
2020-06-09 12:03:53,891: best linked save/Adam.best.pth
2020-06-09 12:03:53,898: saved Adam successfully
2020-06-09 12:03:53,899: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 12:03:53,934: saved ReduceLROnPlateau successfully
2020-06-09 12:03:54,014: epoch=15.00 global_step=585 lr=0.001 start_iter=0
2020-06-09 12:03:54,014: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 12:04:52,870: 0) loss=0.081 grad_norm=9.41 num_segments=256 num_words=219
2020-06-09 12:06:01,275: 1) loss=0.082 grad_norm=16.65 num_segments=256 num_words=215
2020-06-09 12:06:59,231: 2) loss=0.079 grad_norm=10.52 num_segments=256 num_words=205
2020-06-09 12:07:57,611: 3) loss=0.096 grad_norm=13.10 num_segments=256 num_words=213
2020-06-09 12:08:55,674: 4) loss=0.083 grad_norm=10.98 num_segments=256 num_words=212
2020-06-09 12:09:53,465: 5) loss=0.079 grad_norm=12.92 num_segments=256 num_words=200
2020-06-09 12:10:50,106: 6) loss=0.089 grad_norm=17.56 num_segments=256 num_words=219
2020-06-09 12:11:48,980: 7) loss=0.102 grad_norm=14.00 num_segments=256 num_words=213
2020-06-09 12:12:49,901: 8) loss=0.080 grad_norm=8.93 num_segments=256 num_words=210
2020-06-09 12:13:53,794: 9) loss=0.171 grad_norm=19.16 num_segments=256 num_words=211
2020-06-09 12:14:59,176: 10) loss=0.081 grad_norm=15.71 num_segments=256 num_words=201
2020-06-09 12:16:03,906: 11) loss=0.137 grad_norm=15.06 num_segments=256 num_words=200
2020-06-09 12:17:19,998: 12) loss=0.082 grad_norm=15.11 num_segments=256 num_words=205
2020-06-09 12:18:23,722: 13) loss=0.081 grad_norm=8.99 num_segments=256 num_words=212
2020-06-09 12:19:30,138: 14) loss=0.090 grad_norm=25.32 num_segments=256 num_words=214
2020-06-09 12:20:34,508: 15) loss=0.084 grad_norm=11.61 num_segments=256 num_words=206
2020-06-09 12:21:39,830: 16) loss=0.083 grad_norm=11.85 num_segments=256 num_words=207
2020-06-09 12:22:44,882: 17) loss=0.083 grad_norm=15.48 num_segments=256 num_words=216
2020-06-09 12:23:49,261: 18) loss=0.087 grad_norm=10.21 num_segments=256 num_words=216
2020-06-09 12:24:56,121: 19) loss=0.083 grad_norm=10.02 num_segments=256 num_words=215
2020-06-09 12:26:00,387: 20) loss=0.080 grad_norm=11.76 num_segments=256 num_words=194
2020-06-09 12:27:04,702: 21) loss=0.091 grad_norm=14.63 num_segments=256 num_words=216
2020-06-09 12:28:10,805: 22) loss=0.082 grad_norm=10.36 num_segments=256 num_words=202
2020-06-09 12:29:16,378: 23) loss=0.087 grad_norm=13.04 num_segments=256 num_words=214
2020-06-09 12:30:21,542: 24) loss=0.085 grad_norm=12.80 num_segments=256 num_words=202
2020-06-09 12:31:26,392: 25) loss=0.088 grad_norm=11.81 num_segments=256 num_words=212
2020-06-09 12:32:49,320: 26) loss=0.087 grad_norm=12.64 num_segments=256 num_words=214
2020-06-09 12:33:53,711: 27) loss=0.092 grad_norm=17.53 num_segments=256 num_words=220
2020-06-09 12:34:58,419: 28) loss=0.084 grad_norm=14.75 num_segments=256 num_words=205
2020-06-09 12:36:02,910: 29) loss=0.087 grad_norm=14.28 num_segments=256 num_words=212
2020-06-09 12:37:11,857: 30) loss=0.097 grad_norm=15.53 num_segments=256 num_words=198
2020-06-09 12:38:16,385: 31) loss=0.092 grad_norm=16.05 num_segments=256 num_words=224
2020-06-09 12:39:21,134: 32) loss=0.098 grad_norm=15.94 num_segments=256 num_words=214
2020-06-09 12:40:26,370: 33) loss=0.086 grad_norm=16.10 num_segments=256 num_words=225
2020-06-09 12:41:32,361: 34) loss=0.087 grad_norm=15.07 num_segments=256 num_words=220
2020-06-09 12:42:45,856: 35) loss=0.082 grad_norm=10.74 num_segments=256 num_words=210
2020-06-09 12:43:51,102: 36) loss=0.087 grad_norm=11.55 num_segments=256 num_words=209
2020-06-09 12:44:56,360: 37) loss=0.085 grad_norm=15.36 num_segments=256 num_words=212
2020-06-09 12:45:54,932: 38) loss=0.111 grad_norm=15.41 num_segments=243 num_words=200
2020-06-09 12:45:54,944: epoch= 16.00
2020-06-09 12:45:54,944:  >> time to evaluate and save:
2020-06-09 12:45:55,034: saved save/MultiViewDataset_IndividualWords.624.pth
2020-06-09 12:45:55,041: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 12:45:55,066: removed save/MultiViewDataset_IndividualWords.390.pth
2020-06-09 12:45:55,066: saved MultiViewDataset_IndividualWords successfully
2020-06-09 12:45:56,383: saved save/MultiViewRNN.624.pth
2020-06-09 12:45:56,397: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 12:45:56,438: removed save/MultiViewRNN.390.pth
2020-06-09 12:45:56,439: saved MultiViewRNN successfully
2020-06-09 12:45:58,989: saved save/Adam.624.pth
2020-06-09 12:45:58,997: most_recent linked save/Adam.most_recent.pth
2020-06-09 12:45:59,072: removed save/Adam.390.pth
2020-06-09 12:45:59,072: saved Adam successfully
2020-06-09 12:45:59,074: saved save/ReduceLROnPlateau.624.pth
2020-06-09 12:45:59,113: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 12:45:59,117: saved ReduceLROnPlateau successfully
2020-06-09 12:45:59,119: saved config successfully
2020-06-09 12:47:29,125:   >> crossview_ap=0.677 (10966 x 3921 pairs)
2020-06-09 12:48:29,781:   >> acoustic_ap=0.722 (10966 choose 2 pairs)
2020-06-09 12:48:29,784: best_so_far= 0.677 at 624
2020-06-09 12:48:29,807: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 12:48:29,809: saved MultiViewDataset_IndividualWords successfully
2020-06-09 12:48:29,820: best linked save/MultiViewRNN.best.pth
2020-06-09 12:48:29,829: saved MultiViewRNN successfully
2020-06-09 12:48:29,842: best linked save/Adam.best.pth
2020-06-09 12:48:29,850: saved Adam successfully
2020-06-09 12:48:29,867: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 12:48:29,878: removed save/ReduceLROnPlateau.390.pth
2020-06-09 12:48:29,878: saved ReduceLROnPlateau successfully
2020-06-09 12:48:30,404: epoch=16.00 global_step=624 lr=0.001 start_iter=0
2020-06-09 12:48:30,404: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 12:49:36,860: 0) loss=0.094 grad_norm=18.64 num_segments=256 num_words=215
2020-06-09 12:50:42,286: 1) loss=0.085 grad_norm=17.33 num_segments=256 num_words=213
2020-06-09 12:51:47,027: 2) loss=0.082 grad_norm=10.70 num_segments=256 num_words=214
2020-06-09 12:52:54,256: 3) loss=0.086 grad_norm=14.92 num_segments=256 num_words=219
2020-06-09 12:54:01,293: 4) loss=0.086 grad_norm=11.98 num_segments=256 num_words=220
2020-06-09 12:55:31,253: 5) loss=0.089 grad_norm=14.74 num_segments=256 num_words=222
2020-06-09 12:56:36,705: 6) loss=0.144 grad_norm=12.74 num_segments=256 num_words=205
2020-06-09 12:57:41,857: 7) loss=0.088 grad_norm=16.74 num_segments=256 num_words=201
2020-06-09 12:58:47,423: 8) loss=0.103 grad_norm=9.59 num_segments=256 num_words=203
2020-06-09 12:59:52,186: 9) loss=0.081 grad_norm=13.88 num_segments=256 num_words=213
2020-06-09 13:00:56,778: 10) loss=0.082 grad_norm=15.75 num_segments=256 num_words=212
2020-06-09 13:02:01,125: 11) loss=0.094 grad_norm=15.23 num_segments=256 num_words=210
2020-06-09 13:03:05,716: 12) loss=0.083 grad_norm=15.16 num_segments=256 num_words=202
2020-06-09 13:04:12,889: 13) loss=0.087 grad_norm=13.73 num_segments=256 num_words=214
2020-06-09 13:05:22,993: 14) loss=0.157 grad_norm=22.54 num_segments=256 num_words=214
2020-06-09 13:06:31,742: 15) loss=0.080 grad_norm=16.45 num_segments=256 num_words=200
2020-06-09 13:07:37,561: 16) loss=0.086 grad_norm=13.84 num_segments=256 num_words=216
2020-06-09 13:08:42,567: 17) loss=0.079 grad_norm=8.83 num_segments=256 num_words=206
2020-06-09 13:09:51,740: 18) loss=0.091 grad_norm=27.35 num_segments=256 num_words=213
2020-06-09 13:10:57,229: 19) loss=0.082 grad_norm=12.42 num_segments=256 num_words=218
2020-06-09 13:12:15,993: 20) loss=0.083 grad_norm=14.84 num_segments=256 num_words=222
2020-06-09 13:13:22,774: 21) loss=0.078 grad_norm=11.65 num_segments=256 num_words=201
2020-06-09 13:14:44,632: 22) loss=0.077 grad_norm=18.44 num_segments=256 num_words=212
2020-06-09 13:15:50,284: 23) loss=0.093 grad_norm=20.07 num_segments=256 num_words=210
2020-06-09 13:16:55,959: 24) loss=0.093 grad_norm=16.50 num_segments=256 num_words=217
2020-06-09 13:18:01,224: 25) loss=0.087 grad_norm=16.95 num_segments=256 num_words=200
2020-06-09 13:19:30,839: 26) loss=0.087 grad_norm=14.79 num_segments=256 num_words=212
2020-06-09 13:20:36,476: 27) loss=0.094 grad_norm=21.68 num_segments=256 num_words=214
2020-06-09 13:21:41,124: 28) loss=0.079 grad_norm=16.12 num_segments=256 num_words=210
2020-06-09 13:22:46,057: 29) loss=0.165 grad_norm=21.57 num_segments=256 num_words=227
2020-06-09 13:23:52,587: 30) loss=0.079 grad_norm=10.22 num_segments=256 num_words=210
2020-06-09 13:24:59,990: 31) loss=0.094 grad_norm=15.83 num_segments=256 num_words=213
2020-06-09 13:26:04,062: 32) loss=0.086 grad_norm=22.63 num_segments=256 num_words=216
2020-06-09 13:27:07,186: 33) loss=0.085 grad_norm=13.25 num_segments=256 num_words=200
2020-06-09 13:28:14,890: 34) loss=0.095 grad_norm=24.80 num_segments=256 num_words=212
2020-06-09 13:29:17,015: 35) loss=0.079 grad_norm=11.35 num_segments=256 num_words=209
2020-06-09 13:30:20,354: 36) loss=0.086 grad_norm=18.88 num_segments=256 num_words=199
2020-06-09 13:31:22,571: 37) loss=0.094 grad_norm=16.10 num_segments=256 num_words=215
2020-06-09 13:32:18,982: 38) loss=0.084 grad_norm=11.08 num_segments=243 num_words=195
2020-06-09 13:32:18,994: epoch= 17.00
2020-06-09 13:32:18,994:  >> time to evaluate and save:
2020-06-09 13:32:19,036: saved save/MultiViewDataset_IndividualWords.663.pth
2020-06-09 13:32:19,095: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 13:32:19,136: removed save/MultiViewDataset_IndividualWords.429.pth
2020-06-09 13:32:19,137: saved MultiViewDataset_IndividualWords successfully
2020-06-09 13:32:20,537: saved save/MultiViewRNN.663.pth
2020-06-09 13:32:20,557: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 13:32:20,610: removed save/MultiViewRNN.429.pth
2020-06-09 13:32:20,610: saved MultiViewRNN successfully
2020-06-09 13:32:23,148: saved save/Adam.663.pth
2020-06-09 13:32:23,175: most_recent linked save/Adam.most_recent.pth
2020-06-09 13:32:23,259: removed save/Adam.429.pth
2020-06-09 13:32:23,259: saved Adam successfully
2020-06-09 13:32:23,261: saved save/ReduceLROnPlateau.663.pth
2020-06-09 13:32:23,280: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 13:32:23,295: removed save/ReduceLROnPlateau.429.pth
2020-06-09 13:32:23,295: saved ReduceLROnPlateau successfully
2020-06-09 13:32:23,297: saved config successfully
2020-06-09 13:33:52,879:   >> crossview_ap=0.684 (10966 x 3921 pairs)
2020-06-09 13:34:47,294:   >> acoustic_ap=0.727 (10966 choose 2 pairs)
2020-06-09 13:34:47,298: best_so_far= 0.684 at 663
2020-06-09 13:34:47,322: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 13:34:47,325: saved MultiViewDataset_IndividualWords successfully
2020-06-09 13:34:47,356: best linked save/MultiViewRNN.best.pth
2020-06-09 13:34:47,366: saved MultiViewRNN successfully
2020-06-09 13:34:47,390: best linked save/Adam.best.pth
2020-06-09 13:34:47,399: saved Adam successfully
2020-06-09 13:34:47,425: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 13:34:47,428: saved ReduceLROnPlateau successfully
2020-06-09 13:34:48,245: epoch=17.00 global_step=663 lr=0.001 start_iter=0
2020-06-09 13:34:48,246: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 13:35:50,079: 0) loss=0.083 grad_norm=14.02 num_segments=256 num_words=202
2020-06-09 13:36:49,425: 1) loss=0.075 grad_norm=11.30 num_segments=256 num_words=218
2020-06-09 13:37:48,753: 2) loss=0.094 grad_norm=10.30 num_segments=256 num_words=203
2020-06-09 13:38:47,486: 3) loss=0.078 grad_norm=9.69 num_segments=256 num_words=211
2020-06-09 13:39:46,275: 4) loss=0.075 grad_norm=6.55 num_segments=256 num_words=210
2020-06-09 13:40:46,468: 5) loss=0.076 grad_norm=11.78 num_segments=256 num_words=206
2020-06-09 13:41:45,180: 6) loss=0.106 grad_norm=10.85 num_segments=256 num_words=199
2020-06-09 13:42:42,785: 7) loss=0.073 grad_norm=9.05 num_segments=256 num_words=211
2020-06-09 13:43:41,102: 8) loss=0.076 grad_norm=9.36 num_segments=256 num_words=208
2020-06-09 13:44:41,250: 9) loss=0.083 grad_norm=11.34 num_segments=256 num_words=207
2020-06-09 13:45:42,272: 10) loss=0.095 grad_norm=7.27 num_segments=256 num_words=207
2020-06-09 13:46:40,506: 11) loss=0.100 grad_norm=10.40 num_segments=256 num_words=217
2020-06-09 13:47:40,118: 12) loss=0.083 grad_norm=8.36 num_segments=256 num_words=219
2020-06-09 13:48:38,088: 13) loss=0.103 grad_norm=8.47 num_segments=256 num_words=217
2020-06-09 13:50:11,227: 14) loss=0.137 grad_norm=9.26 num_segments=256 num_words=207
2020-06-09 13:51:09,534: 15) loss=0.079 grad_norm=8.60 num_segments=256 num_words=212
2020-06-09 13:52:07,946: 16) loss=0.074 grad_norm=11.06 num_segments=256 num_words=208
2020-06-09 13:53:06,404: 17) loss=0.077 grad_norm=8.52 num_segments=256 num_words=214
2020-06-09 13:54:04,488: 18) loss=0.077 grad_norm=11.64 num_segments=256 num_words=207
2020-06-09 13:55:02,295: 19) loss=0.083 grad_norm=7.85 num_segments=256 num_words=206
2020-06-09 13:56:00,274: 20) loss=0.087 grad_norm=7.74 num_segments=256 num_words=216
2020-06-09 13:56:58,625: 21) loss=0.086 grad_norm=13.23 num_segments=256 num_words=213
2020-06-09 13:57:56,605: 22) loss=0.081 grad_norm=8.32 num_segments=256 num_words=211
2020-06-09 13:58:55,042: 23) loss=0.166 grad_norm=14.04 num_segments=256 num_words=217
2020-06-09 13:59:53,750: 24) loss=0.081 grad_norm=8.11 num_segments=256 num_words=212
2020-06-09 14:00:52,339: 25) loss=0.089 grad_norm=8.41 num_segments=256 num_words=204
2020-06-09 14:01:51,168: 26) loss=0.149 grad_norm=10.48 num_segments=256 num_words=209
2020-06-09 14:02:49,860: 27) loss=0.139 grad_norm=10.58 num_segments=256 num_words=210
2020-06-09 14:03:47,492: 28) loss=0.078 grad_norm=12.37 num_segments=256 num_words=208
2020-06-09 14:04:46,264: 29) loss=0.077 grad_norm=8.22 num_segments=256 num_words=198
2020-06-09 14:05:51,567: 30) loss=0.075 grad_norm=10.07 num_segments=256 num_words=211
2020-06-09 14:06:49,746: 31) loss=0.094 grad_norm=13.93 num_segments=256 num_words=210
2020-06-09 14:07:48,188: 32) loss=0.077 grad_norm=10.56 num_segments=256 num_words=203
2020-06-09 14:08:46,495: 33) loss=0.078 grad_norm=10.56 num_segments=256 num_words=209
2020-06-09 14:09:45,740: 34) loss=0.083 grad_norm=19.27 num_segments=256 num_words=217
2020-06-09 14:10:48,979: 35) loss=0.095 grad_norm=10.28 num_segments=256 num_words=209
2020-06-09 14:11:50,495: 36) loss=0.081 grad_norm=14.46 num_segments=256 num_words=219
2020-06-09 14:12:48,745: 37) loss=0.075 grad_norm=12.78 num_segments=256 num_words=195
2020-06-09 14:13:41,771: 38) loss=0.078 grad_norm=10.42 num_segments=243 num_words=200
2020-06-09 14:13:41,781: epoch= 18.00
2020-06-09 14:13:41,781:  >> time to evaluate and save:
2020-06-09 14:13:41,817: saved save/MultiViewDataset_IndividualWords.702.pth
2020-06-09 14:13:41,845: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 14:13:41,872: removed save/MultiViewDataset_IndividualWords.468.pth
2020-06-09 14:13:41,873: saved MultiViewDataset_IndividualWords successfully
2020-06-09 14:13:43,210: saved save/MultiViewRNN.702.pth
2020-06-09 14:13:43,216: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 14:13:43,262: removed save/MultiViewRNN.468.pth
2020-06-09 14:13:43,262: saved MultiViewRNN successfully
2020-06-09 14:13:45,805: saved save/Adam.702.pth
2020-06-09 14:13:45,811: most_recent linked save/Adam.most_recent.pth
2020-06-09 14:13:45,839: removed save/Adam.468.pth
2020-06-09 14:13:45,839: saved Adam successfully
2020-06-09 14:13:45,841: saved save/ReduceLROnPlateau.702.pth
2020-06-09 14:13:45,847: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 14:13:45,870: removed save/ReduceLROnPlateau.468.pth
2020-06-09 14:13:45,870: saved ReduceLROnPlateau successfully
2020-06-09 14:13:45,872: saved config successfully
2020-06-09 14:15:05,936:   >> crossview_ap=0.678 (10966 x 3921 pairs)
2020-06-09 14:16:06,066:   >> acoustic_ap=0.736 (10966 choose 2 pairs)
2020-06-09 14:16:06,070: best_so_far= 0.684 at 663
2020-06-09 14:16:07,174: epoch=18.00 global_step=702 lr=0.001 start_iter=0
2020-06-09 14:16:07,175: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 14:17:09,634: 0) loss=0.087 grad_norm=9.37 num_segments=256 num_words=215
2020-06-09 14:18:07,498: 1) loss=0.082 grad_norm=9.06 num_segments=256 num_words=204
2020-06-09 14:19:06,901: 2) loss=0.081 grad_norm=15.53 num_segments=256 num_words=213
2020-06-09 14:20:04,942: 3) loss=0.080 grad_norm=7.32 num_segments=256 num_words=210
2020-06-09 14:21:03,213: 4) loss=0.084 grad_norm=8.22 num_segments=256 num_words=205
2020-06-09 14:22:01,483: 5) loss=0.083 grad_norm=10.59 num_segments=256 num_words=214
2020-06-09 14:23:01,484: 6) loss=0.080 grad_norm=9.57 num_segments=256 num_words=217
2020-06-09 14:23:59,853: 7) loss=0.081 grad_norm=6.48 num_segments=256 num_words=209
2020-06-09 14:24:57,701: 8) loss=0.151 grad_norm=9.57 num_segments=256 num_words=208
2020-06-09 14:26:36,325: 9) loss=0.081 grad_norm=14.06 num_segments=256 num_words=213
2020-06-09 14:27:34,486: 10) loss=0.079 grad_norm=7.74 num_segments=256 num_words=204
2020-06-09 14:28:37,144: 11) loss=0.088 grad_norm=15.56 num_segments=256 num_words=214
2020-06-09 14:29:37,679: 12) loss=0.079 grad_norm=18.41 num_segments=256 num_words=203
2020-06-09 14:30:35,947: 13) loss=0.083 grad_norm=23.97 num_segments=256 num_words=203
2020-06-09 14:31:33,723: 14) loss=0.090 grad_norm=10.79 num_segments=256 num_words=211
2020-06-09 14:32:32,167: 15) loss=0.081 grad_norm=13.32 num_segments=256 num_words=200
2020-06-09 14:33:30,427: 16) loss=0.150 grad_norm=13.09 num_segments=256 num_words=216
2020-06-09 14:34:29,662: 17) loss=0.079 grad_norm=10.71 num_segments=256 num_words=212
2020-06-09 14:35:27,384: 18) loss=0.082 grad_norm=12.83 num_segments=256 num_words=221
2020-06-09 14:36:25,468: 19) loss=0.079 grad_norm=9.54 num_segments=256 num_words=200
2020-06-09 14:37:23,979: 20) loss=0.149 grad_norm=11.00 num_segments=256 num_words=213
2020-06-09 14:38:21,253: 21) loss=0.092 grad_norm=10.42 num_segments=256 num_words=204
2020-06-09 14:39:19,825: 22) loss=0.074 grad_norm=9.12 num_segments=256 num_words=216
2020-06-09 14:40:27,253: 23) loss=0.077 grad_norm=10.45 num_segments=256 num_words=210
2020-06-09 14:41:25,746: 24) loss=0.084 grad_norm=7.36 num_segments=256 num_words=208
2020-06-09 14:42:24,027: 25) loss=0.074 grad_norm=9.21 num_segments=256 num_words=216
2020-06-09 14:43:22,603: 26) loss=0.077 grad_norm=11.30 num_segments=256 num_words=202
2020-06-09 14:44:20,667: 27) loss=0.082 grad_norm=8.94 num_segments=256 num_words=199
2020-06-09 14:45:19,849: 28) loss=0.083 grad_norm=12.01 num_segments=256 num_words=211
2020-06-09 14:46:20,052: 29) loss=0.078 grad_norm=11.34 num_segments=256 num_words=207
2020-06-09 14:47:22,938: 30) loss=0.081 grad_norm=19.69 num_segments=256 num_words=205
2020-06-09 14:48:22,052: 31) loss=0.083 grad_norm=10.09 num_segments=256 num_words=209
2020-06-09 14:49:27,904: 32) loss=0.078 grad_norm=15.31 num_segments=256 num_words=215
2020-06-09 14:50:35,953: 33) loss=0.083 grad_norm=9.36 num_segments=256 num_words=220
2020-06-09 14:51:55,465: 34) loss=0.079 grad_norm=16.80 num_segments=256 num_words=209
2020-06-09 14:53:16,135: 35) loss=0.151 grad_norm=17.39 num_segments=256 num_words=203
2020-06-09 14:54:38,455: 36) loss=0.084 grad_norm=23.83 num_segments=256 num_words=217
2020-06-09 14:55:57,661: 37) loss=0.095 grad_norm=10.13 num_segments=256 num_words=205
2020-06-09 14:56:52,737: 38) loss=0.098 grad_norm=10.68 num_segments=243 num_words=199
2020-06-09 14:56:52,915: epoch= 19.00
2020-06-09 14:56:52,915:  >> time to evaluate and save:
2020-06-09 14:56:54,383: saved save/MultiViewDataset_IndividualWords.741.pth
2020-06-09 14:56:54,909: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 14:56:55,479: removed save/MultiViewDataset_IndividualWords.507.pth
2020-06-09 14:56:55,479: saved MultiViewDataset_IndividualWords successfully
2020-06-09 14:56:57,711: saved save/MultiViewRNN.741.pth
2020-06-09 14:56:58,152: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 14:56:59,560: removed save/MultiViewRNN.507.pth
2020-06-09 14:56:59,560: saved MultiViewRNN successfully
2020-06-09 14:57:03,525: saved save/Adam.741.pth
2020-06-09 14:57:03,974: most_recent linked save/Adam.most_recent.pth
2020-06-09 14:57:05,356: removed save/Adam.507.pth
2020-06-09 14:57:05,569: saved Adam successfully
2020-06-09 14:57:06,006: saved save/ReduceLROnPlateau.741.pth
2020-06-09 14:57:06,505: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 14:57:07,058: removed save/ReduceLROnPlateau.507.pth
2020-06-09 14:57:07,058: saved ReduceLROnPlateau successfully
2020-06-09 14:57:07,575: saved config successfully
2020-06-09 14:58:43,288:   >> crossview_ap=0.684 (10966 x 3921 pairs)
2020-06-09 14:59:37,857:   >> acoustic_ap=0.731 (10966 choose 2 pairs)
2020-06-09 14:59:37,861: best_so_far= 0.684 at 741
2020-06-09 14:59:37,879: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 14:59:37,882: saved MultiViewDataset_IndividualWords successfully
2020-06-09 14:59:37,908: best linked save/MultiViewRNN.best.pth
2020-06-09 14:59:37,917: saved MultiViewRNN successfully
2020-06-09 14:59:37,937: best linked save/Adam.best.pth
2020-06-09 14:59:37,944: saved Adam successfully
2020-06-09 14:59:37,965: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 14:59:37,969: saved ReduceLROnPlateau successfully
2020-06-09 14:59:39,562: epoch=19.00 global_step=741 lr=0.001 start_iter=0
2020-06-09 14:59:39,563: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 15:00:41,969: 0) loss=0.070 grad_norm=7.92 num_segments=256 num_words=210
2020-06-09 15:01:44,948: 1) loss=0.085 grad_norm=14.06 num_segments=256 num_words=222
2020-06-09 15:02:47,848: 2) loss=0.078 grad_norm=8.74 num_segments=256 num_words=213
2020-06-09 15:03:54,745: 3) loss=0.079 grad_norm=12.15 num_segments=256 num_words=218
2020-06-09 15:04:49,993: 4) loss=0.077 grad_norm=7.41 num_segments=256 num_words=206
2020-06-09 15:05:45,200: 5) loss=0.073 grad_norm=9.59 num_segments=256 num_words=208
2020-06-09 15:06:41,214: 6) loss=0.081 grad_norm=9.48 num_segments=256 num_words=214
2020-06-09 15:07:37,005: 7) loss=0.079 grad_norm=10.17 num_segments=256 num_words=207
2020-06-09 15:08:32,623: 8) loss=0.070 grad_norm=7.56 num_segments=256 num_words=206
2020-06-09 15:09:28,780: 9) loss=0.083 grad_norm=11.71 num_segments=256 num_words=208
2020-06-09 15:10:23,831: 10) loss=0.077 grad_norm=10.81 num_segments=256 num_words=204
2020-06-09 15:11:18,992: 11) loss=0.085 grad_norm=10.98 num_segments=256 num_words=211
2020-06-09 15:13:03,948: 12) loss=0.096 grad_norm=11.20 num_segments=256 num_words=216
2020-06-09 15:13:59,401: 13) loss=0.074 grad_norm=12.83 num_segments=256 num_words=213
2020-06-09 15:14:54,585: 14) loss=0.067 grad_norm=7.84 num_segments=256 num_words=202
2020-06-09 15:15:50,132: 15) loss=0.089 grad_norm=10.89 num_segments=256 num_words=210
2020-06-09 15:16:45,242: 16) loss=0.072 grad_norm=8.15 num_segments=256 num_words=201
2020-06-09 15:17:41,057: 17) loss=0.087 grad_norm=11.04 num_segments=256 num_words=210
2020-06-09 15:18:36,791: 18) loss=0.075 grad_norm=8.50 num_segments=256 num_words=216
2020-06-09 15:19:31,769: 19) loss=0.086 grad_norm=15.07 num_segments=256 num_words=206
2020-06-09 15:20:10,008: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-09 15:20:10,040: Using 1 GPU(s)
2020-06-09 15:20:10,040: Machine: 0 / 1
2020-06-09 15:20:10,045: Hyperparam tuning-------------------
2020-06-09 15:20:10,045: optim_lr: 0.001
2020-06-09 15:20:10,045: dropout (for both): 0.4
2020-06-09 15:20:10,045: margin: 0.4
2020-06-09 15:20:10,045: ------------------------------------
2020-06-09 15:20:10,047: Calling main function: multiview_trainer.train
2020-06-09 15:20:10,047: Using config file: train_config.json
2020-06-09 15:20:10,047: Using module at multiview_trainer.train
2020-06-09 15:20:10,315: Using module at multiview_vocab.MultiViewVocab
2020-06-09 15:20:10,351: Building vocab_data from config
2020-06-09 15:20:10,648:  >> min_count= 0
2020-06-09 15:20:10,648:  >> # words= 34323 (# removed= 0)
2020-06-09 15:20:10,648:  >> # subwords= 45
2020-06-09 15:20:10,648:     [laughter]= 1
2020-06-09 15:20:10,648:     [noise]= 2
2020-06-09 15:20:10,649:     [vocalized-noise]= 3
2020-06-09 15:20:10,649:     aa= 4
2020-06-09 15:20:10,649:     ae= 5
2020-06-09 15:20:10,649:     ah= 6
2020-06-09 15:20:10,649:     ao= 7
2020-06-09 15:20:10,649:     aw= 8
2020-06-09 15:20:10,649:     ax= 9
2020-06-09 15:20:10,649:     ay= 10
2020-06-09 15:20:10,649:     b= 11
2020-06-09 15:20:10,649:     ch= 12
2020-06-09 15:20:10,649:     d= 13
2020-06-09 15:20:10,649:     dh= 14
2020-06-09 15:20:10,649:     eh= 15
2020-06-09 15:20:10,649:     el= 16
2020-06-09 15:20:10,650:     en= 17
2020-06-09 15:20:10,650:     er= 18
2020-06-09 15:20:10,650:     ey= 19
2020-06-09 15:20:10,650:     f= 20
2020-06-09 15:20:10,650:     g= 21
2020-06-09 15:20:10,650:     hh= 22
2020-06-09 15:20:10,650:     ih= 23
2020-06-09 15:20:10,650:     iy= 24
2020-06-09 15:20:10,650:     jh= 25
2020-06-09 15:20:10,650:     k= 26
2020-06-09 15:20:10,650:     l= 27
2020-06-09 15:20:10,650:     m= 28
2020-06-09 15:20:10,650:     n= 29
2020-06-09 15:20:10,651:     ng= 30
2020-06-09 15:20:10,651:     ow= 31
2020-06-09 15:20:10,651:     oy= 32
2020-06-09 15:20:10,651:     p= 33
2020-06-09 15:20:10,651:     r= 34
2020-06-09 15:20:10,651:     s= 35
2020-06-09 15:20:10,651:     sh= 36
2020-06-09 15:20:10,651:     t= 37
2020-06-09 15:20:10,651:     th= 38
2020-06-09 15:20:10,651:     uh= 39
2020-06-09 15:20:10,651:     uw= 40
2020-06-09 15:20:10,651:     v= 41
2020-06-09 15:20:10,651:     w= 42
2020-06-09 15:20:10,651:     y= 43
2020-06-09 15:20:10,652:     z= 44
2020-06-09 15:20:10,652:     zh= 45
2020-06-09 15:20:10,666: Using module at data.batch_samplers.BatchSampler
2020-06-09 15:20:10,689: Building vocab_sampler from config
2020-06-09 15:20:10,689:  >> # examples= 34323
2020-06-09 15:20:10,689:  >> batch_size= 1000
2020-06-09 15:20:10,690:  >> shuffle= False
2020-06-09 15:20:10,697:  >> BatchSampler; 35 batches
2020-06-09 15:20:10,697: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 15:20:10,807: Building train_data from config
2020-06-09 15:20:17,901:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-09 15:20:17,902:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-09 15:20:17,903:  >> stack= False
2020-06-09 15:20:17,903:  >> seg_durs= (1, None)
2020-06-09 15:20:17,903:  >> # words= 9971 (# ignored= 0)
2020-06-09 15:20:17,903:  >> input_feat_dim= 108
2020-06-09 15:20:17,903:  >> input_num_subwords= 45
2020-06-09 15:20:17,903: Using module at data.batch_samplers.BatchSampler
2020-06-09 15:20:17,903: Building train_sampler from config
2020-06-09 15:20:17,904:  >> # examples= 9971
2020-06-09 15:20:17,904:  >> batch_size= 256
2020-06-09 15:20:17,904:  >> shuffle= True
2020-06-09 15:20:17,911:  >> BatchSampler; 39 batches
2020-06-09 15:20:17,911: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 15:20:17,911: Building dev_data from config
2020-06-09 15:20:26,005:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-09 15:20:26,006:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-09 15:20:26,006:  >> stack= False
2020-06-09 15:20:26,006:  >> seg_durs= (1, None)
2020-06-09 15:20:26,006:  >> # words= 10966 (# ignored= 0)
2020-06-09 15:20:26,007:  >> input_feat_dim= 108
2020-06-09 15:20:26,007:  >> input_num_subwords= 45
2020-06-09 15:20:26,007: Using module at data.batch_samplers.BatchSampler
2020-06-09 15:20:26,007: Building dev_sampler from config
2020-06-09 15:20:26,008:  >> # examples= 10966
2020-06-09 15:20:26,008:  >> batch_size= 256
2020-06-09 15:20:26,008:  >> shuffle= False
2020-06-09 15:20:26,010:  >> BatchSampler; 43 batches
2020-06-09 15:20:26,010: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 15:20:26,010: Building test_data from config
2020-06-09 15:20:33,356:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-09 15:20:33,356:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-09 15:20:33,356:  >> stack= False
2020-06-09 15:20:33,356:  >> seg_durs= (1, None)
2020-06-09 15:20:33,356:  >> # words= 11024 (# ignored= 0)
2020-06-09 15:20:33,357:  >> input_feat_dim= 108
2020-06-09 15:20:33,357:  >> input_num_subwords= 45
2020-06-09 15:20:33,357: Using module at data.batch_samplers.BatchSampler
2020-06-09 15:20:33,357: Building test_sampler from config
2020-06-09 15:20:33,357:  >> # examples= 11024
2020-06-09 15:20:33,357:  >> batch_size= 256
2020-06-09 15:20:33,358:  >> shuffle= False
2020-06-09 15:20:33,359:  >> BatchSampler; 44 batches
2020-06-09 15:20:33,360: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-09 15:20:33,442: Building loss from config
2020-06-09 15:20:33,443:  >> margin= 0.4
2020-06-09 15:20:33,443:  >> k= 16
2020-06-09 15:20:33,443:  >> min_k= 8
2020-06-09 15:20:33,443:  >> extra= 0
2020-06-09 15:20:33,443:  >> average= False
2020-06-09 15:20:33,444:  >> margin_max= 0.5
2020-06-09 15:20:33,444:  >> threshold_max= 9
2020-06-09 15:20:33,444:  >> using obj0
2020-06-09 15:20:33,444: Using module at metric.multiview_ap.MultiViewAP
2020-06-09 15:20:33,559: Building eval from config
2020-06-09 15:20:33,560:  >> acoustic_ap= True
2020-06-09 15:20:33,560:  >> crossview_ap= True
2020-06-09 15:20:33,560:  >> full_vocab= False
2020-06-09 15:20:33,560:  >> metric= crossview_ap
2020-06-09 15:20:33,560:  >> mode= max
2020-06-09 15:20:33,560: Using module at multiview_rnn.MultiViewRNN
2020-06-09 15:20:33,639: Building net from config
2020-06-09 15:20:33,641: view1:
2020-06-09 15:20:33,642:  >> cell= GRU
2020-06-09 15:20:33,642:  >> input_size= 108
2020-06-09 15:20:33,642:  >> hidden_size= 512
2020-06-09 15:20:33,642:  >> bidirectional= True
2020-06-09 15:20:33,643:  >> num_layers= 6
2020-06-09 15:20:33,643:  >> dropout between layers= 0.4
2020-06-09 15:20:33,873: view2:
2020-06-09 15:20:33,874:  >> cell= GRU
2020-06-09 15:20:33,874:  >> input_size= 64
2020-06-09 15:20:33,874:  >> hidden_size= 512
2020-06-09 15:20:33,874:  >> bidirectional= True
2020-06-09 15:20:33,874:  >> num_layers= 2
2020-06-09 15:20:33,874:  >> dropout between layers= 0.4
2020-06-09 15:20:33,874:  >> num input embeddings= 45
2020-06-09 15:20:37,423: Using module at optim.adam.Adam
2020-06-09 15:20:37,445: Building optim from config
2020-06-09 15:20:37,446:  >> lr= 0.001
2020-06-09 15:20:37,446:  >> betas= (0.9, 0.999)
2020-06-09 15:20:37,446:  >> eps= 1e-08
2020-06-09 15:20:37,446:  >> weight_decay= 0
2020-06-09 15:20:37,446:  >> amsgrad= False
2020-06-09 15:20:37,446:  >> min_lr= 1e-07
2020-06-09 15:20:37,447: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-09 15:20:37,486: Building sched from config
2020-06-09 15:20:37,487:  >> optim= Adam
2020-06-09 15:20:37,487:  >> decay lr by 0.1
2020-06-09 15:20:37,487:  >> eval_fn= MultiViewAP
2020-06-09 15:20:37,488:  >> patience=4
2020-06-09 15:20:37,488:  >> revert=True
2020-06-09 15:20:37,500: loaded save/MultiViewDataset_IndividualWords.741.pth
2020-06-09 15:20:37,500: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 15:20:38,689: loaded save/MultiViewRNN.741.pth
2020-06-09 15:20:38,692: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 15:20:41,338: loaded save/Adam.741.pth
2020-06-09 15:20:41,338: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 15:20:41,341: loaded save/ReduceLROnPlateau.741.pth
2020-06-09 15:20:41,341: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 15:20:41,342: epoch=19.00 global_step=741 lr=0.001 start_iter=0
2020-06-09 15:20:41,342: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 15:23:32,029: 0) loss=0.039 grad_norm=5.63 num_segments=256 num_words=210
2020-06-09 15:26:07,779: 1) loss=0.051 grad_norm=10.61 num_segments=256 num_words=222
2020-06-09 15:28:40,831: 2) loss=0.049 grad_norm=12.60 num_segments=256 num_words=213
2020-06-09 15:31:03,526: 3) loss=0.054 grad_norm=8.46 num_segments=256 num_words=218
2020-06-09 15:33:13,956: 4) loss=0.058 grad_norm=6.73 num_segments=256 num_words=206
2020-06-09 15:35:13,422: 5) loss=0.059 grad_norm=8.80 num_segments=256 num_words=208
2020-06-09 15:36:59,679: 6) loss=0.076 grad_norm=11.53 num_segments=256 num_words=214
2020-06-09 15:38:34,811: 7) loss=0.081 grad_norm=12.45 num_segments=256 num_words=207
2020-06-09 15:40:12,023: 8) loss=0.071 grad_norm=12.51 num_segments=256 num_words=206
2020-06-09 15:41:46,481: 9) loss=0.083 grad_norm=17.53 num_segments=256 num_words=208
2020-06-09 15:43:24,899: 10) loss=0.076 grad_norm=10.41 num_segments=256 num_words=204
2020-06-09 15:44:59,877: 11) loss=0.086 grad_norm=11.70 num_segments=256 num_words=211
2020-06-09 15:46:34,538: 12) loss=0.097 grad_norm=14.77 num_segments=256 num_words=216
2020-06-09 15:48:09,697: 13) loss=0.077 grad_norm=21.22 num_segments=256 num_words=213
2020-06-09 15:49:48,677: 14) loss=0.069 grad_norm=15.33 num_segments=256 num_words=202
2020-06-09 15:51:23,825: 15) loss=0.089 grad_norm=11.52 num_segments=256 num_words=210
2020-06-09 15:52:58,724: 16) loss=0.073 grad_norm=11.32 num_segments=256 num_words=201
2020-06-09 15:54:34,616: 17) loss=0.082 grad_norm=10.83 num_segments=256 num_words=210
2020-06-09 15:56:10,105: 18) loss=0.078 grad_norm=18.38 num_segments=256 num_words=216
2020-06-09 15:57:49,895: 19) loss=0.088 grad_norm=20.98 num_segments=256 num_words=206
2020-06-09 15:59:24,912: 20) loss=0.076 grad_norm=10.77 num_segments=256 num_words=217
2020-06-09 16:01:00,250: 21) loss=0.087 grad_norm=14.11 num_segments=256 num_words=208
2020-06-09 16:02:35,405: 22) loss=0.086 grad_norm=11.89 num_segments=256 num_words=220
2020-06-09 16:04:11,039: 23) loss=0.085 grad_norm=13.26 num_segments=256 num_words=220
2020-06-09 16:05:51,517: 24) loss=0.073 grad_norm=9.59 num_segments=256 num_words=221
2020-06-09 16:07:26,371: 25) loss=0.079 grad_norm=11.94 num_segments=256 num_words=219
2020-06-09 16:09:01,388: 26) loss=0.073 grad_norm=11.47 num_segments=256 num_words=206
2020-06-09 16:10:36,405: 27) loss=0.084 grad_norm=9.81 num_segments=256 num_words=211
2020-06-09 16:12:11,077: 28) loss=0.077 grad_norm=12.01 num_segments=256 num_words=215
2020-06-09 16:13:45,792: 29) loss=0.081 grad_norm=16.17 num_segments=256 num_words=215
2020-06-09 16:15:20,924: 30) loss=0.078 grad_norm=11.20 num_segments=256 num_words=203
2020-06-09 16:17:03,236: 31) loss=0.087 grad_norm=16.36 num_segments=256 num_words=216
2020-06-09 16:18:38,255: 32) loss=0.087 grad_norm=14.22 num_segments=256 num_words=213
2020-06-09 16:20:13,687: 33) loss=0.081 grad_norm=13.67 num_segments=256 num_words=214
2020-06-09 16:21:48,730: 34) loss=0.073 grad_norm=10.69 num_segments=256 num_words=204
2020-06-09 16:23:24,106: 35) loss=0.078 grad_norm=6.09 num_segments=256 num_words=216
2020-06-09 16:25:00,221: 36) loss=0.080 grad_norm=11.07 num_segments=256 num_words=206
2020-06-09 16:26:36,240: 37) loss=0.076 grad_norm=17.62 num_segments=256 num_words=202
2020-06-09 16:28:03,456: 38) loss=0.082 grad_norm=14.18 num_segments=243 num_words=199
2020-06-09 16:28:03,474: epoch= 20.00
2020-06-09 16:28:03,474:  >> time to evaluate and save:
2020-06-09 16:28:03,554: saved save/MultiViewDataset_IndividualWords.780.pth
2020-06-09 16:28:03,574: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 16:28:03,588: removed save/MultiViewDataset_IndividualWords.546.pth
2020-06-09 16:28:03,588: saved MultiViewDataset_IndividualWords successfully
2020-06-09 16:28:04,868: saved save/MultiViewRNN.780.pth
2020-06-09 16:28:04,875: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 16:28:05,284: removed save/MultiViewRNN.546.pth
2020-06-09 16:28:05,285: saved MultiViewRNN successfully
2020-06-09 16:28:07,845: saved save/Adam.780.pth
2020-06-09 16:28:07,851: most_recent linked save/Adam.most_recent.pth
2020-06-09 16:28:08,145: removed save/Adam.546.pth
2020-06-09 16:28:08,145: saved Adam successfully
2020-06-09 16:28:08,148: saved save/ReduceLROnPlateau.780.pth
2020-06-09 16:28:08,157: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 16:28:08,182: saved ReduceLROnPlateau successfully
2020-06-09 16:28:08,184: saved config successfully
2020-06-09 16:29:55,642:   >> crossview_ap=0.689 (10966 x 3921 pairs)
2020-06-09 16:31:07,059:   >> acoustic_ap=0.742 (10966 choose 2 pairs)
2020-06-09 16:31:07,061: best_so_far= 0.689 at 780
2020-06-09 16:31:07,091: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 16:31:07,095: saved MultiViewDataset_IndividualWords successfully
2020-06-09 16:31:07,117: best linked save/MultiViewRNN.best.pth
2020-06-09 16:31:07,131: saved MultiViewRNN successfully
2020-06-09 16:31:07,145: best linked save/Adam.best.pth
2020-06-09 16:31:07,159: saved Adam successfully
2020-06-09 16:31:07,166: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 16:31:07,175: saved ReduceLROnPlateau successfully
2020-06-09 16:31:07,216: epoch=20.00 global_step=780 lr=0.001 start_iter=0
2020-06-09 16:31:07,217: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 16:32:44,606: 0) loss=0.075 grad_norm=11.58 num_segments=256 num_words=202
2020-06-09 16:34:30,253: 1) loss=0.078 grad_norm=8.42 num_segments=256 num_words=218
2020-06-09 16:36:04,846: 2) loss=0.084 grad_norm=11.27 num_segments=256 num_words=215
2020-06-09 16:37:39,297: 3) loss=0.074 grad_norm=12.40 num_segments=256 num_words=210
2020-06-09 16:39:13,962: 4) loss=0.076 grad_norm=8.30 num_segments=256 num_words=213
2020-06-09 16:40:46,033: 5) loss=0.071 grad_norm=6.68 num_segments=256 num_words=212
2020-06-09 16:42:18,292: 6) loss=0.076 grad_norm=14.71 num_segments=256 num_words=213
2020-06-09 16:43:50,358: 7) loss=0.152 grad_norm=11.29 num_segments=256 num_words=203
2020-06-09 16:45:21,866: 8) loss=0.081 grad_norm=14.30 num_segments=256 num_words=202
2020-06-09 16:46:53,765: 9) loss=0.070 grad_norm=8.16 num_segments=256 num_words=205
2020-06-09 16:48:25,481: 10) loss=0.084 grad_norm=12.48 num_segments=256 num_words=224
2020-06-09 16:49:54,925: 11) loss=0.089 grad_norm=6.24 num_segments=256 num_words=213
2020-06-09 16:51:42,422: 12) loss=0.075 grad_norm=5.44 num_segments=256 num_words=219
2020-06-09 16:53:13,680: 13) loss=0.084 grad_norm=11.64 num_segments=256 num_words=219
2020-06-09 16:54:46,101: 14) loss=0.078 grad_norm=19.27 num_segments=256 num_words=205
2020-06-09 16:56:18,195: 15) loss=0.085 grad_norm=8.68 num_segments=256 num_words=206
2020-06-09 16:57:50,042: 16) loss=0.077 grad_norm=10.38 num_segments=256 num_words=203
2020-06-09 16:59:22,160: 17) loss=0.078 grad_norm=11.42 num_segments=256 num_words=207
2020-06-09 17:00:54,401: 18) loss=0.085 grad_norm=16.54 num_segments=256 num_words=213
2020-06-09 17:02:26,578: 19) loss=0.074 grad_norm=5.81 num_segments=256 num_words=207
2020-06-09 17:03:58,581: 20) loss=0.076 grad_norm=11.76 num_segments=256 num_words=208
2020-06-09 17:05:30,412: 21) loss=0.074 grad_norm=10.72 num_segments=256 num_words=214
2020-06-09 17:07:02,379: 22) loss=0.074 grad_norm=7.81 num_segments=256 num_words=216
2020-06-09 17:08:34,594: 23) loss=0.075 grad_norm=11.06 num_segments=256 num_words=205
2020-06-09 17:10:06,418: 24) loss=0.085 grad_norm=9.36 num_segments=256 num_words=217
2020-06-09 17:11:38,524: 25) loss=0.074 grad_norm=10.17 num_segments=256 num_words=217
2020-06-09 17:13:27,675: 26) loss=0.074 grad_norm=8.62 num_segments=256 num_words=220
2020-06-09 17:14:59,605: 27) loss=0.078 grad_norm=9.17 num_segments=256 num_words=200
2020-06-09 17:16:31,511: 28) loss=0.077 grad_norm=8.71 num_segments=256 num_words=204
2020-06-09 17:18:03,271: 29) loss=0.076 grad_norm=8.74 num_segments=256 num_words=215
2020-06-09 17:19:35,242: 30) loss=0.078 grad_norm=8.33 num_segments=256 num_words=214
2020-06-09 17:21:07,390: 31) loss=0.069 grad_norm=14.15 num_segments=256 num_words=203
2020-06-09 17:22:39,843: 32) loss=0.085 grad_norm=11.12 num_segments=256 num_words=214
2020-06-09 17:24:12,207: 33) loss=0.087 grad_norm=11.38 num_segments=256 num_words=215
2020-06-09 17:25:44,470: 34) loss=0.089 grad_norm=14.53 num_segments=256 num_words=208
2020-06-09 17:27:16,747: 35) loss=0.082 grad_norm=7.37 num_segments=256 num_words=206
2020-06-09 17:28:49,069: 36) loss=0.149 grad_norm=9.66 num_segments=256 num_words=207
2020-06-09 17:30:21,462: 37) loss=0.067 grad_norm=8.20 num_segments=256 num_words=203
2020-06-09 17:31:44,460: 38) loss=0.075 grad_norm=6.71 num_segments=243 num_words=196
2020-06-09 17:31:44,491: epoch= 21.00
2020-06-09 17:31:44,492:  >> time to evaluate and save:
2020-06-09 17:31:44,845: saved save/MultiViewDataset_IndividualWords.819.pth
2020-06-09 17:31:44,881: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 17:31:44,920: removed save/MultiViewDataset_IndividualWords.585.pth
2020-06-09 17:31:44,920: saved MultiViewDataset_IndividualWords successfully
2020-06-09 17:31:48,545: saved save/MultiViewRNN.819.pth
2020-06-09 17:31:48,556: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 17:31:48,657: removed save/MultiViewRNN.585.pth
2020-06-09 17:31:48,657: saved MultiViewRNN successfully
2020-06-09 17:31:53,141: saved save/Adam.819.pth
2020-06-09 17:31:53,162: most_recent linked save/Adam.most_recent.pth
2020-06-09 17:31:53,206: removed save/Adam.585.pth
2020-06-09 17:31:53,206: saved Adam successfully
2020-06-09 17:31:53,212: saved save/ReduceLROnPlateau.819.pth
2020-06-09 17:31:53,256: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 17:31:53,283: removed save/ReduceLROnPlateau.546.pth
2020-06-09 17:31:53,283: saved ReduceLROnPlateau successfully
2020-06-09 17:31:53,288: saved config successfully
2020-06-09 17:33:17,555:   >> crossview_ap=0.693 (10966 x 3921 pairs)
2020-06-09 17:34:11,200:   >> acoustic_ap=0.746 (10966 choose 2 pairs)
2020-06-09 17:34:11,203: best_so_far= 0.693 at 819
2020-06-09 17:34:11,226: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 17:34:11,229: saved MultiViewDataset_IndividualWords successfully
2020-06-09 17:34:11,244: best linked save/MultiViewRNN.best.pth
2020-06-09 17:34:11,259: saved MultiViewRNN successfully
2020-06-09 17:34:11,272: best linked save/Adam.best.pth
2020-06-09 17:34:11,285: saved Adam successfully
2020-06-09 17:34:11,300: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 17:34:11,316: removed save/ReduceLROnPlateau.585.pth
2020-06-09 17:34:11,317: saved ReduceLROnPlateau successfully
2020-06-09 17:34:11,868: epoch=21.00 global_step=819 lr=0.001 start_iter=0
2020-06-09 17:34:11,868: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 17:35:44,906: 0) loss=0.075 grad_norm=7.26 num_segments=256 num_words=204
2020-06-09 17:37:17,491: 1) loss=0.072 grad_norm=7.65 num_segments=256 num_words=211
2020-06-09 17:38:50,237: 2) loss=0.077 grad_norm=9.28 num_segments=256 num_words=217
2020-06-09 17:40:22,460: 3) loss=0.074 grad_norm=25.03 num_segments=256 num_words=208
2020-06-09 17:41:57,108: 4) loss=0.072 grad_norm=5.88 num_segments=256 num_words=200
2020-06-09 17:43:50,029: 5) loss=0.080 grad_norm=11.51 num_segments=256 num_words=205
2020-06-09 17:45:22,090: 6) loss=0.076 grad_norm=12.15 num_segments=256 num_words=211
2020-06-09 17:46:54,280: 7) loss=0.077 grad_norm=12.97 num_segments=256 num_words=221
2020-06-09 17:48:26,318: 8) loss=0.076 grad_norm=9.65 num_segments=256 num_words=210
2020-06-09 17:49:59,019: 9) loss=0.143 grad_norm=11.97 num_segments=256 num_words=215
2020-06-09 17:51:31,042: 10) loss=0.093 grad_norm=10.84 num_segments=256 num_words=219
2020-06-09 17:53:03,387: 11) loss=0.081 grad_norm=9.75 num_segments=256 num_words=201
2020-06-09 17:54:36,011: 12) loss=0.072 grad_norm=15.78 num_segments=256 num_words=208
2020-06-09 17:56:08,104: 13) loss=0.076 grad_norm=8.23 num_segments=256 num_words=204
2020-06-09 17:57:40,215: 14) loss=0.076 grad_norm=11.62 num_segments=256 num_words=210
2020-06-09 17:59:12,206: 15) loss=0.080 grad_norm=9.78 num_segments=256 num_words=212
2020-06-09 18:00:44,297: 16) loss=0.098 grad_norm=13.99 num_segments=256 num_words=211
2020-06-09 18:02:16,589: 17) loss=0.095 grad_norm=15.71 num_segments=256 num_words=212
2020-06-09 18:03:48,676: 18) loss=0.085 grad_norm=9.03 num_segments=256 num_words=205
2020-06-09 18:05:20,997: 19) loss=0.151 grad_norm=8.39 num_segments=256 num_words=210
2020-06-09 18:06:53,081: 20) loss=0.076 grad_norm=11.41 num_segments=256 num_words=208
2020-06-09 18:08:24,816: 21) loss=0.074 grad_norm=6.64 num_segments=256 num_words=213
2020-06-09 18:09:57,410: 22) loss=0.079 grad_norm=9.07 num_segments=256 num_words=212
2020-06-09 18:11:29,586: 23) loss=0.091 grad_norm=10.54 num_segments=256 num_words=207
2020-06-09 18:13:01,608: 24) loss=0.088 grad_norm=13.61 num_segments=256 num_words=210
2020-06-09 18:14:33,906: 25) loss=0.084 grad_norm=10.15 num_segments=256 num_words=205
2020-06-09 18:16:28,704: 26) loss=0.071 grad_norm=7.17 num_segments=256 num_words=208
2020-06-09 18:18:00,906: 27) loss=0.143 grad_norm=15.28 num_segments=256 num_words=222
2020-06-09 18:19:33,619: 28) loss=0.074 grad_norm=8.01 num_segments=256 num_words=208
2020-06-09 18:21:05,363: 29) loss=0.072 grad_norm=10.03 num_segments=256 num_words=211
2020-06-09 18:22:37,603: 30) loss=0.078 grad_norm=10.43 num_segments=256 num_words=205
2020-06-09 18:24:09,315: 31) loss=0.080 grad_norm=13.89 num_segments=256 num_words=212
2020-06-09 18:25:41,495: 32) loss=0.080 grad_norm=16.02 num_segments=256 num_words=215
2020-06-09 18:27:13,348: 33) loss=0.080 grad_norm=9.72 num_segments=256 num_words=202
2020-06-09 18:28:45,623: 34) loss=0.078 grad_norm=11.93 num_segments=256 num_words=213
2020-06-09 18:30:17,904: 35) loss=0.085 grad_norm=14.91 num_segments=256 num_words=210
2020-06-09 18:31:50,154: 36) loss=0.094 grad_norm=13.44 num_segments=256 num_words=197
2020-06-09 18:33:22,636: 37) loss=0.081 grad_norm=15.24 num_segments=256 num_words=208
2020-06-09 18:34:45,726: 38) loss=0.085 grad_norm=18.64 num_segments=243 num_words=205
2020-06-09 18:34:45,752: epoch= 22.00
2020-06-09 18:34:45,752:  >> time to evaluate and save:
2020-06-09 18:34:45,824: saved save/MultiViewDataset_IndividualWords.858.pth
2020-06-09 18:34:45,849: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 18:34:45,874: removed save/MultiViewDataset_IndividualWords.624.pth
2020-06-09 18:34:45,875: saved MultiViewDataset_IndividualWords successfully
2020-06-09 18:34:47,211: saved save/MultiViewRNN.858.pth
2020-06-09 18:34:47,228: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 18:34:47,258: removed save/MultiViewRNN.624.pth
2020-06-09 18:34:47,259: saved MultiViewRNN successfully
2020-06-09 18:34:49,785: saved save/Adam.858.pth
2020-06-09 18:34:49,794: most_recent linked save/Adam.most_recent.pth
2020-06-09 18:34:49,839: removed save/Adam.624.pth
2020-06-09 18:34:49,839: saved Adam successfully
2020-06-09 18:34:49,843: saved save/ReduceLROnPlateau.858.pth
2020-06-09 18:34:49,851: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 18:34:49,865: removed save/ReduceLROnPlateau.624.pth
2020-06-09 18:34:49,866: saved ReduceLROnPlateau successfully
2020-06-09 18:34:49,869: saved config successfully
2020-06-09 18:36:17,210:   >> crossview_ap=0.695 (10966 x 3921 pairs)
2020-06-09 18:37:10,671:   >> acoustic_ap=0.748 (10966 choose 2 pairs)
2020-06-09 18:37:10,678: best_so_far= 0.695 at 858
2020-06-09 18:37:10,697: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 18:37:10,702: saved MultiViewDataset_IndividualWords successfully
2020-06-09 18:37:10,714: best linked save/MultiViewRNN.best.pth
2020-06-09 18:37:10,739: saved MultiViewRNN successfully
2020-06-09 18:37:10,759: best linked save/Adam.best.pth
2020-06-09 18:37:10,782: saved Adam successfully
2020-06-09 18:37:10,816: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 18:37:10,836: saved ReduceLROnPlateau successfully
2020-06-09 18:37:11,399: epoch=22.00 global_step=858 lr=0.001 start_iter=0
2020-06-09 18:37:11,399: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 18:38:45,893: 0) loss=0.079 grad_norm=5.38 num_segments=256 num_words=216
2020-06-09 18:40:22,739: 1) loss=0.067 grad_norm=4.79 num_segments=256 num_words=211
2020-06-09 18:41:59,247: 2) loss=0.088 grad_norm=12.43 num_segments=256 num_words=217
2020-06-09 18:43:35,234: 3) loss=0.073 grad_norm=15.86 num_segments=256 num_words=215
2020-06-09 18:45:11,128: 4) loss=0.075 grad_norm=9.01 num_segments=256 num_words=206
2020-06-09 18:46:47,994: 5) loss=0.071 grad_norm=8.85 num_segments=256 num_words=217
2020-06-09 18:48:24,771: 6) loss=0.072 grad_norm=8.24 num_segments=256 num_words=209
2020-06-09 18:50:00,588: 7) loss=0.072 grad_norm=7.11 num_segments=256 num_words=210
2020-06-09 18:51:36,507: 8) loss=0.075 grad_norm=12.34 num_segments=256 num_words=200
2020-06-09 18:53:13,037: 9) loss=0.073 grad_norm=6.94 num_segments=256 num_words=208
2020-06-09 18:54:49,489: 10) loss=0.080 grad_norm=8.48 num_segments=256 num_words=212
2020-06-09 18:56:25,679: 11) loss=0.083 grad_norm=8.94 num_segments=256 num_words=212
2020-06-09 18:58:02,641: 12) loss=0.080 grad_norm=7.56 num_segments=256 num_words=212
2020-06-09 18:59:39,223: 13) loss=0.071 grad_norm=6.33 num_segments=256 num_words=215
2020-06-09 19:01:49,719: 14) loss=0.077 grad_norm=7.62 num_segments=256 num_words=208
2020-06-09 19:03:25,716: 15) loss=0.070 grad_norm=9.17 num_segments=256 num_words=207
2020-06-09 19:05:02,091: 16) loss=0.075 grad_norm=14.51 num_segments=256 num_words=212
2020-06-09 19:06:38,792: 17) loss=0.086 grad_norm=8.45 num_segments=256 num_words=210
2020-06-09 19:08:15,143: 18) loss=0.071 grad_norm=7.22 num_segments=256 num_words=204
2020-06-09 19:09:51,546: 19) loss=0.074 grad_norm=7.62 num_segments=256 num_words=211
2020-06-09 19:11:28,131: 20) loss=0.100 grad_norm=15.24 num_segments=256 num_words=211
2020-06-09 19:13:04,822: 21) loss=0.073 grad_norm=8.96 num_segments=256 num_words=221
2020-06-09 19:14:41,063: 22) loss=0.080 grad_norm=6.11 num_segments=256 num_words=209
2020-06-09 19:16:18,283: 23) loss=0.076 grad_norm=6.35 num_segments=256 num_words=215
2020-06-09 19:17:54,731: 24) loss=0.071 grad_norm=6.49 num_segments=256 num_words=215
2020-06-09 19:19:31,342: 25) loss=0.099 grad_norm=8.90 num_segments=256 num_words=215
2020-06-09 19:20:24,471: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-09 19:20:24,497: Using 1 GPU(s)
2020-06-09 19:20:24,497: Machine: 0 / 1
2020-06-09 19:20:24,498: Hyperparam tuning-------------------
2020-06-09 19:20:24,498: optim_lr: 0.001
2020-06-09 19:20:24,499: dropout (for both): 0.4
2020-06-09 19:20:24,499: margin: 0.4
2020-06-09 19:20:24,499: ------------------------------------
2020-06-09 19:20:24,501: Calling main function: multiview_trainer.train
2020-06-09 19:20:24,501: Using config file: train_config.json
2020-06-09 19:20:24,501: Using module at multiview_trainer.train
2020-06-09 19:20:24,752: Using module at multiview_vocab.MultiViewVocab
2020-06-09 19:20:24,758: Building vocab_data from config
2020-06-09 19:20:24,997:  >> min_count= 0
2020-06-09 19:20:24,997:  >> # words= 34323 (# removed= 0)
2020-06-09 19:20:24,997:  >> # subwords= 45
2020-06-09 19:20:24,997:     [laughter]= 1
2020-06-09 19:20:24,997:     [noise]= 2
2020-06-09 19:20:24,997:     [vocalized-noise]= 3
2020-06-09 19:20:24,997:     aa= 4
2020-06-09 19:20:24,997:     ae= 5
2020-06-09 19:20:24,997:     ah= 6
2020-06-09 19:20:24,997:     ao= 7
2020-06-09 19:20:24,998:     aw= 8
2020-06-09 19:20:24,998:     ax= 9
2020-06-09 19:20:24,998:     ay= 10
2020-06-09 19:20:24,998:     b= 11
2020-06-09 19:20:24,998:     ch= 12
2020-06-09 19:20:24,998:     d= 13
2020-06-09 19:20:24,998:     dh= 14
2020-06-09 19:20:24,998:     eh= 15
2020-06-09 19:20:24,998:     el= 16
2020-06-09 19:20:24,998:     en= 17
2020-06-09 19:20:24,998:     er= 18
2020-06-09 19:20:24,998:     ey= 19
2020-06-09 19:20:24,998:     f= 20
2020-06-09 19:20:24,998:     g= 21
2020-06-09 19:20:24,999:     hh= 22
2020-06-09 19:20:24,999:     ih= 23
2020-06-09 19:20:24,999:     iy= 24
2020-06-09 19:20:24,999:     jh= 25
2020-06-09 19:20:24,999:     k= 26
2020-06-09 19:20:24,999:     l= 27
2020-06-09 19:20:24,999:     m= 28
2020-06-09 19:20:24,999:     n= 29
2020-06-09 19:20:24,999:     ng= 30
2020-06-09 19:20:24,999:     ow= 31
2020-06-09 19:20:24,999:     oy= 32
2020-06-09 19:20:24,999:     p= 33
2020-06-09 19:20:24,999:     r= 34
2020-06-09 19:20:24,999:     s= 35
2020-06-09 19:20:24,999:     sh= 36
2020-06-09 19:20:25,000:     t= 37
2020-06-09 19:20:25,000:     th= 38
2020-06-09 19:20:25,000:     uh= 39
2020-06-09 19:20:25,000:     uw= 40
2020-06-09 19:20:25,000:     v= 41
2020-06-09 19:20:25,000:     w= 42
2020-06-09 19:20:25,000:     y= 43
2020-06-09 19:20:25,000:     z= 44
2020-06-09 19:20:25,000:     zh= 45
2020-06-09 19:20:25,013: Using module at data.batch_samplers.BatchSampler
2020-06-09 19:20:25,015: Building vocab_sampler from config
2020-06-09 19:20:25,015:  >> # examples= 34323
2020-06-09 19:20:25,015:  >> batch_size= 1000
2020-06-09 19:20:25,015:  >> shuffle= False
2020-06-09 19:20:25,022:  >> BatchSampler; 35 batches
2020-06-09 19:20:25,022: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 19:20:25,117: Building train_data from config
2020-06-09 19:20:32,529:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-09 19:20:32,530:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-09 19:20:32,530:  >> stack= False
2020-06-09 19:20:32,530:  >> seg_durs= (1, None)
2020-06-09 19:20:32,530:  >> # words= 9971 (# ignored= 0)
2020-06-09 19:20:32,530:  >> input_feat_dim= 108
2020-06-09 19:20:32,530:  >> input_num_subwords= 45
2020-06-09 19:20:32,530: Using module at data.batch_samplers.BatchSampler
2020-06-09 19:20:32,531: Building train_sampler from config
2020-06-09 19:20:32,531:  >> # examples= 9971
2020-06-09 19:20:32,531:  >> batch_size= 256
2020-06-09 19:20:32,531:  >> shuffle= True
2020-06-09 19:20:32,540:  >> BatchSampler; 39 batches
2020-06-09 19:20:32,540: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 19:20:32,540: Building dev_data from config
2020-06-09 19:20:41,200:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-09 19:20:41,203:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-09 19:20:41,203:  >> stack= False
2020-06-09 19:20:41,203:  >> seg_durs= (1, None)
2020-06-09 19:20:41,204:  >> # words= 10966 (# ignored= 0)
2020-06-09 19:20:41,204:  >> input_feat_dim= 108
2020-06-09 19:20:41,204:  >> input_num_subwords= 45
2020-06-09 19:20:41,204: Using module at data.batch_samplers.BatchSampler
2020-06-09 19:20:41,204: Building dev_sampler from config
2020-06-09 19:20:41,205:  >> # examples= 10966
2020-06-09 19:20:41,205:  >> batch_size= 256
2020-06-09 19:20:41,205:  >> shuffle= False
2020-06-09 19:20:41,207:  >> BatchSampler; 43 batches
2020-06-09 19:20:41,207: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 19:20:41,207: Building test_data from config
2020-06-09 19:20:48,610:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-09 19:20:48,611:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-09 19:20:48,611:  >> stack= False
2020-06-09 19:20:48,611:  >> seg_durs= (1, None)
2020-06-09 19:20:48,611:  >> # words= 11024 (# ignored= 0)
2020-06-09 19:20:48,611:  >> input_feat_dim= 108
2020-06-09 19:20:48,611:  >> input_num_subwords= 45
2020-06-09 19:20:48,611: Using module at data.batch_samplers.BatchSampler
2020-06-09 19:20:48,611: Building test_sampler from config
2020-06-09 19:20:48,612:  >> # examples= 11024
2020-06-09 19:20:48,612:  >> batch_size= 256
2020-06-09 19:20:48,612:  >> shuffle= False
2020-06-09 19:20:48,614:  >> BatchSampler; 44 batches
2020-06-09 19:20:48,614: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-09 19:20:48,626: Building loss from config
2020-06-09 19:20:48,627:  >> margin= 0.4
2020-06-09 19:20:48,627:  >> k= 16
2020-06-09 19:20:48,627:  >> min_k= 8
2020-06-09 19:20:48,627:  >> extra= 0
2020-06-09 19:20:48,627:  >> average= False
2020-06-09 19:20:48,627:  >> margin_max= 0.5
2020-06-09 19:20:48,627:  >> threshold_max= 9
2020-06-09 19:20:48,627:  >> using obj0
2020-06-09 19:20:48,627: Using module at metric.multiview_ap.MultiViewAP
2020-06-09 19:20:48,713: Building eval from config
2020-06-09 19:20:48,713:  >> acoustic_ap= True
2020-06-09 19:20:48,713:  >> crossview_ap= True
2020-06-09 19:20:48,713:  >> full_vocab= False
2020-06-09 19:20:48,713:  >> metric= crossview_ap
2020-06-09 19:20:48,713:  >> mode= max
2020-06-09 19:20:48,714: Using module at multiview_rnn.MultiViewRNN
2020-06-09 19:20:48,726: Building net from config
2020-06-09 19:20:48,727: view1:
2020-06-09 19:20:48,728:  >> cell= GRU
2020-06-09 19:20:48,728:  >> input_size= 108
2020-06-09 19:20:48,728:  >> hidden_size= 512
2020-06-09 19:20:48,728:  >> bidirectional= True
2020-06-09 19:20:48,729:  >> num_layers= 6
2020-06-09 19:20:48,729:  >> dropout between layers= 0.4
2020-06-09 19:20:48,942: view2:
2020-06-09 19:20:48,943:  >> cell= GRU
2020-06-09 19:20:48,943:  >> input_size= 64
2020-06-09 19:20:48,943:  >> hidden_size= 512
2020-06-09 19:20:48,943:  >> bidirectional= True
2020-06-09 19:20:48,943:  >> num_layers= 2
2020-06-09 19:20:48,943:  >> dropout between layers= 0.4
2020-06-09 19:20:48,943:  >> num input embeddings= 45
2020-06-09 19:20:52,434: Using module at optim.adam.Adam
2020-06-09 19:20:52,438: Building optim from config
2020-06-09 19:20:52,438:  >> lr= 0.001
2020-06-09 19:20:52,438:  >> betas= (0.9, 0.999)
2020-06-09 19:20:52,438:  >> eps= 1e-08
2020-06-09 19:20:52,438:  >> weight_decay= 0
2020-06-09 19:20:52,438:  >> amsgrad= False
2020-06-09 19:20:52,438:  >> min_lr= 1e-07
2020-06-09 19:20:52,440: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-09 19:20:52,447: Building sched from config
2020-06-09 19:20:52,447:  >> optim= Adam
2020-06-09 19:20:52,447:  >> decay lr by 0.1
2020-06-09 19:20:52,447:  >> eval_fn= MultiViewAP
2020-06-09 19:20:52,448:  >> patience=4
2020-06-09 19:20:52,448:  >> revert=True
2020-06-09 19:20:52,455: loaded save/MultiViewDataset_IndividualWords.858.pth
2020-06-09 19:20:52,455: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 19:20:52,549: loaded save/MultiViewRNN.858.pth
2020-06-09 19:20:52,549: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 19:20:52,710: loaded save/Adam.858.pth
2020-06-09 19:20:52,710: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 19:20:52,712: loaded save/ReduceLROnPlateau.858.pth
2020-06-09 19:20:52,713: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 19:20:52,713: epoch=22.00 global_step=858 lr=0.001 start_iter=0
2020-06-09 19:20:52,713: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 19:23:51,965: 0) loss=0.043 grad_norm=4.15 num_segments=256 num_words=216
2020-06-09 19:26:36,530: 1) loss=0.039 grad_norm=3.88 num_segments=256 num_words=211
2020-06-09 19:29:10,656: 2) loss=0.058 grad_norm=10.76 num_segments=256 num_words=217
2020-06-09 19:31:33,049: 3) loss=0.049 grad_norm=13.90 num_segments=256 num_words=215
2020-06-09 19:33:42,394: 4) loss=0.056 grad_norm=14.59 num_segments=256 num_words=206
2020-06-09 19:35:41,251: 5) loss=0.059 grad_norm=8.83 num_segments=256 num_words=217
2020-06-09 19:37:26,793: 6) loss=0.064 grad_norm=7.95 num_segments=256 num_words=209
2020-06-09 19:39:01,418: 7) loss=0.073 grad_norm=8.30 num_segments=256 num_words=210
2020-06-09 19:40:37,483: 8) loss=0.075 grad_norm=8.73 num_segments=256 num_words=200
2020-06-09 19:42:11,053: 9) loss=0.074 grad_norm=11.50 num_segments=256 num_words=208
2020-06-09 19:43:49,115: 10) loss=0.080 grad_norm=7.75 num_segments=256 num_words=212
2020-06-09 19:45:23,683: 11) loss=0.084 grad_norm=11.04 num_segments=256 num_words=212
2020-06-09 19:46:57,620: 12) loss=0.081 grad_norm=9.24 num_segments=256 num_words=212
2020-06-09 19:48:31,738: 13) loss=0.071 grad_norm=6.98 num_segments=256 num_words=215
2020-06-09 19:50:10,386: 14) loss=0.075 grad_norm=12.68 num_segments=256 num_words=208
2020-06-09 19:51:44,722: 15) loss=0.128 grad_norm=11.92 num_segments=256 num_words=207
2020-06-09 19:53:18,808: 16) loss=0.074 grad_norm=12.75 num_segments=256 num_words=212
2020-06-09 19:54:53,870: 17) loss=0.087 grad_norm=10.91 num_segments=256 num_words=210
2020-06-09 19:56:28,196: 18) loss=0.071 grad_norm=6.59 num_segments=256 num_words=204
2020-06-09 19:58:08,024: 19) loss=0.075 grad_norm=7.86 num_segments=256 num_words=211
2020-06-09 19:59:43,479: 20) loss=0.107 grad_norm=10.08 num_segments=256 num_words=211
2020-06-09 20:01:18,581: 21) loss=0.073 grad_norm=7.53 num_segments=256 num_words=221
2020-06-09 20:02:53,127: 22) loss=0.082 grad_norm=8.26 num_segments=256 num_words=209
2020-06-09 20:04:27,338: 23) loss=0.078 grad_norm=12.94 num_segments=256 num_words=215
2020-06-09 20:06:07,344: 24) loss=0.070 grad_norm=9.12 num_segments=256 num_words=215
2020-06-09 20:07:42,062: 25) loss=0.097 grad_norm=10.21 num_segments=256 num_words=215
2020-06-09 20:09:16,624: 26) loss=0.076 grad_norm=9.95 num_segments=256 num_words=207
2020-06-09 20:10:51,421: 27) loss=0.073 grad_norm=7.32 num_segments=256 num_words=210
2020-06-09 20:12:25,786: 28) loss=0.135 grad_norm=14.22 num_segments=256 num_words=213
2020-06-09 20:13:59,455: 29) loss=0.093 grad_norm=17.91 num_segments=256 num_words=207
2020-06-09 20:15:32,784: 30) loss=0.071 grad_norm=12.82 num_segments=256 num_words=199
2020-06-09 20:17:13,263: 31) loss=0.078 grad_norm=13.45 num_segments=256 num_words=204
2020-06-09 20:18:46,721: 32) loss=0.083 grad_norm=17.33 num_segments=256 num_words=209
2020-06-09 20:20:18,975: 33) loss=0.089 grad_norm=9.23 num_segments=256 num_words=219
2020-06-09 20:21:52,200: 34) loss=0.074 grad_norm=8.99 num_segments=256 num_words=199
2020-06-09 20:23:25,259: 35) loss=0.075 grad_norm=12.19 num_segments=256 num_words=204
2020-06-09 20:24:56,470: 36) loss=0.074 grad_norm=14.57 num_segments=256 num_words=209
2020-06-09 20:26:27,676: 37) loss=0.076 grad_norm=9.52 num_segments=256 num_words=211
2020-06-09 20:27:49,803: 38) loss=0.077 grad_norm=9.81 num_segments=243 num_words=206
2020-06-09 20:27:49,823: epoch= 23.00
2020-06-09 20:27:49,823:  >> time to evaluate and save:
2020-06-09 20:27:49,927: saved save/MultiViewDataset_IndividualWords.897.pth
2020-06-09 20:27:49,964: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 20:27:50,021: removed save/MultiViewDataset_IndividualWords.663.pth
2020-06-09 20:27:50,021: saved MultiViewDataset_IndividualWords successfully
2020-06-09 20:27:53,547: saved save/MultiViewRNN.897.pth
2020-06-09 20:27:53,557: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 20:27:53,623: removed save/MultiViewRNN.663.pth
2020-06-09 20:27:53,623: saved MultiViewRNN successfully
2020-06-09 20:27:57,243: saved save/Adam.897.pth
2020-06-09 20:27:57,255: most_recent linked save/Adam.most_recent.pth
2020-06-09 20:27:57,300: removed save/Adam.663.pth
2020-06-09 20:27:57,301: saved Adam successfully
2020-06-09 20:27:57,304: saved save/ReduceLROnPlateau.897.pth
2020-06-09 20:27:57,315: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 20:27:57,328: saved ReduceLROnPlateau successfully
2020-06-09 20:27:57,331: saved config successfully
2020-06-09 20:29:27,380:   >> crossview_ap=0.686 (10966 x 3921 pairs)
2020-06-09 20:30:21,117:   >> acoustic_ap=0.739 (10966 choose 2 pairs)
2020-06-09 20:30:21,121: best_so_far= 0.693 at 819
2020-06-09 20:30:21,170: epoch=23.00 global_step=897 lr=0.001 start_iter=0
2020-06-09 20:30:21,170: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 20:31:51,904: 0) loss=0.075 grad_norm=9.11 num_segments=256 num_words=209
2020-06-09 20:33:30,355: 1) loss=0.070 grad_norm=7.84 num_segments=256 num_words=216
2020-06-09 20:34:58,857: 2) loss=0.079 grad_norm=9.09 num_segments=256 num_words=210
2020-06-09 20:36:27,581: 3) loss=0.076 grad_norm=8.72 num_segments=256 num_words=211
2020-06-09 20:37:56,138: 4) loss=0.076 grad_norm=11.05 num_segments=256 num_words=211
2020-06-09 20:39:25,115: 5) loss=0.075 grad_norm=12.94 num_segments=256 num_words=209
2020-06-09 20:40:53,598: 6) loss=0.076 grad_norm=6.11 num_segments=256 num_words=212
2020-06-09 20:42:21,935: 7) loss=0.073 grad_norm=7.26 num_segments=256 num_words=210
2020-06-09 20:43:52,375: 8) loss=0.074 grad_norm=4.89 num_segments=256 num_words=213
2020-06-09 20:45:27,402: 9) loss=0.076 grad_norm=8.35 num_segments=256 num_words=209
2020-06-09 20:46:57,911: 10) loss=0.080 grad_norm=9.91 num_segments=256 num_words=209
2020-06-09 20:48:26,664: 11) loss=0.079 grad_norm=11.72 num_segments=256 num_words=213
2020-06-09 20:50:05,786: 12) loss=0.071 grad_norm=7.63 num_segments=256 num_words=210
2020-06-09 20:51:34,477: 13) loss=0.085 grad_norm=8.96 num_segments=256 num_words=212
2020-06-09 20:53:02,769: 14) loss=0.073 grad_norm=7.81 num_segments=256 num_words=208
2020-06-09 20:54:30,585: 15) loss=0.081 grad_norm=9.29 num_segments=256 num_words=220
2020-06-09 20:55:59,293: 16) loss=0.076 grad_norm=8.41 num_segments=256 num_words=199
2020-06-09 20:57:27,488: 17) loss=0.073 grad_norm=7.87 num_segments=256 num_words=215
2020-06-09 20:58:56,025: 18) loss=0.078 grad_norm=6.58 num_segments=256 num_words=215
2020-06-09 21:00:24,724: 19) loss=0.075 grad_norm=7.03 num_segments=256 num_words=215
2020-06-09 21:01:53,450: 20) loss=0.078 grad_norm=7.33 num_segments=256 num_words=206
2020-06-09 21:03:22,269: 21) loss=0.077 grad_norm=9.58 num_segments=256 num_words=211
2020-06-09 21:04:50,673: 22) loss=0.073 grad_norm=12.25 num_segments=256 num_words=208
2020-06-09 21:06:19,393: 23) loss=0.077 grad_norm=10.06 num_segments=256 num_words=203
2020-06-09 21:07:49,477: 24) loss=0.079 grad_norm=8.85 num_segments=256 num_words=207
2020-06-09 21:09:19,102: 25) loss=0.110 grad_norm=10.41 num_segments=256 num_words=205
2020-06-09 21:11:02,557: 26) loss=0.074 grad_norm=10.75 num_segments=256 num_words=214
2020-06-09 21:12:31,436: 27) loss=0.082 grad_norm=12.19 num_segments=256 num_words=201
2020-06-09 21:14:00,059: 28) loss=0.075 grad_norm=6.92 num_segments=256 num_words=216
2020-06-09 21:15:31,488: 29) loss=0.077 grad_norm=7.53 num_segments=256 num_words=218
2020-06-09 21:17:00,219: 30) loss=0.087 grad_norm=13.79 num_segments=256 num_words=209
2020-06-09 21:18:28,502: 31) loss=0.073 grad_norm=8.85 num_segments=256 num_words=215
2020-06-09 21:19:57,613: 32) loss=0.069 grad_norm=10.09 num_segments=256 num_words=210
2020-06-09 21:21:26,149: 33) loss=0.095 grad_norm=9.75 num_segments=256 num_words=199
2020-06-09 21:22:54,695: 34) loss=0.080 grad_norm=6.65 num_segments=256 num_words=208
2020-06-09 21:24:23,550: 35) loss=0.076 grad_norm=9.22 num_segments=256 num_words=197
2020-06-09 21:25:52,166: 36) loss=0.071 grad_norm=6.69 num_segments=256 num_words=207
2020-06-09 21:27:21,063: 37) loss=0.074 grad_norm=7.59 num_segments=256 num_words=212
2020-06-09 21:28:41,106: 38) loss=0.076 grad_norm=9.64 num_segments=243 num_words=197
2020-06-09 21:28:41,122: epoch= 24.00
2020-06-09 21:28:41,122:  >> time to evaluate and save:
2020-06-09 21:28:41,179: saved save/MultiViewDataset_IndividualWords.936.pth
2020-06-09 21:28:41,197: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 21:28:41,225: removed save/MultiViewDataset_IndividualWords.702.pth
2020-06-09 21:28:41,225: saved MultiViewDataset_IndividualWords successfully
2020-06-09 21:28:42,653: saved save/MultiViewRNN.936.pth
2020-06-09 21:28:43,166: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 21:28:44,657: removed save/MultiViewRNN.702.pth
2020-06-09 21:28:44,658: saved MultiViewRNN successfully
2020-06-09 21:28:47,265: saved save/Adam.936.pth
2020-06-09 21:28:47,309: most_recent linked save/Adam.most_recent.pth
2020-06-09 21:28:47,386: removed save/Adam.702.pth
2020-06-09 21:28:47,386: saved Adam successfully
2020-06-09 21:28:47,389: saved save/ReduceLROnPlateau.936.pth
2020-06-09 21:28:47,406: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 21:28:47,418: removed save/ReduceLROnPlateau.663.pth
2020-06-09 21:28:47,418: saved ReduceLROnPlateau successfully
2020-06-09 21:28:47,421: saved config successfully
2020-06-09 21:30:13,449:   >> crossview_ap=0.692 (10966 x 3921 pairs)
2020-06-09 21:31:07,167:   >> acoustic_ap=0.759 (10966 choose 2 pairs)
2020-06-09 21:31:07,171: best_so_far= 0.693 at 819
2020-06-09 21:31:07,617: epoch=24.00 global_step=936 lr=0.001 start_iter=0
2020-06-09 21:31:07,618: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 21:32:37,863: 0) loss=0.077 grad_norm=7.49 num_segments=256 num_words=212
2020-06-09 21:34:06,889: 1) loss=0.073 grad_norm=6.10 num_segments=256 num_words=215
2020-06-09 21:35:35,458: 2) loss=0.071 grad_norm=5.21 num_segments=256 num_words=221
2020-06-09 21:37:04,200: 3) loss=0.071 grad_norm=7.15 num_segments=256 num_words=207
2020-06-09 21:38:34,506: 4) loss=0.084 grad_norm=7.69 num_segments=256 num_words=213
2020-06-09 21:40:25,596: 5) loss=0.133 grad_norm=6.45 num_segments=256 num_words=203
2020-06-09 21:41:54,637: 6) loss=0.135 grad_norm=5.60 num_segments=256 num_words=206
2020-06-09 21:43:23,323: 7) loss=0.074 grad_norm=12.88 num_segments=256 num_words=205
2020-06-09 21:44:52,650: 8) loss=0.069 grad_norm=6.86 num_segments=256 num_words=201
2020-06-09 21:46:21,375: 9) loss=0.077 grad_norm=5.59 num_segments=256 num_words=204
2020-06-09 21:47:50,546: 10) loss=0.080 grad_norm=7.43 num_segments=256 num_words=200
2020-06-09 21:49:19,132: 11) loss=0.064 grad_norm=7.47 num_segments=256 num_words=200
2020-06-09 21:50:48,203: 12) loss=0.075 grad_norm=7.22 num_segments=256 num_words=215
2020-06-09 21:52:17,361: 13) loss=0.085 grad_norm=4.85 num_segments=256 num_words=210
2020-06-09 21:53:46,323: 14) loss=0.072 grad_norm=5.36 num_segments=256 num_words=206
2020-06-09 21:55:15,314: 15) loss=0.075 grad_norm=4.64 num_segments=256 num_words=211
2020-06-09 21:56:43,987: 16) loss=0.069 grad_norm=10.12 num_segments=256 num_words=212
2020-06-09 21:58:12,265: 17) loss=0.075 grad_norm=10.00 num_segments=256 num_words=212
7:56,834: Using 1 GPU(s)
2020-06-09 21:57:56,834: Machine: 0 / 1
2020-06-09 21:57:56,835: Hyperparam tuning-------------------
2020-06-09 21:57:56,836: optim_lr: 0.001
2020-06-09 21:57:56,836: dropout (for both): 0.4
2020-06-09 21:57:56,836: margin: 0.4
2020-06-09 21:57:56,836: ------------------------------------
2020-06-09 21:57:56,837: Calling main function: multiview_trainer.train
2020-06-09 21:57:56,837: Using config file: train_config.json
2020-06-09 21:57:56,837: Using module at multiview_trainer.train
2020-06-09 21:57:57,016: Using module at multiview_vocab.MultiViewVocab
2020-06-09 21:57:57,040: Building vocab_data from config
2020-06-09 21:57:57,275:  >> min_count= 0
2020-06-09 21:57:57,275:  >> # words= 34323 (# removed= 0)
2020-06-09 21:57:57,276:  >> # subwords= 45
2020-06-09 21:57:57,276:     [laughter]= 1
2020-06-09 21:57:57,276:     [noise]= 2
2020-06-09 21:57:57,276:     [vocalized-noise]= 3
2020-06-09 21:57:57,276:     aa= 4
2020-06-09 21:57:57,276:     ae= 5
2020-06-09 21:57:57,276:     ah= 6
2020-06-09 21:57:57,276:     ao= 7
2020-06-09 21:57:57,276:     aw= 8
2020-06-09 21:57:57,276:     ax= 9
2020-06-09 21:57:57,276:     ay= 10
2020-06-09 21:57:57,276:     b= 11
2020-06-09 21:57:57,276:     ch= 12
2020-06-09 21:57:57,276:     d= 13
2020-06-09 21:57:57,276:     dh= 14
2020-06-09 21:57:57,276:     eh= 15
2020-06-09 21:57:57,276:     el= 16
2020-06-09 21:57:57,276:     en= 17
2020-06-09 21:57:57,276:     er= 18
2020-06-09 21:57:57,276:     ey= 19
2020-06-09 21:57:57,276:     f= 20
2020-06-09 21:57:57,276:     g= 21
2020-06-09 21:57:57,277:     hh= 22
2020-06-09 21:57:57,277:     ih= 23
2020-06-09 21:57:57,277:     iy= 24
2020-06-09 21:57:57,277:     jh= 25
2020-06-09 21:57:57,277:     k= 26
2020-06-09 21:57:57,277:     l= 27
2020-06-09 21:57:57,277:     m= 28
2020-06-09 21:57:57,277:     n= 29
2020-06-09 21:57:57,277:     ng= 30
2020-06-09 21:57:57,277:     ow= 31
2020-06-09 21:57:57,277:     oy= 32
2020-06-09 21:57:57,277:     p= 33
2020-06-09 21:57:57,277:     r= 34
2020-06-09 21:57:57,277:     s= 35
2020-06-09 21:57:57,277:     sh= 36
2020-06-09 21:57:57,277:     t= 37
2020-06-09 21:57:57,277:     th= 38
2020-06-09 21:57:57,277:     uh= 39
2020-06-09 21:57:57,277:     uw= 40
2020-06-09 21:57:57,277:     v= 41
2020-06-09 21:57:57,277:     w= 42
2020-06-09 21:57:57,277:     y= 43
2020-06-09 21:57:57,277:     z= 44
2020-06-09 21:57:57,278:     zh= 45
2020-06-09 21:57:57,290: Using module at data.batch_samplers.BatchSampler
2020-06-09 21:57:57,291: Building vocab_sampler from config
2020-06-09 21:57:57,292:  >> # examples= 34323
2020-06-09 21:57:57,292:  >> batch_size= 1000
2020-06-09 21:57:57,292:  >> shuffle= False
2020-06-09 21:57:57,298:  >> BatchSampler; 35 batches
2020-06-09 21:57:57,298: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 21:57:57,370: Building train_data from config
2020-06-09 21:58:04,171:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-09 21:58:04,173:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-09 21:58:04,174:  >> stack= False
2020-06-09 21:58:04,174:  >> seg_durs= (1, None)
2020-06-09 21:58:04,174:  >> # words= 9971 (# ignored= 0)
2020-06-09 21:58:04,174:  >> input_feat_dim= 108
2020-06-09 21:58:04,174:  >> input_num_subwords= 45
2020-06-09 21:58:04,174: Using module at data.batch_samplers.BatchSampler
2020-06-09 21:58:04,174: Building train_sampler from config
2020-06-09 21:58:04,175:  >> # examples= 9971
2020-06-09 21:58:04,175:  >> batch_size= 256
2020-06-09 21:58:04,175:  >> shuffle= True
2020-06-09 21:58:04,183:  >> BatchSampler; 39 batches
2020-06-09 21:58:04,183: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 21:58:04,183: Building dev_data from config
2020-06-09 21:58:11,736:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-09 21:58:11,738:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-09 21:58:11,738:  >> stack= False
2020-06-09 21:58:11,738:  >> seg_durs= (1, None)
2020-06-09 21:58:11,738:  >> # words= 10966 (# ignored= 0)
2020-06-09 21:58:11,738:  >> input_feat_dim= 108
2020-06-09 21:58:11,738:  >> input_num_subwords= 45
2020-06-09 21:58:11,738: Using module at data.batch_samplers.BatchSampler
2020-06-09 21:58:11,738: Building dev_sampler from config
2020-06-09 21:58:11,739:  >> # examples= 10966
2020-06-09 21:58:11,739:  >> batch_size= 256
2020-06-09 21:58:11,739:  >> shuffle= False
2020-06-09 21:58:11,741:  >> BatchSampler; 43 batches
2020-06-09 21:58:11,741: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 21:58:11,741: Building test_data from config
2020-06-09 21:58:18,179:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-09 21:58:18,179:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-09 21:58:18,179:  >> stack= False
2020-06-09 21:58:18,179:  >> seg_durs= (1, None)
2020-06-09 21:58:18,179:  >> # words= 11024 (# ignored= 0)
2020-06-09 21:58:18,179:  >> input_feat_dim= 108
2020-06-09 21:58:18,180:  >> input_num_subwords= 45
2020-06-09 21:58:18,180: Using module at data.batch_samplers.BatchSampler
2020-06-09 21:58:18,180: Building test_sampler from config
2020-06-09 21:58:18,180:  >> # examples= 11024
2020-06-09 21:58:18,180:  >> batch_size= 256
2020-06-09 21:58:18,180:  >> shuffle= False
2020-06-09 21:58:18,183:  >> BatchSampler; 44 batches
2020-06-09 21:58:18,183: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-09 21:58:18,218: Building loss from config
2020-06-09 21:58:18,218:  >> margin= 0.4
2020-06-09 21:58:18,218:  >> k= 16
2020-06-09 21:58:18,218:  >> min_k= 8
2020-06-09 21:58:18,218:  >> extra= 0
2020-06-09 21:58:18,218:  >> average= False
2020-06-09 21:58:18,218:  >> margin_max= 0.5
2020-06-09 21:58:18,218:  >> threshold_max= 9
2020-06-09 21:58:18,218:  >> using obj0
2020-06-09 21:58:18,219: Using module at metric.multiview_ap.MultiViewAP
2020-06-09 21:58:18,277: Building eval from config
2020-06-09 21:58:18,277:  >> acoustic_ap= True
2020-06-09 21:58:18,277:  >> crossview_ap= True
2020-06-09 21:58:18,277:  >> full_vocab= False
2020-06-09 21:58:18,278:  >> metric= crossview_ap
2020-06-09 21:58:18,278:  >> mode= max
2020-06-09 21:58:18,278: Using module at multiview_rnn.MultiViewRNN
2020-06-09 21:58:18,321: Building net from config
2020-06-09 21:58:18,322: view1:
2020-06-09 21:58:18,323:  >> cell= GRU
2020-06-09 21:58:18,323:  >> input_size= 108
2020-06-09 21:58:18,323:  >> hidden_size= 512
2020-06-09 21:58:18,323:  >> bidirectional= True
2020-06-09 21:58:18,323:  >> num_layers= 6
2020-06-09 21:58:18,323:  >> dropout between layers= 0.4
2020-06-09 21:58:18,532: view2:
2020-06-09 21:58:18,533:  >> cell= GRU
2020-06-09 21:58:18,533:  >> input_size= 64
2020-06-09 21:58:18,533:  >> hidden_size= 512
2020-06-09 21:58:18,533:  >> bidirectional= True
2020-06-09 21:58:18,533:  >> num_layers= 2
2020-06-09 21:58:18,534:  >> dropout between layers= 0.4
2020-06-09 21:58:18,534:  >> num input embeddings= 45
2020-06-09 21:58:21,880: Using module at optim.adam.Adam
2020-06-09 21:58:21,885: Building optim from config
2020-06-09 21:58:21,885:  >> lr= 0.001
2020-06-09 21:58:21,885:  >> betas= (0.9, 0.999)
2020-06-09 21:58:21,885:  >> eps= 1e-08
2020-06-09 21:58:21,885:  >> weight_decay= 0
2020-06-09 21:58:21,885:  >> amsgrad= False
2020-06-09 21:58:21,885:  >> min_lr= 1e-07
2020-06-09 21:58:21,886: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-09 21:58:21,916: Building sched from config
2020-06-09 21:58:21,916:  >> optim= Adam
2020-06-09 21:58:21,916:  >> decay lr by 0.1
2020-06-09 21:58:21,917:  >> eval_fn= MultiViewAP
2020-06-09 21:58:21,917:  >> patience=4
2020-06-09 21:58:21,917:  >> revert=True
2020-06-09 21:58:21,927: loaded save/MultiViewDataset_IndividualWords.936.pth
2020-06-09 21:58:21,928: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 21:58:23,043: loaded save/MultiViewRNN.936.pth
2020-06-09 21:58:23,043: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    2020-06-09 21:58:25,261: loaded save/Adam.936.pth
2020-06-09 21:58:25,262: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 21:58:25,264: loaded save/ReduceLROnPlateau.936.pth
2020-06-09 21:58:25,264: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 21:58:25,264: epoch=24.00 global_step=936 lr=0.001 start_iter=0
2020-06-09 21:58:25,265: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 21:59:41,336: 18) loss=0.082 grad_norm=11.01 num_segments=256 num_words=221
2020-06-09 22:01:10,361: 19) loss=0.070 grad_norm=13.85 num_segments=256 num_words=209
2020-06-09 22:02:39,461: 20) loss=0.070 grad_norm=7.16 num_segments=256 num_words=207
2020-06-09 22:04:09,029: 21) loss=0.071 grad_norm=6.80 num_segments=256 num_words=196
2020-06-09 22:05:37,638: 22) loss=0.146 grad_norm=8.68 num_segments=256 num_words=212
2020-06-09 22:07:06,256: 23) loss=0.072 grad_norm=6.37 num_segments=256 num_words=210
2020-06-09 22:08:35,111: 24) loss=0.139 grad_norm=14.08 num_segments=256 num_words=216
2020-06-09 22:10:04,346: 25) loss=0.076 grad_norm=4.64 num_segments=256 num_words=218
2020-06-09 22:11:55,171: 26) loss=0.074 grad_norm=7.64 num_segments=256 num_words=213
2020-06-09 22:13:23,723: 27) loss=0.075 grad_norm=10.14 num_segments=256 num_words=215
2020-06-09 22:14:53,154: 28) loss=0.067 grad_norm=7.73 num_segments=256 num_words=219
2020-06-09 22:16:24,129: 29) loss=0.075 grad_norm=6.34 num_segments=256 num_words=207
2020-06-09 22:17:54,171: 30) loss=0.070 grad_norm=8.78 num_segments=256 num_words=209
2020-06-09 22:19:22,661: 31) loss=0.075 grad_norm=7.08 num_segments=256 num_words=207
2020-06-09 22:20:51,255: 32) loss=0.071 grad_norm=8.51 num_segments=256 num_words=204
2020-06-09 22:22:19,486: 33) loss=0.073 grad_norm=6.60 num_segments=256 num_words=212
2020-06-09 22:23:47,748: 34) loss=0.091 grad_norm=9.48 num_segments=256 num_words=218
2020-06-09 22:25:16,523: 35) loss=0.083 grad_norm=8.11 num_segments=256 num_words=208
2020-06-09 22:26:44,780: 36) loss=0.073 grad_norm=11.83 num_segments=256 num_words=211
2020-06-09 22:28:13,203: 37) loss=0.077 grad_norm=5.87 num_segments=256 num_words=210
2020-06-09 22:29:33,180: 38) loss=0.078 grad_norm=7.24 num_segments=243 num_words=209
2020-06-09 22:29:33,197: epoch= 25.00
2020-06-09 22:29:33,197:  >> time to evaluate and save:
2020-06-09 22:29:33,237: saved save/MultiViewDataset_IndividualWords.975.pth
2020-06-09 22:29:33,260: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 22:29:33,289: removed save/MultiViewDataset_IndividualWords.741.pth
2020-06-09 22:29:33,289: saved MultiViewDataset_IndividualWords successfully
2020-06-09 22:29:34,799: saved save/MultiViewRNN.975.pth
2020-06-09 22:29:34,809: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 22:29:34,892: removed save/MultiViewRNN.741.pth
2020-06-09 22:29:34,892: saved MultiViewRNN successfully
2020-06-09 22:29:37,637: saved save/Adam.975.pth
2020-06-09 22:29:37,688: most_recent linked save/Adam.most_recent.pth
2020-06-09 22:29:37,792: removed save/Adam.741.pth
2020-06-09 22:29:37,793: saved Adam successfully
2020-06-09 22:29:37,796: saved save/ReduceLROnPlateau.975.pth
2020-06-09 22:29:37,815: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 22:29:37,834: removed save/ReduceLROnPlateau.702.pth
2020-06-09 22:29:37,834: saved ReduceLROnPlateau successfully
2020-06-09 22:29:37,837: saved config successfully
2020-06-09 22:31:42,715:   >> crossview_ap=0.687 (10966 x 3921 pairs)
2020-06-09 22:33:12,915:   >> acoustic_ap=0.737 (10966 choose 2 pairs)
2020-06-09 22:33:12,919: best_so_far= 0.693 at 819
2020-06-09 22:33:13,611: epoch=25.00 global_step=975 lr=0.001 start_iter=0
2020-06-09 22:33:13,611: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 22:34:46,351: 0) loss=0.075 grad_norm=4.62 num_segments=256 num_words=212
2020-06-09 22:36:15,847: 1) loss=0.080 grad_norm=7.45 num_segments=256 num_words=198
2020-06-09 22:37:45,063: 2) loss=0.074 grad_norm=5.86 num_segments=256 num_words=210
2020-06-09 22:39:13,790: 3) loss=0.071 grad_norm=6.73 num_segments=256 num_words=223
2020-06-09 22:40:42,389: 4) loss=0.065 grad_norm=6.16 num_segments=256 num_words=211
2020-06-09 22:42:11,289: 5) loss=0.073 grad_norm=7.02 num_segments=256 num_words=220
2020-06-09 22:43:40,138: 6) loss=0.078 grad_norm=6.49 num_segments=256 num_words=205
2020-06-09 22:45:08,973: 7) loss=0.071 grad_norm=4.96 num_segments=256 num_words=211
2020-06-09 22:46:37,778: 8) loss=0.068 grad_norm=7.35 num_segments=256 num_words=206
2020-06-09 22:48:06,932: 9) loss=0.069 grad_norm=5.05 num_segments=256 num_words=211
2020-06-09 22:49:37,211: 10) loss=0.076 grad_norm=7.30 num_segments=256 num_words=203
2020-06-09 22:51:05,858: 11) loss=0.076 grad_norm=8.89 num_segments=256 num_words=222
2020-06-09 22:52:35,262: 12) loss=0.075 grad_norm=10.25 num_segments=256 num_words=208
2020-06-09 22:54:04,558: 13) loss=0.063 grad_norm=7.30 num_segments=256 num_words=200
2020-06-09 22:56:11,198: 14) loss=0.072 grad_norm=7.09 num_segments=256 num_words=217
2020-06-09 22:57:41,720: 15) loss=0.077 grad_norm=4.38 num_segments=256 num_words=226
2020-06-09 22:59:10,961: 16) loss=0.069 grad_norm=9.19 num_segments=256 num_words=202
2020-06-09 23:00:41,286: 17) loss=0.077 grad_norm=4.29 num_segments=256 num_words=201
2020-06-09 23:02:11,473: 18) loss=0.075 grad_norm=7.99 num_segments=256 num_words=217
2020-06-09 23:03:40,652: 19) loss=0.073 grad_norm=6.10 num_segments=256 num_words=206
2020-06-09 23:05:10,008: 20) loss=0.073 grad_norm=8.65 num_segments=256 num_words=202
2020-06-09 23:06:39,887: 21) loss=0.070 grad_norm=6.63 num_segments=256 num_words=215
2020-06-09 23:08:10,012: 22) loss=0.084 grad_norm=9.44 num_segments=256 num_words=211
2020-06-09 23:09:39,006: 23) loss=0.077 grad_norm=8.17 num_segments=256 num_words=204
2020-06-09 23:11:08,295: 24) loss=0.070 grad_norm=7.56 num_segments=256 num_words=204
2020-06-09 23:12:37,611: 25) loss=0.073 grad_norm=9.23 num_segments=256 num_words=219
2020-06-09 23:14:07,123: 26) loss=0.074 grad_norm=8.02 num_segments=256 num_words=206
2020-06-09 23:15:36,376: 27) loss=0.148 grad_norm=8.40 num_segments=256 num_words=212
2020-06-09 23:17:05,646: 28) loss=0.072 grad_norm=14.97 num_segments=256 num_words=215
2020-06-09 23:18:35,016: 29) loss=0.084 grad_norm=15.94 num_segments=256 num_words=214
2020-06-09 23:20:05,882: 30) loss=0.087 grad_norm=10.22 num_segments=256 num_words=213
2020-06-09 23:20:50,962: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-09 23:20:51,006: Using 1 GPU(s)
2020-06-09 23:20:51,007: Machine: 0 / 1
2020-06-09 23:20:51,009: Hyperparam tuning-------------------
2020-06-09 23:20:51,009: optim_lr: 0.001
2020-06-09 23:20:51,009: dropout (for both): 0.4
2020-06-09 23:20:51,009: margin: 0.4
2020-06-09 23:20:51,009: ------------------------------------
2020-06-09 23:20:51,012: Calling main function: multiview_trainer.train
2020-06-09 23:20:51,013: Using config file: train_config.json
2020-06-09 23:20:51,013: Using module at multiview_trainer.train
2020-06-09 23:20:51,345: Using module at multiview_vocab.MultiViewVocab
2020-06-09 23:20:51,354: Building vocab_data from config
2020-06-09 23:20:51,633:  >> min_count= 0
2020-06-09 23:20:51,634:  >> # words= 34323 (# removed= 0)
2020-06-09 23:20:51,634:  >> # subwords= 45
2020-06-09 23:20:51,634:     [laughter]= 1
2020-06-09 23:20:51,634:     [noise]= 2
2020-06-09 23:20:51,634:     [vocalized-noise]= 3
2020-06-09 23:20:51,634:     aa= 4
2020-06-09 23:20:51,634:     ae= 5
2020-06-09 23:20:51,634:     ah= 6
2020-06-09 23:20:51,634:     ao= 7
2020-06-09 23:20:51,634:     aw= 8
2020-06-09 23:20:51,634:     ax= 9
2020-06-09 23:20:51,634:     ay= 10
2020-06-09 23:20:51,635:     b= 11
2020-06-09 23:20:51,635:     ch= 12
2020-06-09 23:20:51,635:     d= 13
2020-06-09 23:20:51,635:     dh= 14
2020-06-09 23:20:51,635:     eh= 15
2020-06-09 23:20:51,635:     el= 16
2020-06-09 23:20:51,635:     en= 17
2020-06-09 23:20:51,635:     er= 18
2020-06-09 23:20:51,635:     ey= 19
2020-06-09 23:20:51,635:     f= 20
2020-06-09 23:20:51,635:     g= 21
2020-06-09 23:20:51,635:     hh= 22
2020-06-09 23:20:51,635:     ih= 23
2020-06-09 23:20:51,636:     iy= 24
2020-06-09 23:20:51,636:     jh= 25
2020-06-09 23:20:51,636:     k= 26
2020-06-09 23:20:51,636:     l= 27
2020-06-09 23:20:51,636:     m= 28
2020-06-09 23:20:51,636:     n= 29
2020-06-09 23:20:51,636:     ng= 30
2020-06-09 23:20:51,636:     ow= 31
2020-06-09 23:20:51,636:     oy= 32
2020-06-09 23:20:51,636:     p= 33
2020-06-09 23:20:51,636:     r= 34
2020-06-09 23:20:51,636:     s= 35
2020-06-09 23:20:51,636:     sh= 36
2020-06-09 23:20:51,636:     t= 37
2020-06-09 23:20:51,637:     th= 38
2020-06-09 23:20:51,637:     uh= 39
2020-06-09 23:20:51,637:     uw= 40
2020-06-09 23:20:51,637:     v= 41
2020-06-09 23:20:51,637:     w= 42
2020-06-09 23:20:51,637:     y= 43
2020-06-09 23:20:51,637:     z= 44
2020-06-09 23:20:51,637:     zh= 45
2020-06-09 23:20:51,651: Using module at data.batch_samplers.BatchSampler
2020-06-09 23:20:51,653: Building vocab_sampler from config
2020-06-09 23:20:51,654:  >> # examples= 34323
2020-06-09 23:20:51,654:  >> batch_size= 1000
2020-06-09 23:20:51,654:  >> shuffle= False
2020-06-09 23:20:51,661:  >> BatchSampler; 35 batches
2020-06-09 23:20:51,661: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 23:20:51,773: Building train_data from config
2020-06-09 23:20:58,885:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-09 23:20:58,887:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-09 23:20:58,887:  >> stack= False
2020-06-09 23:20:58,888:  >> seg_durs= (1, None)
2020-06-09 23:20:58,888:  >> # words= 9971 (# ignored= 0)
2020-06-09 23:20:58,888:  >> input_feat_dim= 108
2020-06-09 23:20:58,888:  >> input_num_subwords= 45
2020-06-09 23:20:58,888: Using module at data.batch_samplers.BatchSampler
2020-06-09 23:20:58,888: Building train_sampler from config
2020-06-09 23:20:58,890:  >> # examples= 9971
2020-06-09 23:20:58,890:  >> batch_size= 256
2020-06-09 23:20:58,890:  >> shuffle= True
2020-06-09 23:20:58,897:  >> BatchSampler; 39 batches
2020-06-09 23:20:58,897: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 23:20:58,898: Building dev_data from config
2020-06-09 23:21:07,078:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-09 23:21:07,079:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-09 23:21:07,079:  >> stack= False
2020-06-09 23:21:07,079:  >> seg_durs= (1, None)
2020-06-09 23:21:07,079:  >> # words= 10966 (# ignored= 0)
2020-06-09 23:21:07,079:  >> input_feat_dim= 108
2020-06-09 23:21:07,079:  >> input_num_subwords= 45
2020-06-09 23:21:07,080: Using module at data.batch_samplers.BatchSampler
2020-06-09 23:21:07,080: Building dev_sampler from config
2020-06-09 23:21:07,080:  >> # examples= 10966
2020-06-09 23:21:07,080:  >> batch_size= 256
2020-06-09 23:21:07,080:  >> shuffle= False
2020-06-09 23:21:07,083:  >> BatchSampler; 43 batches
2020-06-09 23:21:07,083: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 23:21:07,083: Building test_data from config
2020-06-09 23:21:20,000: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-09 23:21:20,066: Using 1 GPU(s)
2020-06-09 23:21:20,066: Machine: 0 / 1
2020-06-09 23:21:20,081: Hyperparam tuning-------------------
2020-06-09 23:21:20,081: optim_lr: 0.001
2020-06-09 23:21:20,082: dropout (for both): 0.4
2020-06-09 23:21:20,082: margin: 0.4
2020-06-09 23:21:20,082: ------------------------------------
2020-06-09 23:21:20,125: Calling main function: multiview_trainer.train
2020-06-09 23:21:20,125: Using config file: train_config.json
2020-06-09 23:21:20,125: Using module at multiview_trainer.train
2020-06-09 23:21:25,876: Using module at multiview_vocab.MultiViewVocab
2020-06-09 23:21:25,923: Building vocab_data from config
2020-06-09 23:21:26,362:  >> min_count= 0
2020-06-09 23:21:26,362:  >> # words= 34323 (# removed= 0)
2020-06-09 23:21:26,362:  >> # subwords= 45
2020-06-09 23:21:26,362:     [laughter]= 1
2020-06-09 23:21:26,363:     [noise]= 2
2020-06-09 23:21:26,363:     [vocalized-noise]= 3
2020-06-09 23:21:26,363:     aa= 4
2020-06-09 23:21:26,363:     ae= 5
2020-06-09 23:21:26,363:     ah= 6
2020-06-09 23:21:26,363:     ao= 7
2020-06-09 23:21:26,363:     aw= 8
2020-06-09 23:21:26,363:     ax= 9
2020-06-09 23:21:26,363:     ay= 10
2020-06-09 23:21:26,363:     b= 11
2020-06-09 23:21:26,363:     ch= 12
2020-06-09 23:21:26,363:     d= 13
2020-06-09 23:21:26,363:     dh= 14
2020-06-09 23:21:26,363:     eh= 15
2020-06-09 23:21:26,363:     el= 16
2020-06-09 23:21:26,363:     en= 17
2020-06-09 23:21:26,363:     er= 18
2020-06-09 23:21:26,363:     ey= 19
2020-06-09 23:21:26,364:     f= 20
2020-06-09 23:21:26,364:     g= 21
2020-06-09 23:21:26,364:     hh= 22
2020-06-09 23:21:26,364:     ih= 23
2020-06-09 23:21:26,364:     iy= 24
2020-06-09 23:21:26,364:     jh= 25
2020-06-09 23:21:26,364:     k= 26
2020-06-09 23:21:26,364:     l= 27
2020-06-09 23:21:26,364:     m= 28
2020-06-09 23:21:26,364:     n= 29
2020-06-09 23:21:26,364:     ng= 30
2020-06-09 23:21:26,364:     ow= 31
2020-06-09 23:21:26,364:     oy= 32
2020-06-09 23:21:26,364:     p= 33
2020-06-09 23:21:26,364:     r= 34
2020-06-09 23:21:26,364:     s= 35
2020-06-09 23:21:26,364:     sh= 36
2020-06-09 23:21:26,364:     t= 37
2020-06-09 23:21:26,364:     th= 38
2020-06-09 23:21:26,365:     uh= 39
2020-06-09 23:21:26,365:     uw= 40
2020-06-09 23:21:26,365:     v= 41
2020-06-09 23:21:26,365:     w= 42
2020-06-09 23:21:26,365:     y= 43
2020-06-09 23:21:26,365:     z= 44
2020-06-09 23:21:26,365:     zh= 45
2020-06-09 23:21:26,378: Using module at data.batch_samplers.BatchSampler
2020-06-09 23:21:26,380: Building vocab_sampler from config
2020-06-09 23:21:26,381:  >> # examples= 34323
2020-06-09 23:21:26,381:  >> batch_size= 1000
2020-06-09 23:21:26,381:  >> shuffle= False
2020-06-09 23:21:26,389:  >> BatchSampler; 35 batches
2020-06-09 23:21:26,389: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 23:21:28,806: Building train_data from config
2020-06-09 23:21:36,046:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-09 23:21:36,047:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-09 23:21:36,047:  >> stack= False
2020-06-09 23:21:36,047:  >> seg_durs= (1, None)
2020-06-09 23:21:36,047:  >> # words= 9971 (# ignored= 0)
2020-06-09 23:21:36,047:  >> input_feat_dim= 108
2020-06-09 23:21:36,047:  >> input_num_subwords= 45
2020-06-09 23:21:36,047: Using module at data.batch_samplers.BatchSampler
2020-06-09 23:21:36,047: Building train_sampler from config
2020-06-09 23:21:36,048:  >> # examples= 9971
2020-06-09 23:21:36,048:  >> batch_size= 256
2020-06-09 23:21:36,048:  >> shuffle= True
2020-06-09 23:21:36,055:  >> BatchSampler; 39 batches
2020-06-09 23:21:36,055: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 23:21:36,055: Building dev_data from config
                                                    2020-06-09 23:21:43,155:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-09 23:21:43,156:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-09 23:21:43,156:  >> stack= False
2020-06-09 23:21:43,156:  >> seg_durs= (1, None)
2020-06-09 23:21:43,156:  >> # words= 10966 (# ignored= 0)
2020-06-09 23:21:43,156:  >> input_feat_dim= 108
2020-06-09 23:21:43,156:  >> input_num_subwords= 45
2020-06-09 23:21:43,156: Using module at data.batch_samplers.BatchSampler
2020-06-09 23:21:43,156: Building dev_sampler from config
2020-06-09 23:21:43,157:  >> # examples= 10966
2020-06-09 23:21:43,157:  >> batch_size= 256
2020-06-09 23:21:43,157:  >> shuffle= False
2020-06-09 23:21:43,159:  >> BatchSampler; 43 batches
2020-06-09 23:21:43,159: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 23:21:43,159: Building test_data from config
2020-06-09 23:21:49,635:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-09 23:21:49,635:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-09 23:21:49,635:  >> stack= False
2020-06-09 23:21:49,635:  >> seg_durs= (1, None)
2020-06-09 23:21:49,636:  >> # words= 11024 (# ignored= 0)
2020-06-09 23:21:49,636:  >> input_feat_dim= 108
2020-06-09 23:21:49,636:  >> input_num_subwords= 45
2020-06-09 23:21:49,636: Using module at data.batch_samplers.BatchSampler
2020-06-09 23:21:49,636: Building test_sampler from config
2020-06-09 23:21:49,636:  >> # examples= 11024
2020-06-09 23:21:49,636:  >> batch_size= 256
2020-06-09 23:21:49,636:  >> shuffle= False
2020-06-09 23:21:49,638:  >> BatchSampler; 44 batches
2020-06-09 23:21:49,638: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-09 23:21:49,842: Building loss from config
2020-06-09 23:21:49,842:  >> margin= 0.4
2020-06-09 23:21:49,842:  >> k= 16
2020-06-09 23:21:49,843:  >> min_k= 8
2020-06-09 23:21:49,843:  >> extra= 0
2020-06-09 23:21:49,843:  >> average= False
2020-06-09 23:21:49,843:  >> margin_max= 0.5
2020-06-09 23:21:49,843:  >> threshold_max= 9
2020-06-09 23:21:49,843:  >> using obj0
2020-06-09 23:21:49,843: Using module at metric.multiview_ap.MultiViewAP
2020-06-09 23:21:51,888: Building eval from config
2020-06-09 23:21:51,889:  >> acoustic_ap= True
2020-06-09 23:21:51,889:  >> crossview_ap= True
2020-06-09 23:21:51,889:  >> full_vocab= False
2020-06-09 23:21:51,889:  >> metric= crossview_ap
2020-06-09 23:21:51,889:  >> mode= max
2020-06-09 23:21:51,889: Using module at multiview_rnn.MultiViewRNN
2020-06-09 23:21:51,933: Building net from config
2020-06-09 23:21:51,934: view1:
2020-06-09 23:21:51,935:  >> cell= GRU
2020-06-09 23:21:51,935:  >> input_size= 108
2020-06-09 23:21:51,935:  >> hidden_size= 512
2020-06-09 23:21:51,936:  >> bidirectional= True
2020-06-09 23:21:51,936:  >> num_layers= 6
2020-06-09 23:21:51,936:  >> dropout between layers= 0.4
2020-06-09 23:21:52,195: view2:
2020-06-09 23:21:52,196:  >> cell= GRU
2020-06-09 23:21:52,196:  >> input_size= 64
2020-06-09 23:21:52,196:  >> hidden_size= 512
2020-06-09 23:21:52,196:  >> bidirectional= True
2020-06-09 23:21:52,196:  >> num_layers= 2
2020-06-09 23:21:52,196:  >> dropout between layers= 0.4
2020-06-09 23:21:52,196:  >> num input embeddings= 45
2020-06-09 23:22:05,287: Using module at optim.adam.Adam
2020-06-09 23:22:05,303: Building optim from config
2020-06-09 23:22:05,304:  >> lr= 0.001
2020-06-09 23:22:05,305:  >> betas= (0.9, 0.999)
2020-06-09 23:22:05,305:  >> eps= 1e-08
2020-06-09 23:22:05,305:  >> weight_decay= 0
2020-06-09 23:22:05,305:  >> amsgrad= False
2020-06-09 23:22:05,305:  >> min_lr= 1e-07
2020-06-09 23:22:05,306: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-09 23:22:05,336: Building sched from config
2020-06-09 23:22:05,337:  >> optim= Adam
2020-06-09 23:22:05,337:  >> decay lr by 0.1
2020-06-09 23:22:05,337:  >> eval_fn= MultiViewAP
2020-06-09 23:22:05,338:  >> patience=4
2020-06-09 23:22:05,338:  >> revert=True
2020-06-09 23:22:05,384: loaded save/MultiViewDataset_IndividualWords.975.pth
2020-06-09 23:22:05,384: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 23:22:06,603: loaded save/MultiViewRNN.975.pth
2020-06-09 23:22:06,603: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 23:22:08,875: loaded save/Adam.975.pth
2020-06-09 23:22:08,875: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 23:22:08,882: loaded save/ReduceLROnPlateau.975.pth
2020-06-09 23:22:08,882: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-09 23:22:08,882: epoch=25.00 global_step=975 lr=0.001 start_iter=0
2020-06-09 23:22:08,882: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 23:24:14,943: 0) loss=0.042 grad_norm=3.23 num_segments=256 num_words=212
2020-06-09 23:26:00,207: 1) loss=0.049 grad_norm=7.84 num_segments=256 num_words=198
                                                                                     2020-06-09 23:27:39,279: 2) loss=0.047 grad_norm=3.69 num_segments=256 num_words=210
2020-06-09 23:29:10,875: 3) loss=0.050 grad_norm=9.85 num_segments=256 num_words=223
2020-06-09 23:30:36,111: 4) loss=0.048 grad_norm=4.16 num_segments=256 num_words=211
                                                                                     2020-06-09 23:31:55,034: 5) loss=0.060 grad_norm=9.14 num_segments=256 num_words=220
2020-06-09 23:33:05,280: 6) loss=0.070 grad_norm=5.95 num_segments=256 num_words=205
2020-06-09 23:34:05,450: 7) loss=0.071 grad_norm=7.37 num_segments=256 num_words=211
2020-06-09 23:35:07,500: 8) loss=0.069 grad_norm=8.52 num_segments=256 num_words=206
2020-06-09 23:36:07,444: 9) loss=0.069 grad_norm=5.82 num_segments=256 num_words=211
                                                                                     2020-06-09 23:37:08,683: 10) loss=0.075 grad_norm=7.91 num_segments=256 num_words=203
                                                                                     2020-06-09 23:38:08,097: 11) loss=0.075 grad_norm=8.62 num_segments=256 num_words=222
2020-06-09 23:39:08,655: 12) loss=0.075 grad_norm=7.89 num_segments=256 num_words=208
                                                                                     2020-06-09 23:40:12,382: 13) loss=0.064 grad_norm=7.45 num_segments=256 num_words=200
                                                                                     2020-06-09 23:41:18,221: 14) loss=0.073 grad_norm=11.72 num_segments=256 num_words=217
2020-06-09 23:42:20,170: 15) loss=0.078 grad_norm=6.49 num_segments=256 num_words=226
                                                                                      2020-06-09 23:43:22,557: 16) loss=0.068 grad_norm=5.13 num_segments=256 num_words=202
                                                                                      2020-06-09 23:44:25,923: 17) loss=0.077 grad_norm=5.45 num_segments=256 num_words=201
2020-06-09 23:45:27,820: 18) loss=0.075 grad_norm=8.82 num_segments=256 num_words=217
2020-06-09 23:46:34,021: 19) loss=0.073 grad_norm=5.03 num_segments=256 num_words=206
                                                                                      2020-06-09 23:47:35,653: 20) loss=0.073 grad_norm=9.24 num_segments=256 num_words=202
2020-06-09 23:48:37,719: 21) loss=0.070 grad_norm=6.46 num_segments=256 num_words=215
 2020-06-09 23:49:39,303: 22) loss=0.084 grad_norm=5.17 num_segments=256 num_words=211
                                                                                      2020-06-09 23:50:41,483: 23) loss=0.078 grad_norm=9.94 num_segments=256 num_words=204
                                                                                      2020-06-09 23:51:49,877: 24) loss=0.070 grad_norm=9.13 num_segments=256 num_words=204
2020-06-09 23:52:53,597: 25) loss=0.071 grad_norm=4.40 num_segments=256 num_words=219
2020-06-09 23:53:56,926: 26) loss=0.073 grad_norm=6.78 num_segments=256 num_words=206
                                                                                      2020-06-09 23:54:59,035: 27) loss=0.146 grad_norm=10.45 num_segments=256 num_words=212
2020-06-09 23:56:02,405: 28) loss=0.072 grad_norm=9.69 num_segments=256 num_words=215
2020-06-09 23:57:03,653: 29) loss=0.081 grad_norm=6.18 num_segments=256 num_words=214
                                                                                      2020-06-09 23:58:05,563: 30) loss=0.086 grad_norm=16.39 num_segments=256 num_words=213
                                                                                      2020-06-09 23:59:14,664: 31) loss=0.080 grad_norm=9.83 num_segments=256 num_words=204
                                                                                      2020-06-10 00:00:16,108: 32) loss=0.070 grad_norm=8.70 num_segments=256 num_words=208
2020-06-10 00:01:18,678: 33) loss=0.071 grad_norm=5.75 num_segments=256 num_words=218
                                                                                      2020-06-10 00:02:20,797: 34) loss=0.075 grad_norm=10.69 num_segments=256 num_words=209
                                                                                      2020-06-10 00:03:22,513: 35) loss=0.074 grad_norm=9.24 num_segments=256 num_words=202
2020-06-10 00:04:24,867: 36) loss=0.075 grad_norm=11.24 num_segments=256 num_words=212
                                                                                      2020-06-10 00:05:26,257: 37) loss=0.076 grad_norm=7.54 num_segments=256 num_words=219
                                                                                      2020-06-10 00:06:23,620: 38) loss=0.078 grad_norm=21.64 num_segments=243 num_words=206
2020-06-10 00:06:23,640: epoch= 26.00
2020-06-10 00:06:23,640:  >> time to evaluate and save:
2020-06-10 00:06:23,693: saved save/MultiViewDataset_IndividualWords.1014.pth
2020-06-10 00:06:23,701: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 00:06:23,718: removed save/MultiViewDataset_IndividualWords.780.pth
2020-06-10 00:06:23,718: saved MultiViewDataset_IndividualWords successfully
2020-06-10 00:06:25,050: saved save/MultiViewRNN.1014.pth
2020-06-10 00:06:25,061: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 00:06:25,430: removed save/MultiViewRNN.780.pth
2020-06-10 00:06:25,430: saved MultiViewRNN successfully
2020-06-10 00:06:27,938: saved save/Adam.1014.pth
2020-06-10 00:06:27,957: most_recent linked save/Adam.most_recent.pth
2020-06-10 00:06:28,308: removed save/Adam.780.pth
2020-06-10 00:06:28,308: saved Adam successfully
2020-06-10 00:06:28,310: saved save/ReduceLROnPlateau.1014.pth
2020-06-10 00:06:28,319: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 00:06:28,369: removed save/ReduceLROnPlateau.741.pth
2020-06-10 00:06:28,369: saved ReduceLROnPlateau successfully
2020-06-10 00:06:28,370: saved config successfully
2020-06-10 00:07:48,989:   >> crossview_ap=0.699 (10966 x 3921 pairs)
                 2020-06-10 00:08:40,492:   >> acoustic_ap=0.750 (10966 choose 2 pairs)
2020-06-10 00:08:40,494: best_so_far= 0.699 at 1014
2020-06-10 00:08:40,519: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 00:08:40,522: saved MultiViewDataset_IndividualWords successfully
2020-06-10 00:08:40,542: best linked save/MultiViewRNN.best.pth
2020-06-10 00:08:40,551: saved MultiViewRNN successfully
2020-06-10 00:08:40,578: best linked save/Adam.best.pth
2020-06-10 00:08:40,587: saved Adam successfully
2020-06-10 00:08:40,591: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 00:08:40,598: saved ReduceLROnPlateau successfully
2020-06-10 00:08:40,648: epoch=26.00 global_step=1014 lr=0.001 start_iter=0
2020-06-10 00:08:40,648: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
                                                                                      2020-06-10 00:09:44,475: 0) loss=0.072 grad_norm=7.72 num_segments=256 num_words=213
2020-06-10 00:10:56,804: 1) loss=0.073 grad_norm=4.22 num_segments=256 num_words=211
 2020-06-10 00:11:58,707: 2) loss=0.071 grad_norm=10.46 num_segments=256 num_words=214
 2020-06-10 00:13:01,496: 3) loss=0.086 grad_norm=8.98 num_segments=256 num_words=205
2020-06-10 00:14:04,185: 4) loss=0.071 grad_norm=6.76 num_segments=256 num_words=210
 2020-06-10 00:15:07,495: 5) loss=0.079 grad_norm=10.76 num_segments=256 num_words=211
2020-06-10 00:16:09,378: 6) loss=0.076 grad_norm=7.72 num_segments=256 num_words=220
                                                                                      2020-06-10 00:17:11,011: 7) loss=0.070 grad_norm=7.97 num_segments=256 num_words=218
                                                                                       2020-06-10 00:18:12,917: 8) loss=0.071 grad_norm=10.56 num_segments=256 num_words=202
2020-06-10 00:19:15,290: 9) loss=0.076 grad_norm=6.97 num_segments=256 num_words=210
                                                                                      2020-06-10 00:20:17,248: 10) loss=0.069 grad_norm=3.70 num_segments=256 num_words=210
                                                                                       2020-06-10 00:21:19,541: 11) loss=0.068 grad_norm=4.89 num_segments=256 num_words=207
2020-06-10 00:22:32,490: 12) loss=0.068 grad_norm=7.82 num_segments=256 num_words=206
2020-06-10 00:23:34,410: 13) loss=0.092 grad_norm=14.62 num_segments=256 num_words=210
                                                                                                                                                                                                                                                                                                                                                                                                      2020-06-10 00:24:37,210: 14) loss=0.071 grad_norm=4.32 num_segments=256 num_words=207
2020-06-10 00:25:39,045: 15) loss=0.074 grad_norm=5.26 num_segments=256 num_words=206
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 2020-06-10 00:26:40,851: 16) loss=0.076 grad_norm=10.09 num_segments=256 num_words=217
                                                                         2020-06-10 00:27:42,996: 17) loss=0.073 grad_norm=6.61 num_segments=256 num_words=203
                                                                                     2020-06-10 00:28:52,560: 18) loss=0.076 grad_norm=8.54 num_segments=256 num_words=209
2020-06-10 00:29:58,606: 19) loss=0.068 grad_norm=7.16 num_segments=256 num_words=203
                                                                                      2020-06-10 00:31:02,492: 20) loss=0.133 grad_norm=10.13 num_segments=256 num_words=217
2020-06-10 00:32:06,609: 21) loss=0.082 grad_norm=7.91 num_segments=256 num_words=207
                                                                                     2020-06-10 00:33:10,313: 22) loss=0.072 grad_norm=4.09 num_segments=256 num_words=216
                                                                                     2020-06-10 00:34:13,651: 23) loss=0.071 grad_norm=4.62 num_segments=256 num_words=208
2020-06-10 00:35:17,004: 24) loss=0.076 grad_norm=7.51 num_segments=256 num_words=207
2020-06-10 00:36:20,982: 25) loss=0.077 grad_norm=7.75 num_segments=256 num_words=206
2020-06-10 00:36:44,875: 6) loss=0.076 grad_norm=7.72 num_segments=256 num_words=220
                                                                                      2020-06-10 00:38:12,402: 7) loss=0.070 grad_norm=7.97 num_segments=256 num_words=218
 2020-06-10 00:39:40,338: 8) loss=0.071 grad_norm=10.56 num_segments=256 num_words=202
                                                                                                                                                                            2020-06-10 00:41:07,758: 9) loss=0.076 grad_norm=6.97 num_segments=256 num_words=210
                                                                                      2020-06-10 00:42:35,270: 10) loss=0.069 grad_norm=3.70 num_segments=256 num_words=210
                                                                                      2020-06-10 00:44:02,908: 11) loss=0.068 grad_norm=4.89 num_segments=256 num_words=207
                                                                                      2020-06-10 00:45:40,920: 12) loss=0.068 grad_norm=7.82 num_segments=256 num_words=206
2020-06-10 00:47:08,540: 13) loss=0.092 grad_norm=14.62 num_segments=256 num_words=210
                                                                                                                                                                            2020-06-10 00:48:36,230: 14) loss=0.071 grad_norm=4.32 num_segments=256 num_words=207
                                                                                      2020-06-10 00:50:04,226: 15) loss=0.074 grad_norm=5.26 num_segments=256 num_words=206
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     2020-06-10 00:51:32,909: 16) loss=0.076 grad_norm=10.09 num_segments=256 num_words=217
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       2020-06-10 00:53:00,629: 17) loss=0.073 grad_norm=6.61 num_segments=256 num_words=203
                                                                                     2020-06-10 00:54:28,798: 18) loss=0.076 grad_norm=8.54 num_segments=256 num_words=209
2020-06-10 00:54:45,485: 1) loss=0.073 grad_norm=3.00 num_segments=256 num_words=208
2020-06-10 00:55:49,674: 2) loss=0.069 grad_norm=6.42 num_segments=256 num_words=206
 2020-06-10 00:56:54,281: 3) loss=0.129 grad_norm=6.75 num_segments=256 num_words=201
                                                                                       2020-06-10 00:58:01,111: 4) loss=0.076 grad_norm=5.60 num_segments=256 num_words=206
                                                                                      2020-06-10 00:59:26,036: 5) loss=0.069 grad_norm=4.92 num_segments=256 num_words=215
                                                                                      2020-06-10 01:00:30,162: 6) loss=0.070 grad_norm=5.40 num_segments=256 num_words=207
2020-06-10 01:01:33,832: 7) loss=0.078 grad_norm=10.49 num_segments=256 num_words=213
2020-06-10 01:02:38,372: 8) loss=0.070 grad_norm=6.67 num_segments=256 num_words=213
2020-06-10 01:03:43,617: 9) loss=0.073 grad_norm=3.52 num_segments=256 num_words=213
 2020-06-10 01:04:47,482: 10) loss=0.072 grad_norm=6.20 num_segments=256 num_words=218
2020-06-10 01:05:52,824: 11) loss=0.079 grad_norm=5.70 num_segments=256 num_words=211
2020-06-10 01:06:57,293: 12) loss=0.136 grad_norm=6.98 num_segments=256 num_words=209
2020-06-10 01:08:01,799: 13) loss=0.074 grad_norm=7.22 num_segments=256 num_words=211
2020-06-10 01:09:06,489: 14) loss=0.074 grad_norm=6.37 num_segments=256 num_words=215
                                                                                      2020-06-10 01:10:12,284: 15) loss=0.066 grad_norm=6.32 num_segments=256 num_words=200
2020-06-10 01:11:16,227: 16) loss=0.075 grad_norm=19.56 num_segments=256 num_words=214
2020-06-10 01:12:18,653: 17) loss=0.074 grad_norm=5.24 num_segments=256 num_words=222
2020-06-10 01:13:21,020: 18) loss=0.072 grad_norm=6.68 num_segments=256 num_words=215
                                                                                      2020-06-10 01:14:22,902: 19) loss=0.070 grad_norm=10.70 num_segments=256 num_words=205
2020-06-10 01:15:25,088: 20) loss=0.073 grad_norm=9.06 num_segments=256 num_words=207
2020-06-10 01:16:27,303: 21) loss=0.070 grad_norm=8.37 num_segments=256 num_words=206
2020-06-10 01:17:29,303: 22) loss=0.071 grad_norm=16.90 num_segments=256 num_words=211
2020-06-10 01:18:31,625: 23) loss=0.093 grad_norm=7.83 num_segments=256 num_words=221
2020-06-10 01:19:33,666: 24) loss=0.073 grad_norm=6.21 num_segments=256 num_words=211
                                                                                      2020-06-10 01:20:35,739: 25) loss=0.076 grad_norm=5.64 num_segments=256 num_words=204
2020-06-10 01:21:59,777: 26) loss=0.071 grad_norm=6.73 num_segments=256 num_words=206
2020-06-10 01:23:01,939: 27) loss=0.076 grad_norm=11.18 num_segments=256 num_words=216
2020-06-10 01:24:04,545: 28) loss=0.076 grad_norm=7.14 num_segments=256 num_words=213
                                                                                                                                                                                                                                                                                                                                                                                                      2020-06-10 01:25:06,694: 29) loss=0.081 grad_norm=6.53 num_segments=256 num_words=214
                                                                      2020-06-10 01:26:09,295: 30) loss=0.075 grad_norm=7.76 num_segments=256 num_words=213
6:20,437: best_so_far= 0.701 at 1053
2020-06-10 01:26:20,512: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 01:26:20,517: saved MultiViewDataset_IndividualWords successfully
2020-06-10 01:26:20,597: best linked save/MultiViewRNN.best.pth
2020-06-10 01:26:20,611: saved MultiViewRNN successfully
2020-06-10 01:26:20,657: best linked save/Adam.best.pth
2020-06-10 01:26:20,663: saved Adam successfully
2020-06-10 01:26:20,673: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 01:26:20,677: saved ReduceLROnPlateau successfully
2020-06-10 01:26:21,367: epoch=27.00 global_step=1053 lr=0.001 start_iter=0
2020-06-10 01:26:21,367: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
                                                                                      2020-06-10 01:27:51,359: 0) loss=0.136 grad_norm=7.01 num_segments=256 num_words=211
                                                                                         2020-06-10 01:29:19,845: 1) loss=0.073 grad_norm=3.00 num_segments=256 num_words=208
2020-06-10 01:30:48,007: 2) loss=0.069 grad_norm=6.42 num_segments=256 num_words=206
                                                                                       2020-06-10 01:32:19,294: 3) loss=0.129 grad_norm=6.75 num_segments=256 num_words=201
 2020-06-10 01:33:53,005: 4) loss=0.076 grad_norm=5.60 num_segments=256 num_words=206
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            2020-06-10 01:35:51,336: 5) loss=0.069 grad_norm=4.92 num_segments=256 num_words=215
                                                                                                                                                                                                                                                                                           2020-06-10 01:37:26,862: 6) loss=0.070 grad_norm=5.40 num_segments=256 num_words=207
                                                                                     2020-06-10 01:39:04,125: 7) loss=0.078 grad_norm=10.49 num_segments=256 num_words=213
                                                                                     2020-06-10 01:40:43,911: 8) loss=0.070 grad_norm=6.67 num_segments=256 num_words=213
                                                                                      2020-06-10 01:42:23,337: 9) loss=0.073 grad_norm=3.52 num_segments=256 num_words=213
                                                                                     2020-06-10 01:43:59,678: 10) loss=0.072 grad_norm=6.20 num_segments=256 num_words=218
                                                                                      2020-06-10 01:45:36,309: 11) loss=0.079 grad_norm=5.70 num_segments=256 num_words=211
                                                                                     2020-06-10 01:47:13,477: 12) loss=0.136 grad_norm=6.98 num_segments=256 num_words=209
                                                                                     2020-06-10 01:48:50,407: 13) loss=0.074 grad_norm=7.22 num_segments=256 num_words=211
2020-06-10 01:50:27,668: 14) loss=0.074 grad_norm=6.37 num_segments=256 num_words=215
                                                                                       2020-06-10 01:52:04,481: 15) loss=0.066 grad_norm=6.32 num_segments=256 num_words=200
2020-06-10 01:52:46,633: 12) loss=0.073 grad_norm=7.43 num_segments=256 num_words=214
2020-06-10 01:53:58,058: 13) loss=0.070 grad_norm=6.09 num_segments=256 num_words=208
 2020-06-10 01:55:46,645: 14) loss=0.068 grad_norm=8.31 num_segments=256 num_words=215
2020-06-10 01:56:57,648: 15) loss=0.069 grad_norm=6.28 num_segments=256 num_words=205
2020-06-10 01:58:08,832: 16) loss=0.153 grad_norm=7.27 num_segments=256 num_words=209
                                                                                       2020-06-10 01:59:20,034: 17) loss=0.067 grad_norm=8.29 num_segments=256 num_words=208
2020-06-10 02:00:35,453: 18) loss=0.069 grad_norm=3.82 num_segments=256 num_words=214
2020-06-10 02:01:48,508: 19) loss=0.072 grad_norm=7.14 num_segments=256 num_words=201
2020-06-10 02:02:58,693: 20) loss=0.076 grad_norm=7.00 num_segments=256 num_words=231
                                                                                       2020-06-10 02:04:08,645: 21) loss=0.077 grad_norm=11.43 num_segments=256 num_words=203
2020-06-10 02:05:18,752: 22) loss=0.070 grad_norm=9.08 num_segments=256 num_words=209
2020-06-10 02:06:37,874: 23) loss=0.074 grad_norm=8.30 num_segments=256 num_words=203
2020-06-10 02:07:47,411: 24) loss=0.070 grad_norm=7.93 num_segments=256 num_words=213
                                                                                      2020-06-10 02:08:57,944: 25) loss=0.072 grad_norm=7.35 num_segments=256 num_words=211
2020-06-10 02:10:08,192: 26) loss=0.139 grad_norm=6.85 num_segments=256 num_words=217
2020-06-10 02:11:17,988: 27) loss=0.081 grad_norm=13.05 num_segments=256 num_words=216
2020-06-10 02:12:28,168: 28) loss=0.074 grad_norm=5.78 num_segments=256 num_words=213
 2020-06-10 02:13:37,652: 29) loss=0.089 grad_norm=6.36 num_segments=256 num_words=202
2020-06-10 02:14:47,528: 30) loss=0.071 grad_norm=12.01 num_segments=256 num_words=208
                                                                                      2020-06-10 02:15:57,157: 31) loss=0.080 grad_norm=10.55 num_segments=256 num_words=217
2020-06-10 02:17:06,956: 32) loss=0.080 grad_norm=8.44 num_segments=256 num_words=213
2020-06-10 02:18:18,214: 33) loss=0.069 grad_norm=8.17 num_segments=256 num_words=213
2020-06-10 02:19:28,360: 34) loss=0.073 grad_norm=6.57 num_segments=256 num_words=207
2020-06-10 02:20:38,507: 35) loss=0.074 grad_norm=7.30 num_segments=256 num_words=217
 2020-06-10 02:21:48,212: 36) loss=0.071 grad_norm=7.17 num_segments=256 num_words=209
 2020-06-10 02:22:58,098: 37) loss=0.077 grad_norm=12.60 num_segments=256 num_words=211
2020-06-10 02:24:01,230: 38) loss=0.072 grad_norm=9.15 num_segments=243 num_words=202
2020-06-10 02:24:01,241: epoch= 29.00
2020-06-10 02:24:01,241:  >> time to evaluate and save:
2020-06-10 02:24:01,288: saved save/MultiViewDataset_IndividualWords.1131.pth
2020-06-10 02:24:01,294: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 02:24:01,318: removed save/MultiViewDataset_IndividualWords.897.pth
2020-06-10 02:24:01,318: saved MultiViewDataset_IndividualWords successfully
2020-06-10 02:24:02,655: saved save/MultiViewRNN.1131.pth
2020-06-10 02:24:02,674: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 02:24:02,744: removed save/MultiViewRNN.897.pth
2020-06-10 02:24:02,744: saved MultiViewRNN successfully
2020-06-10 02:24:05,217: saved save/Adam.1131.pth
2020-06-10 02:24:05,228: most_recent linked save/Adam.most_recent.pth
2020-06-10 02:24:05,298: removed save/Adam.897.pth
2020-06-10 02:24:05,298: saved Adam successfully
2020-06-10 02:24:05,301: saved save/ReduceLROnPlateau.1131.pth
2020-06-10 02:24:05,322: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 02:24:05,335: removed save/ReduceLROnPlateau.897.pth
2020-06-10 02:24:05,335: saved ReduceLROnPlateau successfully
2020-06-10 02:24:05,337: saved config successfully
                                                                                      2020-06-10 02:25:38,582:   >> crossview_ap=0.701 (10966 x 3921 pairs)
2020-06-10 02:26:33,584: 36) loss=0.073 grad_norm=6.05 num_segments=256 num_words=204
6:40,842: best_so_far= 0.701 at 1053
2020-06-10 02:26:41,874: epoch=29.00 global_step=1131 lr=0.001 start_iter=0
2020-06-10 02:26:41,874: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 02:27:54,166: 0) loss=0.078 grad_norm=6.27 num_segments=256 num_words=208
                                                                                      2020-06-10 02:29:03,881: 1) loss=0.077 grad_norm=5.06 num_segments=256 num_words=218
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            2020-06-10 02:30:14,385: 2) loss=0.084 grad_norm=7.44 num_segments=256 num_words=208
2020-06-10 02:31:33,905: 3) loss=0.083 grad_norm=6.85 num_segments=256 num_words=210
2020-06-10 02:32:44,666: 4) loss=0.081 grad_norm=10.35 num_segments=256 num_words=225
                                                                                                                                                                                                                                                                                           2020-06-10 02:33:54,652: 5) loss=0.070 grad_norm=3.56 num_segments=256 num_words=208
                                                                                     2020-06-10 02:35:04,525: 6) loss=0.084 grad_norm=5.71 num_segments=256 num_words=201
2020-06-10 02:36:14,714: 7) loss=0.073 grad_norm=5.01 num_segments=256 num_words=203
2020-06-10 02:37:24,855: 8) loss=0.077 grad_norm=8.08 num_segments=256 num_words=212
2020-06-10 02:39:22,795: 9) loss=0.067 grad_norm=6.05 num_segments=256 num_words=209
 2020-06-10 02:40:41,995: 10) loss=0.069 grad_norm=4.36 num_segments=256 num_words=216
2020-06-10 02:42:15,448: 11) loss=0.073 grad_norm=5.59 num_segments=256 num_words=217
                                                                                      2020-06-10 02:43:27,135: 12) loss=0.073 grad_norm=7.67 num_segments=256 num_words=210
2020-06-10 02:44:37,041: 13) loss=0.067 grad_norm=4.31 num_segments=256 num_words=220
2020-06-10 02:45:46,768: 14) loss=0.074 grad_norm=5.14 num_segments=256 num_words=209
2020-06-10 02:46:56,324: 15) loss=0.068 grad_norm=5.33 num_segments=256 num_words=209
                                                                                     2020-06-10 02:48:06,477: 16) loss=0.079 grad_norm=9.45 num_segments=256 num_words=216
2020-06-10 02:49:16,244: 17) loss=0.074 grad_norm=8.71 num_segments=256 num_words=205
2020-06-10 02:50:26,328: 18) loss=0.068 grad_norm=8.17 num_segments=256 num_words=212
2020-06-10 02:51:36,070: 19) loss=0.068 grad_norm=9.78 num_segments=256 num_words=208
2020-06-10 02:52:45,797: 20) loss=0.133 grad_norm=12.27 num_segments=256 num_words=211
2020-06-10 02:53:55,553: 21) loss=0.071 grad_norm=4.93 num_segments=256 num_words=206
2020-06-10 02:55:05,413: 22) loss=0.077 grad_norm=7.56 num_segments=256 num_words=215
2020-06-10 02:56:31,683: 23) loss=0.076 grad_norm=5.09 num_segments=256 num_words=212
2020-06-10 02:57:58,036: 24) loss=0.071 grad_norm=12.66 num_segments=256 num_words=208
2020-06-10 02:59:10,958: 25) loss=0.068 grad_norm=6.91 num_segments=256 num_words=210
2020-06-10 03:00:32,019: 26) loss=0.072 grad_norm=7.03 num_segments=256 num_words=216
                                                                                      2020-06-10 03:01:42,265: 27) loss=0.080 grad_norm=4.95 num_segments=256 num_words=216
2020-06-10 03:02:51,945: 28) loss=0.072 grad_norm=5.16 num_segments=256 num_words=214
2020-06-10 03:04:01,776: 29) loss=0.071 grad_norm=4.20 num_segments=256 num_words=214
                                                                                      2020-06-10 03:05:13,827: 30) loss=0.075 grad_norm=5.33 num_segments=256 num_words=204
                                                                                      2020-06-10 03:06:40,923: 31) loss=0.066 grad_norm=5.59 num_segments=256 num_words=210
                                                                                      2020-06-10 03:08:07,729: 32) loss=0.067 grad_norm=6.09 num_segments=256 num_words=203
2020-06-10 03:09:31,942: 33) loss=0.065 grad_norm=6.18 num_segments=256 num_words=209
 2020-06-10 03:10:42,301: 34) loss=0.069 grad_norm=8.37 num_segments=256 num_words=214
2020-06-10 03:11:52,116: 35) loss=0.075 grad_norm=4.82 num_segments=256 num_words=208
                                                                                      2020-06-10 03:13:01,854: 36) loss=0.071 grad_norm=5.29 num_segments=256 num_words=208
2020-06-10 03:14:12,990: 37) loss=0.074 grad_norm=8.11 num_segments=256 num_words=212
2020-06-10 03:15:16,527: 38) loss=0.077 grad_norm=5.52 num_segments=243 num_words=196
2020-06-10 03:15:16,539: epoch= 30.00
2020-06-10 03:15:16,540:  >> time to evaluate and save:
2020-06-10 03:15:16,582: saved save/MultiViewDataset_IndividualWords.1170.pth
2020-06-10 03:15:16,627: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 03:15:16,652: removed save/MultiViewDataset_IndividualWords.936.pth
2020-06-10 03:15:16,652: saved MultiViewDataset_IndividualWords successfully
2020-06-10 03:15:18,042: saved save/MultiViewRNN.1170.pth
2020-06-10 03:15:18,072: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 03:15:18,121: removed save/MultiViewRNN.936.pth
2020-06-10 03:15:18,122: saved MultiViewRNN successfully
2020-06-10 03:15:20,612: saved save/Adam.1170.pth
2020-06-10 03:15:20,628: most_recent linked save/Adam.most_recent.pth
2020-06-10 03:15:20,678: removed save/Adam.936.pth
2020-06-10 03:15:20,678: saved Adam successfully
2020-06-10 03:15:20,680: saved save/ReduceLROnPlateau.1170.pth
2020-06-10 03:15:20,695: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 03:15:20,725: removed save/ReduceLROnPlateau.936.pth
2020-06-10 03:15:20,725: saved ReduceLROnPlateau successfully
2020-06-10 03:15:20,726: saved config successfully
                                                                                      2020-06-10 03:17:02,617:   >> crossview_ap=0.706 (10966 x 3921 pairs)
                2020-06-10 03:18:05,825:   >> acoustic_ap=0.750 (10966 choose 2 pairs)
2020-06-10 03:18:05,831: best_so_far= 0.706 at 1170
2020-06-10 03:18:05,961: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 03:18:05,965: saved MultiViewDataset_IndividualWords successfully
2020-06-10 03:18:06,003: best linked save/MultiViewRNN.best.pth
2020-06-10 03:18:06,020: saved MultiViewRNN successfully
2020-06-10 03:18:06,030: best linked save/Adam.best.pth
2020-06-10 03:18:06,039: saved Adam successfully
2020-06-10 03:18:06,050: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 03:18:06,056: saved ReduceLROnPlateau successfully
2020-06-10 03:18:07,324: epoch=30.00 global_step=1170 lr=0.001 start_iter=0
2020-06-10 03:18:07,325: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 03:19:20,401: 0) loss=0.067 grad_norm=10.39 num_segments=256 num_words=219
 2020-06-10 03:20:33,667: 28) loss=0.074 grad_norm=5.78 num_segments=256 num_words=213
2020-06-10 05:12:58,758: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-10 05:12:58,839: Using 1 GPU(s)
2020-06-10 05:12:58,839: Machine: 0 / 1
2020-06-10 05:12:58,859: Hyperparam tuning-------------------
2020-06-10 05:12:58,859: optim_lr: 0.001
2020-06-10 05:12:58,859: dropout (for both): 0.4
2020-06-10 05:12:58,859: margin: 0.4
2020-06-10 05:12:58,859: ------------------------------------
2020-06-10 05:12:58,861: Calling main function: multiview_trainer.train
2020-06-10 05:12:58,861: Using config file: train_config.json
2020-06-10 05:12:58,861: Using module at multiview_trainer.train
2020-06-10 05:13:00,033: Using module at multiview_vocab.MultiViewVocab
2020-06-10 05:13:00,037: Building vocab_data from config
2020-06-10 05:13:00,323:  >> min_count= 0
2020-06-10 05:13:00,323:  >> # words= 34323 (# removed= 0)
2020-06-10 05:13:00,323:  >> # subwords= 45
2020-06-10 05:13:00,323:     [laughter]= 1
2020-06-10 05:13:00,323:     [noise]= 2
2020-06-10 05:13:00,324:     [vocalized-noise]= 3
2020-06-10 05:13:00,324:     aa= 4
2020-06-10 05:13:00,324:     ae= 5
2020-06-10 05:13:00,324:     ah= 6
2020-06-10 05:13:00,324:     ao= 7
2020-06-10 05:13:00,324:     aw= 8
2020-06-10 05:13:00,324:     ax= 9
2020-06-10 05:13:00,324:     ay= 10
2020-06-10 05:13:00,324:     b= 11
2020-06-10 05:13:00,324:     ch= 12
2020-06-10 05:13:00,324:     d= 13
2020-06-10 05:13:00,324:     dh= 14
2020-06-10 05:13:00,324:     eh= 15
2020-06-10 05:13:00,324:     el= 16
2020-06-10 05:13:00,324:     en= 17
2020-06-10 05:13:00,324:     er= 18
2020-06-10 05:13:00,324:     ey= 19
2020-06-10 05:13:00,325:     f= 20
2020-06-10 05:13:00,325:     g= 21
2020-06-10 05:13:00,325:     hh= 22
2020-06-10 05:13:00,325:     ih= 23
2020-06-10 05:13:00,325:     iy= 24
2020-06-10 05:13:00,325:     jh= 25
2020-06-10 05:13:00,325:     k= 26
2020-06-10 05:13:00,325:     l= 27
2020-06-10 05:13:00,325:     m= 28
2020-06-10 05:13:00,325:     n= 29
2020-06-10 05:13:00,325:     ng= 30
2020-06-10 05:13:00,325:     ow= 31
2020-06-10 05:13:00,325:     oy= 32
2020-06-10 05:13:00,325:     p= 33
2020-06-10 05:13:00,325:     r= 34
2020-06-10 05:13:00,325:     s= 35
2020-06-10 05:13:00,325:     sh= 36
2020-06-10 05:13:00,325:     t= 37
2020-06-10 05:13:00,326:     th= 38
2020-06-10 05:13:00,326:     uh= 39
2020-06-10 05:13:00,326:     uw= 40
2020-06-10 05:13:00,326:     v= 41
2020-06-10 05:13:00,326:     w= 42
2020-06-10 05:13:00,326:     y= 43
2020-06-10 05:13:00,326:     z= 44
2020-06-10 05:13:00,326:     zh= 45
2020-06-10 05:13:00,342: Using module at data.batch_samplers.BatchSampler
2020-06-10 05:13:00,344: Building vocab_sampler from config
2020-06-10 05:13:00,345:  >> # examples= 34323
2020-06-10 05:13:00,345:  >> batch_size= 1000
2020-06-10 05:13:00,345:  >> shuffle= False
2020-06-10 05:13:00,353:  >> BatchSampler; 35 batches
2020-06-10 05:13:00,353: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 05:13:00,983: Building train_data from config
2020-06-10 05:13:07,972:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-10 05:13:07,973:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-10 05:13:07,973:  >> stack= False
2020-06-10 05:13:07,973:  >> seg_durs= (1, None)
2020-06-10 05:13:07,973:  >> # words= 9971 (# ignored= 0)
2020-06-10 05:13:07,973:  >> input_feat_dim= 108
2020-06-10 05:13:07,973:  >> input_num_subwords= 45
2020-06-10 05:13:07,973: Using module at data.batch_samplers.BatchSampler
2020-06-10 05:13:07,974: Building train_sampler from config
2020-06-10 05:13:07,974:  >> # examples= 9971
2020-06-10 05:13:07,974:  >> batch_size= 256
2020-06-10 05:13:07,974:  >> shuffle= True
2020-06-10 05:13:07,982:  >> BatchSampler; 39 batches
2020-06-10 05:13:07,982: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 05:13:07,982: Building dev_data from config
2020-06-10 05:13:16,048:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 05:13:16,049:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 05:13:16,049:  >> stack= False
2020-06-10 05:13:16,049:  >> seg_durs= (1, None)
2020-06-10 05:13:16,049:  >> # words= 10966 (# ignored= 0)
2020-06-10 05:13:16,049:  >> input_feat_dim= 108
2020-06-10 05:13:16,049:  >> input_num_subwords= 45
2020-06-10 05:13:16,049: Using module at data.batch_samplers.BatchSampler
2020-06-10 05:13:16,050: Building dev_sampler from config
2020-06-10 05:13:16,050:  >> # examples= 10966
2020-06-10 05:13:16,050:  >> batch_size= 256
2020-06-10 05:13:16,050:  >> shuffle= False
2020-06-10 05:13:16,053:  >> BatchSampler; 43 batches
2020-06-10 05:13:16,053: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 05:13:16,053: Building test_data from config
2020-06-10 05:13:23,343:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 05:13:23,344:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 05:13:23,344:  >> stack= False
2020-06-10 05:13:23,344:  >> seg_durs= (1, None)
2020-06-10 05:13:23,344:  >> # words= 11024 (# ignored= 0)
2020-06-10 05:13:23,344:  >> input_feat_dim= 108
2020-06-10 05:13:23,344:  >> input_num_subwords= 45
2020-06-10 05:13:23,344: Using module at data.batch_samplers.BatchSampler
2020-06-10 05:13:23,344: Building test_sampler from config
2020-06-10 05:13:23,345:  >> # examples= 11024
2020-06-10 05:13:23,345:  >> batch_size= 256
2020-06-10 05:13:23,345:  >> shuffle= False
2020-06-10 05:13:23,347:  >> BatchSampler; 44 batches
2020-06-10 05:13:23,347: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-10 05:13:23,352: Building loss from config
2020-06-10 05:13:23,353:  >> margin= 0.4
2020-06-10 05:13:23,353:  >> k= 16
2020-06-10 05:13:23,353:  >> min_k= 8
2020-06-10 05:13:23,353:  >> extra= 0
2020-06-10 05:13:23,353:  >> average= False
2020-06-10 05:13:23,353:  >> margin_max= 0.5
2020-06-10 05:13:23,353:  >> threshold_max= 9
2020-06-10 05:13:23,353:  >> using obj0
2020-06-10 05:13:23,354: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 05:13:23,379: Building eval from config
2020-06-10 05:13:23,379:  >> acoustic_ap= True
2020-06-10 05:13:23,380:  >> crossview_ap= True
2020-06-10 05:13:23,380:  >> full_vocab= False
2020-06-10 05:13:23,380:  >> metric= crossview_ap
2020-06-10 05:13:23,380:  >> mode= max
2020-06-10 05:13:23,380: Using module at multiview_rnn.MultiViewRNN
2020-06-10 05:13:23,387: Building net from config
2020-06-10 05:13:23,388: view1:
2020-06-10 05:13:23,389:  >> cell= GRU
2020-06-10 05:13:23,389:  >> input_size= 108
2020-06-10 05:13:23,389:  >> hidden_size= 512
2020-06-10 05:13:23,389:  >> bidirectional= True
2020-06-10 05:13:23,389:  >> num_layers= 6
2020-06-10 05:13:23,389:  >> dropout between layers= 0.4
2020-06-10 05:13:23,679: view2:
2020-06-10 05:13:23,679:  >> cell= GRU
2020-06-10 05:13:23,680:  >> input_size= 64
2020-06-10 05:13:23,680:  >> hidden_size= 512
2020-06-10 05:13:23,680:  >> bidirectional= True
2020-06-10 05:13:23,680:  >> num_layers= 2
2020-06-10 05:13:23,680:  >> dropout between layers= 0.4
2020-06-10 05:13:23,680:  >> num input embeddings= 45
2020-06-10 05:13:27,431: Using module at optim.adam.Adam
2020-06-10 05:13:27,433: Building optim from config
2020-06-10 05:13:27,434:  >> lr= 0.001
2020-06-10 05:13:27,434:  >> betas= (0.9, 0.999)
2020-06-10 05:13:27,434:  >> eps= 1e-08
2020-06-10 05:13:27,434:  >> weight_decay= 0
2020-06-10 05:13:27,434:  >> amsgrad= False
2020-06-10 05:13:27,434:  >> min_lr= 1e-07
2020-06-10 05:13:27,435: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-10 05:13:27,439: Building sched from config
2020-06-10 05:13:27,439:  >> optim= Adam
2020-06-10 05:13:27,439:  >> decay lr by 0.1
2020-06-10 05:13:27,439:  >> eval_fn= MultiViewAP
2020-06-10 05:13:27,440:  >> patience=4
2020-06-10 05:13:27,440:  >> revert=True
2020-06-10 05:13:27,477: loaded save/MultiViewDataset_IndividualWords.1170.pth
2020-06-10 05:13:27,477: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 05:13:28,754: loaded save/MultiViewRNN.1170.pth
2020-06-10 05:13:28,754: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 05:13:31,435: loaded save/Adam.1170.pth
2020-06-10 05:13:31,444: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 05:13:31,451: loaded save/ReduceLROnPlateau.1170.pth
2020-06-10 05:13:31,451: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 05:13:31,451: epoch=30.00 global_step=1170 lr=0.001 start_iter=0
2020-06-10 05:13:31,451: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 05:15:38,446: 0) loss=0.037 grad_norm=4.58 num_segments=256 num_words=219
2020-06-10 05:17:32,980: 1) loss=0.045 grad_norm=4.75 num_segments=256 num_words=207
2020-06-10 05:19:18,327: 2) loss=0.046 grad_norm=2.49 num_segments=256 num_words=208
2020-06-10 05:20:56,366: 3) loss=0.053 grad_norm=6.11 num_segments=256 num_words=221
2020-06-10 05:22:27,578: 4) loss=0.054 grad_norm=5.08 num_segments=256 num_words=205
2020-06-10 05:23:52,007: 5) loss=0.057 grad_norm=5.22 num_segments=256 num_words=203
2020-06-10 05:25:05,202: 6) loss=0.072 grad_norm=4.34 num_segments=256 num_words=203
2020-06-10 05:26:11,593: 7) loss=0.070 grad_norm=4.23 num_segments=256 num_words=209
2020-06-10 05:27:19,907: 8) loss=0.072 grad_norm=7.54 num_segments=256 num_words=205
2020-06-10 05:28:26,165: 9) loss=0.072 grad_norm=5.90 num_segments=256 num_words=213
2020-06-10 05:29:34,901: 10) loss=0.070 grad_norm=3.95 num_segments=256 num_words=210
2020-06-10 05:30:39,526: 11) loss=0.083 grad_norm=5.23 num_segments=256 num_words=224
2020-06-10 05:31:44,673: 12) loss=0.069 grad_norm=5.12 num_segments=256 num_words=217
2020-06-10 05:32:49,965: 13) loss=0.078 grad_norm=3.88 num_segments=256 num_words=206
2020-06-10 05:33:59,733: 14) loss=0.074 grad_norm=2.69 num_segments=256 num_words=209
2020-06-10 05:35:04,585: 15) loss=0.077 grad_norm=8.24 num_segments=256 num_words=207
2020-06-10 05:36:12,289: 16) loss=0.066 grad_norm=4.89 num_segments=256 num_words=212
2020-06-10 05:37:19,384: 17) loss=0.150 grad_norm=3.84 num_segments=256 num_words=211
2020-06-10 05:38:24,620: 18) loss=0.089 grad_norm=4.41 num_segments=256 num_words=214
2020-06-10 05:39:34,905: 19) loss=0.127 grad_norm=7.41 num_segments=256 num_words=212
2020-06-10 05:40:45,897: 20) loss=0.067 grad_norm=3.83 num_segments=256 num_words=208
2020-06-10 05:41:52,380: 21) loss=0.066 grad_norm=3.24 num_segments=256 num_words=211
2020-06-10 05:42:58,026: 22) loss=0.066 grad_norm=3.42 num_segments=256 num_words=203
2020-06-10 05:44:06,355: 23) loss=0.065 grad_norm=3.17 num_segments=256 num_words=203
2020-06-10 05:45:19,361: 24) loss=0.074 grad_norm=4.18 num_segments=256 num_words=215
2020-06-10 05:46:24,971: 25) loss=0.070 grad_norm=3.11 num_segments=256 num_words=203
2020-06-10 05:47:32,131: 26) loss=0.073 grad_norm=4.73 num_segments=256 num_words=211
2020-06-10 05:48:37,663: 27) loss=0.072 grad_norm=3.61 num_segments=256 num_words=207
2020-06-10 05:49:42,815: 28) loss=0.142 grad_norm=5.68 num_segments=256 num_words=208
2020-06-10 05:50:48,512: 29) loss=0.074 grad_norm=5.04 num_segments=256 num_words=219
2020-06-10 05:51:54,840: 30) loss=0.074 grad_norm=2.61 num_segments=256 num_words=222
2020-06-10 05:53:08,681: 31) loss=0.073 grad_norm=4.37 num_segments=256 num_words=211
2020-06-10 05:54:14,026: 32) loss=0.070 grad_norm=3.54 num_segments=256 num_words=216
2020-06-10 05:55:21,288: 33) loss=0.067 grad_norm=3.10 num_segments=256 num_words=204
2020-06-10 05:56:27,482: 34) loss=0.067 grad_norm=3.27 num_segments=256 num_words=213
2020-06-10 05:57:36,597: 35) loss=0.091 grad_norm=5.04 num_segments=256 num_words=218
2020-06-10 05:58:42,624: 36) loss=0.068 grad_norm=7.29 num_segments=256 num_words=212
2020-06-10 05:59:51,208: 37) loss=0.072 grad_norm=3.19 num_segments=256 num_words=201
2020-06-10 06:00:51,881: 38) loss=0.066 grad_norm=3.05 num_segments=243 num_words=203
2020-06-10 06:00:51,995: epoch= 31.00
2020-06-10 06:00:51,996:  >> time to evaluate and save:
2020-06-10 06:00:52,417: saved save/MultiViewDataset_IndividualWords.1209.pth
2020-06-10 06:00:52,961: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 06:00:53,751: removed save/MultiViewDataset_IndividualWords.975.pth
2020-06-10 06:00:53,752: saved MultiViewDataset_IndividualWords successfully
2020-06-10 06:00:55,220: saved save/MultiViewRNN.1209.pth
2020-06-10 06:00:55,235: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 06:00:55,636: removed save/MultiViewRNN.975.pth
2020-06-10 06:00:55,636: saved MultiViewRNN successfully
2020-06-10 06:00:58,200: saved save/Adam.1209.pth
2020-06-10 06:00:58,214: most_recent linked save/Adam.most_recent.pth
2020-06-10 06:00:58,663: removed save/Adam.975.pth
2020-06-10 06:00:58,663: saved Adam successfully
2020-06-10 06:00:58,665: saved save/ReduceLROnPlateau.1209.pth
2020-06-10 06:00:58,666: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 06:00:58,722: saved ReduceLROnPlateau successfully
2020-06-10 06:00:58,724: saved config successfully
2020-06-10 06:02:33,028:   >> crossview_ap=0.710 (10966 x 3921 pairs)
2020-06-10 06:03:37,218:   >> acoustic_ap=0.766 (10966 choose 2 pairs)
2020-06-10 06:03:37,221: best_so_far= 0.710 at 1209
2020-06-10 06:03:37,237: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 06:03:37,239: saved MultiViewDataset_IndividualWords successfully
2020-06-10 06:03:37,241: best linked save/MultiViewRNN.best.pth
2020-06-10 06:03:37,249: saved MultiViewRNN successfully
2020-06-10 06:03:37,267: best linked save/Adam.best.pth
2020-06-10 06:03:37,276: saved Adam successfully
2020-06-10 06:03:37,277: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 06:03:37,283: saved ReduceLROnPlateau successfully
2020-06-10 06:03:37,328: epoch=31.00 global_step=1209 lr=0.001 start_iter=0
2020-06-10 06:03:37,329: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 06:04:50,629: 0) loss=0.066 grad_norm=2.07 num_segments=256 num_words=207
2020-06-10 06:06:13,459: 1) loss=0.070 grad_norm=3.13 num_segments=256 num_words=212
2020-06-10 06:07:20,958: 2) loss=0.071 grad_norm=3.52 num_segments=256 num_words=214
2020-06-10 06:08:29,692: 3) loss=0.083 grad_norm=6.39 num_segments=256 num_words=213
2020-06-10 06:09:38,260: 4) loss=0.068 grad_norm=2.50 num_segments=256 num_words=220
2020-06-10 06:10:46,405: 5) loss=0.133 grad_norm=3.79 num_segments=256 num_words=209
2020-06-10 06:11:55,477: 6) loss=0.073 grad_norm=2.24 num_segments=256 num_words=213
2020-06-10 06:13:03,440: 7) loss=0.079 grad_norm=2.95 num_segments=256 num_words=200
2020-06-10 06:14:11,365: 8) loss=0.074 grad_norm=9.87 num_segments=256 num_words=206
2020-06-10 06:15:20,271: 9) loss=0.066 grad_norm=2.80 num_segments=256 num_words=204
2020-06-10 06:16:28,127: 10) loss=0.071 grad_norm=2.91 num_segments=256 num_words=216
2020-06-10 06:17:35,710: 11) loss=0.075 grad_norm=2.88 num_segments=256 num_words=212
2020-06-10 06:18:56,819: 12) loss=0.091 grad_norm=3.54 num_segments=256 num_words=212
2020-06-10 06:20:05,462: 13) loss=0.071 grad_norm=3.00 num_segments=256 num_words=210
2020-06-10 06:21:13,455: 14) loss=0.071 grad_norm=9.21 num_segments=256 num_words=214
2020-06-10 06:22:23,116: 15) loss=0.067 grad_norm=4.05 num_segments=256 num_words=216
2020-06-10 06:23:30,937: 16) loss=0.067 grad_norm=6.76 num_segments=256 num_words=215
2020-06-10 06:24:39,315: 17) loss=0.072 grad_norm=5.30 num_segments=256 num_words=215
2020-06-10 06:25:47,212: 18) loss=0.070 grad_norm=2.65 num_segments=256 num_words=216
2020-06-10 06:26:54,464: 19) loss=0.070 grad_norm=6.73 num_segments=256 num_words=210
2020-06-10 06:28:02,321: 20) loss=0.073 grad_norm=3.07 num_segments=256 num_words=216
2020-06-10 06:29:12,379: 21) loss=0.065 grad_norm=4.56 num_segments=256 num_words=219
2020-06-10 06:30:21,279: 22) loss=0.069 grad_norm=5.70 num_segments=256 num_words=216
2020-06-10 06:31:32,207: 23) loss=0.083 grad_norm=5.59 num_segments=256 num_words=215
2020-06-10 06:32:40,465: 24) loss=0.096 grad_norm=6.29 num_segments=256 num_words=210
2020-06-10 06:33:48,436: 25) loss=0.064 grad_norm=3.86 num_segments=256 num_words=207
2020-06-10 06:35:14,288: 26) loss=0.074 grad_norm=3.12 num_segments=256 num_words=210
2020-06-10 06:36:22,562: 27) loss=0.069 grad_norm=2.63 num_segments=256 num_words=214
2020-06-10 06:37:31,658: 28) loss=0.072 grad_norm=4.69 num_segments=256 num_words=210
2020-06-10 06:38:40,600: 29) loss=0.070 grad_norm=4.44 num_segments=256 num_words=208
2020-06-10 06:39:49,127: 30) loss=0.071 grad_norm=9.53 num_segments=256 num_words=211
2020-06-10 06:40:57,382: 31) loss=0.074 grad_norm=4.07 num_segments=256 num_words=205
2020-06-10 06:42:05,807: 32) loss=0.074 grad_norm=4.14 num_segments=256 num_words=205
2020-06-10 06:43:14,176: 33) loss=0.072 grad_norm=19.46 num_segments=256 num_words=210
2020-06-10 06:44:22,127: 34) loss=0.073 grad_norm=6.83 num_segments=256 num_words=209
2020-06-10 06:45:29,644: 35) loss=0.069 grad_norm=5.69 num_segments=256 num_words=207
2020-06-10 06:46:37,839: 36) loss=0.074 grad_norm=3.53 num_segments=256 num_words=219
2020-06-10 06:47:46,905: 37) loss=0.071 grad_norm=4.19 num_segments=256 num_words=203
2020-06-10 06:48:48,056: 38) loss=0.074 grad_norm=5.26 num_segments=243 num_words=198
2020-06-10 06:48:48,068: epoch= 32.00
2020-06-10 06:48:48,068:  >> time to evaluate and save:
2020-06-10 06:48:48,103: saved save/MultiViewDataset_IndividualWords.1248.pth
2020-06-10 06:48:48,124: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 06:48:48,178: removed save/MultiViewDataset_IndividualWords.1014.pth
2020-06-10 06:48:48,179: saved MultiViewDataset_IndividualWords successfully
2020-06-10 06:48:49,536: saved save/MultiViewRNN.1248.pth
2020-06-10 06:48:49,538: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 06:48:49,573: removed save/MultiViewRNN.1014.pth
2020-06-10 06:48:49,574: saved MultiViewRNN successfully
2020-06-10 06:48:52,123: saved save/Adam.1248.pth
2020-06-10 06:48:52,125: most_recent linked save/Adam.most_recent.pth
2020-06-10 06:48:52,148: removed save/Adam.1014.pth
2020-06-10 06:48:52,148: saved Adam successfully
2020-06-10 06:48:52,150: saved save/ReduceLROnPlateau.1248.pth
2020-06-10 06:48:52,160: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 06:48:52,169: removed save/ReduceLROnPlateau.975.pth
2020-06-10 06:48:52,169: saved ReduceLROnPlateau successfully
2020-06-10 06:48:52,171: saved config successfully
2020-06-10 06:50:25,535:   >> crossview_ap=0.702 (10966 x 3921 pairs)
2020-06-10 06:51:29,129:   >> acoustic_ap=0.760 (10966 choose 2 pairs)
2020-06-10 06:51:29,133: best_so_far= 0.710 at 1209
2020-06-10 06:51:29,827: epoch=32.00 global_step=1248 lr=0.001 start_iter=0
2020-06-10 06:51:29,827: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 06:52:43,660: 0) loss=0.070 grad_norm=6.69 num_segments=256 num_words=217
2020-06-10 06:53:53,354: 1) loss=0.072 grad_norm=4.39 num_segments=256 num_words=218
2020-06-10 06:55:03,211: 2) loss=0.095 grad_norm=6.09 num_segments=256 num_words=212
2020-06-10 06:56:14,049: 3) loss=0.070 grad_norm=7.84 num_segments=256 num_words=227
2020-06-10 06:57:23,822: 4) loss=0.073 grad_norm=3.76 num_segments=256 num_words=212
2020-06-10 06:58:56,551: 5) loss=0.068 grad_norm=3.46 num_segments=256 num_words=213
2020-06-10 07:00:04,108: 6) loss=0.074 grad_norm=3.03 num_segments=256 num_words=202
2020-06-10 07:01:12,014: 7) loss=0.075 grad_norm=7.61 num_segments=256 num_words=209
2020-06-10 07:02:20,285: 8) loss=0.071 grad_norm=4.45 num_segments=256 num_words=217
2020-06-10 07:03:28,133: 9) loss=0.074 grad_norm=4.05 num_segments=256 num_words=197
2020-06-10 07:04:35,522: 10) loss=0.072 grad_norm=4.34 num_segments=256 num_words=221
2020-06-10 07:05:43,983: 11) loss=0.071 grad_norm=10.13 num_segments=256 num_words=214
2020-06-10 07:06:51,956: 12) loss=0.143 grad_norm=4.53 num_segments=256 num_words=217
2020-06-10 07:07:59,543: 13) loss=0.061 grad_norm=2.61 num_segments=256 num_words=207
2020-06-10 07:09:07,898: 14) loss=0.069 grad_norm=6.11 num_segments=256 num_words=212
2020-06-10 07:10:16,290: 15) loss=0.078 grad_norm=5.93 num_segments=256 num_words=209
2020-06-10 07:11:25,086: 16) loss=0.075 grad_norm=6.15 num_segments=256 num_words=217
2020-06-10 07:12:33,080: 17) loss=0.076 grad_norm=6.30 num_segments=256 num_words=206
2020-06-10 07:13:40,948: 18) loss=0.065 grad_norm=2.72 num_segments=256 num_words=202
2020-06-10 07:14:48,761: 19) loss=0.070 grad_norm=4.79 num_segments=256 num_words=215
2020-06-10 07:15:56,728: 20) loss=0.081 grad_norm=4.24 num_segments=256 num_words=213
2020-06-10 07:17:03,970: 21) loss=0.071 grad_norm=4.83 num_segments=256 num_words=218
2020-06-10 07:18:12,193: 22) loss=0.067 grad_norm=4.69 num_segments=256 num_words=220
2020-06-10 07:19:20,351: 23) loss=0.071 grad_norm=5.40 num_segments=256 num_words=212
2020-06-10 07:20:28,701: 24) loss=0.074 grad_norm=5.74 num_segments=256 num_words=206
2020-06-10 07:21:36,948: 25) loss=0.072 grad_norm=4.91 num_segments=256 num_words=220
2020-06-10 07:23:12,307: 26) loss=0.068 grad_norm=2.80 num_segments=256 num_words=219
2020-06-10 07:24:20,629: 27) loss=0.070 grad_norm=2.92 num_segments=256 num_words=214
2020-06-10 07:25:28,459: 28) loss=0.075 grad_norm=2.70 num_segments=256 num_words=219
2020-06-10 07:26:36,391: 29) loss=0.071 grad_norm=5.13 num_segments=256 num_words=217
2020-06-10 07:27:48,720: 30) loss=0.072 grad_norm=4.16 num_segments=256 num_words=205
2020-06-10 07:28:56,888: 31) loss=0.069 grad_norm=6.97 num_segments=256 num_words=209
2020-06-10 07:30:07,203: 32) loss=0.063 grad_norm=4.72 num_segments=256 num_words=209
2020-06-10 07:31:15,721: 33) loss=0.072 grad_norm=3.76 num_segments=256 num_words=215
2020-06-10 07:32:24,115: 34) loss=0.075 grad_norm=3.71 num_segments=256 num_words=202
2020-06-10 07:33:32,445: 35) loss=0.067 grad_norm=2.45 num_segments=256 num_words=205
2020-06-10 07:34:40,986: 36) loss=0.072 grad_norm=6.33 num_segments=256 num_words=206
2020-06-10 07:35:49,162: 37) loss=0.063 grad_norm=3.16 num_segments=256 num_words=199
2020-06-10 07:36:50,715: 38) loss=0.072 grad_norm=4.26 num_segments=243 num_words=214
2020-06-10 07:36:50,731: epoch= 33.00
2020-06-10 07:36:50,732:  >> time to evaluate and save:
2020-06-10 07:36:50,766: saved save/MultiViewDataset_IndividualWords.1287.pth
2020-06-10 07:36:50,768: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 07:36:50,811: removed save/MultiViewDataset_IndividualWords.1053.pth
2020-06-10 07:36:50,811: saved MultiViewDataset_IndividualWords successfully
2020-06-10 07:36:52,200: saved save/MultiViewRNN.1287.pth
2020-06-10 07:36:52,202: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 07:36:52,233: removed save/MultiViewRNN.1053.pth
2020-06-10 07:36:52,233: saved MultiViewRNN successfully
2020-06-10 07:36:54,778: saved save/Adam.1287.pth
2020-06-10 07:36:54,779: most_recent linked save/Adam.most_recent.pth
2020-06-10 07:36:54,819: removed save/Adam.1053.pth
2020-06-10 07:36:54,819: saved Adam successfully
2020-06-10 07:36:54,821: saved save/ReduceLROnPlateau.1287.pth
2020-06-10 07:36:54,830: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 07:36:54,869: removed save/ReduceLROnPlateau.1014.pth
2020-06-10 07:36:54,869: saved ReduceLROnPlateau successfully
2020-06-10 07:36:54,871: saved config successfully
2020-06-10 07:38:29,030:   >> crossview_ap=0.702 (10966 x 3921 pairs)
2020-06-10 07:39:32,230:   >> acoustic_ap=0.760 (10966 choose 2 pairs)
2020-06-10 07:39:32,233: best_so_far= 0.710 at 1209
2020-06-10 07:39:33,111: epoch=33.00 global_step=1287 lr=0.001 start_iter=0
2020-06-10 07:39:33,111: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 07:40:43,419: 0) loss=0.070 grad_norm=3.01 num_segments=256 num_words=206
2020-06-10 07:41:51,048: 1) loss=0.067 grad_norm=3.78 num_segments=256 num_words=215
2020-06-10 07:42:59,614: 2) loss=0.079 grad_norm=3.54 num_segments=256 num_words=211
2020-06-10 07:44:08,483: 3) loss=0.074 grad_norm=3.87 num_segments=256 num_words=211
2020-06-10 07:45:17,043: 4) loss=0.071 grad_norm=2.02 num_segments=256 num_words=212
2020-06-10 07:46:25,244: 5) loss=0.063 grad_norm=4.16 num_segments=256 num_words=197
2020-06-10 07:47:34,133: 6) loss=0.071 grad_norm=2.67 num_segments=256 num_words=207
2020-06-10 07:48:43,770: 7) loss=0.077 grad_norm=4.34 num_segments=256 num_words=205
2020-06-10 07:49:52,125: 8) loss=0.075 grad_norm=2.85 num_segments=256 num_words=214
2020-06-10 07:51:00,670: 9) loss=0.085 grad_norm=3.52 num_segments=256 num_words=208
2020-06-10 07:52:09,368: 10) loss=0.067 grad_norm=3.19 num_segments=256 num_words=212
2020-06-10 07:53:17,760: 11) loss=0.067 grad_norm=2.26 num_segments=256 num_words=206
2020-06-10 07:54:26,342: 12) loss=0.066 grad_norm=3.61 num_segments=256 num_words=205
2020-06-10 07:55:34,904: 13) loss=0.123 grad_norm=3.90 num_segments=256 num_words=215
2020-06-10 07:57:24,331: 14) loss=0.125 grad_norm=8.25 num_segments=256 num_words=216
2020-06-10 07:58:32,277: 15) loss=0.072 grad_norm=5.65 num_segments=256 num_words=215
2020-06-10 07:59:40,355: 16) loss=0.071 grad_norm=4.03 num_segments=256 num_words=213
2020-06-10 08:00:48,149: 17) loss=0.069 grad_norm=4.83 num_segments=256 num_words=207
2020-06-10 08:01:56,249: 18) loss=0.069 grad_norm=2.45 num_segments=256 num_words=211
2020-06-10 08:03:03,768: 19) loss=0.072 grad_norm=6.04 num_segments=256 num_words=210
2020-06-10 08:04:11,784: 20) loss=0.080 grad_norm=6.88 num_segments=256 num_words=212
2020-06-10 08:05:20,339: 21) loss=0.068 grad_norm=3.20 num_segments=256 num_words=204
2020-06-10 08:06:27,860: 22) loss=0.077 grad_norm=3.47 num_segments=256 num_words=222
2020-06-10 08:07:35,910: 23) loss=0.074 grad_norm=3.08 num_segments=256 num_words=213
2020-06-10 08:08:43,959: 24) loss=0.068 grad_norm=2.06 num_segments=256 num_words=204
2020-06-10 08:09:52,056: 25) loss=0.079 grad_norm=2.70 num_segments=256 num_words=213
2020-06-10 08:11:00,275: 26) loss=0.070 grad_norm=2.48 num_segments=256 num_words=199
2020-06-10 08:12:08,618: 27) loss=0.076 grad_norm=3.02 num_segments=256 num_words=203
2020-06-10 08:13:18,937: 28) loss=0.074 grad_norm=5.23 num_segments=256 num_words=214
2020-06-10 08:14:27,118: 29) loss=0.070 grad_norm=2.27 num_segments=256 num_words=214
2020-06-10 08:15:34,668: 30) loss=0.073 grad_norm=4.15 num_segments=256 num_words=205
2020-06-10 08:16:43,000: 31) loss=0.073 grad_norm=3.73 num_segments=256 num_words=200
2020-06-10 08:17:50,456: 32) loss=0.062 grad_norm=1.95 num_segments=256 num_words=209
2020-06-10 08:18:58,372: 33) loss=0.073 grad_norm=3.72 num_segments=256 num_words=205
2020-06-10 08:20:06,490: 34) loss=0.072 grad_norm=2.76 num_segments=256 num_words=216
2020-06-10 08:21:15,012: 35) loss=0.072 grad_norm=7.52 num_segments=256 num_words=214
2020-06-10 08:22:23,217: 36) loss=0.067 grad_norm=2.08 num_segments=256 num_words=211
2020-06-10 08:23:30,639: 37) loss=0.087 grad_norm=3.39 num_segments=256 num_words=206
2020-06-10 08:24:32,013: 38) loss=0.067 grad_norm=3.61 num_segments=243 num_words=197
2020-06-10 08:24:32,026: epoch= 34.00
2020-06-10 08:24:32,026:  >> time to evaluate and save:
2020-06-10 08:24:32,060: saved save/MultiViewDataset_IndividualWords.1326.pth
2020-06-10 08:24:32,096: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 08:24:32,116: removed save/MultiViewDataset_IndividualWords.1092.pth
2020-06-10 08:24:32,116: saved MultiViewDataset_IndividualWords successfully
2020-06-10 08:24:33,547: saved save/MultiViewRNN.1326.pth
2020-06-10 08:24:33,564: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 08:24:33,622: removed save/MultiViewRNN.1092.pth
2020-06-10 08:24:33,622: saved MultiViewRNN successfully
2020-06-10 08:24:36,181: saved save/Adam.1326.pth
2020-06-10 08:24:36,189: most_recent linked save/Adam.most_recent.pth
2020-06-10 08:24:36,226: removed save/Adam.1092.pth
2020-06-10 08:24:36,226: saved Adam successfully
2020-06-10 08:24:36,228: saved save/ReduceLROnPlateau.1326.pth
2020-06-10 08:24:36,241: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 08:24:36,250: removed save/ReduceLROnPlateau.1053.pth
2020-06-10 08:24:36,250: saved ReduceLROnPlateau successfully
2020-06-10 08:24:36,252: saved config successfully
2020-06-10 08:26:23,652:   >> crossview_ap=0.710 (10966 x 3921 pairs)
2020-06-10 08:27:49,924:   >> acoustic_ap=0.765 (10966 choose 2 pairs)
2020-06-10 08:27:49,927: best_so_far= 0.710 at 1326
2020-06-10 08:27:49,934: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 08:27:49,937: saved MultiViewDataset_IndividualWords successfully
2020-06-10 08:27:49,951: best linked save/MultiViewRNN.best.pth
2020-06-10 08:27:49,960: saved MultiViewRNN successfully
2020-06-10 08:27:49,979: best linked save/Adam.best.pth
2020-06-10 08:27:49,986: saved Adam successfully
2020-06-10 08:27:49,992: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 08:27:49,996: removed save/ReduceLROnPlateau.1092.pth
2020-06-10 08:27:49,996: saved ReduceLROnPlateau successfully
2020-06-10 08:27:52,332: epoch=34.00 global_step=1326 lr=0.001 start_iter=0
2020-06-10 08:27:52,333: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 08:29:07,019: 0) loss=0.068 grad_norm=5.64 num_segments=256 num_words=212
2020-06-10 08:30:17,203: 1) loss=0.072 grad_norm=1.61 num_segments=256 num_words=218
2020-06-10 08:31:28,998: 2) loss=0.081 grad_norm=3.87 num_segments=256 num_words=223
2020-06-10 08:32:38,393: 3) loss=0.073 grad_norm=2.01 num_segments=256 num_words=208
2020-06-10 08:33:48,311: 4) loss=0.072 grad_norm=4.12 num_segments=256 num_words=213
2020-06-10 08:34:56,726: 5) loss=0.070 grad_norm=2.53 num_segments=256 num_words=217
2020-06-10 08:36:04,977: 6) loss=0.068 grad_norm=2.36 num_segments=256 num_words=213
2020-06-10 08:37:13,485: 7) loss=0.073 grad_norm=2.14 num_segments=256 num_words=220
2020-06-10 08:38:21,314: 8) loss=0.083 grad_norm=2.72 num_segments=256 num_words=212
2020-06-10 08:40:23,953: 9) loss=0.072 grad_norm=2.83 num_segments=256 num_words=210
2020-06-10 08:41:32,818: 10) loss=0.066 grad_norm=1.98 num_segments=256 num_words=207
2020-06-10 08:42:52,077: 11) loss=0.073 grad_norm=5.81 num_segments=256 num_words=199
2020-06-10 08:44:03,396: 12) loss=0.072 grad_norm=2.62 num_segments=256 num_words=216
2020-06-10 08:45:17,243: 13) loss=0.077 grad_norm=7.67 num_segments=256 num_words=222
2020-06-10 08:46:30,253: 14) loss=0.066 grad_norm=2.72 num_segments=256 num_words=207
2020-06-10 08:47:41,968: 15) loss=0.069 grad_norm=2.43 num_segments=256 num_words=204
2020-06-10 08:48:53,178: 16) loss=0.071 grad_norm=5.87 num_segments=256 num_words=205
2020-06-10 08:50:07,512: 17) loss=0.070 grad_norm=9.50 num_segments=256 num_words=212
2020-06-10 08:51:21,093: 18) loss=0.142 grad_norm=4.10 num_segments=256 num_words=212
2020-06-10 08:52:34,296: 19) loss=0.071 grad_norm=3.30 num_segments=256 num_words=201
2020-06-10 08:53:46,273: 20) loss=0.069 grad_norm=5.51 num_segments=256 num_words=209
2020-06-10 08:54:56,395: 21) loss=0.072 grad_norm=3.97 num_segments=256 num_words=211
2020-06-10 08:56:06,910: 22) loss=0.065 grad_norm=3.12 num_segments=256 num_words=204
2020-06-10 08:57:18,007: 23) loss=0.071 grad_norm=6.46 num_segments=256 num_words=218
2020-06-10 08:58:29,975: 24) loss=0.075 grad_norm=3.68 num_segments=256 num_words=220
2020-06-10 08:59:41,000: 25) loss=0.064 grad_norm=3.15 num_segments=256 num_words=211
2020-06-10 09:00:51,057: 26) loss=0.068 grad_norm=2.04 num_segments=256 num_words=205
2020-06-10 09:02:02,110: 27) loss=0.071 grad_norm=2.97 num_segments=256 num_words=204
2020-06-10 09:03:13,589: 28) loss=0.073 grad_norm=4.45 num_segments=256 num_words=213
2020-06-10 09:04:26,750: 29) loss=0.072 grad_norm=1.96 num_segments=256 num_words=211
2020-06-10 09:05:36,432: 30) loss=0.062 grad_norm=2.27 num_segments=256 num_words=208
2020-06-10 09:06:46,820: 31) loss=0.066 grad_norm=2.74 num_segments=256 num_words=198
2020-06-10 09:07:57,115: 32) loss=0.063 grad_norm=2.25 num_segments=256 num_words=215
2020-06-10 09:09:06,733: 33) loss=0.077 grad_norm=4.97 num_segments=256 num_words=208
2020-06-10 09:10:17,423: 34) loss=0.070 grad_norm=2.75 num_segments=256 num_words=206
2020-06-10 09:11:28,141: 35) loss=0.068 grad_norm=4.95 num_segments=256 num_words=204
2020-06-10 09:12:38,341: 36) loss=0.064 grad_norm=3.92 num_segments=256 num_words=207
2020-06-10 09:13:37,775: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-10 09:13:37,817: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-10 09:13:37,825: Using 1 GPU(s)
2020-06-10 09:13:37,825: Machine: 0 / 1
2020-06-10 09:13:37,830: Hyperparam tuning-------------------
2020-06-10 09:13:37,831: optim_lr: 0.001
2020-06-10 09:13:37,831: dropout (for both): 0.4
2020-06-10 09:13:37,831: margin: 0.4
2020-06-10 09:13:37,831: ------------------------------------
2020-06-10 09:13:37,832: Calling main function: multiview_trainer.train
2020-06-10 09:13:37,832: Using config file: train_config.json
2020-06-10 09:13:37,832: Using module at multiview_trainer.train
2020-06-10 09:13:37,871: Using 1 GPU(s)
2020-06-10 09:13:37,871: Machine: 0 / 1
2020-06-10 09:13:37,873: Hyperparam tuning-------------------
2020-06-10 09:13:37,873: optim_lr: 0.001
2020-06-10 09:13:37,873: dropout (for both): 0.4
2020-06-10 09:13:37,873: margin: 0.4
2020-06-10 09:13:37,873: ------------------------------------
2020-06-10 09:13:37,874: Calling main function: multiview_trainer.train
2020-06-10 09:13:37,874: Using config file: train_config.json
2020-06-10 09:13:37,874: Using module at multiview_trainer.train
2020-06-10 09:13:37,975: Using module at multiview_vocab.MultiViewVocab
2020-06-10 09:13:37,978: Building vocab_data from config
2020-06-10 09:13:37,993: Using module at multiview_vocab.MultiViewVocab
2020-06-10 09:13:37,995: Building vocab_data from config
2020-06-10 09:13:38,278:  >> min_count= 0
2020-06-10 09:13:38,278:  >> # words= 34323 (# removed= 0)
2020-06-10 09:13:38,278:  >> # subwords= 45
2020-06-10 09:13:38,278:     [laughter]= 1
2020-06-10 09:13:38,278:     [noise]= 2
2020-06-10 09:13:38,278:     [vocalized-noise]= 3
2020-06-10 09:13:38,278:     aa= 4
2020-06-10 09:13:38,278:     ae= 5
2020-06-10 09:13:38,278:     ah= 6
2020-06-10 09:13:38,278:     ao= 7
2020-06-10 09:13:38,278:     aw= 8
2020-06-10 09:13:38,278:     ax= 9
2020-06-10 09:13:38,278:     ay= 10
2020-06-10 09:13:38,279:     b= 11
2020-06-10 09:13:38,279:     ch= 12
2020-06-10 09:13:38,279:     d= 13
2020-06-10 09:13:38,279:     dh= 14
2020-06-10 09:13:38,279:     eh= 15
2020-06-10 09:13:38,279:     el= 16
2020-06-10 09:13:38,279:     en= 17
2020-06-10 09:13:38,279:     er= 18
2020-06-10 09:13:38,279:     ey= 19
2020-06-10 09:13:38,279:     f= 20
2020-06-10 09:13:38,279:     g= 21
2020-06-10 09:13:38,279:     hh= 22
2020-06-10 09:13:38,279:     ih= 23
2020-06-10 09:13:38,279:     iy= 24
2020-06-10 09:13:38,279:     jh= 25
2020-06-10 09:13:38,279:     k= 26
2020-06-10 09:13:38,279:     l= 27
2020-06-10 09:13:38,279:     m= 28
2020-06-10 09:13:38,279:     n= 29
2020-06-10 09:13:38,280:     ng= 30
2020-06-10 09:13:38,280:     ow= 31
2020-06-10 09:13:38,280:     oy= 32
2020-06-10 09:13:38,280:     p= 33
2020-06-10 09:13:38,280:     r= 34
2020-06-10 09:13:38,280:     s= 35
2020-06-10 09:13:38,280:     sh= 36
2020-06-10 09:13:38,280:     t= 37
2020-06-10 09:13:38,280:     th= 38
2020-06-10 09:13:38,280:     uh= 39
2020-06-10 09:13:38,280:     uw= 40
2020-06-10 09:13:38,280:     v= 41
2020-06-10 09:13:38,280:     w= 42
2020-06-10 09:13:38,280:     y= 43
2020-06-10 09:13:38,280:     z= 44
2020-06-10 09:13:38,280:     zh= 45
2020-06-10 09:13:38,295: Using module at data.batch_samplers.BatchSampler
2020-06-10 09:13:38,297: Building vocab_sampler from config
2020-06-10 09:13:38,297:  >> # examples= 34323
2020-06-10 09:13:38,297:  >> batch_size= 1000
2020-06-10 09:13:38,297:  >> shuffle= False
2020-06-10 09:13:38,302:  >> min_count= 0
2020-06-10 09:13:38,302:  >> # words= 34323 (# removed= 0)
2020-06-10 09:13:38,302:  >> # subwords= 45
2020-06-10 09:13:38,302:     [laughter]= 1
2020-06-10 09:13:38,302:     [noise]= 2
2020-06-10 09:13:38,302:     [vocalized-noise]= 3
2020-06-10 09:13:38,302:     aa= 4
2020-06-10 09:13:38,302:     ae= 5
2020-06-10 09:13:38,302:     ah= 6
2020-06-10 09:13:38,302:     ao= 7
2020-06-10 09:13:38,302:     aw= 8
2020-06-10 09:13:38,302:     ax= 9
2020-06-10 09:13:38,303:     ay= 10
2020-06-10 09:13:38,303:     b= 11
2020-06-10 09:13:38,303:     ch= 12
2020-06-10 09:13:38,303:     d= 13
2020-06-10 09:13:38,303:     dh= 14
2020-06-10 09:13:38,303:     eh= 15
2020-06-10 09:13:38,303:     el= 16
2020-06-10 09:13:38,303:     en= 17
2020-06-10 09:13:38,303:     er= 18
2020-06-10 09:13:38,303:     ey= 19
2020-06-10 09:13:38,303:     f= 20
2020-06-10 09:13:38,303:     g= 21
2020-06-10 09:13:38,303:     hh= 22
2020-06-10 09:13:38,303:     ih= 23
2020-06-10 09:13:38,303:     iy= 24
2020-06-10 09:13:38,303:     jh= 25
2020-06-10 09:13:38,303:     k= 26
2020-06-10 09:13:38,303:     l= 27
2020-06-10 09:13:38,303:     m= 28
2020-06-10 09:13:38,304:     n= 29
2020-06-10 09:13:38,304:     ng= 30
2020-06-10 09:13:38,304:     ow= 31
2020-06-10 09:13:38,304:     oy= 32
2020-06-10 09:13:38,304:     p= 33
2020-06-10 09:13:38,304:     r= 34
2020-06-10 09:13:38,304:     s= 35
2020-06-10 09:13:38,304:     sh= 36
2020-06-10 09:13:38,304:     t= 37
2020-06-10 09:13:38,304:     th= 38
2020-06-10 09:13:38,304:     uh= 39
2020-06-10 09:13:38,304:     uw= 40
2020-06-10 09:13:38,304:     v= 41
2020-06-10 09:13:38,304:     w= 42
2020-06-10 09:13:38,304:     y= 43
2020-06-10 09:13:38,304:     z= 44
2020-06-10 09:13:38,304:     zh= 45
2020-06-10 09:13:38,305:  >> BatchSampler; 35 batches
2020-06-10 09:13:38,306: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 09:13:38,320: Using module at data.batch_samplers.BatchSampler
2020-06-10 09:13:38,321: Building vocab_sampler from config
2020-06-10 09:13:38,321:  >> # examples= 34323
2020-06-10 09:13:38,321:  >> batch_size= 1000
2020-06-10 09:13:38,321:  >> shuffle= False
2020-06-10 09:13:38,330:  >> BatchSampler; 35 batches
2020-06-10 09:13:38,330: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 09:13:38,382: Building train_data from config
2020-06-10 09:13:38,390: Building train_data from config
2020-06-10 09:13:45,297:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-10 09:13:45,298:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-10 09:13:45,298:  >> stack= False
2020-06-10 09:13:45,298:  >> seg_durs= (1, None)
2020-06-10 09:13:45,298:  >> # words= 9971 (# ignored= 0)
2020-06-10 09:13:45,298:  >> input_feat_dim= 108
2020-06-10 09:13:45,298:  >> input_num_subwords= 45
2020-06-10 09:13:45,299: Using module at data.batch_samplers.BatchSampler
2020-06-10 09:13:45,299: Building train_sampler from config
2020-06-10 09:13:45,300:  >> # examples= 9971
2020-06-10 09:13:45,300:  >> batch_size= 256
2020-06-10 09:13:45,300:  >> shuffle= True
2020-06-10 09:13:45,309:  >> BatchSampler; 39 batches
2020-06-10 09:13:45,309: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 09:13:45,309: Building dev_data from config
2020-06-10 09:13:45,360:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-10 09:13:45,361:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-10 09:13:45,361:  >> stack= False
2020-06-10 09:13:45,361:  >> seg_durs= (1, None)
2020-06-10 09:13:45,361:  >> # words= 9971 (# ignored= 0)
2020-06-10 09:13:45,361:  >> input_feat_dim= 108
2020-06-10 09:13:45,361:  >> input_num_subwords= 45
2020-06-10 09:13:45,362: Using module at data.batch_samplers.BatchSampler
2020-06-10 09:13:45,362: Building train_sampler from config
2020-06-10 09:13:45,363:  >> # examples= 9971
2020-06-10 09:13:45,363:  >> batch_size= 256
2020-06-10 09:13:45,363:  >> shuffle= True
2020-06-10 09:13:45,372:  >> BatchSampler; 39 batches
2020-06-10 09:13:45,372: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 09:13:45,372: Building dev_data from config
2020-06-10 09:13:53,187:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 09:13:53,188:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 09:13:53,188:  >> stack= False
2020-06-10 09:13:53,188:  >> seg_durs= (1, None)
2020-06-10 09:13:53,188:  >> # words= 10966 (# ignored= 0)
2020-06-10 09:13:53,188:  >> input_feat_dim= 108
2020-06-10 09:13:53,188:  >> input_num_subwords= 45
2020-06-10 09:13:53,188: Using module at data.batch_samplers.BatchSampler
2020-06-10 09:13:53,188: Building dev_sampler from config
2020-06-10 09:13:53,189:  >> # examples= 10966
2020-06-10 09:13:53,189:  >> batch_size= 256
2020-06-10 09:13:53,189:  >> shuffle= False
2020-06-10 09:13:53,191:  >> BatchSampler; 43 batches
2020-06-10 09:13:53,191: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 09:13:53,191: Building test_data from config
2020-06-10 09:13:53,768:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 09:13:53,769:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 09:13:53,769:  >> stack= False
2020-06-10 09:13:53,769:  >> seg_durs= (1, None)
2020-06-10 09:13:53,769:  >> # words= 10966 (# ignored= 0)
2020-06-10 09:13:53,769:  >> input_feat_dim= 108
2020-06-10 09:13:53,769:  >> input_num_subwords= 45
2020-06-10 09:13:53,769: Using module at data.batch_samplers.BatchSampler
2020-06-10 09:13:53,769: Building dev_sampler from config
2020-06-10 09:13:53,770:  >> # examples= 10966
2020-06-10 09:13:53,770:  >> batch_size= 256
2020-06-10 09:13:53,770:  >> shuffle= False
2020-06-10 09:13:53,773:  >> BatchSampler; 43 batches
2020-06-10 09:13:53,773: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 09:13:53,773: Building test_data from config
2020-06-10 09:14:00,038:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 09:14:00,038:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 09:14:00,038:  >> stack= False
2020-06-10 09:14:00,038:  >> seg_durs= (1, None)
2020-06-10 09:14:00,038:  >> # words= 11024 (# ignored= 0)
2020-06-10 09:14:00,038:  >> input_feat_dim= 108
2020-06-10 09:14:00,038:  >> input_num_subwords= 45
2020-06-10 09:14:00,039: Using module at data.batch_samplers.BatchSampler
2020-06-10 09:14:00,039: Building test_sampler from config
2020-06-10 09:14:00,040:  >> # examples= 11024
2020-06-10 09:14:00,040:  >> batch_size= 256
2020-06-10 09:14:00,040:  >> shuffle= False
2020-06-10 09:14:00,043:  >> BatchSampler; 44 batches
2020-06-10 09:14:00,043: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-10 09:14:00,801:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 09:14:00,801:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 09:14:00,801:  >> stack= False
2020-06-10 09:14:00,801:  >> seg_durs= (1, None)
2020-06-10 09:14:00,801:  >> # words= 11024 (# ignored= 0)
2020-06-10 09:14:00,801:  >> input_feat_dim= 108
2020-06-10 09:14:00,801:  >> input_num_subwords= 45
2020-06-10 09:14:00,802: Using module at data.batch_samplers.BatchSampler
2020-06-10 09:14:00,802: Building test_sampler from config
2020-06-10 09:14:00,802:  >> # examples= 11024
2020-06-10 09:14:00,802:  >> batch_size= 256
2020-06-10 09:14:00,802:  >> shuffle= False
2020-06-10 09:14:00,805:  >> BatchSampler; 44 batches
2020-06-10 09:14:00,805: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-10 09:14:01,448: Building loss from config
2020-06-10 09:14:01,448: Building loss from config
2020-06-10 09:14:01,677:  >> margin= 0.4
2020-06-10 09:14:01,677:  >> k= 16
2020-06-10 09:14:01,677:  >> margin= 0.4
2020-06-10 09:14:01,677:  >> min_k= 8
2020-06-10 09:14:01,677:  >> k= 16
2020-06-10 09:14:01,677:  >> extra= 0
2020-06-10 09:14:01,677:  >> min_k= 8
2020-06-10 09:14:01,677:  >> average= False
2020-06-10 09:14:01,677:  >> extra= 0
2020-06-10 09:14:01,677:  >> margin_max= 0.5
2020-06-10 09:14:01,677:  >> average= False
2020-06-10 09:14:01,677:  >> threshold_max= 9
2020-06-10 09:14:01,677:  >> using obj0
2020-06-10 09:14:01,677:  >> margin_max= 0.5
2020-06-10 09:14:01,677:  >> threshold_max= 9
2020-06-10 09:14:01,677:  >> using obj0
2020-06-10 09:14:01,678: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 09:14:01,678: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 09:14:01,905: Building eval from config
2020-06-10 09:14:01,905:  >> acoustic_ap= True
2020-06-10 09:14:01,905:  >> crossview_ap= True
2020-06-10 09:14:01,905:  >> full_vocab= False
2020-06-10 09:14:01,905:  >> metric= crossview_ap
2020-06-10 09:14:01,905:  >> mode= max
2020-06-10 09:14:01,905: Using module at multiview_rnn.MultiViewRNN
2020-06-10 09:14:01,910: Building eval from config
2020-06-10 09:14:01,910:  >> acoustic_ap= True
2020-06-10 09:14:01,911:  >> crossview_ap= True
2020-06-10 09:14:01,911:  >> full_vocab= False
2020-06-10 09:14:01,911:  >> metric= crossview_ap
2020-06-10 09:14:01,911:  >> mode= max
2020-06-10 09:14:01,911: Using module at multiview_rnn.MultiViewRNN
2020-06-10 09:14:01,911: Building net from config
2020-06-10 09:14:01,913: view1:
2020-06-10 09:14:01,914:  >> cell= GRU
2020-06-10 09:14:01,914:  >> input_size= 108
2020-06-10 09:14:01,914:  >> hidden_size= 512
2020-06-10 09:14:01,914:  >> bidirectional= True
2020-06-10 09:14:01,914:  >> num_layers= 6
2020-06-10 09:14:01,914:  >> dropout between layers= 0.4
2020-06-10 09:14:01,915: Building net from config
2020-06-10 09:14:01,916: view1:
2020-06-10 09:14:01,917:  >> cell= GRU
2020-06-10 09:14:01,917:  >> input_size= 108
2020-06-10 09:14:01,917:  >> hidden_size= 512
2020-06-10 09:14:01,917:  >> bidirectional= True
2020-06-10 09:14:01,917:  >> num_layers= 6
2020-06-10 09:14:01,917:  >> dropout between layers= 0.4
2020-06-10 09:14:02,142: view2:
2020-06-10 09:14:02,143:  >> cell= GRU
2020-06-10 09:14:02,143:  >> input_size= 64
2020-06-10 09:14:02,143:  >> hidden_size= 512
2020-06-10 09:14:02,143:  >> bidirectional= True
2020-06-10 09:14:02,143:  >> num_layers= 2
2020-06-10 09:14:02,143:  >> dropout between layers= 0.4
2020-06-10 09:14:02,143: view2:
2020-06-10 09:14:02,143:  >> num input embeddings= 45
2020-06-10 09:14:02,144:  >> cell= GRU
2020-06-10 09:14:02,144:  >> input_size= 64
2020-06-10 09:14:02,144:  >> hidden_size= 512
2020-06-10 09:14:02,144:  >> bidirectional= True
2020-06-10 09:14:02,144:  >> num_layers= 2
2020-06-10 09:14:02,144:  >> dropout between layers= 0.4
2020-06-10 09:14:02,144:  >> num input embeddings= 45
2020-06-10 09:14:05,739: Using module at optim.adam.Adam
2020-06-10 09:14:05,742: Building optim from config
2020-06-10 09:14:05,742:  >> lr= 0.001
2020-06-10 09:14:05,742:  >> betas= (0.9, 0.999)
2020-06-10 09:14:05,742:  >> eps= 1e-08
2020-06-10 09:14:05,742:  >> weight_decay= 0
2020-06-10 09:14:05,742:  >> amsgrad= False
2020-06-10 09:14:05,742:  >> min_lr= 1e-07
2020-06-10 09:14:05,743: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-10 09:14:05,747: Building sched from config
2020-06-10 09:14:05,747:  >> optim= Adam
2020-06-10 09:14:05,747:  >> decay lr by 0.1
2020-06-10 09:14:05,747:  >> eval_fn= MultiViewAP
2020-06-10 09:14:05,748:  >> patience=4
2020-06-10 09:14:05,748:  >> revert=True
2020-06-10 09:14:05,779: loaded save/MultiViewDataset_IndividualWords.1326.pth
2020-06-10 09:14:05,780: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 09:14:05,838: Using module at optim.adam.Adam
2020-06-10 09:14:06,075: Building optim from config
2020-06-10 09:14:06,076:  >> lr= 0.001
2020-06-10 09:14:06,076:  >> betas= (0.9, 0.999)
2020-06-10 09:14:06,076:  >> eps= 1e-08
2020-06-10 09:14:06,076:  >> weight_decay= 0
2020-06-10 09:14:06,077:  >> amsgrad= False
2020-06-10 09:14:06,077:  >> min_lr= 1e-07
2020-06-10 09:14:06,234: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-10 09:14:06,955: Building sched from config
2020-06-10 09:14:06,956:  >> optim= Adam
2020-06-10 09:14:06,956:  >> decay lr by 0.1
2020-06-10 09:14:06,956:  >> eval_fn= MultiViewAP
2020-06-10 09:14:06,957:  >> patience=4
2020-06-10 09:14:06,957:  >> revert=True
2020-06-10 09:14:06,967: loaded save/MultiViewDataset_IndividualWords.1326.pth
2020-06-10 09:14:06,968: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 09:14:06,970: loaded save/MultiViewRNN.1326.pth
2020-06-10 09:14:06,970: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 09:14:07,067: loaded save/MultiViewRNN.1326.pth
2020-06-10 09:14:07,067: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 09:14:09,372: loaded save/Adam.1326.pth
2020-06-10 09:14:09,372: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 09:14:09,379: loaded save/Adam.1326.pth
2020-06-10 09:14:09,379: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 09:14:09,385: loaded save/ReduceLROnPlateau.1326.pth
2020-06-10 09:14:09,385: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 09:14:09,385: epoch=34.00 global_step=1326 lr=0.001 start_iter=0
2020-06-10 09:14:09,385: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 09:14:09,385: loaded save/ReduceLROnPlateau.1326.pth
2020-06-10 09:14:09,385: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 09:14:09,385: epoch=34.00 global_step=1326 lr=0.001 start_iter=0
2020-06-10 09:14:09,385: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 09:16:18,249: 0) loss=0.037 grad_norm=6.42 num_segments=256 num_words=212
2020-06-10 09:16:20,039: 0) loss=0.037 grad_norm=6.42 num_segments=256 num_words=212
2020-06-10 09:18:12,094: 1) loss=0.043 grad_norm=2.10 num_segments=256 num_words=218
2020-06-10 09:18:13,802: 1) loss=0.043 grad_norm=2.10 num_segments=256 num_words=218
2020-06-10 09:19:59,187: 2) loss=0.049 grad_norm=3.33 num_segments=256 num_words=223
2020-06-10 09:19:59,799: 2) loss=0.049 grad_norm=3.33 num_segments=256 num_words=223
2020-06-10 09:21:37,067: 3) loss=0.049 grad_norm=1.56 num_segments=256 num_words=208
2020-06-10 09:21:41,895: 3) loss=0.049 grad_norm=1.56 num_segments=256 num_words=208
2020-06-10 09:23:06,987: 4) loss=0.053 grad_norm=2.58 num_segments=256 num_words=213
2020-06-10 09:23:12,005: 4) loss=0.053 grad_norm=2.58 num_segments=256 num_words=213
2020-06-10 09:24:29,837: 5) loss=0.056 grad_norm=2.86 num_segments=256 num_words=217
2020-06-10 09:24:35,063: 5) loss=0.056 grad_norm=2.86 num_segments=256 num_words=217
2020-06-10 09:25:42,527: 6) loss=0.060 grad_norm=1.98 num_segments=256 num_words=213
2020-06-10 09:25:48,435: 6) loss=0.060 grad_norm=1.98 num_segments=256 num_words=213
2020-06-10 09:26:47,466: 7) loss=0.073 grad_norm=3.29 num_segments=256 num_words=220
2020-06-10 09:26:56,094: 7) loss=0.073 grad_norm=3.29 num_segments=256 num_words=220
2020-06-10 09:27:54,901: 8) loss=0.083 grad_norm=3.05 num_segments=256 num_words=212
2020-06-10 09:28:04,522: 8) loss=0.083 grad_norm=3.05 num_segments=256 num_words=212
2020-06-10 09:28:59,463: 9) loss=0.071 grad_norm=2.10 num_segments=256 num_words=210
2020-06-10 09:29:11,535: 9) loss=0.071 grad_norm=2.10 num_segments=256 num_words=210
2020-06-10 09:30:07,699: 10) loss=0.067 grad_norm=2.63 num_segments=256 num_words=207
2020-06-10 09:30:19,775: 10) loss=0.067 grad_norm=2.63 num_segments=256 num_words=207
2020-06-10 09:31:13,151: 11) loss=0.072 grad_norm=5.94 num_segments=256 num_words=199
2020-06-10 09:31:24,567: 11) loss=0.072 grad_norm=5.94 num_segments=256 num_words=199
2020-06-10 09:32:18,550: 12) loss=0.072 grad_norm=2.91 num_segments=256 num_words=216
2020-06-10 09:32:31,744: 12) loss=0.072 grad_norm=2.91 num_segments=256 num_words=216
2020-06-10 09:33:23,949: 13) loss=0.077 grad_norm=4.22 num_segments=256 num_words=222
2020-06-10 09:33:38,113: 13) loss=0.077 grad_norm=4.22 num_segments=256 num_words=222
2020-06-10 09:34:32,962: 14) loss=0.066 grad_norm=3.32 num_segments=256 num_words=207
2020-06-10 09:34:47,406: 14) loss=0.066 grad_norm=3.32 num_segments=256 num_words=207
2020-06-10 09:35:38,282: 15) loss=0.069 grad_norm=2.32 num_segments=256 num_words=204
2020-06-10 09:35:52,762: 15) loss=0.069 grad_norm=2.32 num_segments=256 num_words=204
2020-06-10 09:36:44,586: 16) loss=0.071 grad_norm=4.15 num_segments=256 num_words=205
2020-06-10 09:37:01,375: 16) loss=0.071 grad_norm=4.15 num_segments=256 num_words=205
2020-06-10 09:37:50,366: 17) loss=0.069 grad_norm=7.43 num_segments=256 num_words=212
2020-06-10 09:38:07,724: 17) loss=0.069 grad_norm=7.43 num_segments=256 num_words=212
2020-06-10 09:38:56,196: 18) loss=0.142 grad_norm=4.60 num_segments=256 num_words=212
2020-06-10 09:39:14,651: 18) loss=0.142 grad_norm=4.60 num_segments=256 num_words=212
2020-06-10 09:40:06,648: 19) loss=0.071 grad_norm=2.03 num_segments=256 num_words=201
2020-06-10 09:40:27,254: 19) loss=0.071 grad_norm=2.03 num_segments=256 num_words=201
2020-06-10 09:41:11,292: 20) loss=0.067 grad_norm=2.34 num_segments=256 num_words=209
2020-06-10 09:41:32,766: 20) loss=0.067 grad_norm=2.34 num_segments=256 num_words=209
2020-06-10 09:42:17,083: 21) loss=0.072 grad_norm=3.73 num_segments=256 num_words=211
2020-06-10 09:42:40,268: 21) loss=0.072 grad_norm=3.73 num_segments=256 num_words=211
2020-06-10 09:43:22,950: 22) loss=0.064 grad_norm=4.46 num_segments=256 num_words=204
2020-06-10 09:43:49,181: 22) loss=0.064 grad_norm=4.46 num_segments=256 num_words=204
2020-06-10 09:44:27,924: 23) loss=0.070 grad_norm=2.88 num_segments=256 num_words=218
2020-06-10 09:44:55,527: 23) loss=0.070 grad_norm=2.88 num_segments=256 num_words=218
2020-06-10 09:45:39,303: 24) loss=0.073 grad_norm=3.57 num_segments=256 num_words=220
2020-06-10 09:46:07,681: 24) loss=0.073 grad_norm=3.57 num_segments=256 num_words=220
2020-06-10 09:46:44,694: 25) loss=0.064 grad_norm=8.22 num_segments=256 num_words=211
2020-06-10 09:47:16,786: 25) loss=0.064 grad_norm=8.22 num_segments=256 num_words=211
2020-06-10 09:47:49,835: 26) loss=0.068 grad_norm=2.02 num_segments=256 num_words=205
2020-06-10 09:48:26,441: 26) loss=0.068 grad_norm=2.02 num_segments=256 num_words=205
2020-06-10 09:48:55,226: 27) loss=0.071 grad_norm=3.94 num_segments=256 num_words=204
2020-06-10 09:49:31,859: 27) loss=0.071 grad_norm=3.94 num_segments=256 num_words=204
2020-06-10 09:50:00,568: 28) loss=0.073 grad_norm=6.57 num_segments=256 num_words=213
2020-06-10 09:50:41,023: 28) loss=0.073 grad_norm=6.57 num_segments=256 num_words=213
2020-06-10 09:51:06,314: 29) loss=0.072 grad_norm=2.12 num_segments=256 num_words=211
2020-06-10 09:51:46,744: 29) loss=0.072 grad_norm=2.12 num_segments=256 num_words=211
2020-06-10 09:52:11,772: 30) loss=0.062 grad_norm=3.45 num_segments=256 num_words=208
2020-06-10 09:52:52,138: 30) loss=0.062 grad_norm=3.45 num_segments=256 num_words=208
2020-06-10 09:53:25,359: 31) loss=0.066 grad_norm=3.27 num_segments=256 num_words=198
2020-06-10 09:54:05,211: 31) loss=0.066 grad_norm=3.27 num_segments=256 num_words=198
2020-06-10 09:54:30,630: 32) loss=0.063 grad_norm=2.05 num_segments=256 num_words=215
2020-06-10 09:55:10,314: 32) loss=0.063 grad_norm=2.05 num_segments=256 num_words=215
2020-06-10 09:55:36,766: 33) loss=0.077 grad_norm=3.59 num_segments=256 num_words=208
2020-06-10 09:56:16,497: 33) loss=0.077 grad_norm=3.59 num_segments=256 num_words=208
2020-06-10 09:56:42,870: 34) loss=0.070 grad_norm=3.02 num_segments=256 num_words=206
2020-06-10 09:57:21,436: 34) loss=0.070 grad_norm=3.02 num_segments=256 num_words=206
2020-06-10 09:57:48,848: 35) loss=0.068 grad_norm=2.22 num_segments=256 num_words=204
2020-06-10 09:58:26,541: 35) loss=0.068 grad_norm=2.22 num_segments=256 num_words=204
2020-06-10 09:58:55,231: 36) loss=0.065 grad_norm=6.98 num_segments=256 num_words=207
2020-06-10 09:59:37,072: 36) loss=0.065 grad_norm=6.98 num_segments=256 num_words=207
2020-06-10 10:00:00,789: 37) loss=0.070 grad_norm=4.99 num_segments=256 num_words=217
2020-06-10 10:00:45,153: 37) loss=0.070 grad_norm=4.99 num_segments=256 num_words=217
2020-06-10 10:00:59,905: 38) loss=0.064 grad_norm=2.63 num_segments=243 num_words=202
2020-06-10 10:00:59,917: epoch= 35.00
2020-06-10 10:00:59,917:  >> time to evaluate and save:
2020-06-10 10:00:59,964: saved save/MultiViewDataset_IndividualWords.1365.pth
2020-06-10 10:01:00,018: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 10:01:00,048: removed save/MultiViewDataset_IndividualWords.1131.pth
2020-06-10 10:01:00,048: saved MultiViewDataset_IndividualWords successfully
2020-06-10 10:01:01,444: saved save/MultiViewRNN.1365.pth
2020-06-10 10:01:01,452: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 10:01:01,690: removed save/MultiViewRNN.1131.pth
2020-06-10 10:01:01,690: saved MultiViewRNN successfully
2020-06-10 10:01:04,208: saved save/Adam.1365.pth
2020-06-10 10:01:04,232: most_recent linked save/Adam.most_recent.pth
2020-06-10 10:01:04,535: removed save/Adam.1131.pth
2020-06-10 10:01:04,535: saved Adam successfully
2020-06-10 10:01:04,537: saved save/ReduceLROnPlateau.1365.pth
2020-06-10 10:01:04,547: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 10:01:04,564: saved ReduceLROnPlateau successfully
2020-06-10 10:01:04,566: saved config successfully
2020-06-10 10:01:45,834: 38) loss=0.064 grad_norm=2.63 num_segments=243 num_words=202
2020-06-10 10:01:45,847: epoch= 35.00
2020-06-10 10:01:45,848:  >> time to evaluate and save:
2020-06-10 10:01:45,856: saved MultiViewDataset_IndividualWords successfully
2020-06-10 10:01:45,866: saved MultiViewRNN successfully
2020-06-10 10:01:45,876: saved Adam successfully
2020-06-10 10:01:45,880: saved ReduceLROnPlateau successfully
2020-06-10 10:01:45,882: saved config successfully
2020-06-10 10:02:40,119:   >> crossview_ap=0.714 (10966 x 3921 pairs)
2020-06-10 10:03:18,813:   >> crossview_ap=0.714 (10966 x 3921 pairs)
2020-06-10 10:03:44,111:   >> acoustic_ap=0.773 (10966 choose 2 pairs)
2020-06-10 10:03:44,113: best_so_far= 0.714 at 1365
2020-06-10 10:03:44,121: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 10:03:44,123: saved MultiViewDataset_IndividualWords successfully
2020-06-10 10:03:44,133: best linked save/MultiViewRNN.best.pth
2020-06-10 10:03:44,142: saved MultiViewRNN successfully
2020-06-10 10:03:44,158: best linked save/Adam.best.pth
2020-06-10 10:03:44,167: saved Adam successfully
2020-06-10 10:03:44,168: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 10:03:44,174: saved ReduceLROnPlateau successfully
2020-06-10 10:03:44,250: epoch=35.00 global_step=1365 lr=0.001 start_iter=0
2020-06-10 10:03:44,250: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 10:04:21,246:   >> acoustic_ap=0.773 (10966 choose 2 pairs)
2020-06-10 10:04:21,249: best_so_far= 0.714 at 1365
2020-06-10 10:04:21,252: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 10:04:21,256: saved MultiViewDataset_IndividualWords successfully
2020-06-10 10:04:21,258: best linked save/MultiViewRNN.best.pth
2020-06-10 10:04:21,267: saved MultiViewRNN successfully
2020-06-10 10:04:21,269: best linked save/Adam.best.pth
2020-06-10 10:04:21,278: saved Adam successfully
2020-06-10 10:04:21,305: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 10:04:21,311: saved ReduceLROnPlateau successfully
2020-06-10 10:04:21,402: epoch=35.00 global_step=1365 lr=0.001 start_iter=0
2020-06-10 10:04:21,402: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 10:04:52,539: 0) loss=0.068 grad_norm=2.80 num_segments=256 num_words=207
2020-06-10 10:05:28,623: 0) loss=0.068 grad_norm=2.80 num_segments=256 num_words=207
2020-06-10 10:06:10,673: 1) loss=0.070 grad_norm=1.89 num_segments=256 num_words=201
2020-06-10 10:06:49,030: 1) loss=0.070 grad_norm=1.89 num_segments=256 num_words=201
2020-06-10 10:07:16,660: 2) loss=0.069 grad_norm=2.53 num_segments=256 num_words=206
2020-06-10 10:07:55,226: 2) loss=0.069 grad_norm=2.53 num_segments=256 num_words=206
2020-06-10 10:08:22,414: 3) loss=0.073 grad_norm=2.96 num_segments=256 num_words=200
2020-06-10 10:09:00,956: 3) loss=0.073 grad_norm=2.96 num_segments=256 num_words=200
2020-06-10 10:09:28,248: 4) loss=0.068 grad_norm=11.44 num_segments=256 num_words=215
2020-06-10 10:10:06,335: 4) loss=0.068 grad_norm=11.44 num_segments=256 num_words=215
2020-06-10 10:10:33,714: 5) loss=0.074 grad_norm=3.88 num_segments=256 num_words=208
2020-06-10 10:11:16,087: 5) loss=0.074 grad_norm=3.88 num_segments=256 num_words=208
2020-06-10 10:11:39,205: 6) loss=0.070 grad_norm=2.26 num_segments=256 num_words=202
2020-06-10 10:12:24,641: 6) loss=0.070 grad_norm=2.26 num_segments=256 num_words=202
2020-06-10 10:12:44,348: 7) loss=0.065 grad_norm=2.24 num_segments=256 num_words=219
2020-06-10 10:13:32,030: 7) loss=0.065 grad_norm=2.24 num_segments=256 num_words=219
2020-06-10 10:13:49,806: 8) loss=0.068 grad_norm=2.22 num_segments=256 num_words=215
2020-06-10 10:14:37,536: 8) loss=0.068 grad_norm=2.22 num_segments=256 num_words=215
2020-06-10 10:14:55,897: 9) loss=0.076 grad_norm=7.93 num_segments=256 num_words=220
2020-06-10 10:15:42,917: 9) loss=0.076 grad_norm=7.93 num_segments=256 num_words=220
2020-06-10 10:16:01,978: 10) loss=0.071 grad_norm=11.53 num_segments=256 num_words=224
2020-06-10 10:16:50,936: 10) loss=0.071 grad_norm=11.53 num_segments=256 num_words=224
2020-06-10 10:17:07,777: 11) loss=0.067 grad_norm=5.64 num_segments=256 num_words=210
2020-06-10 10:17:56,198: 11) loss=0.067 grad_norm=5.64 num_segments=256 num_words=210
2020-06-10 10:18:25,653: 12) loss=0.071 grad_norm=2.45 num_segments=256 num_words=207
2020-06-10 10:19:14,590: 12) loss=0.071 grad_norm=2.45 num_segments=256 num_words=207
2020-06-10 10:19:31,281: 13) loss=0.063 grad_norm=6.46 num_segments=256 num_words=214
2020-06-10 10:20:19,773: 13) loss=0.063 grad_norm=6.46 num_segments=256 num_words=214
2020-06-10 10:20:36,837: 14) loss=0.082 grad_norm=14.84 num_segments=256 num_words=212
2020-06-10 10:21:24,744: 14) loss=0.082 grad_norm=14.84 num_segments=256 num_words=212
2020-06-10 10:21:42,812: 15) loss=0.072 grad_norm=2.64 num_segments=256 num_words=207
2020-06-10 10:22:29,608: 15) loss=0.072 grad_norm=2.64 num_segments=256 num_words=207
2020-06-10 10:22:48,514: 16) loss=0.124 grad_norm=6.74 num_segments=256 num_words=196
2020-06-10 10:23:35,690: 16) loss=0.124 grad_norm=6.74 num_segments=256 num_words=196
2020-06-10 10:23:53,875: 17) loss=0.074 grad_norm=5.17 num_segments=256 num_words=220
2020-06-10 10:24:42,639: 17) loss=0.074 grad_norm=5.17 num_segments=256 num_words=220
2020-06-10 10:24:58,862: 18) loss=0.082 grad_norm=3.86 num_segments=256 num_words=211
2020-06-10 10:25:53,088: 18) loss=0.082 grad_norm=3.86 num_segments=256 num_words=211
2020-06-10 10:26:04,132: 19) loss=0.067 grad_norm=3.26 num_segments=256 num_words=209
2020-06-10 10:26:58,559: 19) loss=0.067 grad_norm=3.26 num_segments=256 num_words=209
2020-06-10 10:27:09,552: 20) loss=0.077 grad_norm=6.16 num_segments=256 num_words=218
2020-06-10 10:28:04,147: 20) loss=0.077 grad_norm=6.16 num_segments=256 num_words=218
2020-06-10 10:28:15,666: 21) loss=0.144 grad_norm=9.90 num_segments=256 num_words=192
2020-06-10 10:29:09,654: 21) loss=0.144 grad_norm=9.90 num_segments=256 num_words=192
2020-06-10 10:29:21,568: 22) loss=0.067 grad_norm=4.21 num_segments=256 num_words=205
2020-06-10 10:30:15,002: 22) loss=0.067 grad_norm=4.21 num_segments=256 num_words=205
2020-06-10 10:30:27,283: 23) loss=0.068 grad_norm=1.80 num_segments=256 num_words=207
2020-06-10 10:31:19,996: 23) loss=0.068 grad_norm=1.80 num_segments=256 num_words=207
2020-06-10 10:31:32,983: 24) loss=0.071 grad_norm=2.19 num_segments=256 num_words=217
2020-06-10 10:32:25,029: 24) loss=0.071 grad_norm=2.19 num_segments=256 num_words=217
2020-06-10 10:32:38,912: 25) loss=0.137 grad_norm=5.80 num_segments=256 num_words=202
2020-06-10 10:33:30,245: 25) loss=0.137 grad_norm=5.80 num_segments=256 num_words=202
2020-06-10 10:34:00,839: 26) loss=0.079 grad_norm=5.81 num_segments=256 num_words=207
2020-06-10 10:34:53,227: 26) loss=0.079 grad_norm=5.81 num_segments=256 num_words=207
2020-06-10 10:35:06,100: 27) loss=0.068 grad_norm=5.88 num_segments=256 num_words=214
2020-06-10 10:36:00,808: 27) loss=0.068 grad_norm=5.88 num_segments=256 num_words=214
2020-06-10 10:36:11,780: 28) loss=0.075 grad_norm=3.24 num_segments=256 num_words=209
2020-06-10 10:37:06,483: 28) loss=0.075 grad_norm=3.24 num_segments=256 num_words=209
2020-06-10 10:37:17,147: 29) loss=0.069 grad_norm=2.32 num_segments=256 num_words=204
2020-06-10 10:38:12,437: 29) loss=0.069 grad_norm=2.32 num_segments=256 num_words=204
2020-06-10 10:38:22,903: 30) loss=0.064 grad_norm=3.73 num_segments=256 num_words=211
2020-06-10 10:39:17,502: 30) loss=0.064 grad_norm=3.73 num_segments=256 num_words=211
2020-06-10 10:39:28,916: 31) loss=0.065 grad_norm=3.19 num_segments=256 num_words=212
2020-06-10 10:40:22,167: 31) loss=0.065 grad_norm=3.19 num_segments=256 num_words=212
2020-06-10 10:40:34,233: 32) loss=0.067 grad_norm=3.12 num_segments=256 num_words=216
2020-06-10 10:41:30,631: 32) loss=0.067 grad_norm=3.12 num_segments=256 num_words=216
2020-06-10 10:41:39,797: 33) loss=0.068 grad_norm=4.07 num_segments=256 num_words=205
2020-06-10 10:42:36,407: 33) loss=0.068 grad_norm=4.07 num_segments=256 num_words=205
2020-06-10 10:42:45,150: 34) loss=0.083 grad_norm=4.81 num_segments=256 num_words=212
2020-06-10 10:43:46,910: 34) loss=0.083 grad_norm=4.81 num_segments=256 num_words=212
2020-06-10 10:43:50,531: 35) loss=0.072 grad_norm=4.49 num_segments=256 num_words=211
2020-06-10 10:44:52,541: 35) loss=0.072 grad_norm=4.49 num_segments=256 num_words=211
2020-06-10 10:44:56,140: 36) loss=0.068 grad_norm=2.08 num_segments=256 num_words=205
2020-06-10 10:45:58,946: 36) loss=0.068 grad_norm=2.08 num_segments=256 num_words=205
2020-06-10 10:46:01,840: 37) loss=0.076 grad_norm=6.60 num_segments=256 num_words=215
2020-06-10 10:47:00,749: 38) loss=0.071 grad_norm=3.04 num_segments=243 num_words=198
2020-06-10 10:47:00,760: epoch= 36.00
2020-06-10 10:47:00,760:  >> time to evaluate and save:
2020-06-10 10:47:00,790: saved save/MultiViewDataset_IndividualWords.1404.pth
2020-06-10 10:47:00,826: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 10:47:00,872: removed save/MultiViewDataset_IndividualWords.1170.pth
2020-06-10 10:47:00,873: saved MultiViewDataset_IndividualWords successfully
2020-06-10 10:47:02,179: saved save/MultiViewRNN.1404.pth
2020-06-10 10:47:02,201: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 10:47:02,274: removed save/MultiViewRNN.1170.pth
2020-06-10 10:47:02,274: saved MultiViewRNN successfully
2020-06-10 10:47:04,758: saved save/Adam.1404.pth
2020-06-10 10:47:04,766: most_recent linked save/Adam.most_recent.pth
2020-06-10 10:47:04,851: removed save/Adam.1170.pth
2020-06-10 10:47:04,851: saved Adam successfully
2020-06-10 10:47:04,854: saved save/ReduceLROnPlateau.1404.pth
2020-06-10 10:47:04,858: 37) loss=0.076 grad_norm=6.60 num_segments=256 num_words=215
2020-06-10 10:47:04,862: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 10:47:04,865: removed save/ReduceLROnPlateau.1131.pth
2020-06-10 10:47:04,865: saved ReduceLROnPlateau successfully
2020-06-10 10:47:04,867: saved config successfully
2020-06-10 10:48:10,633: 38) loss=0.071 grad_norm=3.04 num_segments=243 num_words=198
2020-06-10 10:48:10,649: epoch= 36.00
2020-06-10 10:48:10,650:  >> time to evaluate and save:
2020-06-10 10:48:10,654: saved MultiViewDataset_IndividualWords successfully
2020-06-10 10:48:10,659: saved MultiViewRNN successfully
2020-06-10 10:48:10,664: saved Adam successfully
2020-06-10 10:48:10,666: saved ReduceLROnPlateau successfully
2020-06-10 10:48:10,667: saved config successfully
2020-06-10 10:48:37,038:   >> crossview_ap=0.715 (10966 x 3921 pairs)
2020-06-10 10:49:41,447:   >> acoustic_ap=0.771 (10966 choose 2 pairs)
2020-06-10 10:49:41,450: best_so_far= 0.715 at 1404
2020-06-10 10:49:41,481: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 10:49:41,503: saved MultiViewDataset_IndividualWords successfully
2020-06-10 10:49:41,519: best linked save/MultiViewRNN.best.pth
2020-06-10 10:49:41,532: saved MultiViewRNN successfully
2020-06-10 10:49:41,549: best linked save/Adam.best.pth
2020-06-10 10:49:41,561: saved Adam successfully
2020-06-10 10:49:41,572: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 10:49:41,584: removed save/ReduceLROnPlateau.1170.pth
2020-06-10 10:49:41,585: saved ReduceLROnPlateau successfully
2020-06-10 10:49:42,129: epoch=36.00 global_step=1404 lr=0.001 start_iter=0
2020-06-10 10:49:42,129: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 10:49:45,762:   >> crossview_ap=0.715 (10966 x 3921 pairs)
2020-06-10 10:50:49,334:   >> acoustic_ap=0.771 (10966 choose 2 pairs)
2020-06-10 10:50:49,337: best_so_far= 0.715 at 1404
2020-06-10 10:50:49,341: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 10:50:49,344: saved MultiViewDataset_IndividualWords successfully
2020-06-10 10:50:49,346: best linked save/MultiViewRNN.best.pth
2020-06-10 10:50:49,355: saved MultiViewRNN successfully
2020-06-10 10:50:49,357: best linked save/Adam.best.pth
2020-06-10 10:50:49,367: saved Adam successfully
2020-06-10 10:50:49,368: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 10:50:49,370: saved ReduceLROnPlateau successfully
2020-06-10 10:50:49,866: 0) loss=0.072 grad_norm=6.18 num_segments=256 num_words=207
2020-06-10 10:50:49,925: epoch=36.00 global_step=1404 lr=0.001 start_iter=0
2020-06-10 10:50:49,925: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 10:51:55,527: 1) loss=0.075 grad_norm=5.98 num_segments=256 num_words=216
2020-06-10 10:52:01,326: 0) loss=0.072 grad_norm=6.18 num_segments=256 num_words=207
2020-06-10 10:53:02,579: 2) loss=0.066 grad_norm=1.69 num_segments=256 num_words=214
2020-06-10 10:53:07,750: 1) loss=0.075 grad_norm=5.98 num_segments=256 num_words=216
2020-06-10 10:54:08,515: 3) loss=0.073 grad_norm=5.15 num_segments=256 num_words=218
2020-06-10 10:54:13,247: 2) loss=0.066 grad_norm=1.69 num_segments=256 num_words=214
2020-06-10 10:55:16,430: 4) loss=0.057 grad_norm=2.17 num_segments=256 num_words=193
2020-06-10 10:55:18,574: 3) loss=0.073 grad_norm=5.15 num_segments=256 num_words=218
2020-06-10 10:56:25,881: 4) loss=0.057 grad_norm=2.17 num_segments=256 num_words=193
2020-06-10 10:56:47,736: 5) loss=0.071 grad_norm=3.14 num_segments=256 num_words=208
2020-06-10 10:57:53,193: 6) loss=0.074 grad_norm=1.90 num_segments=256 num_words=214
2020-06-10 10:57:55,895: 5) loss=0.071 grad_norm=3.14 num_segments=256 num_words=208
2020-06-10 10:58:58,847: 7) loss=0.073 grad_norm=7.24 num_segments=256 num_words=201
2020-06-10 10:59:05,273: 6) loss=0.074 grad_norm=1.90 num_segments=256 num_words=214
2020-06-10 11:00:05,491: 8) loss=0.072 grad_norm=11.74 num_segments=256 num_words=216
2020-06-10 11:00:10,476: 7) loss=0.073 grad_norm=7.24 num_segments=256 num_words=201
2020-06-10 11:01:11,599: 9) loss=0.072 grad_norm=4.75 num_segments=256 num_words=218
2020-06-10 11:01:17,987: 8) loss=0.072 grad_norm=11.74 num_segments=256 num_words=216
2020-06-10 11:02:17,613: 10) loss=0.068 grad_norm=5.18 num_segments=256 num_words=217
2020-06-10 11:02:23,913: 9) loss=0.072 grad_norm=4.75 num_segments=256 num_words=218
2020-06-10 11:03:24,775: 11) loss=0.067 grad_norm=4.46 num_segments=256 num_words=220
2020-06-10 11:03:29,833: 10) loss=0.068 grad_norm=5.18 num_segments=256 num_words=217
2020-06-10 11:04:30,778: 12) loss=0.141 grad_norm=13.83 num_segments=256 num_words=214
2020-06-10 11:04:35,871: 11) loss=0.067 grad_norm=4.46 num_segments=256 num_words=220
2020-06-10 11:05:36,887: 13) loss=0.068 grad_norm=3.48 num_segments=256 num_words=206
2020-06-10 11:05:41,547: 12) loss=0.141 grad_norm=13.83 num_segments=256 num_words=214
2020-06-10 11:06:43,457: 14) loss=0.081 grad_norm=9.36 num_segments=256 num_words=209
2020-06-10 11:06:47,462: 13) loss=0.068 grad_norm=3.48 num_segments=256 num_words=206
2020-06-10 11:07:49,841: 15) loss=0.062 grad_norm=3.98 num_segments=256 num_words=207
2020-06-10 11:07:54,339: 14) loss=0.081 grad_norm=9.36 num_segments=256 num_words=209
2020-06-10 11:08:56,379: 16) loss=0.128 grad_norm=6.39 num_segments=256 num_words=217
2020-06-10 11:09:00,795: 15) loss=0.062 grad_norm=3.98 num_segments=256 num_words=207
2020-06-10 11:10:03,004: 17) loss=0.068 grad_norm=3.91 num_segments=256 num_words=214
2020-06-10 11:10:07,846: 16) loss=0.128 grad_norm=6.39 num_segments=256 num_words=217
2020-06-10 11:11:09,310: 18) loss=0.069 grad_norm=2.55 num_segments=256 num_words=208
2020-06-10 11:11:15,238: 17) loss=0.068 grad_norm=3.91 num_segments=256 num_words=214
2020-06-10 11:12:15,802: 19) loss=0.068 grad_norm=17.03 num_segments=256 num_words=215
2020-06-10 11:12:22,132: 18) loss=0.069 grad_norm=2.55 num_segments=256 num_words=208
2020-06-10 11:13:21,637: 20) loss=0.072 grad_norm=5.63 num_segments=256 num_words=214
2020-06-10 11:13:28,096: 19) loss=0.068 grad_norm=17.03 num_segments=256 num_words=215
2020-06-10 11:14:27,713: 21) loss=0.071 grad_norm=4.96 num_segments=256 num_words=216
2020-06-10 11:14:33,836: 20) loss=0.072 grad_norm=5.63 num_segments=256 num_words=214
2020-06-10 11:15:34,373: 22) loss=0.074 grad_norm=7.12 num_segments=256 num_words=213
2020-06-10 11:15:39,713: 21) loss=0.071 grad_norm=4.96 num_segments=256 num_words=216
2020-06-10 11:16:40,816: 23) loss=0.069 grad_norm=4.44 num_segments=256 num_words=199
2020-06-10 11:16:45,566: 22) loss=0.074 grad_norm=7.12 num_segments=256 num_words=213
2020-06-10 11:17:47,153: 24) loss=0.063 grad_norm=6.45 num_segments=256 num_words=211
2020-06-10 11:17:51,336: 23) loss=0.069 grad_norm=4.44 num_segments=256 num_words=199
2020-06-10 11:18:53,314: 25) loss=0.069 grad_norm=10.53 num_segments=256 num_words=215
2020-06-10 11:18:57,728: 24) loss=0.063 grad_norm=6.45 num_segments=256 num_words=211
2020-06-10 11:20:04,262: 25) loss=0.069 grad_norm=10.53 num_segments=256 num_words=215
2020-06-10 11:20:27,141: 26) loss=0.069 grad_norm=2.63 num_segments=256 num_words=201
2020-06-10 11:21:33,699: 27) loss=0.134 grad_norm=8.23 num_segments=256 num_words=197
2020-06-10 11:21:38,374: 26) loss=0.069 grad_norm=2.63 num_segments=256 num_words=201
2020-06-10 11:22:40,187: 28) loss=0.064 grad_norm=2.93 num_segments=256 num_words=213
2020-06-10 11:22:44,667: 27) loss=0.134 grad_norm=8.23 num_segments=256 num_words=197
2020-06-10 11:23:46,531: 29) loss=0.068 grad_norm=4.62 num_segments=256 num_words=207
2020-06-10 11:23:51,206: 28) loss=0.064 grad_norm=2.93 num_segments=256 num_words=213
2020-06-10 11:24:53,290: 30) loss=0.073 grad_norm=4.73 num_segments=256 num_words=206
2020-06-10 11:24:57,368: 29) loss=0.068 grad_norm=4.62 num_segments=256 num_words=207
2020-06-10 11:25:59,575: 31) loss=0.075 grad_norm=3.60 num_segments=256 num_words=205
2020-06-10 11:26:03,543: 30) loss=0.073 grad_norm=4.73 num_segments=256 num_words=206
2020-06-10 11:27:06,264: 32) loss=0.066 grad_norm=2.94 num_segments=256 num_words=210
2020-06-10 11:27:09,810: 31) loss=0.075 grad_norm=3.60 num_segments=256 num_words=205
2020-06-10 11:28:12,624: 33) loss=0.067 grad_norm=3.65 num_segments=256 num_words=217
2020-06-10 11:28:19,569: 32) loss=0.066 grad_norm=2.94 num_segments=256 num_words=210
2020-06-10 11:29:19,201: 34) loss=0.082 grad_norm=3.25 num_segments=256 num_words=199
2020-06-10 11:29:25,993: 33) loss=0.067 grad_norm=3.65 num_segments=256 num_words=217
2020-06-10 11:30:25,553: 35) loss=0.071 grad_norm=6.29 num_segments=256 num_words=211
2020-06-10 11:30:32,141: 34) loss=0.082 grad_norm=3.25 num_segments=256 num_words=199
2020-06-10 11:31:31,891: 36) loss=0.138 grad_norm=4.53 num_segments=256 num_words=203
2020-06-10 11:31:38,073: 35) loss=0.071 grad_norm=6.29 num_segments=256 num_words=211
2020-06-10 11:32:37,987: 37) loss=0.065 grad_norm=4.25 num_segments=256 num_words=213
2020-06-10 11:32:48,097: 36) loss=0.138 grad_norm=4.53 num_segments=256 num_words=203
2020-06-10 11:33:37,486: 38) loss=0.074 grad_norm=4.37 num_segments=243 num_words=203
2020-06-10 11:33:37,499: epoch= 37.00
2020-06-10 11:33:37,499:  >> time to evaluate and save:
2020-06-10 11:33:37,534: saved save/MultiViewDataset_IndividualWords.1443.pth
2020-06-10 11:33:37,536: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 11:33:37,559: removed save/MultiViewDataset_IndividualWords.1209.pth
2020-06-10 11:33:37,559: saved MultiViewDataset_IndividualWords successfully
2020-06-10 11:33:38,933: saved save/MultiViewRNN.1443.pth
2020-06-10 11:33:38,935: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 11:33:38,974: removed save/MultiViewRNN.1209.pth
2020-06-10 11:33:38,974: saved MultiViewRNN successfully
2020-06-10 11:33:41,524: saved save/Adam.1443.pth
2020-06-10 11:33:41,526: most_recent linked save/Adam.most_recent.pth
2020-06-10 11:33:41,574: removed save/Adam.1209.pth
2020-06-10 11:33:41,574: saved Adam successfully
2020-06-10 11:33:41,576: saved save/ReduceLROnPlateau.1443.pth
2020-06-10 11:33:41,578: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 11:33:41,582: removed save/ReduceLROnPlateau.1209.pth
2020-06-10 11:33:41,582: saved ReduceLROnPlateau successfully
2020-06-10 11:33:41,584: saved config successfully
2020-06-10 11:34:00,804: 37) loss=0.065 grad_norm=4.25 num_segments=256 num_words=213
2020-06-10 11:35:05,654: 38) loss=0.074 grad_norm=4.37 num_segments=243 num_words=203
2020-06-10 11:35:05,670: epoch= 37.00
2020-06-10 11:35:05,671:  >> time to evaluate and save:
2020-06-10 11:35:05,674: saved MultiViewDataset_IndividualWords successfully
2020-06-10 11:35:05,679: saved MultiViewRNN successfully
2020-06-10 11:35:05,683: saved Adam successfully
2020-06-10 11:35:05,685: saved ReduceLROnPlateau successfully
2020-06-10 11:35:05,686: saved config successfully
2020-06-10 11:35:18,349:   >> crossview_ap=0.715 (10966 x 3921 pairs)
2020-06-10 11:36:28,685:   >> acoustic_ap=0.773 (10966 choose 2 pairs)
2020-06-10 11:36:28,689: best_so_far= 0.715 at 1404
2020-06-10 11:36:29,485: epoch=37.00 global_step=1443 lr=0.001 start_iter=0
2020-06-10 11:36:29,485: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 11:36:40,749:   >> crossview_ap=0.715 (10966 x 3921 pairs)
2020-06-10 11:37:38,605: 0) loss=0.071 grad_norm=2.90 num_segments=256 num_words=215
2020-06-10 11:37:46,779:   >> acoustic_ap=0.773 (10966 choose 2 pairs)
2020-06-10 11:37:46,782: best_so_far= 0.715 at 1404
2020-06-10 11:37:47,574: epoch=37.00 global_step=1443 lr=0.001 start_iter=0
2020-06-10 11:37:47,575: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 11:38:50,273: 1) loss=0.066 grad_norm=2.45 num_segments=256 num_words=210
2020-06-10 11:38:56,963: 0) loss=0.071 grad_norm=2.90 num_segments=256 num_words=215
2020-06-10 11:39:57,517: 2) loss=0.142 grad_norm=8.49 num_segments=256 num_words=202
2020-06-10 11:40:03,105: 1) loss=0.066 grad_norm=2.45 num_segments=256 num_words=210
2020-06-10 11:41:04,935: 3) loss=0.064 grad_norm=1.92 num_segments=256 num_words=213
2020-06-10 11:41:09,350: 2) loss=0.142 grad_norm=8.49 num_segments=256 num_words=202
2020-06-10 11:42:11,828: 4) loss=0.068 grad_norm=3.69 num_segments=256 num_words=198
2020-06-10 11:42:15,495: 3) loss=0.064 grad_norm=1.92 num_segments=256 num_words=213
2020-06-10 11:43:18,378: 5) loss=0.079 grad_norm=3.05 num_segments=256 num_words=212
2020-06-10 11:43:21,573: 4) loss=0.068 grad_norm=3.69 num_segments=256 num_words=198
2020-06-10 11:44:25,050: 6) loss=0.064 grad_norm=2.52 num_segments=256 num_words=219
2020-06-10 11:44:28,121: 5) loss=0.079 grad_norm=3.05 num_segments=256 num_words=212
2020-06-10 11:45:31,566: 7) loss=0.071 grad_norm=2.19 num_segments=256 num_words=210
2020-06-10 11:45:34,326: 6) loss=0.064 grad_norm=2.52 num_segments=256 num_words=219
2020-06-10 11:46:38,450: 8) loss=0.069 grad_norm=3.26 num_segments=256 num_words=217
2020-06-10 11:46:40,348: 7) loss=0.071 grad_norm=2.19 num_segments=256 num_words=210
2020-06-10 11:47:44,955: 9) loss=0.068 grad_norm=12.05 num_segments=256 num_words=204
2020-06-10 11:47:46,795: 8) loss=0.069 grad_norm=3.26 num_segments=256 num_words=217
2020-06-10 11:48:51,220: 10) loss=0.063 grad_norm=10.88 num_segments=256 num_words=222
2020-06-10 11:48:53,232: 9) loss=0.068 grad_norm=12.05 num_segments=256 num_words=204
2020-06-10 11:49:57,659: 11) loss=0.077 grad_norm=3.43 num_segments=256 num_words=209
2020-06-10 11:49:59,444: 10) loss=0.063 grad_norm=10.88 num_segments=256 num_words=222
2020-06-10 11:51:04,185: 12) loss=0.075 grad_norm=4.82 num_segments=256 num_words=201
2020-06-10 11:51:05,157: 11) loss=0.077 grad_norm=3.43 num_segments=256 num_words=209
2020-06-10 11:52:10,154: 13) loss=0.068 grad_norm=4.49 num_segments=256 num_words=210
2020-06-10 11:52:13,217: 12) loss=0.075 grad_norm=4.82 num_segments=256 num_words=201
2020-06-10 11:53:19,270: 13) loss=0.068 grad_norm=4.49 num_segments=256 num_words=210
2020-06-10 11:53:58,519: 14) loss=0.074 grad_norm=4.83 num_segments=256 num_words=209
2020-06-10 11:55:03,608: 14) loss=0.074 grad_norm=4.83 num_segments=256 num_words=209
2020-06-10 11:55:05,565: 15) loss=0.067 grad_norm=9.37 num_segments=256 num_words=214
2020-06-10 11:56:12,326: 16) loss=0.075 grad_norm=2.87 num_segments=256 num_words=214
2020-06-10 11:56:13,659: 15) loss=0.067 grad_norm=9.37 num_segments=256 num_words=214
2020-06-10 11:57:18,277: 17) loss=0.072 grad_norm=3.88 num_segments=256 num_words=215
2020-06-10 11:57:20,465: 16) loss=0.075 grad_norm=2.87 num_segments=256 num_words=214
2020-06-10 11:58:24,908: 18) loss=0.071 grad_norm=2.17 num_segments=256 num_words=205
2020-06-10 11:58:26,935: 17) loss=0.072 grad_norm=3.88 num_segments=256 num_words=215
2020-06-10 11:59:31,685: 19) loss=0.074 grad_norm=4.59 num_segments=256 num_words=212
2020-06-10 11:59:33,928: 18) loss=0.071 grad_norm=2.17 num_segments=256 num_words=205
2020-06-10 12:00:38,599: 20) loss=0.069 grad_norm=7.34 num_segments=256 num_words=208
2020-06-10 12:00:40,757: 19) loss=0.074 grad_norm=4.59 num_segments=256 num_words=212
2020-06-10 12:01:45,446: 21) loss=0.074 grad_norm=5.27 num_segments=256 num_words=220
2020-06-10 12:01:47,420: 20) loss=0.069 grad_norm=7.34 num_segments=256 num_words=208
2020-06-10 12:02:54,855: 21) loss=0.074 grad_norm=5.27 num_segments=256 num_words=220
2020-06-10 12:02:54,856: 22) loss=0.075 grad_norm=9.06 num_segments=256 num_words=202
2020-06-10 12:04:01,588: 23) loss=0.071 grad_norm=3.79 num_segments=256 num_words=207
2020-06-10 12:04:06,512: 22) loss=0.075 grad_norm=9.06 num_segments=256 num_words=202
2020-06-10 12:05:08,723: 24) loss=0.066 grad_norm=7.99 num_segments=256 num_words=219
2020-06-10 12:05:13,805: 23) loss=0.071 grad_norm=3.79 num_segments=256 num_words=207
2020-06-10 12:06:15,477: 25) loss=0.070 grad_norm=10.12 num_segments=256 num_words=208
2020-06-10 12:06:20,249: 24) loss=0.066 grad_norm=7.99 num_segments=256 num_words=219
2020-06-10 12:07:22,690: 26) loss=0.069 grad_norm=3.04 num_segments=256 num_words=208
2020-06-10 12:07:27,315: 25) loss=0.070 grad_norm=10.12 num_segments=256 num_words=208
2020-06-10 12:08:29,647: 27) loss=0.071 grad_norm=3.56 num_segments=256 num_words=214
2020-06-10 12:08:34,459: 26) loss=0.069 grad_norm=3.04 num_segments=256 num_words=208
2020-06-10 12:09:36,765: 28) loss=0.069 grad_norm=4.00 num_segments=256 num_words=222
2020-06-10 12:09:41,502: 27) loss=0.071 grad_norm=3.56 num_segments=256 num_words=214
2020-06-10 12:10:43,646: 29) loss=0.068 grad_norm=5.17 num_segments=256 num_words=213
2020-06-10 12:10:51,908: 28) loss=0.069 grad_norm=4.00 num_segments=256 num_words=222
2020-06-10 12:11:50,213: 30) loss=0.068 grad_norm=7.76 num_segments=256 num_words=214
2020-06-10 12:12:02,762: 29) loss=0.068 grad_norm=5.17 num_segments=256 num_words=213
2020-06-10 12:12:56,218: 31) loss=0.066 grad_norm=6.45 num_segments=256 num_words=220
2020-06-10 12:13:09,290: 30) loss=0.068 grad_norm=7.76 num_segments=256 num_words=214
2020-06-10 12:14:03,116: 32) loss=0.089 grad_norm=4.21 num_segments=256 num_words=207
2020-06-10 12:14:16,277: 31) loss=0.066 grad_norm=6.45 num_segments=256 num_words=220
2020-06-10 12:15:10,008: 33) loss=0.068 grad_norm=7.82 num_segments=256 num_words=206
2020-06-10 12:15:26,323: 32) loss=0.089 grad_norm=4.21 num_segments=256 num_words=207
2020-06-10 12:16:16,786: 34) loss=0.124 grad_norm=12.56 num_segments=256 num_words=207
2020-06-10 12:16:35,573: 33) loss=0.068 grad_norm=7.82 num_segments=256 num_words=206
2020-06-10 12:17:49,414: 34) loss=0.124 grad_norm=12.56 num_segments=256 num_words=207
2020-06-10 12:18:58,272: 35) loss=0.065 grad_norm=4.07 num_segments=256 num_words=213
2020-06-10 12:19:07,653: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-10 12:19:07,767: Using 1 GPU(s)
2020-06-10 12:19:07,768: Machine: 0 / 1
2020-06-10 12:19:07,769: Hyperparam tuning-------------------
2020-06-10 12:19:07,770: optim_lr: 0.001
2020-06-10 12:19:07,770: dropout (for both): 0.4
2020-06-10 12:19:07,770: margin: 0.4
2020-06-10 12:19:07,770: ------------------------------------
2020-06-10 12:19:07,871: Calling main function: multiview_trainer.train
2020-06-10 12:19:07,871: Using config file: train_config.json
2020-06-10 12:19:07,871: Using module at multiview_trainer.train
2020-06-10 12:19:17,936: Using module at multiview_vocab.MultiViewVocab
2020-06-10 12:19:18,005: Building vocab_data from config
2020-06-10 12:19:18,374:  >> min_count= 0
2020-06-10 12:19:18,374:  >> # words= 34323 (# removed= 0)
2020-06-10 12:19:18,374:  >> # subwords= 45
2020-06-10 12:19:18,374:     [laughter]= 1
2020-06-10 12:19:18,374:     [noise]= 2
2020-06-10 12:19:18,374:     [vocalized-noise]= 3
2020-06-10 12:19:18,374:     aa= 4
2020-06-10 12:19:18,375:     ae= 5
2020-06-10 12:19:18,375:     ah= 6
2020-06-10 12:19:18,375:     ao= 7
2020-06-10 12:19:18,375:     aw= 8
2020-06-10 12:19:18,375:     ax= 9
2020-06-10 12:19:18,375:     ay= 10
2020-06-10 12:19:18,375:     b= 11
2020-06-10 12:19:18,375:     ch= 12
2020-06-10 12:19:18,375:     d= 13
2020-06-10 12:19:18,375:     dh= 14
2020-06-10 12:19:18,375:     eh= 15
2020-06-10 12:19:18,375:     el= 16
2020-06-10 12:19:18,375:     en= 17
2020-06-10 12:19:18,375:     er= 18
2020-06-10 12:19:18,375:     ey= 19
2020-06-10 12:19:18,375:     f= 20
2020-06-10 12:19:18,375:     g= 21
2020-06-10 12:19:18,376:     hh= 22
2020-06-10 12:19:18,376:     ih= 23
2020-06-10 12:19:18,376:     iy= 24
2020-06-10 12:19:18,376:     jh= 25
2020-06-10 12:19:18,376:     k= 26
2020-06-10 12:19:18,376:     l= 27
2020-06-10 12:19:18,376:     m= 28
2020-06-10 12:19:18,376:     n= 29
2020-06-10 12:19:18,376:     ng= 30
2020-06-10 12:19:18,376:     ow= 31
2020-06-10 12:19:18,376:     oy= 32
2020-06-10 12:19:18,376:     p= 33
2020-06-10 12:19:18,376:     r= 34
2020-06-10 12:19:18,376:     s= 35
2020-06-10 12:19:18,376:     sh= 36
2020-06-10 12:19:18,376:     t= 37
2020-06-10 12:19:18,376:     th= 38
2020-06-10 12:19:18,377:     uh= 39
2020-06-10 12:19:18,377:     uw= 40
2020-06-10 12:19:18,377:     v= 41
2020-06-10 12:19:18,377:     w= 42
2020-06-10 12:19:18,377:     y= 43
2020-06-10 12:19:18,377:     z= 44
2020-06-10 12:19:18,377:     zh= 45
2020-06-10 12:19:18,391: Using module at data.batch_samplers.BatchSampler
2020-06-10 12:19:18,431: Building vocab_sampler from config
2020-06-10 12:19:18,431:  >> # examples= 34323
2020-06-10 12:19:18,431:  >> batch_size= 1000
2020-06-10 12:19:18,431:  >> shuffle= False
2020-06-10 12:19:18,445:  >> BatchSampler; 35 batches
2020-06-10 12:19:18,445: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 12:19:20,076: Building train_data from config
2020-06-10 12:19:27,328:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-10 12:19:27,329:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-10 12:19:27,329:  >> stack= False
2020-06-10 12:19:27,329:  >> seg_durs= (1, None)
2020-06-10 12:19:27,329:  >> # words= 9971 (# ignored= 0)
2020-06-10 12:19:27,329:  >> input_feat_dim= 108
2020-06-10 12:19:27,329:  >> input_num_subwords= 45
2020-06-10 12:19:27,329: Using module at data.batch_samplers.BatchSampler
2020-06-10 12:19:27,329: Building train_sampler from config
2020-06-10 12:19:27,330:  >> # examples= 9971
2020-06-10 12:19:27,330:  >> batch_size= 256
2020-06-10 12:19:27,330:  >> shuffle= True
2020-06-10 12:19:27,338:  >> BatchSampler; 39 batches
2020-06-10 12:19:27,338: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 12:19:27,338: Building dev_data from config
2020-06-10 12:19:35,162:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 12:19:35,163:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 12:19:35,163:  >> stack= False
2020-06-10 12:19:35,163:  >> seg_durs= (1, None)
2020-06-10 12:19:35,163:  >> # words= 10966 (# ignored= 0)
2020-06-10 12:19:35,163:  >> input_feat_dim= 108
2020-06-10 12:19:35,163:  >> input_num_subwords= 45
2020-06-10 12:19:35,163: Using module at data.batch_samplers.BatchSampler
2020-06-10 12:19:35,164: Building dev_sampler from config
2020-06-10 12:19:35,164:  >> # examples= 10966
2020-06-10 12:19:35,164:  >> batch_size= 256
2020-06-10 12:19:35,164:  >> shuffle= False
2020-06-10 12:19:35,167:  >> BatchSampler; 43 batches
2020-06-10 12:19:35,167: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 12:19:35,167: Building test_data from config
2020-06-10 12:19:41,848:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 12:19:41,849:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 12:19:41,849:  >> stack= False
2020-06-10 12:19:41,849:  >> seg_durs= (1, None)
2020-06-10 12:19:41,849:  >> # words= 11024 (# ignored= 0)
2020-06-10 12:19:41,849:  >> input_feat_dim= 108
2020-06-10 12:19:41,849:  >> input_num_subwords= 45
2020-06-10 12:19:41,849: Using module at data.batch_samplers.BatchSampler
2020-06-10 12:19:41,849: Building test_sampler from config
2020-06-10 12:19:41,850:  >> # examples= 11024
2020-06-10 12:19:41,850:  >> batch_size= 256
2020-06-10 12:19:41,850:  >> shuffle= False
2020-06-10 12:19:41,853:  >> BatchSampler; 44 batches
2020-06-10 12:19:41,853: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-10 12:19:41,958: Building loss from config
2020-06-10 12:19:41,959:  >> margin= 0.4
2020-06-10 12:19:41,959:  >> k= 16
2020-06-10 12:19:41,959:  >> min_k= 8
2020-06-10 12:19:41,959:  >> extra= 0
2020-06-10 12:19:41,959:  >> average= False
2020-06-10 12:19:41,959:  >> margin_max= 0.5
2020-06-10 12:19:41,960:  >> threshold_max= 9
2020-06-10 12:19:41,960:  >> using obj0
2020-06-10 12:19:41,960: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 12:19:42,645: Building eval from config
2020-06-10 12:19:42,646:  >> acoustic_ap= True
2020-06-10 12:19:42,646:  >> crossview_ap= True
2020-06-10 12:19:42,646:  >> full_vocab= False
2020-06-10 12:19:42,646:  >> metric= crossview_ap
2020-06-10 12:19:42,646:  >> mode= max
2020-06-10 12:19:42,647: Using module at multiview_rnn.MultiViewRNN
2020-06-10 12:19:42,684: Building net from config
2020-06-10 12:19:42,685: view1:
2020-06-10 12:19:42,686:  >> cell= GRU
2020-06-10 12:19:42,686:  >> input_size= 108
2020-06-10 12:19:42,686:  >> hidden_size= 512
2020-06-10 12:19:42,686:  >> bidirectional= True
2020-06-10 12:19:42,687:  >> num_layers= 6
2020-06-10 12:19:42,687:  >> dropout between layers= 0.4
2020-06-10 12:19:42,965: view2:
2020-06-10 12:19:42,966:  >> cell= GRU
2020-06-10 12:19:42,966:  >> input_size= 64
2020-06-10 12:19:42,966:  >> hidden_size= 512
2020-06-10 12:19:42,966:  >> bidirectional= True
2020-06-10 12:19:42,966:  >> num_layers= 2
2020-06-10 12:19:42,966:  >> dropout between layers= 0.4
2020-06-10 12:19:42,966:  >> num input embeddings= 45
2020-06-10 12:19:56,861: Using module at optim.adam.Adam
2020-06-10 12:19:56,895: Building optim from config
2020-06-10 12:19:56,896:  >> lr= 0.001
2020-06-10 12:19:56,897:  >> betas= (0.9, 0.999)
2020-06-10 12:19:56,897:  >> eps= 1e-08
2020-06-10 12:19:56,897:  >> weight_decay= 0
2020-06-10 12:19:56,897:  >> amsgrad= False
2020-06-10 12:19:56,897:  >> min_lr= 1e-07
2020-06-10 12:19:56,899: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-10 12:19:56,933: Building sched from config
2020-06-10 12:19:56,933:  >> optim= Adam
2020-06-10 12:19:56,933:  >> decay lr by 0.1
2020-06-10 12:19:56,933:  >> eval_fn= MultiViewAP
2020-06-10 12:19:56,934:  >> patience=4
2020-06-10 12:19:56,935:  >> revert=True
2020-06-10 12:19:56,947: loaded save/MultiViewDataset_IndividualWords.1443.pth
2020-06-10 12:19:56,947: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 12:19:58,065: loaded save/MultiViewRNN.1443.pth
2020-06-10 12:19:58,065: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 12:20:00,277: loaded save/Adam.1443.pth
2020-06-10 12:20:00,277: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 12:20:00,279: loaded save/ReduceLROnPlateau.1443.pth
2020-06-10 12:20:00,279: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 12:20:00,279: epoch=37.00 global_step=1443 lr=0.001 start_iter=0
2020-06-10 12:20:00,279: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 12:20:07,656: 36) loss=0.064 grad_norm=2.81 num_segments=256 num_words=211
2020-06-10 12:21:13,923: 37) loss=0.072 grad_norm=2.56 num_segments=256 num_words=214
2020-06-10 12:22:13,497: 38) loss=0.067 grad_norm=8.46 num_segments=243 num_words=209
2020-06-10 12:22:13,591: epoch= 38.00
2020-06-10 12:22:13,591:  >> time to evaluate and save:
2020-06-10 12:22:14,019: saved save/MultiViewDataset_IndividualWords.1482.pth
2020-06-10 12:22:14,030: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 12:22:14,042: removed save/MultiViewDataset_IndividualWords.1248.pth
2020-06-10 12:22:14,043: saved MultiViewDataset_IndividualWords successfully
2020-06-10 12:22:16,727: saved save/MultiViewRNN.1482.pth
2020-06-10 12:22:16,889: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 12:22:17,854: removed save/MultiViewRNN.1248.pth
2020-06-10 12:22:17,855: saved MultiViewRNN successfully
2020-06-10 12:22:20,491: saved save/Adam.1482.pth
2020-06-10 12:22:20,492: most_recent linked save/Adam.most_recent.pth
2020-06-10 12:22:20,817: removed save/Adam.1248.pth
2020-06-10 12:22:20,818: saved Adam successfully
2020-06-10 12:22:20,819: 0) loss=0.039 grad_norm=3.02 num_segments=256 num_words=215
2020-06-10 12:22:20,821: saved save/ReduceLROnPlateau.1482.pth
2020-06-10 12:22:20,822: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 12:22:20,825: removed save/ReduceLROnPlateau.1248.pth
2020-06-10 12:22:20,825: saved ReduceLROnPlateau successfully
2020-06-10 12:22:20,828: saved config successfully
2020-06-10 12:24:19,929:   >> crossview_ap=0.702 (10966 x 3921 pairs)
2020-06-10 12:24:21,872: 1) loss=0.038 grad_norm=2.05 num_segments=256 num_words=210
2020-06-10 12:25:37,925:   >> acoustic_ap=0.762 (10966 choose 2 pairs)
2020-06-10 12:25:37,931: best_so_far= 0.715 at 1404
2020-06-10 12:25:39,223: epoch=38.00 global_step=1482 lr=0.001 start_iter=0
2020-06-10 12:25:39,224: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 12:26:11,314: 2) loss=0.091 grad_norm=6.61 num_segments=256 num_words=202
2020-06-10 12:26:50,607: 0) loss=0.066 grad_norm=9.27 num_segments=256 num_words=214
2020-06-10 12:27:47,967: 3) loss=0.043 grad_norm=1.48 num_segments=256 num_words=213
2020-06-10 12:27:57,947: 1) loss=0.130 grad_norm=6.01 num_segments=256 num_words=212
2020-06-10 12:29:06,339: 2) loss=0.061 grad_norm=3.63 num_segments=256 num_words=207
2020-06-10 12:29:18,150: 4) loss=0.049 grad_norm=1.95 num_segments=256 num_words=198
2020-06-10 12:30:15,024: 3) loss=0.071 grad_norm=6.90 num_segments=256 num_words=212
2020-06-10 12:30:40,210: 5) loss=0.064 grad_norm=2.63 num_segments=256 num_words=212
2020-06-10 12:31:25,160: 4) loss=0.077 grad_norm=5.90 num_segments=256 num_words=210
2020-06-10 12:31:51,032: 6) loss=0.057 grad_norm=2.29 num_segments=256 num_words=219
2020-06-10 12:32:31,600: 5) loss=0.067 grad_norm=2.33 num_segments=256 num_words=206
2020-06-10 12:32:57,477: 7) loss=0.070 grad_norm=2.48 num_segments=256 num_words=210
2020-06-10 12:33:38,385: 6) loss=0.070 grad_norm=3.40 num_segments=256 num_words=225
2020-06-10 12:34:04,089: 8) loss=0.069 grad_norm=3.67 num_segments=256 num_words=217
2020-06-10 12:34:44,532: 7) loss=0.138 grad_norm=13.66 num_segments=256 num_words=229
2020-06-10 12:35:15,611: 9) loss=0.068 grad_norm=2.11 num_segments=256 num_words=204
2020-06-10 12:35:50,622: 8) loss=0.074 grad_norm=4.33 num_segments=256 num_words=212
2020-06-10 12:36:23,597: 10) loss=0.063 grad_norm=11.68 num_segments=256 num_words=222
2020-06-10 12:37:27,945: 11) loss=0.078 grad_norm=4.96 num_segments=256 num_words=209
2020-06-10 12:37:49,718: 9) loss=0.124 grad_norm=15.64 num_segments=256 num_words=213
2020-06-10 12:38:32,100: 12) loss=0.075 grad_norm=5.87 num_segments=256 num_words=201
2020-06-10 12:39:01,161: 10) loss=0.075 grad_norm=4.65 num_segments=256 num_words=204
2020-06-10 12:39:37,340: 13) loss=0.069 grad_norm=3.86 num_segments=256 num_words=210
2020-06-10 12:40:14,306: 11) loss=0.078 grad_norm=5.00 num_segments=256 num_words=210
2020-06-10 12:40:45,910: 14) loss=0.074 grad_norm=3.41 num_segments=256 num_words=209
2020-06-10 12:41:21,440: 12) loss=0.131 grad_norm=5.89 num_segments=256 num_words=214
2020-06-10 12:41:49,760: 15) loss=0.067 grad_norm=6.41 num_segments=256 num_words=214
2020-06-10 12:42:28,452: 13) loss=0.071 grad_norm=8.23 num_segments=256 num_words=202
2020-06-10 12:42:54,828: 16) loss=0.075 grad_norm=2.75 num_segments=256 num_words=214
2020-06-10 12:43:36,701: 14) loss=0.074 grad_norm=12.18 num_segments=256 num_words=216
2020-06-10 12:44:01,846: 17) loss=0.072 grad_norm=5.31 num_segments=256 num_words=215
2020-06-10 12:44:43,576: 15) loss=0.064 grad_norm=2.69 num_segments=256 num_words=220
2020-06-10 12:45:09,228: 18) loss=0.071 grad_norm=3.68 num_segments=256 num_words=205
2020-06-10 12:45:50,145: 16) loss=0.071 grad_norm=7.24 num_segments=256 num_words=217
2020-06-10 12:46:29,415: 19) loss=0.074 grad_norm=6.98 num_segments=256 num_words=212
2020-06-10 12:46:56,537: 17) loss=0.074 grad_norm=6.06 num_segments=256 num_words=212
2020-06-10 12:47:34,504: 20) loss=0.069 grad_norm=3.64 num_segments=256 num_words=208
2020-06-10 12:48:03,329: 18) loss=0.076 grad_norm=8.57 num_segments=256 num_words=216
2020-06-10 12:48:40,563: 21) loss=0.073 grad_norm=5.09 num_segments=256 num_words=220
2020-06-10 12:49:10,165: 19) loss=0.076 grad_norm=5.37 num_segments=256 num_words=202
2020-06-10 12:49:45,895: 22) loss=0.078 grad_norm=3.59 num_segments=256 num_words=202
2020-06-10 12:50:17,006: 20) loss=0.061 grad_norm=6.00 num_segments=256 num_words=204
2020-06-10 12:50:53,407: 23) loss=0.070 grad_norm=3.11 num_segments=256 num_words=207
2020-06-10 12:51:24,776: 21) loss=0.083 grad_norm=4.78 num_segments=256 num_words=217
2020-06-10 12:52:13,129: 24) loss=0.065 grad_norm=3.21 num_segments=256 num_words=219
2020-06-10 12:52:32,859: 22) loss=0.125 grad_norm=4.90 num_segments=256 num_words=214
2020-06-10 12:53:20,217: 25) loss=0.070 grad_norm=3.13 num_segments=256 num_words=208
2020-06-10 12:53:45,014: 23) loss=0.077 grad_norm=4.38 num_segments=256 num_words=217
2020-06-10 12:54:26,370: 26) loss=0.069 grad_norm=2.06 num_segments=256 num_words=208
2020-06-10 12:54:57,332: 24) loss=0.072 grad_norm=6.29 num_segments=256 num_words=208
2020-06-10 12:55:33,550: 27) loss=0.071 grad_norm=2.91 num_segments=256 num_words=214
2020-06-10 12:56:06,677: 25) loss=0.069 grad_norm=3.27 num_segments=256 num_words=206
2020-06-10 12:56:39,962: 28) loss=0.069 grad_norm=2.32 num_segments=256 num_words=222
2020-06-10 12:57:14,846: 26) loss=0.073 grad_norm=8.10 num_segments=256 num_words=208
2020-06-10 12:57:45,950: 29) loss=0.068 grad_norm=1.90 num_segments=256 num_words=213
2020-06-10 12:58:22,345: 27) loss=0.070 grad_norm=4.35 num_segments=256 num_words=208
2020-06-10 12:58:51,564: 30) loss=0.067 grad_norm=3.92 num_segments=256 num_words=214
2020-06-10 12:59:29,999: 28) loss=0.072 grad_norm=2.65 num_segments=256 num_words=209
2020-06-10 13:00:07,754: 31) loss=0.066 grad_norm=2.44 num_segments=256 num_words=220
2020-06-10 13:00:37,667: 29) loss=0.067 grad_norm=5.12 num_segments=256 num_words=212
2020-06-10 13:01:13,579: 32) loss=0.089 grad_norm=3.01 num_segments=256 num_words=207
2020-06-10 13:01:44,725: 30) loss=0.067 grad_norm=6.44 num_segments=256 num_words=210
2020-06-10 13:02:19,686: 33) loss=0.067 grad_norm=2.96 num_segments=256 num_words=206
2020-06-10 13:02:56,335: 31) loss=0.069 grad_norm=3.91 num_segments=256 num_words=216
2020-06-10 13:03:26,085: 34) loss=0.068 grad_norm=3.02 num_segments=256 num_words=207
2020-06-10 13:04:06,396: 32) loss=0.072 grad_norm=5.50 num_segments=256 num_words=212
2020-06-10 13:04:32,734: 35) loss=0.064 grad_norm=3.06 num_segments=256 num_words=213
2020-06-10 13:05:13,054: 33) loss=0.066 grad_norm=3.93 num_segments=256 num_words=210
2020-06-10 13:05:38,579: 36) loss=0.064 grad_norm=2.25 num_segments=256 num_words=211
2020-06-10 13:06:23,194: 34) loss=0.077 grad_norm=3.51 num_segments=256 num_words=199
2020-06-10 13:06:44,387: 37) loss=0.072 grad_norm=3.05 num_segments=256 num_words=214
2020-06-10 13:07:37,940: 35) loss=0.069 grad_norm=2.67 num_segments=256 num_words=195
2020-06-10 13:07:43,758: 38) loss=0.072 grad_norm=2.85 num_segments=243 num_words=209
2020-06-10 13:07:43,769: epoch= 38.00
2020-06-10 13:07:43,769:  >> time to evaluate and save:
2020-06-10 13:07:43,772: saved MultiViewDataset_IndividualWords successfully
2020-06-10 13:07:44,147: saved MultiViewRNN successfully
2020-06-10 13:07:44,347: saved Adam successfully
2020-06-10 13:07:44,350: saved ReduceLROnPlateau successfully
2020-06-10 13:07:44,352: saved config successfully
2020-06-10 13:08:45,837: 36) loss=0.070 grad_norm=4.81 num_segments=256 num_words=209
2020-06-10 13:09:53,008: 37) loss=0.070 grad_norm=6.27 num_segments=256 num_words=204
2020-06-10 13:10:55,928: 38) loss=0.074 grad_norm=4.43 num_segments=243 num_words=205
2020-06-10 13:10:55,943: epoch= 39.00
2020-06-10 13:10:55,944:  >> time to evaluate and save:
2020-06-10 13:10:55,986: saved save/MultiViewDataset_IndividualWords.1521.pth
2020-06-10 13:10:56,003: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 13:10:56,030: removed save/MultiViewDataset_IndividualWords.1287.pth
2020-06-10 13:10:56,030: saved MultiViewDataset_IndividualWords successfully
2020-06-10 13:10:57,497: saved save/MultiViewRNN.1521.pth
2020-06-10 13:10:57,498: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 13:10:57,539: removed save/MultiViewRNN.1287.pth
2020-06-10 13:10:57,539: saved MultiViewRNN successfully
2020-06-10 13:11:00,132: saved save/Adam.1521.pth
2020-06-10 13:11:00,141: most_recent linked save/Adam.most_recent.pth
2020-06-10 13:11:00,204: removed save/Adam.1287.pth
2020-06-10 13:11:00,204: saved Adam successfully
2020-06-10 13:11:00,213: saved save/ReduceLROnPlateau.1521.pth
2020-06-10 13:11:00,219: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 13:11:00,232: removed save/ReduceLROnPlateau.1287.pth
2020-06-10 13:11:00,232: saved ReduceLROnPlateau successfully
2020-06-10 13:11:00,240: saved config successfully
2020-06-10 13:12:58,442:   >> crossview_ap=0.706 (10966 x 3921 pairs)
2020-06-10 13:14:15,031: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-10 13:14:15,090: Using 1 GPU(s)
2020-06-10 13:14:15,090: Machine: 0 / 1
2020-06-10 13:14:15,092: Hyperparam tuning-------------------
2020-06-10 13:14:15,092: optim_lr: 0.001
2020-06-10 13:14:15,092: dropout (for both): 0.4
2020-06-10 13:14:15,092: margin: 0.4
2020-06-10 13:14:15,092: ------------------------------------
2020-06-10 13:14:15,095: Calling main function: multiview_trainer.train
2020-06-10 13:14:15,095: Using config file: train_config.json
2020-06-10 13:14:15,095: Using module at multiview_trainer.train
2020-06-10 13:14:15,239: Using module at multiview_vocab.MultiViewVocab
2020-06-10 13:14:15,252: Building vocab_data from config
2020-06-10 13:14:15,532:  >> min_count= 0
2020-06-10 13:14:15,532:  >> # words= 34323 (# removed= 0)
2020-06-10 13:14:15,532:  >> # subwords= 45
2020-06-10 13:14:15,532:     [laughter]= 1
2020-06-10 13:14:15,532:     [noise]= 2
2020-06-10 13:14:15,532:     [vocalized-noise]= 3
2020-06-10 13:14:15,532:     aa= 4
2020-06-10 13:14:15,532:     ae= 5
2020-06-10 13:14:15,532:     ah= 6
2020-06-10 13:14:15,532:     ao= 7
2020-06-10 13:14:15,532:     aw= 8
2020-06-10 13:14:15,533:     ax= 9
2020-06-10 13:14:15,533:     ay= 10
2020-06-10 13:14:15,533:     b= 11
2020-06-10 13:14:15,533:     ch= 12
2020-06-10 13:14:15,533:     d= 13
2020-06-10 13:14:15,533:     dh= 14
2020-06-10 13:14:15,533:     eh= 15
2020-06-10 13:14:15,533:     el= 16
2020-06-10 13:14:15,533:     en= 17
2020-06-10 13:14:15,533:     er= 18
2020-06-10 13:14:15,533:     ey= 19
2020-06-10 13:14:15,533:     f= 20
2020-06-10 13:14:15,533:     g= 21
2020-06-10 13:14:15,533:     hh= 22
2020-06-10 13:14:15,533:     ih= 23
2020-06-10 13:14:15,533:     iy= 24
2020-06-10 13:14:15,533:     jh= 25
2020-06-10 13:14:15,533:     k= 26
2020-06-10 13:14:15,533:     l= 27
2020-06-10 13:14:15,533:     m= 28
2020-06-10 13:14:15,533:     n= 29
2020-06-10 13:14:15,533:     ng= 30
2020-06-10 13:14:15,534:     ow= 31
2020-06-10 13:14:15,534:     oy= 32
2020-06-10 13:14:15,534:     p= 33
2020-06-10 13:14:15,534:     r= 34
2020-06-10 13:14:15,534:     s= 35
2020-06-10 13:14:15,534:     sh= 36
2020-06-10 13:14:15,534:     t= 37
2020-06-10 13:14:15,534:     th= 38
2020-06-10 13:14:15,534:     uh= 39
2020-06-10 13:14:15,534:     uw= 40
2020-06-10 13:14:15,534:     v= 41
2020-06-10 13:14:15,534:     w= 42
2020-06-10 13:14:15,534:     y= 43
2020-06-10 13:14:15,534:     z= 44
2020-06-10 13:14:15,534:     zh= 45
2020-06-10 13:14:15,547: Using module at data.batch_samplers.BatchSampler
2020-06-10 13:14:15,549: Building vocab_sampler from config
2020-06-10 13:14:15,549:  >> # examples= 34323
2020-06-10 13:14:15,549:  >> batch_size= 1000
2020-06-10 13:14:15,549:  >> shuffle= False
2020-06-10 13:14:15,556:  >> BatchSampler; 35 batches
2020-06-10 13:14:15,556: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 13:14:16,683: Building train_data from config
2020-06-10 13:14:24,476:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-10 13:14:24,477:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-10 13:14:24,477:  >> stack= False
2020-06-10 13:14:24,477:  >> seg_durs= (1, None)
2020-06-10 13:14:24,477:  >> # words= 9971 (# ignored= 0)
2020-06-10 13:14:24,477:  >> input_feat_dim= 108
2020-06-10 13:14:24,477:  >> input_num_subwords= 45
2020-06-10 13:14:24,477: Using module at data.batch_samplers.BatchSampler
2020-06-10 13:14:24,478: Building train_sampler from config
2020-06-10 13:14:24,478:  >> # examples= 9971
2020-06-10 13:14:24,478:  >> batch_size= 256
2020-06-10 13:14:24,479:  >> shuffle= True
2020-06-10 13:14:24,487:  >> BatchSampler; 39 batches
2020-06-10 13:14:24,488: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 13:14:24,488: Building dev_data from config
2020-06-10 13:14:32,627:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 13:14:32,628:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 13:14:32,628:  >> stack= False
2020-06-10 13:14:32,628:  >> seg_durs= (1, None)
2020-06-10 13:14:32,628:  >> # words= 10966 (# ignored= 0)
2020-06-10 13:14:32,628:  >> input_feat_dim= 108
2020-06-10 13:14:32,628:  >> input_num_subwords= 45
2020-06-10 13:14:32,628: Using module at data.batch_samplers.BatchSampler
2020-06-10 13:14:32,628: Building dev_sampler from config
2020-06-10 13:14:32,629:  >> # examples= 10966
2020-06-10 13:14:32,629:  >> batch_size= 256
2020-06-10 13:14:32,629:  >> shuffle= False
2020-06-10 13:14:32,631:  >> BatchSampler; 43 batches
2020-06-10 13:14:32,632: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 13:14:32,632: Building test_data from config
2020-06-10 13:14:39,468:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 13:14:39,468:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 13:14:39,468:  >> stack= False
2020-06-10 13:14:39,468:  >> seg_durs= (1, None)
2020-06-10 13:14:39,468:  >> # words= 11024 (# ignored= 0)
2020-06-10 13:14:39,469:  >> input_feat_dim= 108
2020-06-10 13:14:39,469:  >> input_num_subwords= 45
2020-06-10 13:14:39,469: Using module at data.batch_samplers.BatchSampler
2020-06-10 13:14:39,469: Building test_sampler from config
2020-06-10 13:14:39,469:  >> # examples= 11024
2020-06-10 13:14:39,469:  >> batch_size= 256
2020-06-10 13:14:39,470:  >> shuffle= False
2020-06-10 13:14:39,472:  >> BatchSampler; 44 batches
2020-06-10 13:14:39,472: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-10 13:14:39,546: Building loss from config
2020-06-10 13:14:39,546:  >> margin= 0.4
2020-06-10 13:14:39,546:  >> k= 16
2020-06-10 13:14:39,546:  >> min_k= 8
2020-06-10 13:14:39,546:  >> extra= 0
2020-06-10 13:14:39,546:  >> average= False
2020-06-10 13:14:39,546:  >> margin_max= 0.5
2020-06-10 13:14:39,546:  >> threshold_max= 9
2020-06-10 13:14:39,546:  >> using obj0
2020-06-10 13:14:39,547: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 13:14:39,890: Building eval from config
2020-06-10 13:14:39,890:  >> acoustic_ap= True
2020-06-10 13:14:39,890:  >> crossview_ap= True
2020-06-10 13:14:39,890:  >> full_vocab= False
2020-06-10 13:14:39,890:  >> metric= crossview_ap
2020-06-10 13:14:39,890:  >> mode= max
2020-06-10 13:14:39,890: Using module at multiview_rnn.MultiViewRNN
2020-06-10 13:14:39,917: Building net from config
2020-06-10 13:14:39,919: view1:
2020-06-10 13:14:39,919:  >> cell= GRU
2020-06-10 13:14:39,920:  >> input_size= 108
2020-06-10 13:14:39,920:  >> hidden_size= 512
2020-06-10 13:14:39,920:  >> bidirectional= True
2020-06-10 13:14:39,920:  >> num_layers= 6
2020-06-10 13:14:39,920:  >> dropout between layers= 0.4
2020-06-10 13:14:40,188: view2:
2020-06-10 13:14:40,189:  >> cell= GRU
2020-06-10 13:14:40,189:  >> input_size= 64
2020-06-10 13:14:40,189:  >> hidden_size= 512
2020-06-10 13:14:40,189:  >> bidirectional= True
2020-06-10 13:14:40,189:  >> num_layers= 2
2020-06-10 13:14:40,189:  >> dropout between layers= 0.4
2020-06-10 13:14:40,189:  >> num input embeddings= 45
2020-06-10 13:14:43,819: Using module at optim.adam.Adam
2020-06-10 13:14:43,823: Building optim from config
2020-06-10 13:14:43,823:  >> lr= 0.001
2020-06-10 13:14:43,823:  >> betas= (0.9, 0.999)
2020-06-10 13:14:43,823:  >> eps= 1e-08
2020-06-10 13:14:43,823:  >> weight_decay= 0
2020-06-10 13:14:43,823:  >> amsgrad= False
2020-06-10 13:14:43,823:  >> min_lr= 1e-07
2020-06-10 13:14:43,824: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-10 13:14:43,838: Building sched from config
2020-06-10 13:14:43,839:  >> optim= Adam
2020-06-10 13:14:43,839:  >> decay lr by 0.1
2020-06-10 13:14:43,839:  >> eval_fn= MultiViewAP
2020-06-10 13:14:43,840:  >> patience=4
2020-06-10 13:14:43,840:  >> revert=True
2020-06-10 13:14:43,850: loaded save/MultiViewDataset_IndividualWords.1521.pth
2020-06-10 13:14:43,850: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 13:14:44,967: loaded save/MultiViewRNN.1521.pth
2020-06-10 13:14:44,968: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 13:14:48,512: loaded save/Adam.1521.pth
2020-06-10 13:14:48,514: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 13:14:49,153: loaded save/ReduceLROnPlateau.1521.pth
2020-06-10 13:14:49,154: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 13:14:49,154: epoch=39.00 global_step=1521 lr=0.001 start_iter=0
2020-06-10 13:14:49,154: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 13:17:05,069: 0) loss=0.041 grad_norm=4.30 num_segments=256 num_words=213
2020-06-10 13:19:07,946: 1) loss=0.040 grad_norm=7.88 num_segments=256 num_words=211
2020-06-10 13:21:03,317: 2) loss=0.090 grad_norm=3.32 num_segments=256 num_words=212
2020-06-10 13:22:48,516: 3) loss=0.045 grad_norm=3.27 num_segments=256 num_words=207
2020-06-10 13:24:25,252: 4) loss=0.051 grad_norm=2.42 num_segments=256 num_words=220
2020-06-10 13:25:54,084: 5) loss=0.067 grad_norm=10.52 num_segments=256 num_words=202
2020-06-10 13:27:12,568: 6) loss=0.062 grad_norm=4.82 num_segments=256 num_words=209
2020-06-10 13:28:23,138: 7) loss=0.072 grad_norm=4.99 num_segments=256 num_words=211
2020-06-10 13:29:35,316: 8) loss=0.065 grad_norm=3.12 num_segments=256 num_words=209
2020-06-10 13:30:44,723: 9) loss=0.071 grad_norm=2.95 num_segments=256 num_words=209
2020-06-10 13:31:57,344: 10) loss=0.072 grad_norm=3.76 num_segments=256 num_words=214
2020-06-10 13:33:07,384: 11) loss=0.069 grad_norm=4.18 num_segments=256 num_words=208
2020-06-10 13:34:16,848: 12) loss=0.070 grad_norm=2.72 num_segments=256 num_words=219
2020-06-10 13:35:26,822: 13) loss=0.068 grad_norm=14.82 num_segments=256 num_words=205
2020-06-10 13:36:42,032: 14) loss=0.074 grad_norm=4.85 num_segments=256 num_words=206
2020-06-10 13:37:52,062: 15) loss=0.067 grad_norm=3.28 num_segments=256 num_words=216
2020-06-10 13:39:02,121: 16) loss=0.072 grad_norm=3.19 num_segments=256 num_words=199
2020-06-10 13:40:12,906: 17) loss=0.068 grad_norm=4.96 num_segments=256 num_words=201
2020-06-10 13:41:23,433: 18) loss=0.067 grad_norm=4.34 num_segments=256 num_words=219
2020-06-10 13:42:38,332: 19) loss=0.068 grad_norm=3.48 num_segments=256 num_words=216
2020-06-10 13:43:48,378: 20) loss=0.078 grad_norm=4.13 num_segments=256 num_words=205
2020-06-10 13:44:58,235: 21) loss=0.077 grad_norm=7.91 num_segments=256 num_words=210
2020-06-10 13:46:08,337: 22) loss=0.070 grad_norm=3.98 num_segments=256 num_words=213
2020-06-10 13:47:18,946: 23) loss=0.127 grad_norm=5.80 num_segments=256 num_words=214
2020-06-10 13:48:34,067: 24) loss=0.063 grad_norm=3.57 num_segments=256 num_words=216
2020-06-10 13:49:42,824: 25) loss=0.068 grad_norm=4.85 num_segments=256 num_words=210
2020-06-10 13:50:51,094: 26) loss=0.071 grad_norm=3.27 num_segments=256 num_words=208
2020-06-10 13:51:59,885: 27) loss=0.067 grad_norm=4.60 num_segments=256 num_words=207
2020-06-10 13:53:06,978: 28) loss=0.069 grad_norm=2.70 num_segments=256 num_words=207
2020-06-10 13:54:13,431: 29) loss=0.076 grad_norm=4.56 num_segments=256 num_words=212
2020-06-10 13:55:20,116: 30) loss=0.071 grad_norm=7.83 num_segments=256 num_words=205
2020-06-10 13:56:34,035: 31) loss=0.067 grad_norm=2.88 num_segments=256 num_words=212
2020-06-10 13:57:41,079: 32) loss=0.081 grad_norm=3.79 num_segments=256 num_words=214
2020-06-10 13:58:47,814: 33) loss=0.065 grad_norm=4.29 num_segments=256 num_words=215
2020-06-10 13:59:53,528: 34) loss=0.069 grad_norm=5.32 num_segments=256 num_words=210
2020-06-10 14:00:58,938: 35) loss=0.074 grad_norm=6.39 num_segments=256 num_words=215
2020-06-10 14:02:03,734: 36) loss=0.067 grad_norm=4.53 num_segments=256 num_words=216
2020-06-10 14:03:09,200: 37) loss=0.080 grad_norm=3.11 num_segments=256 num_words=209
2020-06-10 14:04:08,025: 38) loss=0.124 grad_norm=10.43 num_segments=243 num_words=205
2020-06-10 14:04:08,036: epoch= 40.00
2020-06-10 14:04:08,037:  >> time to evaluate and save:
2020-06-10 14:04:08,068: saved save/MultiViewDataset_IndividualWords.1560.pth
2020-06-10 14:04:08,070: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 14:04:08,093: removed save/MultiViewDataset_IndividualWords.1326.pth
2020-06-10 14:04:08,093: saved MultiViewDataset_IndividualWords successfully
2020-06-10 14:04:09,408: saved save/MultiViewRNN.1560.pth
2020-06-10 14:04:09,410: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 14:04:09,733: removed save/MultiViewRNN.1326.pth
2020-06-10 14:04:09,733: saved MultiViewRNN successfully
2020-06-10 14:04:12,486: saved save/Adam.1560.pth
2020-06-10 14:04:12,488: most_recent linked save/Adam.most_recent.pth
2020-06-10 14:04:12,679: removed save/Adam.1326.pth
2020-06-10 14:04:12,679: saved Adam successfully
2020-06-10 14:04:12,681: saved save/ReduceLROnPlateau.1560.pth
2020-06-10 14:04:12,683: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 14:04:12,688: removed save/ReduceLROnPlateau.1326.pth
2020-06-10 14:04:12,688: saved ReduceLROnPlateau successfully
2020-06-10 14:04:12,690: saved config successfully
2020-06-10 14:05:34,377:   >> crossview_ap=0.706 (10966 x 3921 pairs)
2020-06-10 14:06:28,316:   >> acoustic_ap=0.757 (10966 choose 2 pairs)
2020-06-10 14:06:28,319: best_so_far= 0.715 at 1404
2020-06-10 14:06:28,374: epoch=40.00 global_step=1560 lr=0.001 start_iter=0
2020-06-10 14:06:28,375: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 14:07:35,736: 0) loss=0.079 grad_norm=3.68 num_segments=256 num_words=210
2020-06-10 14:08:51,135: 1) loss=0.063 grad_norm=4.22 num_segments=256 num_words=216
2020-06-10 14:09:56,427: 2) loss=0.068 grad_norm=5.42 num_segments=256 num_words=215
2020-06-10 14:11:01,717: 3) loss=0.066 grad_norm=3.27 num_segments=256 num_words=203
2020-06-10 14:12:06,639: 4) loss=0.074 grad_norm=5.29 num_segments=256 num_words=214
2020-06-10 14:13:11,623: 5) loss=0.066 grad_norm=5.50 num_segments=256 num_words=212
2020-06-10 14:14:16,511: 6) loss=0.078 grad_norm=4.10 num_segments=256 num_words=216
2020-06-10 14:15:21,789: 7) loss=0.076 grad_norm=4.35 num_segments=256 num_words=203
2020-06-10 14:16:27,034: 8) loss=0.073 grad_norm=3.01 num_segments=256 num_words=210
2020-06-10 14:17:32,153: 9) loss=0.069 grad_norm=3.30 num_segments=256 num_words=215
2020-06-10 14:18:37,042: 10) loss=0.069 grad_norm=2.86 num_segments=256 num_words=206
2020-06-10 14:19:42,187: 11) loss=0.074 grad_norm=3.69 num_segments=256 num_words=217
2020-06-10 14:20:59,241: 12) loss=0.070 grad_norm=7.24 num_segments=256 num_words=211
2020-06-10 14:22:05,774: 13) loss=0.071 grad_norm=4.28 num_segments=256 num_words=214
2020-06-10 14:23:12,116: 14) loss=0.082 grad_norm=3.76 num_segments=256 num_words=213
2020-06-10 14:24:22,193: 15) loss=0.073 grad_norm=8.33 num_segments=256 num_words=209
2020-06-10 14:25:32,856: 16) loss=0.121 grad_norm=3.58 num_segments=256 num_words=216
2020-06-10 14:26:43,756: 17) loss=0.069 grad_norm=2.76 num_segments=256 num_words=211
2020-06-10 14:27:55,979: 18) loss=0.063 grad_norm=2.75 num_segments=256 num_words=212
2020-06-10 14:29:07,449: 19) loss=0.066 grad_norm=5.58 num_segments=256 num_words=208
2020-06-10 14:30:18,374: 20) loss=0.072 grad_norm=6.92 num_segments=256 num_words=204
2020-06-10 14:31:29,136: 21) loss=0.071 grad_norm=5.27 num_segments=256 num_words=216
2020-06-10 14:32:40,264: 22) loss=0.070 grad_norm=2.33 num_segments=256 num_words=196
2020-06-10 14:33:51,265: 23) loss=0.076 grad_norm=4.18 num_segments=256 num_words=210
2020-06-10 14:35:03,119: 24) loss=0.089 grad_norm=5.46 num_segments=256 num_words=221
2020-06-10 14:36:13,793: 25) loss=0.071 grad_norm=3.51 num_segments=256 num_words=200
2020-06-10 14:37:44,250: 26) loss=0.077 grad_norm=4.31 num_segments=256 num_words=206
2020-06-10 14:38:55,419: 27) loss=0.068 grad_norm=2.87 num_segments=256 num_words=215
2020-06-10 14:40:05,047: 28) loss=0.081 grad_norm=4.73 num_segments=256 num_words=213
2020-06-10 14:41:14,598: 29) loss=0.070 grad_norm=1.64 num_segments=256 num_words=206
2020-06-10 14:42:25,962: 30) loss=0.061 grad_norm=3.51 num_segments=256 num_words=214
2020-06-10 14:43:35,527: 31) loss=0.071 grad_norm=5.83 num_segments=256 num_words=206
2020-06-10 14:44:44,904: 32) loss=0.133 grad_norm=4.72 num_segments=256 num_words=211
2020-06-10 14:45:54,183: 33) loss=0.073 grad_norm=3.01 num_segments=256 num_words=211
2020-06-10 14:47:05,454: 34) loss=0.076 grad_norm=3.15 num_segments=256 num_words=206
2020-06-10 14:48:16,658: 35) loss=0.067 grad_norm=4.74 num_segments=256 num_words=208
2020-06-10 14:49:26,473: 36) loss=0.069 grad_norm=2.20 num_segments=256 num_words=204
2020-06-10 14:50:36,038: 37) loss=0.070 grad_norm=8.83 num_segments=256 num_words=212
2020-06-10 14:51:41,179: 38) loss=0.066 grad_norm=3.38 num_segments=243 num_words=200
2020-06-10 14:51:41,192: epoch= 41.00
2020-06-10 14:51:41,193:  >> time to evaluate and save:
2020-06-10 14:51:41,234: saved save/MultiViewDataset_IndividualWords.1599.pth
2020-06-10 14:51:41,245: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 14:51:41,264: removed save/MultiViewDataset_IndividualWords.1365.pth
2020-06-10 14:51:41,264: saved MultiViewDataset_IndividualWords successfully
2020-06-10 14:51:42,590: saved save/MultiViewRNN.1599.pth
2020-06-10 14:51:42,595: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 14:51:42,621: removed save/MultiViewRNN.1365.pth
2020-06-10 14:51:42,621: saved MultiViewRNN successfully
2020-06-10 14:51:45,153: saved save/Adam.1599.pth
2020-06-10 14:51:45,163: most_recent linked save/Adam.most_recent.pth
2020-06-10 14:51:45,213: removed save/Adam.1365.pth
2020-06-10 14:51:45,214: saved Adam successfully
2020-06-10 14:51:45,216: saved save/ReduceLROnPlateau.1599.pth
2020-06-10 14:51:45,224: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 14:51:45,241: removed save/ReduceLROnPlateau.1365.pth
2020-06-10 14:51:45,242: saved ReduceLROnPlateau successfully
2020-06-10 14:51:45,243: saved config successfully
2020-06-10 14:53:16,275:   >> crossview_ap=0.707 (10966 x 3921 pairs)
2020-06-10 14:54:16,679:   >> acoustic_ap=0.755 (10966 choose 2 pairs)
2020-06-10 14:54:16,683: best_so_far= 0.715 at 1404
2020-06-10 14:54:16,683: Reverting to previous best
2020-06-10 14:54:17,805: loaded save/MultiViewRNN.1404.pth
2020-06-10 14:54:17,805: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 14:54:20,093: loaded save/Adam.1404.pth
2020-06-10 14:54:20,093: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 14:54:20,093: Reducing group lr from 0.001 to 0.0001
2020-06-10 14:54:20,105: best linked save/Adam.best.pth
2020-06-10 14:54:20,693: epoch=41.00 global_step=1599 lr=0.0001 start_iter=0
2020-06-10 14:54:20,694: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 14:55:32,148: 0) loss=0.072 grad_norm=3.99 num_segments=256 num_words=219
2020-06-10 14:56:42,545: 1) loss=0.070 grad_norm=2.01 num_segments=256 num_words=214
2020-06-10 14:57:52,394: 2) loss=0.068 grad_norm=12.46 num_segments=256 num_words=206
2020-06-10 14:59:01,921: 3) loss=0.071 grad_norm=4.28 num_segments=256 num_words=213
2020-06-10 15:00:13,476: 4) loss=0.064 grad_norm=8.72 num_segments=256 num_words=208
2020-06-10 15:01:46,222: 5) loss=0.065 grad_norm=2.23 num_segments=256 num_words=208
2020-06-10 15:02:55,879: 6) loss=0.074 grad_norm=2.33 num_segments=256 num_words=209
2020-06-10 15:04:05,398: 7) loss=0.128 grad_norm=3.43 num_segments=256 num_words=210
2020-06-10 15:05:15,331: 8) loss=0.064 grad_norm=1.36 num_segments=256 num_words=206
2020-06-10 15:06:25,923: 9) loss=0.073 grad_norm=5.96 num_segments=256 num_words=212
2020-06-10 15:07:36,664: 10) loss=0.068 grad_norm=3.14 num_segments=256 num_words=205
2020-06-10 15:08:48,568: 11) loss=0.076 grad_norm=2.23 num_segments=256 num_words=213
2020-06-10 15:10:00,073: 12) loss=0.071 grad_norm=2.13 num_segments=256 num_words=199
2020-06-10 15:11:11,283: 13) loss=0.070 grad_norm=1.99 num_segments=256 num_words=204
2020-06-10 15:12:22,834: 14) loss=0.065 grad_norm=1.54 num_segments=256 num_words=209
2020-06-10 15:13:33,655: 15) loss=0.071 grad_norm=2.51 num_segments=256 num_words=209
2020-06-10 15:14:45,104: 16) loss=0.074 grad_norm=1.91 num_segments=256 num_words=220
2020-06-10 15:15:56,949: 17) loss=0.078 grad_norm=3.19 num_segments=256 num_words=202
2020-06-10 15:17:08,520: 18) loss=0.068 grad_norm=1.71 num_segments=256 num_words=221
2020-06-10 15:18:19,433: 19) loss=0.076 grad_norm=11.02 num_segments=256 num_words=215
2020-06-10 15:19:30,530: 20) loss=0.083 grad_norm=2.77 num_segments=256 num_words=215
2020-06-10 15:20:42,201: 21) loss=0.127 grad_norm=4.57 num_segments=256 num_words=208
2020-06-10 15:21:54,580: 22) loss=0.071 grad_norm=3.49 num_segments=256 num_words=213
2020-06-10 15:23:05,808: 23) loss=0.072 grad_norm=1.94 num_segments=256 num_words=206
2020-06-10 15:24:17,512: 24) loss=0.067 grad_norm=1.76 num_segments=256 num_words=215
2020-06-10 15:25:28,913: 25) loss=0.066 grad_norm=1.91 num_segments=256 num_words=207
2020-06-10 15:27:05,962: 26) loss=0.066 grad_norm=2.23 num_segments=256 num_words=209
2020-06-10 15:28:16,954: 27) loss=0.075 grad_norm=3.16 num_segments=256 num_words=213
2020-06-10 15:29:28,461: 28) loss=0.077 grad_norm=7.07 num_segments=256 num_words=215
2020-06-10 15:30:39,669: 29) loss=0.072 grad_norm=2.77 num_segments=256 num_words=211
2020-06-10 15:31:51,272: 30) loss=0.078 grad_norm=2.44 num_segments=256 num_words=205
2020-06-10 15:33:02,378: 31) loss=0.066 grad_norm=2.05 num_segments=256 num_words=206
2020-06-10 15:34:14,460: 32) loss=0.070 grad_norm=1.81 num_segments=256 num_words=215
2020-06-10 15:35:25,859: 33) loss=0.072 grad_norm=3.36 num_segments=256 num_words=208
2020-06-10 15:36:37,579: 34) loss=0.072 grad_norm=2.12 num_segments=256 num_words=211
2020-06-10 15:37:48,173: 35) loss=0.066 grad_norm=1.50 num_segments=256 num_words=198
2020-06-10 15:38:58,645: 36) loss=0.068 grad_norm=1.78 num_segments=256 num_words=215
2020-06-10 15:40:08,932: 37) loss=0.071 grad_norm=3.08 num_segments=256 num_words=215
2020-06-10 15:41:12,126: 38) loss=0.064 grad_norm=1.85 num_segments=243 num_words=198
2020-06-10 15:41:12,140: epoch= 42.00
2020-06-10 15:41:12,140:  >> time to evaluate and save:
2020-06-10 15:41:12,184: saved save/MultiViewDataset_IndividualWords.1638.pth
2020-06-10 15:41:12,198: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 15:41:12,225: removed save/MultiViewDataset_IndividualWords.1443.pth
2020-06-10 15:41:12,225: saved MultiViewDataset_IndividualWords successfully
2020-06-10 15:41:13,560: saved save/MultiViewRNN.1638.pth
2020-06-10 15:41:13,570: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 15:41:13,607: removed save/MultiViewRNN.1443.pth
2020-06-10 15:41:13,608: saved MultiViewRNN successfully
2020-06-10 15:41:16,159: saved save/Adam.1638.pth
2020-06-10 15:41:16,169: most_recent linked save/Adam.most_recent.pth
2020-06-10 15:41:16,234: removed save/Adam.1404.pth
2020-06-10 15:41:16,234: saved Adam successfully
2020-06-10 15:41:16,237: saved save/ReduceLROnPlateau.1638.pth
2020-06-10 15:41:16,247: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 15:41:16,255: removed save/ReduceLROnPlateau.1443.pth
2020-06-10 15:41:16,255: saved ReduceLROnPlateau successfully
2020-06-10 15:41:16,257: saved config successfully
2020-06-10 15:42:50,808:   >> crossview_ap=0.724 (10966 x 3921 pairs)
2020-06-10 15:43:51,320:   >> acoustic_ap=0.777 (10966 choose 2 pairs)
2020-06-10 15:43:51,325: best_so_far= 0.724 at 1638
2020-06-10 15:43:51,352: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 15:43:51,355: saved MultiViewDataset_IndividualWords successfully
2020-06-10 15:43:51,366: best linked save/MultiViewRNN.best.pth
2020-06-10 15:43:51,374: saved MultiViewRNN successfully
2020-06-10 15:43:51,394: best linked save/Adam.best.pth
2020-06-10 15:43:51,402: saved Adam successfully
2020-06-10 15:43:51,411: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 15:43:51,443: saved ReduceLROnPlateau successfully
2020-06-10 15:43:52,352: epoch=42.00 global_step=1638 lr=0.0001 start_iter=0
2020-06-10 15:43:52,352: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 15:45:04,938: 0) loss=0.073 grad_norm=1.46 num_segments=256 num_words=214
2020-06-10 15:46:15,736: 1) loss=0.068 grad_norm=1.53 num_segments=256 num_words=209
2020-06-10 15:47:26,011: 2) loss=0.069 grad_norm=3.34 num_segments=256 num_words=224
2020-06-10 15:48:35,928: 3) loss=0.088 grad_norm=1.78 num_segments=256 num_words=215
2020-06-10 15:49:45,526: 4) loss=0.072 grad_norm=2.17 num_segments=256 num_words=204
2020-06-10 15:50:54,672: 5) loss=0.069 grad_norm=1.75 num_segments=256 num_words=209
2020-06-10 15:52:04,192: 6) loss=0.069 grad_norm=1.77 num_segments=256 num_words=208
2020-06-10 15:53:12,994: 7) loss=0.073 grad_norm=2.02 num_segments=256 num_words=207
2020-06-10 15:54:21,583: 8) loss=0.068 grad_norm=2.55 num_segments=256 num_words=219
2020-06-10 15:55:29,968: 9) loss=0.070 grad_norm=1.94 num_segments=256 num_words=209
2020-06-10 15:56:37,079: 10) loss=0.073 grad_norm=1.24 num_segments=256 num_words=205
2020-06-10 15:57:44,151: 11) loss=0.067 grad_norm=1.21 num_segments=256 num_words=213
2020-06-10 15:58:51,258: 12) loss=0.073 grad_norm=2.18 num_segments=256 num_words=205
2020-06-10 16:00:00,178: 13) loss=0.068 grad_norm=1.87 num_segments=256 num_words=219
2020-06-10 16:01:45,085: 14) loss=0.062 grad_norm=1.83 num_segments=256 num_words=204
2020-06-10 16:02:52,052: 15) loss=0.073 grad_norm=1.63 num_segments=256 num_words=213
2020-06-10 16:03:59,240: 16) loss=0.065 grad_norm=1.38 num_segments=256 num_words=206
2020-06-10 16:05:06,340: 17) loss=0.078 grad_norm=1.58 num_segments=256 num_words=213
2020-06-10 16:06:13,039: 18) loss=0.067 grad_norm=2.92 num_segments=256 num_words=211
2020-06-10 16:07:20,509: 19) loss=0.075 grad_norm=1.83 num_segments=256 num_words=207
2020-06-10 16:08:28,999: 20) loss=0.094 grad_norm=1.82 num_segments=256 num_words=209
2020-06-10 16:09:36,930: 21) loss=0.068 grad_norm=1.30 num_segments=256 num_words=203
2020-06-10 16:10:44,165: 22) loss=0.066 grad_norm=1.66 num_segments=256 num_words=213
2020-06-10 16:11:51,249: 23) loss=0.072 grad_norm=2.40 num_segments=256 num_words=218
2020-06-10 16:12:59,033: 24) loss=0.078 grad_norm=2.06 num_segments=256 num_words=200
2020-06-10 16:14:05,788: 25) loss=0.071 grad_norm=1.79 num_segments=256 num_words=196
2020-06-10 16:15:12,240: 26) loss=0.068 grad_norm=1.73 num_segments=256 num_words=206
2020-06-10 16:16:19,534: 27) loss=0.066 grad_norm=1.37 num_segments=256 num_words=212
2020-06-10 16:17:26,710: 28) loss=0.063 grad_norm=1.74 num_segments=256 num_words=213
2020-06-10 16:18:33,532: 29) loss=0.066 grad_norm=1.67 num_segments=256 num_words=215
2020-06-10 16:19:41,318: 30) loss=0.063 grad_norm=1.85 num_segments=256 num_words=206
2020-06-10 16:20:48,367: 31) loss=0.064 grad_norm=2.14 num_segments=256 num_words=200
2020-06-10 16:21:55,265: 32) loss=0.064 grad_norm=1.47 num_segments=256 num_words=213
2020-06-10 16:23:02,452: 33) loss=0.067 grad_norm=1.79 num_segments=256 num_words=224
2020-06-10 16:24:09,603: 34) loss=0.066 grad_norm=1.70 num_segments=256 num_words=215
2020-06-10 16:25:16,481: 35) loss=0.077 grad_norm=2.30 num_segments=256 num_words=212
2020-06-10 16:26:23,235: 36) loss=0.065 grad_norm=1.57 num_segments=256 num_words=207
2020-06-10 16:27:29,539: 37) loss=0.081 grad_norm=2.31 num_segments=256 num_words=219
2020-06-10 16:28:29,401: 38) loss=0.070 grad_norm=2.09 num_segments=243 num_words=203
2020-06-10 16:28:29,426: epoch= 43.00
2020-06-10 16:28:29,426:  >> time to evaluate and save:
2020-06-10 16:28:29,465: saved save/MultiViewDataset_IndividualWords.1677.pth
2020-06-10 16:28:29,474: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 16:28:29,493: removed save/MultiViewDataset_IndividualWords.1404.pth
2020-06-10 16:28:29,493: saved MultiViewDataset_IndividualWords successfully
2020-06-10 16:28:30,829: saved save/MultiViewRNN.1677.pth
2020-06-10 16:28:30,835: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 16:28:30,903: removed save/MultiViewRNN.1404.pth
2020-06-10 16:28:30,904: saved MultiViewRNN successfully
2020-06-10 16:28:33,459: saved save/Adam.1677.pth
2020-06-10 16:28:33,492: most_recent linked save/Adam.most_recent.pth
2020-06-10 16:28:33,530: removed save/Adam.1443.pth
2020-06-10 16:28:33,530: saved Adam successfully
2020-06-10 16:28:33,533: saved save/ReduceLROnPlateau.1677.pth
2020-06-10 16:28:33,541: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 16:28:33,549: removed save/ReduceLROnPlateau.1404.pth
2020-06-10 16:28:33,551: saved ReduceLROnPlateau successfully
2020-06-10 16:28:33,553: saved config successfully
2020-06-10 16:29:57,868:   >> crossview_ap=0.726 (10966 x 3921 pairs)
2020-06-10 16:31:01,318:   >> acoustic_ap=0.779 (10966 choose 2 pairs)
2020-06-10 16:31:01,321: best_so_far= 0.726 at 1677
2020-06-10 16:31:01,331: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 16:31:01,334: saved MultiViewDataset_IndividualWords successfully
2020-06-10 16:31:01,353: best linked save/MultiViewRNN.best.pth
2020-06-10 16:31:01,366: saved MultiViewRNN successfully
2020-06-10 16:31:01,370: best linked save/Adam.best.pth
2020-06-10 16:31:01,377: saved Adam successfully
2020-06-10 16:31:01,421: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 16:31:01,425: saved ReduceLROnPlateau successfully
2020-06-10 16:31:04,610: epoch=43.00 global_step=1677 lr=0.0001 start_iter=0
2020-06-10 16:31:04,610: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 16:32:13,591: 0) loss=0.072 grad_norm=1.37 num_segments=256 num_words=204
2020-06-10 16:33:20,761: 1) loss=0.072 grad_norm=1.81 num_segments=256 num_words=208
2020-06-10 16:34:27,211: 2) loss=0.063 grad_norm=1.33 num_segments=256 num_words=209
2020-06-10 16:35:32,973: 3) loss=0.072 grad_norm=1.89 num_segments=256 num_words=214
2020-06-10 16:36:39,140: 4) loss=0.066 grad_norm=1.81 num_segments=256 num_words=210
2020-06-10 16:37:45,544: 5) loss=0.073 grad_norm=1.37 num_segments=256 num_words=220
2020-06-10 16:38:54,599: 6) loss=0.068 grad_norm=1.32 num_segments=256 num_words=211
2020-06-10 16:40:02,191: 7) loss=0.071 grad_norm=1.20 num_segments=256 num_words=213
2020-06-10 16:41:09,908: 8) loss=0.074 grad_norm=2.16 num_segments=256 num_words=204
2020-06-10 16:43:03,449: 9) loss=0.071 grad_norm=1.63 num_segments=256 num_words=215
2020-06-10 16:44:10,424: 10) loss=0.131 grad_norm=3.36 num_segments=256 num_words=225
2020-06-10 16:45:17,018: 11) loss=0.069 grad_norm=1.04 num_segments=256 num_words=211
2020-06-10 16:46:19,926: 12) loss=0.070 grad_norm=1.95 num_segments=256 num_words=215
2020-06-10 16:47:22,381: 13) loss=0.066 grad_norm=1.34 num_segments=256 num_words=209
2020-06-10 16:48:25,437: 14) loss=0.131 grad_norm=2.64 num_segments=256 num_words=211
2020-06-10 16:49:28,506: 15) loss=0.074 grad_norm=1.69 num_segments=256 num_words=200
2020-06-10 16:50:32,662: 16) loss=0.068 grad_norm=1.30 num_segments=256 num_words=214
2020-06-10 16:51:36,404: 17) loss=0.067 grad_norm=1.69 num_segments=256 num_words=204
2020-06-10 16:52:40,607: 18) loss=0.070 grad_norm=1.64 num_segments=256 num_words=210
2020-06-10 16:53:45,126: 19) loss=0.125 grad_norm=2.44 num_segments=256 num_words=198
2020-06-10 16:54:52,177: 20) loss=0.065 grad_norm=1.82 num_segments=256 num_words=219
2020-06-10 16:55:58,943: 21) loss=0.068 grad_norm=1.64 num_segments=256 num_words=220
2020-06-10 16:57:04,257: 22) loss=0.066 grad_norm=1.58 num_segments=256 num_words=211
2020-06-10 16:58:08,476: 23) loss=0.127 grad_norm=3.27 num_segments=256 num_words=206
2020-06-10 16:59:12,126: 24) loss=0.071 grad_norm=2.10 num_segments=256 num_words=212
2020-06-10 17:00:18,013: 25) loss=0.067 grad_norm=1.23 num_segments=256 num_words=209
2020-06-10 17:01:24,450: 26) loss=0.067 grad_norm=1.53 num_segments=256 num_words=215
2020-06-10 17:02:30,079: 27) loss=0.071 grad_norm=1.71 num_segments=256 num_words=205
2020-06-10 17:03:35,958: 28) loss=0.070 grad_norm=1.55 num_segments=256 num_words=197
2020-06-10 17:04:39,476: 29) loss=0.066 grad_norm=1.11 num_segments=256 num_words=217
2020-06-10 17:05:45,714: 30) loss=0.064 grad_norm=2.18 num_segments=256 num_words=209
2020-06-10 17:06:49,332: 31) loss=0.070 grad_norm=1.58 num_segments=256 num_words=214
2020-06-10 17:07:54,753: 32) loss=0.067 grad_norm=1.68 num_segments=256 num_words=219
2020-06-10 17:08:58,981: 33) loss=0.064 grad_norm=1.82 num_segments=256 num_words=214
2020-06-10 17:10:03,624: 34) loss=0.070 grad_norm=1.96 num_segments=256 num_words=208
2020-06-10 17:11:10,203: 35) loss=0.068 grad_norm=1.56 num_segments=256 num_words=218
2020-06-10 17:12:15,569: 36) loss=0.067 grad_norm=2.05 num_segments=256 num_words=218
2020-06-10 17:13:24,485: 37) loss=0.067 grad_norm=1.54 num_segments=256 num_words=208
2020-06-10 17:14:22,718: 38) loss=0.070 grad_norm=1.30 num_segments=243 num_words=198
2020-06-10 17:14:22,728: epoch= 44.00
2020-06-10 17:14:22,728:  >> time to evaluate and save:
2020-06-10 17:14:22,756: saved save/MultiViewDataset_IndividualWords.1716.pth
2020-06-10 17:14:22,762: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 17:14:22,800: removed save/MultiViewDataset_IndividualWords.1482.pth
2020-06-10 17:14:22,800: saved MultiViewDataset_IndividualWords successfully
2020-06-10 17:14:24,177: saved save/MultiViewRNN.1716.pth
2020-06-10 17:14:24,190: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 17:14:24,239: removed save/MultiViewRNN.1482.pth
2020-06-10 17:14:24,239: saved MultiViewRNN successfully
2020-06-10 17:14:26,747: saved save/Adam.1716.pth
2020-06-10 17:14:26,757: most_recent linked save/Adam.most_recent.pth
2020-06-10 17:14:26,804: removed save/Adam.1482.pth
2020-06-10 17:14:26,804: saved Adam successfully
2020-06-10 17:14:26,806: saved save/ReduceLROnPlateau.1716.pth
2020-06-10 17:14:26,812: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 17:14:26,819: removed save/ReduceLROnPlateau.1482.pth
2020-06-10 17:14:26,820: saved ReduceLROnPlateau successfully
2020-06-10 17:14:26,821: saved config successfully
2020-06-10 19:53:50,259: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-10 19:53:50,317: Using 1 GPU(s)
2020-06-10 19:53:50,317: Machine: 0 / 1
2020-06-10 19:53:50,343: Hyperparam tuning-------------------
2020-06-10 19:53:50,343: optim_lr: 0.001
2020-06-10 19:53:50,343: dropout (for both): 0.4
2020-06-10 19:53:50,343: margin: 0.4
2020-06-10 19:53:50,343: ------------------------------------
2020-06-10 19:53:50,343: Calling main function: multiview_evaluator.evaluate
2020-06-10 19:53:50,343: Using config file: eval_config.json
2020-06-10 19:53:50,344: Using module at multiview_evaluator.evaluate
2020-06-10 19:53:50,393: Using module at multiview_vocab.MultiViewVocab
2020-06-10 19:53:50,398: Building vocab_data from config
2020-06-10 19:53:50,648:  >> min_count= 0
2020-06-10 19:53:50,648:  >> # words= 34323 (# removed= 0)
2020-06-10 19:53:50,648:  >> # subwords= 45
2020-06-10 19:53:50,648:     [laughter]= 1
2020-06-10 19:53:50,648:     [noise]= 2
2020-06-10 19:53:50,648:     [vocalized-noise]= 3
2020-06-10 19:53:50,648:     aa= 4
2020-06-10 19:53:50,648:     ae= 5
2020-06-10 19:53:50,648:     ah= 6
2020-06-10 19:53:50,649:     ao= 7
2020-06-10 19:53:50,649:     aw= 8
2020-06-10 19:53:50,649:     ax= 9
2020-06-10 19:53:50,649:     ay= 10
2020-06-10 19:53:50,649:     b= 11
2020-06-10 19:53:50,649:     ch= 12
2020-06-10 19:53:50,649:     d= 13
2020-06-10 19:53:50,649:     dh= 14
2020-06-10 19:53:50,649:     eh= 15
2020-06-10 19:53:50,649:     el= 16
2020-06-10 19:53:50,649:     en= 17
2020-06-10 19:53:50,649:     er= 18
2020-06-10 19:53:50,649:     ey= 19
2020-06-10 19:53:50,649:     f= 20
2020-06-10 19:53:50,649:     g= 21
2020-06-10 19:53:50,649:     hh= 22
2020-06-10 19:53:50,649:     ih= 23
2020-06-10 19:53:50,650:     iy= 24
2020-06-10 19:53:50,650:     jh= 25
2020-06-10 19:53:50,650:     k= 26
2020-06-10 19:53:50,650:     l= 27
2020-06-10 19:53:50,650:     m= 28
2020-06-10 19:53:50,650:     n= 29
2020-06-10 19:53:50,650:     ng= 30
2020-06-10 19:53:50,650:     ow= 31
2020-06-10 19:53:50,650:     oy= 32
2020-06-10 19:53:50,650:     p= 33
2020-06-10 19:53:50,650:     r= 34
2020-06-10 19:53:50,650:     s= 35
2020-06-10 19:53:50,650:     sh= 36
2020-06-10 19:53:50,650:     t= 37
2020-06-10 19:53:50,650:     th= 38
2020-06-10 19:53:50,650:     uh= 39
2020-06-10 19:53:50,650:     uw= 40
2020-06-10 19:53:50,651:     v= 41
2020-06-10 19:53:50,651:     w= 42
2020-06-10 19:53:50,651:     y= 43
2020-06-10 19:53:50,651:     z= 44
2020-06-10 19:53:50,651:     zh= 45
2020-06-10 19:53:50,665: Using module at data.batch_samplers.BatchSampler
2020-06-10 19:53:50,666: Building vocab_sampler from config
2020-06-10 19:53:50,667:  >> # examples= 34323
2020-06-10 19:53:50,667:  >> batch_size= 1000
2020-06-10 19:53:50,667:  >> shuffle= False
2020-06-10 19:53:50,675:  >> BatchSampler; 35 batches
2020-06-10 19:53:50,675: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 19:53:52,556: Building dev_data from config
2020-06-10 19:54:01,036:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 19:54:01,043:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 19:54:01,043:  >> stack= False
2020-06-10 19:54:01,043:  >> seg_durs= (1, None)
2020-06-10 19:54:01,043:  >> # words= 10966 (# ignored= 0)
2020-06-10 19:54:01,043:  >> input_feat_dim= 108
2020-06-10 19:54:01,043:  >> input_num_subwords= 45
2020-06-10 19:54:01,043: Using module at data.batch_samplers.BatchSampler
2020-06-10 19:54:01,044: Building dev_sampler from config
2020-06-10 19:54:01,045:  >> # examples= 10966
2020-06-10 19:54:01,045:  >> batch_size= 256
2020-06-10 19:54:01,045:  >> shuffle= False
2020-06-10 19:54:01,047:  >> BatchSampler; 43 batches
2020-06-10 19:54:01,047: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 19:54:01,047: Building test_data from config
2020-06-10 19:54:07,393:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 19:54:07,394:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 19:54:07,394:  >> stack= False
2020-06-10 19:54:07,394:  >> seg_durs= (1, None)
2020-06-10 19:54:07,394:  >> # words= 11024 (# ignored= 0)
2020-06-10 19:54:07,394:  >> input_feat_dim= 108
2020-06-10 19:54:07,394:  >> input_num_subwords= 45
2020-06-10 19:54:07,394: Using module at data.batch_samplers.BatchSampler
2020-06-10 19:54:07,394: Building test_sampler from config
2020-06-10 19:54:07,395:  >> # examples= 11024
2020-06-10 19:54:07,395:  >> batch_size= 256
2020-06-10 19:54:07,395:  >> shuffle= False
2020-06-10 19:54:07,397:  >> BatchSampler; 44 batches
2020-06-10 19:54:07,397: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 19:54:12,241: Building eval from config
2020-06-10 19:54:12,241:  >> acoustic_ap= True
2020-06-10 19:54:12,242:  >> crossview_ap= True
2020-06-10 19:54:12,242:  >> full_vocab= False
2020-06-10 19:54:12,242:  >> metric= crossview_ap
2020-06-10 19:54:12,242:  >> mode= max
2020-06-10 19:54:12,242: Using module at multiview_rnn.MultiViewRNN
2020-06-10 19:54:12,250: Building net from config
2020-06-10 19:54:12,251: view1:
2020-06-10 19:54:12,252:  >> cell= GRU
2020-06-10 19:54:12,252:  >> input_size= 108
2020-06-10 19:54:12,252:  >> hidden_size= 512
2020-06-10 19:54:12,252:  >> bidirectional= True
2020-06-10 19:54:12,253:  >> num_layers= 6
2020-06-10 19:54:12,253:  >> dropout between layers= 0.4
2020-06-10 19:54:12,505: view2:
2020-06-10 19:54:12,505:  >> cell= GRU
2020-06-10 19:54:12,506:  >> input_size= 64
2020-06-10 19:54:12,506:  >> hidden_size= 512
2020-06-10 19:54:12,506:  >> bidirectional= True
2020-06-10 19:54:12,506:  >> num_layers= 2
2020-06-10 19:54:12,506:  >> dropout between layers= 0.4
2020-06-10 19:54:12,506:  >> num input embeddings= 45
2020-06-10 19:54:17,633: loaded save/MultiViewRNN.1677.pth
2020-06-10 19:54:17,643: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 19:54:17,643: Evaluating best model on dev and test:
2020-06-10 19:54:17,643: dev score:
2020-06-10 19:55:48,468:   >> crossview_ap=0.726 (10966 x 3921 pairs)
2020-06-10 19:56:42,366:   >> acoustic_ap=0.779 (10966 choose 2 pairs)
2020-06-10 19:56:43,219: saved outputs to npz file successfully
2020-06-10 19:56:43,219: test score:
2020-06-10 19:58:05,667:   >> crossview_ap=0.769 (11024 x 3392 pairs)
2020-06-10 19:59:01,050:   >> acoustic_ap=0.839 (11024 choose 2 pairs)
2020-06-10 19:59:01,767: saved outputs to npz file successfully
2020-06-10 19:59:01,773: Hyperparam tuning-------------------
2020-06-10 19:59:01,773: optim_lr: 0.001
2020-06-10 19:59:01,773: dropout (for both): 0.4
2020-06-10 19:59:01,773: margin: 0.5
2020-06-10 19:59:01,773: ------------------------------------
2020-06-10 19:59:01,773: Calling main function: multiview_evaluator.evaluate
2020-06-10 19:59:01,773: Using config file: eval_config.json
2020-06-10 19:59:01,774: Using module at multiview_evaluator.evaluate
2020-06-10 19:59:01,774: Using module at multiview_vocab.MultiViewVocab
2020-06-10 19:59:01,774: Building vocab_data from config
2020-06-10 19:59:02,161:  >> min_count= 0
2020-06-10 19:59:02,161:  >> # words= 34323 (# removed= 0)
2020-06-10 19:59:02,161:  >> # subwords= 45
2020-06-10 19:59:02,162:     [laughter]= 1
2020-06-10 19:59:02,162:     [noise]= 2
2020-06-10 19:59:02,162:     [vocalized-noise]= 3
2020-06-10 19:59:02,162:     aa= 4
2020-06-10 19:59:02,162:     ae= 5
2020-06-10 19:59:02,162:     ah= 6
2020-06-10 19:59:02,162:     ao= 7
2020-06-10 19:59:02,162:     aw= 8
2020-06-10 19:59:02,162:     ax= 9
2020-06-10 19:59:02,162:     ay= 10
2020-06-10 19:59:02,162:     b= 11
2020-06-10 19:59:02,162:     ch= 12
2020-06-10 19:59:02,162:     d= 13
2020-06-10 19:59:02,162:     dh= 14
2020-06-10 19:59:02,162:     eh= 15
2020-06-10 19:59:02,162:     el= 16
2020-06-10 19:59:02,162:     en= 17
2020-06-10 19:59:02,162:     er= 18
2020-06-10 19:59:02,162:     ey= 19
2020-06-10 19:59:02,163:     f= 20
2020-06-10 19:59:02,163:     g= 21
2020-06-10 19:59:02,163:     hh= 22
2020-06-10 19:59:02,163:     ih= 23
2020-06-10 19:59:02,163:     iy= 24
2020-06-10 19:59:02,163:     jh= 25
2020-06-10 19:59:02,163:     k= 26
2020-06-10 19:59:02,163:     l= 27
2020-06-10 19:59:02,163:     m= 28
2020-06-10 19:59:02,163:     n= 29
2020-06-10 19:59:02,163:     ng= 30
2020-06-10 19:59:02,163:     ow= 31
2020-06-10 19:59:02,163:     oy= 32
2020-06-10 19:59:02,163:     p= 33
2020-06-10 19:59:02,163:     r= 34
2020-06-10 19:59:02,163:     s= 35
2020-06-10 19:59:02,163:     sh= 36
2020-06-10 19:59:02,163:     t= 37
2020-06-10 19:59:02,163:     th= 38
2020-06-10 19:59:02,164:     uh= 39
2020-06-10 19:59:02,164:     uw= 40
2020-06-10 19:59:02,164:     v= 41
2020-06-10 19:59:02,164:     w= 42
2020-06-10 19:59:02,164:     y= 43
2020-06-10 19:59:02,164:     z= 44
2020-06-10 19:59:02,164:     zh= 45
2020-06-10 19:59:02,178: Using module at data.batch_samplers.BatchSampler
2020-06-10 19:59:02,179: Building vocab_sampler from config
2020-06-10 19:59:02,179:  >> # examples= 34323
2020-06-10 19:59:02,179:  >> batch_size= 1000
2020-06-10 19:59:02,179:  >> shuffle= False
2020-06-10 19:59:02,187:  >> BatchSampler; 35 batches
2020-06-10 19:59:02,187: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 19:59:02,187: Building dev_data from config
2020-06-10 19:59:09,602:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 19:59:09,618:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 19:59:09,618:  >> stack= False
2020-06-10 19:59:09,618:  >> seg_durs= (1, None)
2020-06-10 19:59:09,618:  >> # words= 10966 (# ignored= 0)
2020-06-10 19:59:09,618:  >> input_feat_dim= 108
2020-06-10 19:59:09,619:  >> input_num_subwords= 45
2020-06-10 19:59:09,619: Using module at data.batch_samplers.BatchSampler
2020-06-10 19:59:09,619: Building dev_sampler from config
2020-06-10 19:59:09,619:  >> # examples= 10966
2020-06-10 19:59:09,619:  >> batch_size= 256
2020-06-10 19:59:09,619:  >> shuffle= False
2020-06-10 19:59:09,622:  >> BatchSampler; 43 batches
2020-06-10 19:59:09,622: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 19:59:09,622: Building test_data from config
2020-06-10 19:59:16,250:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 19:59:16,262:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 19:59:16,262:  >> stack= False
2020-06-10 19:59:16,263:  >> seg_durs= (1, None)
2020-06-10 19:59:16,263:  >> # words= 11024 (# ignored= 0)
2020-06-10 19:59:16,263:  >> input_feat_dim= 108
2020-06-10 19:59:16,263:  >> input_num_subwords= 45
2020-06-10 19:59:16,263: Using module at data.batch_samplers.BatchSampler
2020-06-10 19:59:16,263: Building test_sampler from config
2020-06-10 19:59:16,263:  >> # examples= 11024
2020-06-10 19:59:16,263:  >> batch_size= 256
2020-06-10 19:59:16,263:  >> shuffle= False
2020-06-10 19:59:16,265:  >> BatchSampler; 44 batches
2020-06-10 19:59:16,265: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 19:59:16,266: Building eval from config
2020-06-10 19:59:16,266:  >> acoustic_ap= True
2020-06-10 19:59:16,266:  >> crossview_ap= True
2020-06-10 19:59:16,266:  >> full_vocab= False
2020-06-10 19:59:16,266:  >> metric= crossview_ap
2020-06-10 19:59:16,266:  >> mode= max
2020-06-10 19:59:16,266: Using module at multiview_rnn.MultiViewRNN
2020-06-10 19:59:16,266: Building net from config
2020-06-10 19:59:16,267: view1:
2020-06-10 19:59:16,267:  >> cell= GRU
2020-06-10 19:59:16,267:  >> input_size= 108
2020-06-10 19:59:16,267:  >> hidden_size= 512
2020-06-10 19:59:16,267:  >> bidirectional= True
2020-06-10 19:59:16,267:  >> num_layers= 6
2020-06-10 19:59:16,268:  >> dropout between layers= 0.4
2020-06-10 19:59:16,470: view2:
2020-06-10 19:59:16,470:  >> cell= GRU
2020-06-10 19:59:16,470:  >> input_size= 64
2020-06-10 19:59:16,471:  >> hidden_size= 512
2020-06-10 19:59:16,471:  >> bidirectional= True
2020-06-10 19:59:16,471:  >> num_layers= 2
2020-06-10 19:59:16,471:  >> dropout between layers= 0.4
2020-06-10 19:59:16,471:  >> num input embeddings= 45
2020-06-10 19:59:16,636: loaded save/MultiViewRNN.1677.pth
2020-06-10 19:59:16,637: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 19:59:16,637: Evaluating best model on dev and test:
2020-06-10 19:59:16,637: dev score:
2020-06-10 20:00:43,327:   >> crossview_ap=0.726 (10966 x 3921 pairs)
2020-06-10 20:01:38,055:   >> acoustic_ap=0.779 (10966 choose 2 pairs)
2020-06-10 20:01:38,824: saved outputs to npz file successfully
2020-06-10 20:01:38,824: test score:
2020-06-10 20:03:04,296:   >> crossview_ap=0.769 (11024 x 3392 pairs)
2020-06-10 20:04:09,744:   >> acoustic_ap=0.839 (11024 choose 2 pairs)
2020-06-10 20:04:10,461: saved outputs to npz file successfully
2020-06-10 20:04:10,467: Hyperparam tuning-------------------
2020-06-10 20:04:10,468: optim_lr: 0.0005
2020-06-10 20:04:10,468: dropout (for both): 0.4
2020-06-10 20:04:10,468: margin: 0.4
2020-06-10 20:04:10,468: ------------------------------------
2020-06-10 20:04:10,468: Calling main function: multiview_evaluator.evaluate
2020-06-10 20:04:10,468: Using config file: eval_config.json
2020-06-10 20:04:10,468: Using module at multiview_evaluator.evaluate
2020-06-10 20:04:10,469: Using module at multiview_vocab.MultiViewVocab
2020-06-10 20:04:10,469: Building vocab_data from config
2020-06-10 20:04:10,853:  >> min_count= 0
2020-06-10 20:04:10,853:  >> # words= 34323 (# removed= 0)
2020-06-10 20:04:10,853:  >> # subwords= 45
2020-06-10 20:04:10,853:     [laughter]= 1
2020-06-10 20:04:10,853:     [noise]= 2
2020-06-10 20:04:10,853:     [vocalized-noise]= 3
2020-06-10 20:04:10,853:     aa= 4
2020-06-10 20:04:10,853:     ae= 5
2020-06-10 20:04:10,854:     ah= 6
2020-06-10 20:04:10,854:     ao= 7
2020-06-10 20:04:10,854:     aw= 8
2020-06-10 20:04:10,854:     ax= 9
2020-06-10 20:04:10,854:     ay= 10
2020-06-10 20:04:10,854:     b= 11
2020-06-10 20:04:10,854:     ch= 12
2020-06-10 20:04:10,854:     d= 13
2020-06-10 20:04:10,854:     dh= 14
2020-06-10 20:04:10,854:     eh= 15
2020-06-10 20:04:10,854:     el= 16
2020-06-10 20:04:10,854:     en= 17
2020-06-10 20:04:10,854:     er= 18
2020-06-10 20:04:10,854:     ey= 19
2020-06-10 20:04:10,854:     f= 20
2020-06-10 20:04:10,854:     g= 21
2020-06-10 20:04:10,854:     hh= 22
2020-06-10 20:04:10,854:     ih= 23
2020-06-10 20:04:10,854:     iy= 24
2020-06-10 20:04:10,855:     jh= 25
2020-06-10 20:04:10,855:     k= 26
2020-06-10 20:04:10,855:     l= 27
2020-06-10 20:04:10,855:     m= 28
2020-06-10 20:04:10,855:     n= 29
2020-06-10 20:04:10,855:     ng= 30
2020-06-10 20:04:10,855:     ow= 31
2020-06-10 20:04:10,855:     oy= 32
2020-06-10 20:04:10,855:     p= 33
2020-06-10 20:04:10,855:     r= 34
2020-06-10 20:04:10,855:     s= 35
2020-06-10 20:04:10,855:     sh= 36
2020-06-10 20:04:10,855:     t= 37
2020-06-10 20:04:10,855:     th= 38
2020-06-10 20:04:10,855:     uh= 39
2020-06-10 20:04:10,855:     uw= 40
2020-06-10 20:04:10,855:     v= 41
2020-06-10 20:04:10,855:     w= 42
2020-06-10 20:04:10,855:     y= 43
2020-06-10 20:04:10,855:     z= 44
2020-06-10 20:04:10,856:     zh= 45
2020-06-10 20:04:10,869: Using module at data.batch_samplers.BatchSampler
2020-06-10 20:04:10,869: Building vocab_sampler from config
2020-06-10 20:04:10,869:  >> # examples= 34323
2020-06-10 20:04:10,869:  >> batch_size= 1000
2020-06-10 20:04:10,870:  >> shuffle= False
2020-06-10 20:04:10,877:  >> BatchSampler; 35 batches
2020-06-10 20:04:10,878: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 20:04:10,878: Building dev_data from config
2020-06-10 20:04:19,082:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 20:04:19,093:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 20:04:19,093:  >> stack= False
2020-06-10 20:04:19,093:  >> seg_durs= (1, None)
2020-06-10 20:04:19,093:  >> # words= 10966 (# ignored= 0)
2020-06-10 20:04:19,093:  >> input_feat_dim= 108
2020-06-10 20:04:19,093:  >> input_num_subwords= 45
2020-06-10 20:04:19,094: Using module at data.batch_samplers.BatchSampler
2020-06-10 20:04:19,094: Building dev_sampler from config
2020-06-10 20:04:19,095:  >> # examples= 10966
2020-06-10 20:04:19,095:  >> batch_size= 256
2020-06-10 20:04:19,095:  >> shuffle= False
2020-06-10 20:04:19,099:  >> BatchSampler; 43 batches
2020-06-10 20:04:19,099: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 20:04:19,099: Building test_data from config
2020-06-10 20:04:25,610:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 20:04:25,611:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 20:04:25,611:  >> stack= False
2020-06-10 20:04:25,611:  >> seg_durs= (1, None)
2020-06-10 20:04:25,611:  >> # words= 11024 (# ignored= 0)
2020-06-10 20:04:25,611:  >> input_feat_dim= 108
2020-06-10 20:04:25,611:  >> input_num_subwords= 45
2020-06-10 20:04:25,611: Using module at data.batch_samplers.BatchSampler
2020-06-10 20:04:25,611: Building test_sampler from config
2020-06-10 20:04:25,611:  >> # examples= 11024
2020-06-10 20:04:25,612:  >> batch_size= 256
2020-06-10 20:04:25,612:  >> shuffle= False
2020-06-10 20:04:25,613:  >> BatchSampler; 44 batches
2020-06-10 20:04:25,613: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 20:04:25,614: Building eval from config
2020-06-10 20:04:25,614:  >> acoustic_ap= True
2020-06-10 20:04:25,614:  >> crossview_ap= True
2020-06-10 20:04:25,614:  >> full_vocab= False
2020-06-10 20:04:25,614:  >> metric= crossview_ap
2020-06-10 20:04:25,614:  >> mode= max
2020-06-10 20:04:25,614: Using module at multiview_rnn.MultiViewRNN
2020-06-10 20:04:25,614: Building net from config
2020-06-10 20:04:25,615: view1:
2020-06-10 20:04:25,616:  >> cell= GRU
2020-06-10 20:04:25,616:  >> input_size= 108
2020-06-10 20:04:25,616:  >> hidden_size= 512
2020-06-10 20:04:25,616:  >> bidirectional= True
2020-06-10 20:04:25,616:  >> num_layers= 6
2020-06-10 20:04:25,616:  >> dropout between layers= 0.4
2020-06-10 20:04:25,860: view2:
2020-06-10 20:04:25,861:  >> cell= GRU
2020-06-10 20:04:25,861:  >> input_size= 64
2020-06-10 20:04:25,861:  >> hidden_size= 512
2020-06-10 20:04:25,861:  >> bidirectional= True
2020-06-10 20:04:25,861:  >> num_layers= 2
2020-06-10 20:04:25,861:  >> dropout between layers= 0.4
2020-06-10 20:04:25,861:  >> num input embeddings= 45
2020-06-10 20:04:26,075: loaded save/MultiViewRNN.1677.pth
2020-06-10 20:04:26,075: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 20:04:26,075: Evaluating best model on dev and test:
2020-06-10 20:04:26,075: dev score:
2020-06-10 20:05:51,594:   >> crossview_ap=0.726 (10966 x 3921 pairs)
2020-06-10 20:06:50,081:   >> acoustic_ap=0.779 (10966 choose 2 pairs)
2020-06-10 20:06:50,826: saved outputs to npz file successfully
2020-06-10 20:06:50,826: test score:
2020-06-10 20:08:09,107:   >> crossview_ap=0.769 (11024 x 3392 pairs)
2020-06-10 20:09:00,374:   >> acoustic_ap=0.839 (11024 choose 2 pairs)
2020-06-10 20:09:01,094: saved outputs to npz file successfully
2020-06-10 20:09:01,102: Hyperparam tuning-------------------
2020-06-10 20:09:01,102: optim_lr: 0.0005
2020-06-10 20:09:01,102: dropout (for both): 0.4
2020-06-10 20:09:01,102: margin: 0.5
2020-06-10 20:09:01,102: ------------------------------------
2020-06-10 20:09:01,102: Calling main function: multiview_evaluator.evaluate
2020-06-10 20:09:01,103: Using config file: eval_config.json
2020-06-10 20:09:01,103: Using module at multiview_evaluator.evaluate
2020-06-10 20:09:01,103: Using module at multiview_vocab.MultiViewVocab
2020-06-10 20:09:01,103: Building vocab_data from config
2020-06-10 20:09:01,429:  >> min_count= 0
2020-06-10 20:09:01,430:  >> # words= 34323 (# removed= 0)
2020-06-10 20:09:01,430:  >> # subwords= 45
2020-06-10 20:09:01,430:     [laughter]= 1
2020-06-10 20:09:01,430:     [noise]= 2
2020-06-10 20:09:01,430:     [vocalized-noise]= 3
2020-06-10 20:09:01,430:     aa= 4
2020-06-10 20:09:01,430:     ae= 5
2020-06-10 20:09:01,430:     ah= 6
2020-06-10 20:09:01,430:     ao= 7
2020-06-10 20:09:01,430:     aw= 8
2020-06-10 20:09:01,430:     ax= 9
2020-06-10 20:09:01,430:     ay= 10
2020-06-10 20:09:01,430:     b= 11
2020-06-10 20:09:01,430:     ch= 12
2020-06-10 20:09:01,430:     d= 13
2020-06-10 20:09:01,430:     dh= 14
2020-06-10 20:09:01,430:     eh= 15
2020-06-10 20:09:01,430:     el= 16
2020-06-10 20:09:01,430:     en= 17
2020-06-10 20:09:01,430:     er= 18
2020-06-10 20:09:01,430:     ey= 19
2020-06-10 20:09:01,430:     f= 20
2020-06-10 20:09:01,430:     g= 21
2020-06-10 20:09:01,430:     hh= 22
2020-06-10 20:09:01,431:     ih= 23
2020-06-10 20:09:01,431:     iy= 24
2020-06-10 20:09:01,431:     jh= 25
2020-06-10 20:09:01,431:     k= 26
2020-06-10 20:09:01,431:     l= 27
2020-06-10 20:09:01,431:     m= 28
2020-06-10 20:09:01,431:     n= 29
2020-06-10 20:09:01,431:     ng= 30
2020-06-10 20:09:01,431:     ow= 31
2020-06-10 20:09:01,431:     oy= 32
2020-06-10 20:09:01,431:     p= 33
2020-06-10 20:09:01,431:     r= 34
2020-06-10 20:09:01,431:     s= 35
2020-06-10 20:09:01,431:     sh= 36
2020-06-10 20:09:01,431:     t= 37
2020-06-10 20:09:01,431:     th= 38
2020-06-10 20:09:01,431:     uh= 39
2020-06-10 20:09:01,431:     uw= 40
2020-06-10 20:09:01,431:     v= 41
2020-06-10 20:09:01,431:     w= 42
2020-06-10 20:09:01,431:     y= 43
2020-06-10 20:09:01,431:     z= 44
2020-06-10 20:09:01,431:     zh= 45
2020-06-10 20:09:01,442: Using module at data.batch_samplers.BatchSampler
2020-06-10 20:09:01,442: Building vocab_sampler from config
2020-06-10 20:09:01,442:  >> # examples= 34323
2020-06-10 20:09:01,442:  >> batch_size= 1000
2020-06-10 20:09:01,442:  >> shuffle= False
2020-06-10 20:09:01,448:  >> BatchSampler; 35 batches
2020-06-10 20:09:01,448: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 20:09:01,448: Building dev_data from config
2020-06-10 20:09:08,654:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 20:09:08,655:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 20:09:08,655:  >> stack= False
2020-06-10 20:09:08,655:  >> seg_durs= (1, None)
2020-06-10 20:09:08,655:  >> # words= 10966 (# ignored= 0)
2020-06-10 20:09:08,655:  >> input_feat_dim= 108
2020-06-10 20:09:08,655:  >> input_num_subwords= 45
2020-06-10 20:09:08,655: Using module at data.batch_samplers.BatchSampler
2020-06-10 20:09:08,655: Building dev_sampler from config
2020-06-10 20:09:08,655:  >> # examples= 10966
2020-06-10 20:09:08,655:  >> batch_size= 256
2020-06-10 20:09:08,656:  >> shuffle= False
2020-06-10 20:09:08,658:  >> BatchSampler; 43 batches
2020-06-10 20:09:08,658: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 20:09:08,658: Building test_data from config
2020-06-10 20:09:14,968:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 20:09:14,989:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 20:09:14,989:  >> stack= False
2020-06-10 20:09:14,990:  >> seg_durs= (1, None)
2020-06-10 20:09:14,990:  >> # words= 11024 (# ignored= 0)
2020-06-10 20:09:14,990:  >> input_feat_dim= 108
2020-06-10 20:09:14,990:  >> input_num_subwords= 45
2020-06-10 20:09:14,990: Using module at data.batch_samplers.BatchSampler
2020-06-10 20:09:14,990: Building test_sampler from config
2020-06-10 20:09:14,991:  >> # examples= 11024
2020-06-10 20:09:14,991:  >> batch_size= 256
2020-06-10 20:09:14,991:  >> shuffle= False
2020-06-10 20:09:14,995:  >> BatchSampler; 44 batches
2020-06-10 20:09:14,995: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 20:09:14,995: Building eval from config
2020-06-10 20:09:14,996:  >> acoustic_ap= True
2020-06-10 20:09:14,996:  >> crossview_ap= True
2020-06-10 20:09:14,996:  >> full_vocab= False
2020-06-10 20:09:14,996:  >> metric= crossview_ap
2020-06-10 20:09:14,996:  >> mode= max
2020-06-10 20:09:14,996: Using module at multiview_rnn.MultiViewRNN
2020-06-10 20:09:14,996: Building net from config
2020-06-10 20:09:14,997: view1:
2020-06-10 20:09:14,998:  >> cell= GRU
2020-06-10 20:09:14,998:  >> input_size= 108
2020-06-10 20:09:14,998:  >> hidden_size= 512
2020-06-10 20:09:14,998:  >> bidirectional= True
2020-06-10 20:09:14,999:  >> num_layers= 6
2020-06-10 20:09:14,999:  >> dropout between layers= 0.4
2020-06-10 20:09:15,213: view2:
2020-06-10 20:09:15,214:  >> cell= GRU
2020-06-10 20:09:15,214:  >> input_size= 64
2020-06-10 20:09:15,214:  >> hidden_size= 512
2020-06-10 20:09:15,214:  >> bidirectional= True
2020-06-10 20:09:15,214:  >> num_layers= 2
2020-06-10 20:09:15,214:  >> dropout between layers= 0.4
2020-06-10 20:09:15,214:  >> num input embeddings= 45
2020-06-10 20:09:15,408: loaded save/MultiViewRNN.1677.pth
2020-06-10 20:09:15,408: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-edit
2020-06-10 20:09:15,408: Evaluating best model on dev and test:
2020-06-10 20:09:15,408: dev score:
2020-06-10 20:10:43,438:   >> crossview_ap=0.726 (10966 x 3921 pairs)
2020-06-10 20:11:38,439:   >> acoustic_ap=0.779 (10966 choose 2 pairs)
2020-06-10 20:11:39,185: saved outputs to npz file successfully
2020-06-10 20:11:39,185: test score:
2020-06-10 20:12:54,010:   >> crossview_ap=0.769 (11024 x 3392 pairs)
2020-06-10 20:13:49,864:   >> acoustic_ap=0.839 (11024 choose 2 pairs)
2020-06-10 20:13:50,574: saved outputs to npz file successfully
