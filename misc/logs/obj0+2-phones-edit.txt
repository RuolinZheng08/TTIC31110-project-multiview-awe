Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-08 23:16:03,688: Using 1 GPU(s)
2020-06-08 23:16:03,688: Machine: 0 / 1
2020-06-08 23:16:03,691: Hyperparam tuning-------------------
2020-06-08 23:16:03,691: optim_lr: 0.001
2020-06-08 23:16:03,691: dropout (for both): 0.4
2020-06-08 23:16:03,691: margin: 0.4
2020-06-08 23:16:03,691: ------------------------------------
2020-06-08 23:16:03,696: Calling main function: multiview_trainer.train
2020-06-08 23:16:03,696: Using config file: train_config.json
2020-06-08 23:16:03,696: Using module at multiview_trainer.train
2020-06-08 23:16:04,362: Using module at multiview_vocab.MultiViewVocab
2020-06-08 23:16:04,391: Building vocab_data from config
2020-06-08 23:16:04,714:  >> min_count= 0
2020-06-08 23:16:04,714:  >> # words= 34323 (# removed= 0)
2020-06-08 23:16:04,714:  >> # subwords= 45
2020-06-08 23:16:04,714:     [laughter]= 1
2020-06-08 23:16:04,714:     [noise]= 2
2020-06-08 23:16:04,715:     [vocalized-noise]= 3
2020-06-08 23:16:04,715:     aa= 4
2020-06-08 23:16:04,715:     ae= 5
2020-06-08 23:16:04,715:     ah= 6
2020-06-08 23:16:04,715:     ao= 7
2020-06-08 23:16:04,715:     aw= 8
2020-06-08 23:16:04,715:     ax= 9
2020-06-08 23:16:04,715:     ay= 10
2020-06-08 23:16:04,715:     b= 11
2020-06-08 23:16:04,715:     ch= 12
2020-06-08 23:16:04,715:     d= 13
2020-06-08 23:16:04,715:     dh= 14
2020-06-08 23:16:04,715:     eh= 15
2020-06-08 23:16:04,715:     el= 16
2020-06-08 23:16:04,716:     en= 17
2020-06-08 23:16:04,716:     er= 18
2020-06-08 23:16:04,716:     ey= 19
2020-06-08 23:16:04,716:     f= 20
2020-06-08 23:16:04,716:     g= 21
2020-06-08 23:16:04,716:     hh= 22
2020-06-08 23:16:04,716:     ih= 23
2020-06-08 23:16:04,716:     iy= 24
2020-06-08 23:16:04,716:     jh= 25
2020-06-08 23:16:04,716:     k= 26
2020-06-08 23:16:04,716:     l= 27
2020-06-08 23:16:04,716:     m= 28
2020-06-08 23:16:04,716:     n= 29
2020-06-08 23:16:04,717:     ng= 30
2020-06-08 23:16:04,717:     ow= 31
2020-06-08 23:16:04,717:     oy= 32
2020-06-08 23:16:04,717:     p= 33
2020-06-08 23:16:04,717:     r= 34
2020-06-08 23:16:04,717:     s= 35
2020-06-08 23:16:04,717:     sh= 36
2020-06-08 23:16:04,717:     t= 37
2020-06-08 23:16:04,717:     th= 38
2020-06-08 23:16:04,717:     uh= 39
2020-06-08 23:16:04,717:     uw= 40
2020-06-08 23:16:04,717:     v= 41
2020-06-08 23:16:04,717:     w= 42
2020-06-08 23:16:04,717:     y= 43
2020-06-08 23:16:04,718:     z= 44
2020-06-08 23:16:04,718:     zh= 45
2020-06-08 23:16:04,731: Using module at data.batch_samplers.BatchSampler
2020-06-08 23:16:04,739: Building vocab_sampler from config
2020-06-08 23:16:04,740:  >> # examples= 34323
2020-06-08 23:16:04,740:  >> batch_size= 1000
2020-06-08 23:16:04,740:  >> shuffle= False
2020-06-08 23:16:04,747:  >> BatchSampler; 35 batches
2020-06-08 23:16:04,747: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 23:16:04,998: Building train_data from config
2020-06-08 23:16:12,062:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-08 23:16:12,064:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-08 23:16:12,064:  >> stack= False
2020-06-08 23:16:12,064:  >> seg_durs= (1, None)
2020-06-08 23:16:12,064:  >> # words= 9971 (# ignored= 0)
2020-06-08 23:16:12,065:  >> input_feat_dim= 108
2020-06-08 23:16:12,065:  >> input_num_subwords= 45
2020-06-08 23:16:12,065: Using module at data.batch_samplers.BatchSampler
2020-06-08 23:16:12,066: Building train_sampler from config
2020-06-08 23:16:12,067:  >> # examples= 9971
2020-06-08 23:16:12,067:  >> batch_size= 256
2020-06-08 23:16:12,067:  >> shuffle= True
2020-06-08 23:16:12,083:  >> BatchSampler; 39 batches
2020-06-08 23:16:12,083: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 23:16:12,084: Building dev_data from config
2020-06-08 23:16:20,058:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-08 23:16:20,059:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-08 23:16:20,060:  >> stack= False
2020-06-08 23:16:20,060:  >> seg_durs= (1, None)
2020-06-08 23:16:20,060:  >> # words= 10966 (# ignored= 0)
2020-06-08 23:16:20,060:  >> input_feat_dim= 108
2020-06-08 23:16:20,060:  >> input_num_subwords= 45
2020-06-08 23:16:20,060: Using module at data.batch_samplers.BatchSampler
2020-06-08 23:16:20,060: Building dev_sampler from config
2020-06-08 23:16:20,061:  >> # examples= 10966
2020-06-08 23:16:20,062:  >> batch_size= 256
2020-06-08 23:16:20,062:  >> shuffle= False
2020-06-08 23:16:20,064:  >> BatchSampler; 43 batches
2020-06-08 23:16:20,064: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 23:16:20,064: Building test_data from config
2020-06-08 23:16:27,037:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-08 23:16:27,038:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-08 23:16:27,038:  >> stack= False
2020-06-08 23:16:27,038:  >> seg_durs= (1, None)
2020-06-08 23:16:27,038:  >> # words= 11024 (# ignored= 0)
2020-06-08 23:16:27,038:  >> input_feat_dim= 108
2020-06-08 23:16:27,038:  >> input_num_subwords= 45
2020-06-08 23:16:27,039: Using module at data.batch_samplers.BatchSampler
2020-06-08 23:16:27,039: Building test_sampler from config
2020-06-08 23:16:27,039:  >> # examples= 11024
2020-06-08 23:16:27,039:  >> batch_size= 256
2020-06-08 23:16:27,039:  >> shuffle= False
2020-06-08 23:16:27,042:  >> BatchSampler; 44 batches
2020-06-08 23:16:27,042: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-08 23:16:27,081: Building loss from config
2020-06-08 23:16:27,081:  >> margin= 0.4
2020-06-08 23:16:27,082:  >> k= 16
2020-06-08 23:16:27,082:  >> min_k= 8
2020-06-08 23:16:27,082:  >> extra= 0
2020-06-08 23:16:27,082:  >> average= False
2020-06-08 23:16:27,082:  >> margin_max= 0.5
2020-06-08 23:16:27,082:  >> threshold_max= 9
2020-06-08 23:16:27,082:  >> using obj0+2
2020-06-08 23:16:27,082: Using module at metric.multiview_ap.MultiViewAP
2020-06-08 23:16:27,207: Building eval from config
2020-06-08 23:16:27,208:  >> acoustic_ap= True
2020-06-08 23:16:27,208:  >> crossview_ap= True
2020-06-08 23:16:27,208:  >> full_vocab= False
2020-06-08 23:16:27,208:  >> metric= crossview_ap
2020-06-08 23:16:27,208:  >> mode= max
2020-06-08 23:16:27,208: Using module at multiview_rnn.MultiViewRNN
2020-06-08 23:16:27,258: Building net from config
2020-06-08 23:16:27,260: view1:
2020-06-08 23:16:27,261:  >> cell= GRU
2020-06-08 23:16:27,261:  >> input_size= 108
2020-06-08 23:16:27,261:  >> hidden_size= 512
2020-06-08 23:16:27,261:  >> bidirectional= True
2020-06-08 23:16:27,261:  >> num_layers= 6
2020-06-08 23:16:27,261:  >> dropout between layers= 0.4
2020-06-08 23:16:27,476: view2:
2020-06-08 23:16:27,477:  >> cell= GRU
2020-06-08 23:16:27,477:  >> input_size= 64
2020-06-08 23:16:27,477:  >> hidden_size= 512
2020-06-08 23:16:27,477:  >> bidirectional= True
2020-06-08 23:16:27,477:  >> num_layers= 2
2020-06-08 23:16:27,478:  >> dropout between layers= 0.4
2020-06-08 23:16:27,478:  >> num input embeddings= 45
2020-06-08 23:16:36,608: Using module at optim.adam.Adam
2020-06-08 23:16:36,625: Building optim from config
2020-06-08 23:16:36,625:  >> lr= 0.001
2020-06-08 23:16:36,626:  >> betas= (0.9, 0.999)
2020-06-08 23:16:36,626:  >> eps= 1e-08
2020-06-08 23:16:36,626:  >> weight_decay= 0
2020-06-08 23:16:36,626:  >> amsgrad= False
2020-06-08 23:16:36,626:  >> min_lr= 1e-07
2020-06-08 23:16:36,627: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-08 23:16:36,658: Building sched from config
2020-06-08 23:16:36,659:  >> optim= Adam
2020-06-08 23:16:36,659:  >> decay lr by 0.1
2020-06-08 23:16:36,659:  >> eval_fn= MultiViewAP
2020-06-08 23:16:36,660:  >> patience=4
2020-06-08 23:16:36,660:  >> revert=True
2020-06-08 23:16:36,660: epoch=0.00 global_step=0 lr=0.001 start_iter=0
2020-06-08 23:16:36,661: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-08 23:19:22,252: 0) loss=1.031 grad_norm=122.76 num_segments=256 num_words=204
2020-06-08 23:21:54,769: 1) loss=1.131 grad_norm=258.12 num_segments=256 num_words=211
2020-06-08 23:24:16,096: 2) loss=1.316 grad_norm=252.53 num_segments=256 num_words=202
2020-06-08 23:26:26,857: 3) loss=1.191 grad_norm=254.12 num_segments=256 num_words=218
2020-06-08 23:28:26,079: 4) loss=1.065 grad_norm=89.98 num_segments=256 num_words=204
2020-06-08 23:30:16,356: 5) loss=1.033 grad_norm=79.86 num_segments=256 num_words=194
2020-06-08 23:31:53,384: 6) loss=1.035 grad_norm=96.65 num_segments=256 num_words=218
2020-06-08 23:33:20,934: 7) loss=1.023 grad_norm=80.23 num_segments=256 num_words=207
2020-06-08 23:34:49,550: 8) loss=1.049 grad_norm=60.80 num_segments=256 num_words=207
2020-06-08 23:36:16,266: 9) loss=1.051 grad_norm=61.34 num_segments=256 num_words=217
2020-06-08 23:37:45,777: 10) loss=1.012 grad_norm=57.99 num_segments=256 num_words=218
2020-06-08 23:39:13,034: 11) loss=1.014 grad_norm=71.02 num_segments=256 num_words=208
2020-06-08 23:40:40,096: 12) loss=1.078 grad_norm=66.99 num_segments=256 num_words=223
2020-06-08 23:42:07,155: 13) loss=0.994 grad_norm=54.43 num_segments=256 num_words=211
2020-06-08 23:43:40,919: 14) loss=0.989 grad_norm=52.46 num_segments=256 num_words=216
2020-06-08 23:45:07,481: 15) loss=0.987 grad_norm=68.21 num_segments=256 num_words=198
2020-06-08 23:46:34,198: 16) loss=0.968 grad_norm=58.67 num_segments=256 num_words=209
2020-06-08 23:48:01,299: 17) loss=0.984 grad_norm=61.14 num_segments=256 num_words=210
2020-06-08 23:49:28,086: 18) loss=0.954 grad_norm=59.83 num_segments=256 num_words=209
2020-06-08 23:50:59,223: 19) loss=0.936 grad_norm=69.45 num_segments=256 num_words=210
2020-06-08 23:52:26,393: 20) loss=1.020 grad_norm=66.01 num_segments=256 num_words=212
2020-06-08 23:53:52,878: 21) loss=0.932 grad_norm=67.05 num_segments=256 num_words=216
2020-06-08 23:55:19,437: 22) loss=0.921 grad_norm=62.34 num_segments=256 num_words=209
2020-06-08 23:56:45,988: 23) loss=0.918 grad_norm=58.56 num_segments=256 num_words=220
2020-06-08 23:58:17,873: 24) loss=0.918 grad_norm=59.77 num_segments=256 num_words=202
2020-06-08 23:59:44,311: 25) loss=0.904 grad_norm=58.67 num_segments=256 num_words=207
2020-06-09 00:01:10,638: 26) loss=0.905 grad_norm=82.39 num_segments=256 num_words=209
2020-06-09 00:02:36,749: 27) loss=0.878 grad_norm=67.30 num_segments=256 num_words=204
2020-06-09 00:04:03,661: 28) loss=0.888 grad_norm=73.35 num_segments=256 num_words=216
2020-06-09 00:05:30,217: 29) loss=1.060 grad_norm=72.71 num_segments=256 num_words=207
2020-06-09 00:06:57,513: 30) loss=0.937 grad_norm=80.81 num_segments=256 num_words=220
2020-06-09 00:08:30,565: 31) loss=0.903 grad_norm=103.16 num_segments=256 num_words=212
2020-06-09 00:09:57,618: 32) loss=0.851 grad_norm=67.23 num_segments=256 num_words=210
2020-06-09 00:11:24,130: 33) loss=0.864 grad_norm=99.19 num_segments=256 num_words=202
2020-06-09 00:12:50,753: 34) loss=0.843 grad_norm=87.25 num_segments=256 num_words=213
2020-06-09 00:14:17,503: 35) loss=0.840 grad_norm=80.44 num_segments=256 num_words=205
2020-06-09 00:15:43,749: 36) loss=0.854 grad_norm=98.61 num_segments=256 num_words=208
2020-06-09 00:17:10,548: 37) loss=0.834 grad_norm=105.24 num_segments=256 num_words=209
2020-06-09 00:18:29,414: 38) loss=0.840 grad_norm=54.86 num_segments=243 num_words=211
2020-06-09 00:18:29,430: epoch= 1.00
2020-06-09 00:18:29,430:  >> time to evaluate and save:
2020-06-09 00:18:29,461: saved save/MultiViewDataset_IndividualWords.39.pth
2020-06-09 00:18:29,462: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 00:18:29,464: saved MultiViewDataset_IndividualWords successfully
2020-06-09 00:18:30,788: saved save/MultiViewRNN.39.pth
2020-06-09 00:18:30,789: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 00:18:30,791: saved MultiViewRNN successfully
2020-06-09 00:18:33,399: saved save/Adam.39.pth
2020-06-09 00:18:33,400: most_recent linked save/Adam.most_recent.pth
2020-06-09 00:18:33,402: saved Adam successfully
2020-06-09 00:18:33,405: saved save/ReduceLROnPlateau.39.pth
2020-06-09 00:18:33,407: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 00:18:33,409: saved ReduceLROnPlateau successfully
2020-06-09 00:18:33,412: saved config successfully
2020-06-09 00:20:06,521:   >> crossview_ap=0.054 (10966 x 3921 pairs)
2020-06-09 00:21:00,168:   >> acoustic_ap=0.085 (10966 choose 2 pairs)
2020-06-09 00:21:00,171: best_so_far= 0.054 at 39
2020-06-09 00:21:00,176: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 00:21:00,178: saved MultiViewDataset_IndividualWords successfully
2020-06-09 00:21:00,179: best linked save/MultiViewRNN.best.pth
2020-06-09 00:21:00,181: saved MultiViewRNN successfully
2020-06-09 00:21:00,182: best linked save/Adam.best.pth
2020-06-09 00:21:00,184: saved Adam successfully
2020-06-09 00:21:00,185: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 00:21:00,187: saved ReduceLROnPlateau successfully
2020-06-09 00:21:00,236: epoch=1.00 global_step=39 lr=0.001 start_iter=0
2020-06-09 00:21:00,237: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 00:22:28,655: 0) loss=0.843 grad_norm=116.14 num_segments=256 num_words=218
2020-06-09 00:24:04,740: 1) loss=0.820 grad_norm=85.95 num_segments=256 num_words=212
2020-06-09 00:25:30,987: 2) loss=0.835 grad_norm=67.56 num_segments=256 num_words=209
2020-06-09 00:26:57,391: 3) loss=0.809 grad_norm=76.32 num_segments=256 num_words=211
2020-06-09 00:28:24,215: 4) loss=0.801 grad_norm=103.39 num_segments=256 num_words=215
2020-06-09 00:29:50,756: 5) loss=0.799 grad_norm=87.37 num_segments=256 num_words=213
2020-06-09 00:31:17,154: 6) loss=0.815 grad_norm=84.50 num_segments=256 num_words=216
2020-06-09 00:32:43,610: 7) loss=0.825 grad_norm=72.06 num_segments=256 num_words=203
2020-06-09 00:34:09,901: 8) loss=0.790 grad_norm=57.84 num_segments=256 num_words=218
2020-06-09 00:35:36,497: 9) loss=0.770 grad_norm=59.21 num_segments=256 num_words=212
2020-06-09 00:37:03,366: 10) loss=0.761 grad_norm=78.48 num_segments=256 num_words=208
2020-06-09 00:38:29,855: 11) loss=0.783 grad_norm=74.46 num_segments=256 num_words=213
2020-06-09 00:40:06,986: 12) loss=0.746 grad_norm=85.71 num_segments=256 num_words=218
2020-06-09 00:41:33,821: 13) loss=0.755 grad_norm=67.49 num_segments=256 num_words=208
2020-06-09 00:43:00,742: 14) loss=0.771 grad_norm=80.14 num_segments=256 num_words=213
2020-06-09 00:44:27,744: 15) loss=0.775 grad_norm=101.09 num_segments=256 num_words=200
2020-06-09 00:45:55,001: 16) loss=0.748 grad_norm=70.00 num_segments=256 num_words=208
2020-06-09 00:47:21,842: 17) loss=0.760 grad_norm=100.44 num_segments=256 num_words=210
2020-06-09 00:48:48,267: 18) loss=0.792 grad_norm=101.25 num_segments=256 num_words=200
2020-06-09 00:50:15,041: 19) loss=0.741 grad_norm=69.09 num_segments=256 num_words=221
2020-06-09 00:51:41,589: 20) loss=0.738 grad_norm=68.69 num_segments=256 num_words=209
2020-06-09 00:53:08,461: 21) loss=0.736 grad_norm=83.72 num_segments=256 num_words=203
2020-06-09 00:54:35,246: 22) loss=0.712 grad_norm=54.31 num_segments=256 num_words=210
2020-06-09 00:56:01,968: 23) loss=0.757 grad_norm=67.76 num_segments=256 num_words=222
2020-06-09 00:57:29,106: 24) loss=0.685 grad_norm=63.90 num_segments=256 num_words=215
2020-06-09 00:58:56,571: 25) loss=0.719 grad_norm=73.88 num_segments=256 num_words=205
2020-06-09 01:00:36,839: 26) loss=0.728 grad_norm=69.86 num_segments=256 num_words=215
2020-06-09 01:02:03,652: 27) loss=0.750 grad_norm=82.83 num_segments=256 num_words=213
2020-06-09 01:03:30,388: 28) loss=0.729 grad_norm=78.32 num_segments=256 num_words=214
2020-06-09 01:04:57,035: 29) loss=0.689 grad_norm=55.37 num_segments=256 num_words=205
2020-06-09 01:06:23,699: 30) loss=0.697 grad_norm=68.09 num_segments=256 num_words=209
2020-06-09 01:07:50,339: 31) loss=0.685 grad_norm=73.73 num_segments=256 num_words=209
2020-06-09 01:09:16,979: 32) loss=0.752 grad_norm=63.18 num_segments=256 num_words=200
2020-06-09 01:10:43,936: 33) loss=0.658 grad_norm=92.12 num_segments=256 num_words=201
2020-06-09 01:12:10,838: 34) loss=0.681 grad_norm=97.07 num_segments=256 num_words=211
2020-06-09 01:13:37,922: 35) loss=0.696 grad_norm=59.99 num_segments=256 num_words=206
2020-06-09 01:15:05,665: 36) loss=0.669 grad_norm=74.30 num_segments=256 num_words=210
2020-06-09 01:16:33,260: 37) loss=0.694 grad_norm=72.73 num_segments=256 num_words=204
2020-06-09 01:17:51,629: 38) loss=0.660 grad_norm=57.79 num_segments=243 num_words=196
2020-06-09 01:17:51,645: epoch= 2.00
2020-06-09 01:17:51,645:  >> time to evaluate and save:
2020-06-09 01:17:51,679: saved save/MultiViewDataset_IndividualWords.78.pth
2020-06-09 01:17:51,697: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 01:17:51,699: saved MultiViewDataset_IndividualWords successfully
2020-06-09 01:17:53,001: saved save/MultiViewRNN.78.pth
2020-06-09 01:17:53,013: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 01:17:53,021: saved MultiViewRNN successfully
2020-06-09 01:17:55,576: saved save/Adam.78.pth
2020-06-09 01:17:55,578: most_recent linked save/Adam.most_recent.pth
2020-06-09 01:17:55,585: saved Adam successfully
2020-06-09 01:17:55,589: saved save/ReduceLROnPlateau.78.pth
2020-06-09 01:17:55,595: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 01:17:55,598: saved ReduceLROnPlateau successfully
2020-06-09 01:17:55,600: saved config successfully
2020-06-09 01:19:17,832:   >> crossview_ap=0.219 (10966 x 3921 pairs)
2020-06-09 01:20:11,543:   >> acoustic_ap=0.246 (10966 choose 2 pairs)
2020-06-09 01:20:11,549: best_so_far= 0.219 at 78
2020-06-09 01:20:11,601: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 01:20:11,610: saved MultiViewDataset_IndividualWords successfully
2020-06-09 01:20:11,627: best linked save/MultiViewRNN.best.pth
2020-06-09 01:20:11,658: saved MultiViewRNN successfully
2020-06-09 01:20:11,675: best linked save/Adam.best.pth
2020-06-09 01:20:11,702: saved Adam successfully
2020-06-09 01:20:11,726: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 01:20:11,737: saved ReduceLROnPlateau successfully
2020-06-09 01:20:12,156: epoch=2.00 global_step=78 lr=0.001 start_iter=0
2020-06-09 01:20:12,157: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 01:21:40,637: 0) loss=0.660 grad_norm=67.26 num_segments=256 num_words=199
2020-06-09 01:23:07,955: 1) loss=0.642 grad_norm=61.76 num_segments=256 num_words=217
2020-06-09 01:24:35,710: 2) loss=0.631 grad_norm=75.37 num_segments=256 num_words=208
2020-06-09 01:26:03,110: 3) loss=0.592 grad_norm=78.87 num_segments=256 num_words=209
2020-06-09 01:27:32,254: 4) loss=0.675 grad_norm=74.38 num_segments=256 num_words=210
2020-06-09 01:29:18,504: 5) loss=0.651 grad_norm=61.72 num_segments=256 num_words=208
2020-06-09 01:30:45,615: 6) loss=0.655 grad_norm=78.52 num_segments=256 num_words=212
2020-06-09 01:32:12,464: 7) loss=0.644 grad_norm=64.69 num_segments=256 num_words=218
2020-06-09 01:33:39,826: 8) loss=0.638 grad_norm=77.25 num_segments=256 num_words=210
2020-06-09 01:35:07,048: 9) loss=0.615 grad_norm=54.67 num_segments=256 num_words=217
2020-06-09 01:36:34,282: 10) loss=0.605 grad_norm=71.82 num_segments=256 num_words=208
2020-06-09 01:38:01,220: 11) loss=0.606 grad_norm=62.69 num_segments=256 num_words=197
2020-06-09 01:39:28,294: 12) loss=0.596 grad_norm=57.69 num_segments=256 num_words=219
2020-06-09 01:40:55,781: 13) loss=0.587 grad_norm=68.69 num_segments=256 num_words=200
2020-06-09 01:42:22,977: 14) loss=0.597 grad_norm=76.02 num_segments=256 num_words=212
2020-06-09 01:43:50,507: 15) loss=0.645 grad_norm=88.04 num_segments=256 num_words=211
2020-06-09 01:45:17,495: 16) loss=0.605 grad_norm=61.06 num_segments=256 num_words=209
2020-06-09 01:46:44,678: 17) loss=0.802 grad_norm=100.22 num_segments=256 num_words=218
2020-06-09 01:48:11,843: 18) loss=0.615 grad_norm=89.60 num_segments=256 num_words=214
2020-06-09 01:49:39,123: 19) loss=0.612 grad_norm=59.76 num_segments=256 num_words=206
2020-06-09 01:51:06,604: 20) loss=0.586 grad_norm=89.72 num_segments=256 num_words=209
2020-06-09 01:52:34,218: 21) loss=0.587 grad_norm=94.62 num_segments=256 num_words=212
2020-06-09 01:54:01,594: 22) loss=0.593 grad_norm=90.69 num_segments=256 num_words=212
2020-06-09 01:55:29,071: 23) loss=0.553 grad_norm=79.82 num_segments=256 num_words=217
2020-06-09 01:56:56,098: 24) loss=0.590 grad_norm=69.79 num_segments=256 num_words=214
2020-06-09 01:58:23,225: 25) loss=0.580 grad_norm=88.89 num_segments=256 num_words=227
2020-06-09 02:00:12,219: 26) loss=0.627 grad_norm=72.51 num_segments=256 num_words=202
2020-06-09 02:01:39,032: 27) loss=0.575 grad_norm=69.22 num_segments=256 num_words=206
2020-06-09 02:03:06,139: 28) loss=0.560 grad_norm=70.50 num_segments=256 num_words=210
2020-06-09 02:04:33,461: 29) loss=0.597 grad_norm=72.57 num_segments=256 num_words=206
2020-06-09 02:06:00,614: 30) loss=0.582 grad_norm=77.76 num_segments=256 num_words=210
2020-06-09 02:07:27,692: 31) loss=0.616 grad_norm=75.90 num_segments=256 num_words=219
2020-06-09 02:08:55,344: 32) loss=0.566 grad_norm=60.37 num_segments=256 num_words=216
2020-06-09 02:10:23,116: 33) loss=0.588 grad_norm=79.82 num_segments=256 num_words=221
2020-06-09 02:11:50,016: 34) loss=0.565 grad_norm=65.50 num_segments=256 num_words=199
2020-06-09 02:13:17,375: 35) loss=0.555 grad_norm=79.69 num_segments=256 num_words=206
2020-06-09 02:14:45,073: 36) loss=0.564 grad_norm=80.00 num_segments=256 num_words=210
2020-06-09 02:16:12,640: 37) loss=0.594 grad_norm=75.94 num_segments=256 num_words=212
2020-06-09 02:17:30,965: 38) loss=0.569 grad_norm=65.52 num_segments=243 num_words=200
2020-06-09 02:17:30,981: epoch= 3.00
2020-06-09 02:17:30,981:  >> time to evaluate and save:
2020-06-09 02:17:31,010: saved save/MultiViewDataset_IndividualWords.117.pth
2020-06-09 02:17:31,023: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 02:17:31,025: saved MultiViewDataset_IndividualWords successfully
2020-06-09 02:17:32,340: saved save/MultiViewRNN.117.pth
2020-06-09 02:17:32,347: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 02:17:32,355: saved MultiViewRNN successfully
2020-06-09 02:17:37,489: saved save/Adam.117.pth
2020-06-09 02:17:37,517: most_recent linked save/Adam.most_recent.pth
2020-06-09 02:17:37,540: saved Adam successfully
2020-06-09 02:17:37,550: saved save/ReduceLROnPlateau.117.pth
2020-06-09 02:17:37,559: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 02:17:37,569: saved ReduceLROnPlateau successfully
2020-06-09 02:17:37,581: saved config successfully
2020-06-09 02:19:02,791:   >> crossview_ap=0.377 (10966 x 3921 pairs)
2020-06-09 02:19:56,326:   >> acoustic_ap=0.396 (10966 choose 2 pairs)
2020-06-09 02:19:56,330: best_so_far= 0.377 at 117
2020-06-09 02:19:56,363: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 02:19:56,365: saved MultiViewDataset_IndividualWords successfully
2020-06-09 02:19:56,393: best linked save/MultiViewRNN.best.pth
2020-06-09 02:19:56,405: saved MultiViewRNN successfully
2020-06-09 02:19:56,430: best linked save/Adam.best.pth
2020-06-09 02:19:56,438: saved Adam successfully
2020-06-09 02:19:56,464: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 02:19:56,468: saved ReduceLROnPlateau successfully
2020-06-09 02:19:56,997: epoch=3.00 global_step=117 lr=0.001 start_iter=0
2020-06-09 02:19:56,997: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 02:21:25,709: 0) loss=0.523 grad_norm=78.66 num_segments=256 num_words=203
2020-06-09 02:22:53,184: 1) loss=0.518 grad_norm=63.02 num_segments=256 num_words=215
2020-06-09 02:24:20,644: 2) loss=0.536 grad_norm=81.97 num_segments=256 num_words=209
2020-06-09 02:25:48,462: 3) loss=0.507 grad_norm=71.99 num_segments=256 num_words=209
2020-06-09 02:27:16,145: 4) loss=0.517 grad_norm=63.90 num_segments=256 num_words=209
2020-06-09 02:28:43,454: 5) loss=0.546 grad_norm=55.85 num_segments=256 num_words=210
2020-06-09 02:30:11,410: 6) loss=0.551 grad_norm=59.73 num_segments=256 num_words=207
2020-06-09 02:31:38,924: 7) loss=0.520 grad_norm=64.75 num_segments=256 num_words=223
2020-06-09 02:33:06,426: 8) loss=0.506 grad_norm=59.96 num_segments=256 num_words=212
2020-06-09 02:34:33,964: 9) loss=0.513 grad_norm=69.83 num_segments=256 num_words=214
2020-06-09 02:36:01,596: 10) loss=0.508 grad_norm=67.46 num_segments=256 num_words=212
2020-06-09 02:37:29,150: 11) loss=0.479 grad_norm=72.40 num_segments=256 num_words=211
2020-06-09 02:38:56,544: 12) loss=0.537 grad_norm=70.07 num_segments=256 num_words=206
2020-06-09 02:40:24,350: 13) loss=0.528 grad_norm=79.57 num_segments=256 num_words=219
2020-06-09 02:42:23,568: 14) loss=0.489 grad_norm=56.64 num_segments=256 num_words=212
2020-06-09 02:43:51,166: 15) loss=0.477 grad_norm=71.06 num_segments=256 num_words=205
2020-06-09 02:45:18,605: 16) loss=0.527 grad_norm=76.57 num_segments=256 num_words=211
2020-06-09 02:46:46,190: 17) loss=0.553 grad_norm=68.59 num_segments=256 num_words=210
2020-06-09 02:48:13,533: 18) loss=0.509 grad_norm=79.29 num_segments=256 num_words=218
2020-06-09 02:49:41,175: 19) loss=0.487 grad_norm=65.90 num_segments=256 num_words=207
2020-06-09 02:51:08,640: 20) loss=0.491 grad_norm=72.66 num_segments=256 num_words=208
2020-06-09 02:52:36,579: 21) loss=0.502 grad_norm=57.39 num_segments=256 num_words=213
2020-06-09 02:54:04,326: 22) loss=0.512 grad_norm=57.95 num_segments=256 num_words=207
2020-06-09 02:55:31,810: 23) loss=0.492 grad_norm=81.26 num_segments=256 num_words=214
2020-06-09 02:56:59,344: 24) loss=0.500 grad_norm=61.36 num_segments=256 num_words=212
2020-06-09 02:58:27,541: 25) loss=0.497 grad_norm=96.04 num_segments=256 num_words=212
2020-06-09 02:59:55,187: 26) loss=0.524 grad_norm=71.21 num_segments=256 num_words=210
2020-06-09 03:01:22,843: 27) loss=0.512 grad_norm=70.84 num_segments=256 num_words=209
2020-06-09 03:02:50,832: 28) loss=0.467 grad_norm=82.02 num_segments=256 num_words=213
2020-06-09 03:04:18,486: 29) loss=0.474 grad_norm=105.76 num_segments=256 num_words=218
2020-06-09 03:05:46,064: 30) loss=0.505 grad_norm=65.80 num_segments=256 num_words=199
2020-06-09 03:07:13,658: 31) loss=0.454 grad_norm=93.92 num_segments=256 num_words=202
2020-06-09 03:08:42,107: 32) loss=0.472 grad_norm=79.16 num_segments=256 num_words=210
2020-06-09 03:10:10,820: 33) loss=0.454 grad_norm=68.06 num_segments=256 num_words=213
2020-06-09 03:11:38,743: 34) loss=0.476 grad_norm=58.91 num_segments=256 num_words=208
2020-06-09 03:13:06,573: 35) loss=0.444 grad_norm=58.37 num_segments=256 num_words=203
2020-06-09 03:14:34,424: 36) loss=0.645 grad_norm=51.78 num_segments=256 num_words=213
2020-06-09 03:16:08,386: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-09 03:16:08,429: Using 1 GPU(s)
2020-06-09 03:16:08,429: Machine: 0 / 1
2020-06-09 03:16:08,431: Hyperparam tuning-------------------
2020-06-09 03:16:08,431: optim_lr: 0.001
2020-06-09 03:16:08,431: dropout (for both): 0.4
2020-06-09 03:16:08,431: margin: 0.4
2020-06-09 03:16:08,431: ------------------------------------
2020-06-09 03:16:08,434: Calling main function: multiview_trainer.train
2020-06-09 03:16:08,434: Using config file: train_config.json
2020-06-09 03:16:08,434: Using module at multiview_trainer.train
2020-06-09 03:16:08,736: Using module at multiview_vocab.MultiViewVocab
2020-06-09 03:16:08,805: Building vocab_data from config
2020-06-09 03:16:09,083:  >> min_count= 0
2020-06-09 03:16:09,084:  >> # words= 34323 (# removed= 0)
2020-06-09 03:16:09,084:  >> # subwords= 45
2020-06-09 03:16:09,084:     [laughter]= 1
2020-06-09 03:16:09,084:     [noise]= 2
2020-06-09 03:16:09,084:     [vocalized-noise]= 3
2020-06-09 03:16:09,084:     aa= 4
2020-06-09 03:16:09,084:     ae= 5
2020-06-09 03:16:09,084:     ah= 6
2020-06-09 03:16:09,084:     ao= 7
2020-06-09 03:16:09,084:     aw= 8
2020-06-09 03:16:09,084:     ax= 9
2020-06-09 03:16:09,085:     ay= 10
2020-06-09 03:16:09,085:     b= 11
2020-06-09 03:16:09,085:     ch= 12
2020-06-09 03:16:09,085:     d= 13
2020-06-09 03:16:09,085:     dh= 14
2020-06-09 03:16:09,085:     eh= 15
2020-06-09 03:16:09,085:     el= 16
2020-06-09 03:16:09,085:     en= 17
2020-06-09 03:16:09,085:     er= 18
2020-06-09 03:16:09,085:     ey= 19
2020-06-09 03:16:09,085:     f= 20
2020-06-09 03:16:09,085:     g= 21
2020-06-09 03:16:09,085:     hh= 22
2020-06-09 03:16:09,086:     ih= 23
2020-06-09 03:16:09,086:     iy= 24
2020-06-09 03:16:09,086:     jh= 25
2020-06-09 03:16:09,086:     k= 26
2020-06-09 03:16:09,086:     l= 27
2020-06-09 03:16:09,086:     m= 28
2020-06-09 03:16:09,086:     n= 29
2020-06-09 03:16:09,086:     ng= 30
2020-06-09 03:16:09,086:     ow= 31
2020-06-09 03:16:09,086:     oy= 32
2020-06-09 03:16:09,086:     p= 33
2020-06-09 03:16:09,086:     r= 34
2020-06-09 03:16:09,086:     s= 35
2020-06-09 03:16:09,087:     sh= 36
2020-06-09 03:16:09,087:     t= 37
2020-06-09 03:16:09,087:     th= 38
2020-06-09 03:16:09,087:     uh= 39
2020-06-09 03:16:09,087:     uw= 40
2020-06-09 03:16:09,087:     v= 41
2020-06-09 03:16:09,087:     w= 42
2020-06-09 03:16:09,087:     y= 43
2020-06-09 03:16:09,087:     z= 44
2020-06-09 03:16:09,087:     zh= 45
2020-06-09 03:16:09,100: Using module at data.batch_samplers.BatchSampler
2020-06-09 03:16:09,111: Building vocab_sampler from config
2020-06-09 03:16:09,111:  >> # examples= 34323
2020-06-09 03:16:09,111:  >> batch_size= 1000
2020-06-09 03:16:09,112:  >> shuffle= False
2020-06-09 03:16:09,118:  >> BatchSampler; 35 batches
2020-06-09 03:16:09,118: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 03:16:09,241: Building train_data from config
2020-06-09 03:16:16,414:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-09 03:16:16,415:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-09 03:16:16,415:  >> stack= False
2020-06-09 03:16:16,415:  >> seg_durs= (1, None)
2020-06-09 03:16:16,415:  >> # words= 9971 (# ignored= 0)
2020-06-09 03:16:16,415:  >> input_feat_dim= 108
2020-06-09 03:16:16,415:  >> input_num_subwords= 45
2020-06-09 03:16:16,415: Using module at data.batch_samplers.BatchSampler
2020-06-09 03:16:16,416: Building train_sampler from config
2020-06-09 03:16:16,416:  >> # examples= 9971
2020-06-09 03:16:16,416:  >> batch_size= 256
2020-06-09 03:16:16,416:  >> shuffle= True
2020-06-09 03:16:16,424:  >> BatchSampler; 39 batches
2020-06-09 03:16:16,424: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 03:16:16,424: Building dev_data from config
2020-06-09 03:16:24,641:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-09 03:16:24,642:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-09 03:16:24,642:  >> stack= False
2020-06-09 03:16:24,642:  >> seg_durs= (1, None)
2020-06-09 03:16:24,642:  >> # words= 10966 (# ignored= 0)
2020-06-09 03:16:24,642:  >> input_feat_dim= 108
2020-06-09 03:16:24,642:  >> input_num_subwords= 45
2020-06-09 03:16:24,642: Using module at data.batch_samplers.BatchSampler
2020-06-09 03:16:24,643: Building dev_sampler from config
2020-06-09 03:16:24,643:  >> # examples= 10966
2020-06-09 03:16:24,643:  >> batch_size= 256
2020-06-09 03:16:24,643:  >> shuffle= False
2020-06-09 03:16:24,646:  >> BatchSampler; 43 batches
2020-06-09 03:16:24,646: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 03:16:24,646: Building test_data from config
2020-06-09 03:16:31,628:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-09 03:16:31,628:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-09 03:16:31,628:  >> stack= False
2020-06-09 03:16:31,629:  >> seg_durs= (1, None)
2020-06-09 03:16:31,629:  >> # words= 11024 (# ignored= 0)
2020-06-09 03:16:31,629:  >> input_feat_dim= 108
2020-06-09 03:16:31,629:  >> input_num_subwords= 45
2020-06-09 03:16:31,629: Using module at data.batch_samplers.BatchSampler
2020-06-09 03:16:31,630: Building test_sampler from config
2020-06-09 03:16:31,631:  >> # examples= 11024
2020-06-09 03:16:31,631:  >> batch_size= 256
2020-06-09 03:16:31,631:  >> shuffle= False
2020-06-09 03:16:31,636:  >> BatchSampler; 44 batches
2020-06-09 03:16:31,636: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-09 03:16:31,688: Building loss from config
2020-06-09 03:16:31,689:  >> margin= 0.4
2020-06-09 03:16:31,689:  >> k= 16
2020-06-09 03:16:31,689:  >> min_k= 8
2020-06-09 03:16:31,689:  >> extra= 0
2020-06-09 03:16:31,690:  >> average= False
2020-06-09 03:16:31,690:  >> margin_max= 0.5
2020-06-09 03:16:31,690:  >> threshold_max= 9
2020-06-09 03:16:31,690:  >> using obj0+2
2020-06-09 03:16:31,690: Using module at metric.multiview_ap.MultiViewAP
2020-06-09 03:16:31,759: Building eval from config
2020-06-09 03:16:31,759:  >> acoustic_ap= True
2020-06-09 03:16:31,760:  >> crossview_ap= True
2020-06-09 03:16:31,760:  >> full_vocab= False
2020-06-09 03:16:31,760:  >> metric= crossview_ap
2020-06-09 03:16:31,760:  >> mode= max
2020-06-09 03:16:31,760: Using module at multiview_rnn.MultiViewRNN
2020-06-09 03:16:31,799: Building net from config
2020-06-09 03:16:31,802: view1:
2020-06-09 03:16:31,803:  >> cell= GRU
2020-06-09 03:16:31,803:  >> input_size= 108
2020-06-09 03:16:31,803:  >> hidden_size= 512
2020-06-09 03:16:31,803:  >> bidirectional= True
2020-06-09 03:16:31,803:  >> num_layers= 6
2020-06-09 03:16:31,804:  >> dropout between layers= 0.4
2020-06-09 03:16:32,035: view2:
2020-06-09 03:16:32,036:  >> cell= GRU
2020-06-09 03:16:32,036:  >> input_size= 64
2020-06-09 03:16:32,037:  >> hidden_size= 512
2020-06-09 03:16:32,037:  >> bidirectional= True
2020-06-09 03:16:32,037:  >> num_layers= 2
2020-06-09 03:16:32,037:  >> dropout between layers= 0.4
2020-06-09 03:16:32,037:  >> num input embeddings= 45
2020-06-09 03:16:35,242: Using module at optim.adam.Adam
2020-06-09 03:16:35,248: Building optim from config
2020-06-09 03:16:35,249:  >> lr= 0.001
2020-06-09 03:16:35,249:  >> betas= (0.9, 0.999)
2020-06-09 03:16:35,249:  >> eps= 1e-08
2020-06-09 03:16:35,249:  >> weight_decay= 0
2020-06-09 03:16:35,249:  >> amsgrad= False
2020-06-09 03:16:35,249:  >> min_lr= 1e-07
2020-06-09 03:16:35,250: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-09 03:16:35,289: Building sched from config
2020-06-09 03:16:35,290:  >> optim= Adam
2020-06-09 03:16:35,290:  >> decay lr by 0.1
2020-06-09 03:16:35,290:  >> eval_fn= MultiViewAP
2020-06-09 03:16:35,291:  >> patience=4
2020-06-09 03:16:35,291:  >> revert=True
2020-06-09 03:16:35,299: loaded save/MultiViewDataset_IndividualWords.117.pth
2020-06-09 03:16:35,299: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-09 03:16:35,391: loaded save/MultiViewRNN.117.pth
2020-06-09 03:16:35,391: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-09 03:16:35,533: loaded save/Adam.117.pth
2020-06-09 03:16:35,533: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-09 03:16:35,536: loaded save/ReduceLROnPlateau.117.pth
2020-06-09 03:16:35,536: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-09 03:16:35,536: epoch=3.00 global_step=117 lr=0.001 start_iter=0
2020-06-09 03:16:35,536: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 03:19:21,711: 0) loss=0.388 grad_norm=81.01 num_segments=256 num_words=203
2020-06-09 03:21:54,941: 1) loss=0.410 grad_norm=65.33 num_segments=256 num_words=215
2020-06-09 03:24:18,127: 2) loss=0.419 grad_norm=75.46 num_segments=256 num_words=209
2020-06-09 03:26:29,412: 3) loss=0.409 grad_norm=88.13 num_segments=256 num_words=209
2020-06-09 03:28:30,898: 4) loss=0.440 grad_norm=70.14 num_segments=256 num_words=209
2020-06-09 03:30:21,522: 5) loss=0.495 grad_norm=58.84 num_segments=256 num_words=210
2020-06-09 03:31:59,866: 6) loss=0.520 grad_norm=68.46 num_segments=256 num_words=207
2020-06-09 03:33:28,098: 7) loss=0.522 grad_norm=67.35 num_segments=256 num_words=223
2020-06-09 03:34:57,775: 8) loss=0.506 grad_norm=68.23 num_segments=256 num_words=212
2020-06-09 03:36:25,331: 9) loss=0.518 grad_norm=68.06 num_segments=256 num_words=214
2020-06-09 03:37:55,735: 10) loss=0.500 grad_norm=60.63 num_segments=256 num_words=212
2020-06-09 03:39:23,281: 11) loss=0.476 grad_norm=76.12 num_segments=256 num_words=211
2020-06-09 03:40:50,812: 12) loss=0.540 grad_norm=76.83 num_segments=256 num_words=206
2020-06-09 03:42:18,785: 13) loss=0.526 grad_norm=91.73 num_segments=256 num_words=219
2020-06-09 03:43:49,952: 14) loss=0.487 grad_norm=57.15 num_segments=256 num_words=212
2020-06-09 03:45:17,753: 15) loss=0.478 grad_norm=59.87 num_segments=256 num_words=205
2020-06-09 03:46:45,938: 16) loss=0.524 grad_norm=73.33 num_segments=256 num_words=211
2020-06-09 03:48:14,536: 17) loss=0.551 grad_norm=65.93 num_segments=256 num_words=210
2020-06-09 03:49:42,267: 18) loss=0.485 grad_norm=70.20 num_segments=256 num_words=218
2020-06-09 03:51:14,216: 19) loss=0.492 grad_norm=67.62 num_segments=256 num_words=207
2020-06-09 03:52:42,104: 20) loss=0.501 grad_norm=81.79 num_segments=256 num_words=208
2020-06-09 03:54:10,059: 21) loss=0.504 grad_norm=75.52 num_segments=256 num_words=213
2020-06-09 03:55:38,080: 22) loss=0.514 grad_norm=62.89 num_segments=256 num_words=207
2020-06-09 03:57:05,912: 23) loss=0.488 grad_norm=77.90 num_segments=256 num_words=214
2020-06-09 03:58:39,006: 24) loss=0.500 grad_norm=66.25 num_segments=256 num_words=212
2020-06-09 04:00:06,527: 25) loss=0.498 grad_norm=84.87 num_segments=256 num_words=212
2020-06-09 04:01:34,211: 26) loss=0.499 grad_norm=66.43 num_segments=256 num_words=210
2020-06-09 04:03:01,707: 27) loss=0.498 grad_norm=58.80 num_segments=256 num_words=209
2020-06-09 04:04:29,592: 28) loss=0.463 grad_norm=67.83 num_segments=256 num_words=213
2020-06-09 04:05:57,235: 29) loss=0.485 grad_norm=89.13 num_segments=256 num_words=218
2020-06-09 04:07:24,964: 30) loss=0.496 grad_norm=61.88 num_segments=256 num_words=199
2020-06-09 04:08:59,447: 31) loss=0.455 grad_norm=86.71 num_segments=256 num_words=202
2020-06-09 04:10:27,269: 32) loss=0.465 grad_norm=65.11 num_segments=256 num_words=210
2020-06-09 04:11:54,874: 33) loss=0.454 grad_norm=55.65 num_segments=256 num_words=213
2020-06-09 04:13:22,526: 34) loss=0.469 grad_norm=53.75 num_segments=256 num_words=208
2020-06-09 04:14:50,446: 35) loss=0.445 grad_norm=51.74 num_segments=256 num_words=203
2020-06-09 04:16:18,130: 36) loss=0.638 grad_norm=48.13 num_segments=256 num_words=213
2020-06-09 04:17:46,140: 37) loss=0.453 grad_norm=65.91 num_segments=256 num_words=195
2020-06-09 04:19:05,359: 38) loss=0.437 grad_norm=50.85 num_segments=243 num_words=203
2020-06-09 04:19:05,375: epoch= 4.00
2020-06-09 04:19:05,375:  >> time to evaluate and save:
2020-06-09 04:19:05,404: saved save/MultiViewDataset_IndividualWords.156.pth
2020-06-09 04:19:05,421: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 04:19:05,424: saved MultiViewDataset_IndividualWords successfully
2020-06-09 04:19:06,710: saved save/MultiViewRNN.156.pth
2020-06-09 04:19:06,716: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 04:19:06,728: saved MultiViewRNN successfully
2020-06-09 04:19:09,218: saved save/Adam.156.pth
2020-06-09 04:19:09,221: most_recent linked save/Adam.most_recent.pth
2020-06-09 04:19:09,231: saved Adam successfully
2020-06-09 04:19:09,233: saved save/ReduceLROnPlateau.156.pth
2020-06-09 04:19:09,251: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 04:19:09,257: saved ReduceLROnPlateau successfully
2020-06-09 04:19:09,259: saved config successfully
2020-06-09 04:20:34,647:   >> crossview_ap=0.486 (10966 x 3921 pairs)
2020-06-09 04:21:28,248:   >> acoustic_ap=0.490 (10966 choose 2 pairs)
2020-06-09 04:21:28,251: best_so_far= 0.486 at 156
2020-06-09 04:21:28,258: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 04:21:28,261: saved MultiViewDataset_IndividualWords successfully
2020-06-09 04:21:28,266: best linked save/MultiViewRNN.best.pth
2020-06-09 04:21:28,275: saved MultiViewRNN successfully
2020-06-09 04:21:28,277: best linked save/Adam.best.pth
2020-06-09 04:21:28,286: saved Adam successfully
2020-06-09 04:21:28,288: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 04:21:28,293: saved ReduceLROnPlateau successfully
2020-06-09 04:21:28,331: epoch=4.00 global_step=156 lr=0.001 start_iter=0
2020-06-09 04:21:28,331: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 04:22:57,842: 0) loss=0.435 grad_norm=54.49 num_segments=256 num_words=209
2020-06-09 04:24:35,370: 1) loss=0.478 grad_norm=59.84 num_segments=256 num_words=213
2020-06-09 04:26:02,742: 2) loss=0.458 grad_norm=58.84 num_segments=256 num_words=213
2020-06-09 04:27:30,445: 3) loss=0.460 grad_norm=62.12 num_segments=256 num_words=208
2020-06-09 04:28:58,073: 4) loss=0.441 grad_norm=70.59 num_segments=256 num_words=217
2020-06-09 04:30:25,689: 5) loss=0.476 grad_norm=52.10 num_segments=256 num_words=217
2020-06-09 04:31:53,336: 6) loss=0.578 grad_norm=70.47 num_segments=256 num_words=204
2020-06-09 04:33:21,094: 7) loss=0.452 grad_norm=64.37 num_segments=256 num_words=201
2020-06-09 04:34:48,750: 8) loss=0.577 grad_norm=73.11 num_segments=256 num_words=207
2020-06-09 04:36:16,533: 9) loss=0.484 grad_norm=65.73 num_segments=256 num_words=214
2020-06-09 04:37:44,768: 10) loss=0.427 grad_norm=48.93 num_segments=256 num_words=207
2020-06-09 04:39:12,562: 11) loss=0.476 grad_norm=59.19 num_segments=256 num_words=206
2020-06-09 04:40:50,684: 12) loss=0.424 grad_norm=54.83 num_segments=256 num_words=211
2020-06-09 04:42:18,281: 13) loss=0.430 grad_norm=70.21 num_segments=256 num_words=197
2020-06-09 04:43:46,228: 14) loss=0.496 grad_norm=83.49 num_segments=256 num_words=215
2020-06-09 04:45:14,162: 15) loss=0.414 grad_norm=63.25 num_segments=256 num_words=215
2020-06-09 04:46:42,247: 16) loss=0.420 grad_norm=55.97 num_segments=256 num_words=212
2020-06-09 04:48:10,304: 17) loss=0.514 grad_norm=54.18 num_segments=256 num_words=214
2020-06-09 04:49:38,175: 18) loss=0.405 grad_norm=98.74 num_segments=256 num_words=208
2020-06-09 04:51:06,083: 19) loss=0.562 grad_norm=76.05 num_segments=256 num_words=215
2020-06-09 04:52:33,861: 20) loss=0.430 grad_norm=71.18 num_segments=256 num_words=213
2020-06-09 04:54:01,949: 21) loss=0.405 grad_norm=67.93 num_segments=256 num_words=217
2020-06-09 04:55:29,866: 22) loss=0.442 grad_norm=61.68 num_segments=256 num_words=209
2020-06-09 04:56:57,863: 23) loss=0.460 grad_norm=69.09 num_segments=256 num_words=206
2020-06-09 04:58:25,734: 24) loss=0.398 grad_norm=68.71 num_segments=256 num_words=204
2020-06-09 04:59:53,605: 25) loss=0.412 grad_norm=55.94 num_segments=256 num_words=208
2020-06-09 05:01:34,910: 26) loss=0.473 grad_norm=83.50 num_segments=256 num_words=213
2020-06-09 05:03:02,948: 27) loss=0.416 grad_norm=79.07 num_segments=256 num_words=218
2020-06-09 05:04:31,175: 28) loss=0.444 grad_norm=71.60 num_segments=256 num_words=208
2020-06-09 05:05:59,077: 29) loss=0.412 grad_norm=77.99 num_segments=256 num_words=203
2020-06-09 05:07:27,089: 30) loss=0.456 grad_norm=85.28 num_segments=256 num_words=215
2020-06-09 05:08:55,299: 31) loss=0.394 grad_norm=61.72 num_segments=256 num_words=217
2020-06-09 05:10:23,474: 32) loss=0.417 grad_norm=55.09 num_segments=256 num_words=211
2020-06-09 05:11:51,898: 33) loss=0.392 grad_norm=102.73 num_segments=256 num_words=219
2020-06-09 05:13:20,156: 34) loss=0.419 grad_norm=73.80 num_segments=256 num_words=208
2020-06-09 05:14:48,280: 35) loss=0.443 grad_norm=78.70 num_segments=256 num_words=213
2020-06-09 05:16:16,257: 36) loss=0.403 grad_norm=71.96 num_segments=256 num_words=208
2020-06-09 05:17:44,485: 37) loss=0.398 grad_norm=60.50 num_segments=256 num_words=216
2020-06-09 05:19:04,024: 38) loss=0.404 grad_norm=69.63 num_segments=243 num_words=207
2020-06-09 05:19:04,044: epoch= 5.00
2020-06-09 05:19:04,044:  >> time to evaluate and save:
2020-06-09 05:19:04,073: saved save/MultiViewDataset_IndividualWords.195.pth
2020-06-09 05:19:04,088: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 05:19:04,091: saved MultiViewDataset_IndividualWords successfully
2020-06-09 05:19:05,585: saved save/MultiViewRNN.195.pth
2020-06-09 05:19:05,601: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 05:19:05,611: saved MultiViewRNN successfully
2020-06-09 05:19:08,222: saved save/Adam.195.pth
2020-06-09 05:19:08,241: most_recent linked save/Adam.most_recent.pth
2020-06-09 05:19:08,250: saved Adam successfully
2020-06-09 05:19:08,254: saved save/ReduceLROnPlateau.195.pth
2020-06-09 05:19:08,261: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 05:19:08,265: saved ReduceLROnPlateau successfully
2020-06-09 05:19:08,268: saved config successfully
2020-06-09 05:20:38,724:   >> crossview_ap=0.553 (10966 x 3921 pairs)
2020-06-09 05:21:33,381:   >> acoustic_ap=0.573 (10966 choose 2 pairs)
2020-06-09 05:21:33,387: best_so_far= 0.553 at 195
2020-06-09 05:21:33,394: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 05:21:33,397: saved MultiViewDataset_IndividualWords successfully
2020-06-09 05:21:33,430: best linked save/MultiViewRNN.best.pth
2020-06-09 05:21:33,442: saved MultiViewRNN successfully
2020-06-09 05:21:33,475: best linked save/Adam.best.pth
2020-06-09 05:21:33,484: saved Adam successfully
2020-06-09 05:21:33,486: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 05:21:33,491: saved ReduceLROnPlateau successfully
2020-06-09 05:21:33,851: epoch=5.00 global_step=195 lr=0.001 start_iter=0
2020-06-09 05:21:33,851: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 05:23:05,517: 0) loss=0.373 grad_norm=59.60 num_segments=256 num_words=208
2020-06-09 05:24:35,104: 1) loss=0.451 grad_norm=54.73 num_segments=256 num_words=212
2020-06-09 05:26:04,387: 2) loss=0.363 grad_norm=68.32 num_segments=256 num_words=224
2020-06-09 05:27:34,242: 3) loss=0.367 grad_norm=60.66 num_segments=256 num_words=208
2020-06-09 05:29:05,782: 4) loss=0.394 grad_norm=70.70 num_segments=256 num_words=218
2020-06-09 05:30:55,425: 5) loss=0.346 grad_norm=53.19 num_segments=256 num_words=191
2020-06-09 05:32:24,703: 6) loss=0.361 grad_norm=50.87 num_segments=256 num_words=200
2020-06-09 05:33:54,094: 7) loss=0.406 grad_norm=70.76 num_segments=256 num_words=216
2020-06-09 05:35:25,079: 8) loss=0.364 grad_norm=51.62 num_segments=256 num_words=203
2020-06-09 05:36:56,774: 9) loss=0.342 grad_norm=47.23 num_segments=256 num_words=210
2020-06-09 05:38:28,437: 10) loss=0.411 grad_norm=57.19 num_segments=256 num_words=206
2020-06-09 05:39:59,877: 11) loss=0.526 grad_norm=68.33 num_segments=256 num_words=212
2020-06-09 05:41:31,355: 12) loss=0.347 grad_norm=46.26 num_segments=256 num_words=210
2020-06-09 05:43:02,841: 13) loss=0.356 grad_norm=57.14 num_segments=256 num_words=214
2020-06-09 05:44:34,791: 14) loss=0.367 grad_norm=52.03 num_segments=256 num_words=211
2020-06-09 05:46:05,973: 15) loss=0.346 grad_norm=53.41 num_segments=256 num_words=204
2020-06-09 05:47:35,631: 16) loss=0.360 grad_norm=44.30 num_segments=256 num_words=206
2020-06-09 05:49:06,892: 17) loss=0.412 grad_norm=62.21 num_segments=256 num_words=204
2020-06-09 05:50:38,407: 18) loss=0.380 grad_norm=71.75 num_segments=256 num_words=211
2020-06-09 05:52:09,083: 19) loss=0.378 grad_norm=54.01 num_segments=256 num_words=220
2020-06-09 05:53:38,491: 20) loss=0.371 grad_norm=61.92 num_segments=256 num_words=207
2020-06-09 05:55:08,258: 21) loss=0.378 grad_norm=82.71 num_segments=256 num_words=212
2020-06-09 05:56:38,135: 22) loss=0.374 grad_norm=53.86 num_segments=256 num_words=208
2020-06-09 05:58:07,947: 23) loss=0.359 grad_norm=69.19 num_segments=256 num_words=217
2020-06-09 05:59:38,320: 24) loss=0.426 grad_norm=67.63 num_segments=256 num_words=211
2020-06-09 06:01:08,098: 25) loss=0.364 grad_norm=58.13 num_segments=256 num_words=214
2020-06-09 06:02:59,819: 26) loss=0.372 grad_norm=57.38 num_segments=256 num_words=212
2020-06-09 06:04:31,558: 27) loss=0.362 grad_norm=66.48 num_segments=256 num_words=207
2020-06-09 06:06:03,355: 28) loss=0.446 grad_norm=73.28 num_segments=256 num_words=210
2020-06-09 06:07:34,946: 29) loss=0.368 grad_norm=58.43 num_segments=256 num_words=203
2020-06-09 06:09:06,639: 30) loss=0.371 grad_norm=59.15 num_segments=256 num_words=196
2020-06-09 06:10:38,499: 31) loss=0.409 grad_norm=71.25 num_segments=256 num_words=202
2020-06-09 06:12:10,144: 32) loss=0.388 grad_norm=56.66 num_segments=256 num_words=206
2020-06-09 06:13:41,216: 33) loss=0.395 grad_norm=58.64 num_segments=256 num_words=214
2020-06-09 06:15:12,381: 34) loss=0.368 grad_norm=53.41 num_segments=256 num_words=211
2020-06-09 06:16:43,954: 35) loss=0.344 grad_norm=60.16 num_segments=256 num_words=204
2020-06-09 06:18:14,650: 36) loss=0.361 grad_norm=47.05 num_segments=256 num_words=216
2020-06-09 06:19:45,594: 37) loss=0.360 grad_norm=57.65 num_segments=256 num_words=208
2020-06-09 06:21:08,127: 38) loss=0.329 grad_norm=48.70 num_segments=243 num_words=203
2020-06-09 06:21:08,153: epoch= 6.00
2020-06-09 06:21:08,154:  >> time to evaluate and save:
2020-06-09 06:21:08,185: saved save/MultiViewDataset_IndividualWords.234.pth
2020-06-09 06:21:08,204: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 06:21:08,207: saved MultiViewDataset_IndividualWords successfully
2020-06-09 06:21:09,783: saved save/MultiViewRNN.234.pth
2020-06-09 06:21:09,785: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 06:21:09,791: saved MultiViewRNN successfully
2020-06-09 06:21:12,522: saved save/Adam.234.pth
2020-06-09 06:21:12,541: most_recent linked save/Adam.most_recent.pth
2020-06-09 06:21:12,550: saved Adam successfully
2020-06-09 06:21:12,553: saved save/ReduceLROnPlateau.234.pth
2020-06-09 06:21:12,563: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 06:21:12,567: saved ReduceLROnPlateau successfully
2020-06-09 06:21:12,570: saved config successfully
2020-06-09 06:22:37,059:   >> crossview_ap=0.587 (10966 x 3921 pairs)
2020-06-09 06:23:31,561:   >> acoustic_ap=0.614 (10966 choose 2 pairs)
2020-06-09 06:23:31,568: best_so_far= 0.587 at 234
2020-06-09 06:23:31,587: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 06:23:31,590: saved MultiViewDataset_IndividualWords successfully
2020-06-09 06:23:31,597: best linked save/MultiViewRNN.best.pth
2020-06-09 06:23:31,609: saved MultiViewRNN successfully
2020-06-09 06:23:31,636: best linked save/Adam.best.pth
2020-06-09 06:23:31,649: saved Adam successfully
2020-06-09 06:23:31,672: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 06:23:31,674: saved ReduceLROnPlateau successfully
2020-06-09 06:23:32,190: epoch=6.00 global_step=234 lr=0.001 start_iter=0
2020-06-09 06:23:32,191: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 06:25:04,283: 0) loss=0.358 grad_norm=65.93 num_segments=256 num_words=217
2020-06-09 06:26:34,991: 1) loss=0.314 grad_norm=45.86 num_segments=256 num_words=210
2020-06-09 06:28:05,598: 2) loss=0.349 grad_norm=44.04 num_segments=256 num_words=205
2020-06-09 06:29:36,366: 3) loss=0.340 grad_norm=63.78 num_segments=256 num_words=207
2020-06-09 06:31:07,346: 4) loss=0.348 grad_norm=65.41 num_segments=256 num_words=213
2020-06-09 06:32:38,160: 5) loss=0.325 grad_norm=38.33 num_segments=256 num_words=210
2020-06-09 06:34:09,179: 6) loss=0.321 grad_norm=66.46 num_segments=256 num_words=201
2020-06-09 06:35:40,166: 7) loss=0.308 grad_norm=45.84 num_segments=256 num_words=212
2020-06-09 06:37:11,642: 8) loss=0.332 grad_norm=46.99 num_segments=256 num_words=207
2020-06-09 06:38:44,062: 9) loss=0.330 grad_norm=48.23 num_segments=256 num_words=219
2020-06-09 06:40:15,003: 10) loss=0.330 grad_norm=83.90 num_segments=256 num_words=213
2020-06-09 06:41:46,570: 11) loss=0.341 grad_norm=53.28 num_segments=256 num_words=202
2020-06-09 06:43:17,459: 12) loss=0.320 grad_norm=61.76 num_segments=256 num_words=204
2020-06-09 06:44:48,240: 13) loss=0.368 grad_norm=66.22 num_segments=256 num_words=213
2020-06-09 06:46:50,817: 14) loss=0.318 grad_norm=53.37 num_segments=256 num_words=203
2020-06-09 06:48:21,588: 15) loss=0.312 grad_norm=57.02 num_segments=256 num_words=218
2020-06-09 06:49:52,180: 16) loss=0.333 grad_norm=62.12 num_segments=256 num_words=205
2020-06-09 06:51:22,624: 17) loss=0.333 grad_norm=50.31 num_segments=256 num_words=212
2020-06-09 06:52:53,523: 18) loss=0.349 grad_norm=60.52 num_segments=256 num_words=213
2020-06-09 06:54:24,332: 19) loss=0.341 grad_norm=52.78 num_segments=256 num_words=212
2020-06-09 06:55:54,922: 20) loss=0.316 grad_norm=56.80 num_segments=256 num_words=211
2020-06-09 06:57:26,279: 21) loss=0.339 grad_norm=54.60 num_segments=256 num_words=217
2020-06-09 06:58:56,959: 22) loss=0.307 grad_norm=49.04 num_segments=256 num_words=211
2020-06-09 07:00:28,457: 23) loss=0.322 grad_norm=54.03 num_segments=256 num_words=200
2020-06-09 07:01:59,419: 24) loss=0.338 grad_norm=62.48 num_segments=256 num_words=211
2020-06-09 07:03:30,885: 25) loss=0.296 grad_norm=47.14 num_segments=256 num_words=215
2020-06-09 07:04:59,731: 26) loss=0.298 grad_norm=58.01 num_segments=256 num_words=203
2020-06-09 07:06:31,731: 27) loss=0.326 grad_norm=70.75 num_segments=256 num_words=220
2020-06-09 07:08:03,527: 28) loss=0.345 grad_norm=77.47 num_segments=256 num_words=204
2020-06-09 07:09:35,402: 29) loss=0.329 grad_norm=75.62 num_segments=256 num_words=213
2020-06-09 07:11:07,246: 30) loss=0.303 grad_norm=69.33 num_segments=256 num_words=204
2020-06-09 07:12:38,903: 31) loss=0.325 grad_norm=59.35 num_segments=256 num_words=216
2020-06-09 07:14:11,313: 32) loss=0.314 grad_norm=57.79 num_segments=256 num_words=215
2020-06-09 07:15:43,787: 33) loss=0.329 grad_norm=82.64 num_segments=256 num_words=214
2020-06-09 07:16:50,130: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-09 07:16:50,178: Using 1 GPU(s)
2020-06-09 07:16:50,178: Machine: 0 / 1
2020-06-09 07:16:50,179: Hyperparam tuning-------------------
2020-06-09 07:16:50,179: optim_lr: 0.001
2020-06-09 07:16:50,180: dropout (for both): 0.4
2020-06-09 07:16:50,180: margin: 0.4
2020-06-09 07:16:50,180: ------------------------------------
2020-06-09 07:16:50,181: Calling main function: multiview_trainer.train
2020-06-09 07:16:50,181: Using config file: train_config.json
2020-06-09 07:16:50,181: Using module at multiview_trainer.train
2020-06-09 07:16:50,376: Using module at multiview_vocab.MultiViewVocab
2020-06-09 07:16:51,456: Building vocab_data from config
2020-06-09 07:16:51,799:  >> min_count= 0
2020-06-09 07:16:51,799:  >> # words= 34323 (# removed= 0)
2020-06-09 07:16:51,799:  >> # subwords= 45
2020-06-09 07:16:51,799:     [laughter]= 1
2020-06-09 07:16:51,799:     [noise]= 2
2020-06-09 07:16:51,799:     [vocalized-noise]= 3
2020-06-09 07:16:51,799:     aa= 4
2020-06-09 07:16:51,799:     ae= 5
2020-06-09 07:16:51,799:     ah= 6
2020-06-09 07:16:51,799:     ao= 7
2020-06-09 07:16:51,799:     aw= 8
2020-06-09 07:16:51,799:     ax= 9
2020-06-09 07:16:51,799:     ay= 10
2020-06-09 07:16:51,799:     b= 11
2020-06-09 07:16:51,799:     ch= 12
2020-06-09 07:16:51,800:     d= 13
2020-06-09 07:16:51,800:     dh= 14
2020-06-09 07:16:51,800:     eh= 15
2020-06-09 07:16:51,800:     el= 16
2020-06-09 07:16:51,800:     en= 17
2020-06-09 07:16:51,800:     er= 18
2020-06-09 07:16:51,800:     ey= 19
2020-06-09 07:16:51,800:     f= 20
2020-06-09 07:16:51,800:     g= 21
2020-06-09 07:16:51,800:     hh= 22
2020-06-09 07:16:51,800:     ih= 23
2020-06-09 07:16:51,800:     iy= 24
2020-06-09 07:16:51,800:     jh= 25
2020-06-09 07:16:51,800:     k= 26
2020-06-09 07:16:51,800:     l= 27
2020-06-09 07:16:51,800:     m= 28
2020-06-09 07:16:51,800:     n= 29
2020-06-09 07:16:51,800:     ng= 30
2020-06-09 07:16:51,800:     ow= 31
2020-06-09 07:16:51,801:     oy= 32
2020-06-09 07:16:51,801:     p= 33
2020-06-09 07:16:51,801:     r= 34
2020-06-09 07:16:51,801:     s= 35
2020-06-09 07:16:51,801:     sh= 36
2020-06-09 07:16:51,801:     t= 37
2020-06-09 07:16:51,801:     th= 38
2020-06-09 07:16:51,801:     uh= 39
2020-06-09 07:16:51,801:     uw= 40
2020-06-09 07:16:51,801:     v= 41
2020-06-09 07:16:51,801:     w= 42
2020-06-09 07:16:51,801:     y= 43
2020-06-09 07:16:51,801:     z= 44
2020-06-09 07:16:51,801:     zh= 45
2020-06-09 07:16:51,819: Using module at data.batch_samplers.BatchSampler
2020-06-09 07:16:51,983: Building vocab_sampler from config
2020-06-09 07:16:51,984:  >> # examples= 34323
2020-06-09 07:16:51,984:  >> batch_size= 1000
2020-06-09 07:16:51,984:  >> shuffle= False
2020-06-09 07:16:51,997:  >> BatchSampler; 35 batches
2020-06-09 07:16:51,997: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 07:16:52,246: Building train_data from config
2020-06-09 07:16:59,296:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-09 07:16:59,297:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-09 07:16:59,297:  >> stack= False
2020-06-09 07:16:59,297:  >> seg_durs= (1, None)
2020-06-09 07:16:59,297:  >> # words= 9971 (# ignored= 0)
2020-06-09 07:16:59,297:  >> input_feat_dim= 108
2020-06-09 07:16:59,297:  >> input_num_subwords= 45
2020-06-09 07:16:59,297: Using module at data.batch_samplers.BatchSampler
2020-06-09 07:16:59,297: Building train_sampler from config
2020-06-09 07:16:59,298:  >> # examples= 9971
2020-06-09 07:16:59,298:  >> batch_size= 256
2020-06-09 07:16:59,298:  >> shuffle= True
2020-06-09 07:16:59,307:  >> BatchSampler; 39 batches
2020-06-09 07:16:59,307: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 07:16:59,307: Building dev_data from config
2020-06-09 07:17:06,462:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-09 07:17:06,462:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-09 07:17:06,462:  >> stack= False
2020-06-09 07:17:06,462:  >> seg_durs= (1, None)
2020-06-09 07:17:06,463:  >> # words= 10966 (# ignored= 0)
2020-06-09 07:17:06,463:  >> input_feat_dim= 108
2020-06-09 07:17:06,463:  >> input_num_subwords= 45
2020-06-09 07:17:06,463: Using module at data.batch_samplers.BatchSampler
2020-06-09 07:17:06,463: Building dev_sampler from config
2020-06-09 07:17:06,463:  >> # examples= 10966
2020-06-09 07:17:06,463:  >> batch_size= 256
2020-06-09 07:17:06,463:  >> shuffle= False
2020-06-09 07:17:06,465:  >> BatchSampler; 43 batches
2020-06-09 07:17:06,465: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 07:17:06,465: Building test_data from config
2020-06-09 07:17:12,757:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-09 07:17:12,758:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-09 07:17:12,758:  >> stack= False
2020-06-09 07:17:12,758:  >> seg_durs= (1, None)
2020-06-09 07:17:12,759:  >> # words= 11024 (# ignored= 0)
2020-06-09 07:17:12,759:  >> input_feat_dim= 108
2020-06-09 07:17:12,759:  >> input_num_subwords= 45
2020-06-09 07:17:12,759: Using module at data.batch_samplers.BatchSampler
2020-06-09 07:17:12,759: Building test_sampler from config
2020-06-09 07:17:12,760:  >> # examples= 11024
2020-06-09 07:17:12,760:  >> batch_size= 256
2020-06-09 07:17:12,760:  >> shuffle= False
2020-06-09 07:17:12,762:  >> BatchSampler; 44 batches
2020-06-09 07:17:12,762: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-09 07:17:12,801: Building loss from config
2020-06-09 07:17:12,801:  >> margin= 0.4
2020-06-09 07:17:12,801:  >> k= 16
2020-06-09 07:17:12,801:  >> min_k= 8
2020-06-09 07:17:12,801:  >> extra= 0
2020-06-09 07:17:12,801:  >> average= False
2020-06-09 07:17:12,801:  >> margin_max= 0.5
2020-06-09 07:17:12,801:  >> threshold_max= 9
2020-06-09 07:17:12,801:  >> using obj0+2
2020-06-09 07:17:12,801: Using module at metric.multiview_ap.MultiViewAP
2020-06-09 07:17:12,851: Building eval from config
2020-06-09 07:17:12,851:  >> acoustic_ap= True
2020-06-09 07:17:12,851:  >> crossview_ap= True
2020-06-09 07:17:12,851:  >> full_vocab= False
2020-06-09 07:17:12,851:  >> metric= crossview_ap
2020-06-09 07:17:12,851:  >> mode= max
2020-06-09 07:17:12,851: Using module at multiview_rnn.MultiViewRNN
2020-06-09 07:17:12,916: Building net from config
2020-06-09 07:17:12,917: view1:
2020-06-09 07:17:12,918:  >> cell= GRU
2020-06-09 07:17:12,918:  >> input_size= 108
2020-06-09 07:17:12,918:  >> hidden_size= 512
2020-06-09 07:17:12,918:  >> bidirectional= True
2020-06-09 07:17:12,918:  >> num_layers= 6
2020-06-09 07:17:12,918:  >> dropout between layers= 0.4
2020-06-09 07:17:13,116: view2:
2020-06-09 07:17:13,117:  >> cell= GRU
2020-06-09 07:17:13,117:  >> input_size= 64
2020-06-09 07:17:13,117:  >> hidden_size= 512
2020-06-09 07:17:13,117:  >> bidirectional= True
2020-06-09 07:17:13,117:  >> num_layers= 2
2020-06-09 07:17:13,117:  >> dropout between layers= 0.4
2020-06-09 07:17:13,117:  >> num input embeddings= 45
2020-06-09 07:17:15,684: Using module at optim.adam.Adam
2020-06-09 07:17:15,689: Building optim from config
2020-06-09 07:17:15,689:  >> lr= 0.001
2020-06-09 07:17:15,690:  >> betas= (0.9, 0.999)
2020-06-09 07:17:15,690:  >> eps= 1e-08
2020-06-09 07:17:15,690:  >> weight_decay= 0
2020-06-09 07:17:15,690:  >> amsgrad= False
2020-06-09 07:17:15,690:  >> min_lr= 1e-07
2020-06-09 07:17:15,691: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-09 07:17:15,710: Building sched from config
2020-06-09 07:17:15,710:  >> optim= Adam
2020-06-09 07:17:15,710:  >> decay lr by 0.1
2020-06-09 07:17:15,710:  >> eval_fn= MultiViewAP
2020-06-09 07:17:15,711:  >> patience=4
2020-06-09 07:17:15,711:  >> revert=True
2020-06-09 07:17:15,724: loaded save/MultiViewDataset_IndividualWords.234.pth
2020-06-09 07:17:15,724: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-09 07:17:16,835: loaded save/MultiViewRNN.234.pth
2020-06-09 07:17:16,835: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-09 07:17:19,041: loaded save/Adam.234.pth
2020-06-09 07:17:19,041: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-09 07:17:19,043: loaded save/ReduceLROnPlateau.234.pth
2020-06-09 07:17:19,043: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-09 07:17:19,043: epoch=6.00 global_step=234 lr=0.001 start_iter=0
2020-06-09 07:17:19,044: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 07:19:05,531: 0) loss=0.218 grad_norm=54.34 num_segments=256 num_words=217
2020-06-09 07:20:42,217: 1) loss=0.198 grad_norm=40.61 num_segments=256 num_words=210
2020-06-09 07:22:11,438: 2) loss=0.244 grad_norm=47.45 num_segments=256 num_words=205
2020-06-09 07:23:33,966: 3) loss=0.255 grad_norm=76.26 num_segments=256 num_words=207
2020-06-09 07:24:51,192: 4) loss=0.299 grad_norm=107.48 num_segments=256 num_words=213
2020-06-09 07:26:01,570: 5) loss=0.282 grad_norm=39.97 num_segments=256 num_words=210
2020-06-09 07:27:06,033: 6) loss=0.293 grad_norm=58.48 num_segments=256 num_words=201
2020-06-09 07:28:01,608: 7) loss=0.305 grad_norm=55.46 num_segments=256 num_words=212
2020-06-09 07:28:58,211: 8) loss=0.333 grad_norm=46.48 num_segments=256 num_words=207
2020-06-09 07:29:53,364: 9) loss=0.339 grad_norm=79.20 num_segments=256 num_words=219
2020-06-09 07:30:54,470: 10) loss=0.328 grad_norm=60.38 num_segments=256 num_words=213
2020-06-09 07:31:49,421: 11) loss=0.340 grad_norm=62.60 num_segments=256 num_words=202
2020-06-09 07:32:47,433: 12) loss=0.319 grad_norm=55.93 num_segments=256 num_words=204
2020-06-09 07:33:41,648: 13) loss=0.371 grad_norm=117.21 num_segments=256 num_words=213
2020-06-09 07:34:39,505: 14) loss=0.322 grad_norm=58.87 num_segments=256 num_words=203
2020-06-09 07:35:35,240: 15) loss=0.322 grad_norm=57.30 num_segments=256 num_words=218
2020-06-09 07:36:29,814: 16) loss=0.332 grad_norm=42.03 num_segments=256 num_words=205
2020-06-09 07:37:24,978: 17) loss=0.328 grad_norm=65.00 num_segments=256 num_words=212
2020-06-09 07:38:20,131: 18) loss=0.322 grad_norm=69.04 num_segments=256 num_words=213
2020-06-09 07:39:20,161: 19) loss=0.346 grad_norm=54.34 num_segments=256 num_words=212
2020-06-09 07:40:14,734: 20) loss=0.310 grad_norm=61.78 num_segments=256 num_words=211
2020-06-09 07:41:09,941: 21) loss=0.337 grad_norm=66.63 num_segments=256 num_words=217
2020-06-09 07:42:05,956: 22) loss=0.309 grad_norm=50.93 num_segments=256 num_words=211
2020-06-09 07:43:01,386: 23) loss=0.326 grad_norm=51.73 num_segments=256 num_words=200
2020-06-09 07:44:03,074: 24) loss=0.339 grad_norm=56.60 num_segments=256 num_words=211
2020-06-09 07:45:02,189: 25) loss=0.290 grad_norm=43.45 num_segments=256 num_words=215
2020-06-09 07:45:57,745: 26) loss=0.299 grad_norm=42.59 num_segments=256 num_words=203
2020-06-09 07:46:53,667: 27) loss=0.323 grad_norm=64.91 num_segments=256 num_words=220
2020-06-09 07:47:48,881: 28) loss=0.342 grad_norm=66.36 num_segments=256 num_words=204
2020-06-09 07:48:43,519: 29) loss=0.328 grad_norm=96.26 num_segments=256 num_words=213
2020-06-09 07:49:38,180: 30) loss=0.304 grad_norm=52.65 num_segments=256 num_words=204
2020-06-09 07:50:39,473: 31) loss=0.325 grad_norm=70.01 num_segments=256 num_words=216
2020-06-09 07:51:36,527: 32) loss=0.308 grad_norm=58.81 num_segments=256 num_words=215
2020-06-09 07:52:33,140: 33) loss=0.324 grad_norm=62.14 num_segments=256 num_words=214
2020-06-09 07:53:29,301: 34) loss=0.346 grad_norm=52.45 num_segments=256 num_words=220
2020-06-09 07:54:24,754: 35) loss=0.333 grad_norm=54.80 num_segments=256 num_words=207
2020-06-09 07:55:20,507: 36) loss=0.322 grad_norm=69.85 num_segments=256 num_words=206
2020-06-09 07:56:15,616: 37) loss=0.361 grad_norm=62.89 num_segments=256 num_words=212
2020-06-09 07:57:05,912: 38) loss=0.313 grad_norm=64.67 num_segments=243 num_words=198
2020-06-09 07:57:05,925: epoch= 7.00
2020-06-09 07:57:05,925:  >> time to evaluate and save:
2020-06-09 07:57:06,001: saved save/MultiViewDataset_IndividualWords.273.pth
2020-06-09 07:57:06,047: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 07:57:06,053: saved MultiViewDataset_IndividualWords successfully
2020-06-09 07:57:07,394: saved save/MultiViewRNN.273.pth
2020-06-09 07:57:07,403: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 07:57:07,677: saved MultiViewRNN successfully
2020-06-09 07:57:10,254: saved save/Adam.273.pth
2020-06-09 07:57:10,275: most_recent linked save/Adam.most_recent.pth
2020-06-09 07:57:10,523: saved Adam successfully
2020-06-09 07:57:10,526: saved save/ReduceLROnPlateau.273.pth
2020-06-09 07:57:10,530: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 07:57:10,535: saved ReduceLROnPlateau successfully
2020-06-09 07:57:10,536: saved config successfully
2020-06-09 07:58:29,434:   >> crossview_ap=0.624 (10966 x 3921 pairs)
2020-06-09 07:59:19,513:   >> acoustic_ap=0.659 (10966 choose 2 pairs)
2020-06-09 07:59:19,515: best_so_far= 0.624 at 273
2020-06-09 07:59:19,550: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 07:59:19,554: saved MultiViewDataset_IndividualWords successfully
2020-06-09 07:59:19,594: best linked save/MultiViewRNN.best.pth
2020-06-09 07:59:19,607: saved MultiViewRNN successfully
2020-06-09 07:59:19,654: best linked save/Adam.best.pth
2020-06-09 07:59:19,657: saved Adam successfully
2020-06-09 07:59:19,690: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 07:59:19,695: saved ReduceLROnPlateau successfully
2020-06-09 07:59:19,745: epoch=7.00 global_step=273 lr=0.001 start_iter=0
2020-06-09 07:59:19,745: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 08:00:16,146: 0) loss=0.276 grad_norm=42.71 num_segments=256 num_words=207
2020-06-09 08:01:21,537: 1) loss=0.279 grad_norm=44.56 num_segments=256 num_words=207
2020-06-09 08:02:19,277: 2) loss=0.276 grad_norm=44.07 num_segments=256 num_words=213
2020-06-09 08:03:18,215: 3) loss=0.278 grad_norm=43.37 num_segments=256 num_words=215
2020-06-09 08:04:17,011: 4) loss=0.293 grad_norm=45.30 num_segments=256 num_words=213
2020-06-09 08:05:12,652: 5) loss=0.306 grad_norm=38.00 num_segments=256 num_words=213
2020-06-09 08:06:12,876: 6) loss=0.261 grad_norm=40.13 num_segments=256 num_words=217
2020-06-09 08:07:07,880: 7) loss=0.291 grad_norm=41.44 num_segments=256 num_words=202
2020-06-09 08:08:02,822: 8) loss=0.289 grad_norm=40.25 num_segments=256 num_words=210
2020-06-09 08:09:02,069: 9) loss=0.324 grad_norm=42.61 num_segments=256 num_words=211
2020-06-09 08:09:56,668: 10) loss=0.313 grad_norm=75.57 num_segments=256 num_words=211
2020-06-09 08:10:52,519: 11) loss=0.299 grad_norm=60.75 num_segments=256 num_words=202
2020-06-09 08:12:00,693: 12) loss=0.333 grad_norm=47.98 num_segments=256 num_words=213
2020-06-09 08:12:55,644: 13) loss=0.302 grad_norm=57.58 num_segments=256 num_words=212
2020-06-09 08:13:50,901: 14) loss=0.315 grad_norm=75.32 num_segments=256 num_words=215
2020-06-09 08:14:46,530: 15) loss=0.284 grad_norm=45.58 num_segments=256 num_words=208
2020-06-09 08:15:42,168: 16) loss=0.281 grad_norm=50.40 num_segments=256 num_words=202
2020-06-09 08:16:37,134: 17) loss=0.309 grad_norm=64.54 num_segments=256 num_words=214
2020-06-09 08:17:32,921: 18) loss=0.305 grad_norm=72.37 num_segments=256 num_words=220
2020-06-09 08:18:28,238: 19) loss=0.328 grad_norm=57.54 num_segments=256 num_words=208
2020-06-09 08:19:23,697: 20) loss=0.299 grad_norm=51.39 num_segments=256 num_words=198
2020-06-09 08:20:18,855: 21) loss=0.296 grad_norm=64.78 num_segments=256 num_words=215
2020-06-09 08:21:13,481: 22) loss=0.300 grad_norm=46.06 num_segments=256 num_words=207
2020-06-09 08:22:08,117: 23) loss=0.307 grad_norm=54.16 num_segments=256 num_words=210
2020-06-09 08:23:02,764: 24) loss=0.301 grad_norm=53.40 num_segments=256 num_words=202
2020-06-09 08:23:57,734: 25) loss=0.256 grad_norm=40.94 num_segments=256 num_words=209
2020-06-09 08:25:06,840: 26) loss=0.322 grad_norm=40.70 num_segments=256 num_words=213
2020-06-09 08:26:03,568: 27) loss=0.293 grad_norm=54.73 num_segments=256 num_words=212
2020-06-09 08:26:58,482: 28) loss=0.285 grad_norm=56.53 num_segments=256 num_words=215
2020-06-09 08:27:52,726: 29) loss=0.304 grad_norm=35.88 num_segments=256 num_words=205
2020-06-09 08:28:47,223: 30) loss=0.321 grad_norm=44.55 num_segments=256 num_words=209
2020-06-09 08:29:41,894: 31) loss=0.331 grad_norm=47.00 num_segments=256 num_words=214
2020-06-09 08:30:40,726: 32) loss=0.287 grad_norm=43.66 num_segments=256 num_words=214
2020-06-09 08:31:41,315: 33) loss=0.280 grad_norm=47.94 num_segments=256 num_words=201
2020-06-09 08:32:37,659: 34) loss=0.263 grad_norm=41.45 num_segments=256 num_words=217
2020-06-09 08:33:35,916: 35) loss=0.293 grad_norm=40.62 num_segments=256 num_words=214
2020-06-09 08:34:31,830: 36) loss=0.314 grad_norm=74.55 num_segments=256 num_words=203
2020-06-09 08:35:27,737: 37) loss=0.296 grad_norm=55.74 num_segments=256 num_words=201
2020-06-09 08:36:22,398: 38) loss=0.471 grad_norm=48.10 num_segments=243 num_words=201
2020-06-09 08:36:22,408: epoch= 8.00
2020-06-09 08:36:22,408:  >> time to evaluate and save:
2020-06-09 08:36:22,432: saved save/MultiViewDataset_IndividualWords.312.pth
2020-06-09 08:36:22,460: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 08:36:22,463: saved MultiViewDataset_IndividualWords successfully
2020-06-09 08:36:23,806: saved save/MultiViewRNN.312.pth
2020-06-09 08:36:23,813: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 08:36:23,819: saved MultiViewRNN successfully
2020-06-09 08:36:26,311: saved save/Adam.312.pth
2020-06-09 08:36:26,320: most_recent linked save/Adam.most_recent.pth
2020-06-09 08:36:26,325: saved Adam successfully
2020-06-09 08:36:26,327: saved save/ReduceLROnPlateau.312.pth
2020-06-09 08:36:26,341: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 08:36:26,344: saved ReduceLROnPlateau successfully
2020-06-09 08:36:26,346: saved config successfully
2020-06-09 08:37:40,842:   >> crossview_ap=0.644 (10966 x 3921 pairs)
2020-06-09 08:38:36,107:   >> acoustic_ap=0.691 (10966 choose 2 pairs)
2020-06-09 08:38:36,113: best_so_far= 0.644 at 312
2020-06-09 08:38:36,145: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 08:38:36,149: saved MultiViewDataset_IndividualWords successfully
2020-06-09 08:38:36,177: best linked save/MultiViewRNN.best.pth
2020-06-09 08:38:36,191: saved MultiViewRNN successfully
2020-06-09 08:38:36,214: best linked save/Adam.best.pth
2020-06-09 08:38:36,219: saved Adam successfully
2020-06-09 08:38:36,237: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 08:38:36,289: saved ReduceLROnPlateau successfully
2020-06-09 08:38:36,727: epoch=8.00 global_step=312 lr=0.001 start_iter=0
2020-06-09 08:38:36,728: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 08:39:33,581: 0) loss=0.263 grad_norm=38.41 num_segments=256 num_words=212
2020-06-09 08:40:28,874: 1) loss=0.261 grad_norm=49.64 num_segments=256 num_words=198
2020-06-09 08:41:23,698: 2) loss=0.286 grad_norm=54.48 num_segments=256 num_words=213
2020-06-09 08:42:18,364: 3) loss=0.283 grad_norm=46.27 num_segments=256 num_words=209
2020-06-09 08:43:15,537: 4) loss=0.275 grad_norm=34.97 num_segments=256 num_words=207
2020-06-09 08:44:31,534: 5) loss=0.257 grad_norm=36.08 num_segments=256 num_words=213
2020-06-09 08:45:26,935: 6) loss=0.249 grad_norm=36.38 num_segments=256 num_words=221
2020-06-09 08:46:22,539: 7) loss=0.254 grad_norm=40.54 num_segments=256 num_words=210
2020-06-09 08:47:18,435: 8) loss=0.255 grad_norm=39.62 num_segments=256 num_words=200
2020-06-09 08:48:13,052: 9) loss=0.253 grad_norm=33.17 num_segments=256 num_words=214
2020-06-09 08:49:07,935: 10) loss=0.254 grad_norm=59.21 num_segments=256 num_words=212
2020-06-09 08:50:03,605: 11) loss=0.308 grad_norm=38.28 num_segments=256 num_words=215
2020-06-09 08:50:59,392: 12) loss=0.247 grad_norm=30.54 num_segments=256 num_words=207
2020-06-09 08:51:55,983: 13) loss=0.317 grad_norm=40.41 num_segments=256 num_words=198
2020-06-09 08:52:52,687: 14) loss=0.281 grad_norm=41.73 num_segments=256 num_words=213
2020-06-09 08:53:49,049: 15) loss=0.262 grad_norm=38.32 num_segments=256 num_words=214
2020-06-09 08:54:45,465: 16) loss=0.267 grad_norm=45.58 num_segments=256 num_words=214
2020-06-09 08:55:43,964: 17) loss=0.302 grad_norm=47.93 num_segments=256 num_words=204
2020-06-09 08:56:39,587: 18) loss=0.267 grad_norm=45.76 num_segments=256 num_words=213
2020-06-09 08:57:34,830: 19) loss=0.259 grad_norm=36.50 num_segments=256 num_words=214
2020-06-09 08:58:28,983: 20) loss=0.298 grad_norm=42.35 num_segments=256 num_words=200
2020-06-09 08:59:24,787: 21) loss=0.281 grad_norm=48.97 num_segments=256 num_words=204
2020-06-09 09:00:21,307: 22) loss=0.252 grad_norm=40.67 num_segments=256 num_words=199
2020-06-09 09:01:17,189: 23) loss=0.252 grad_norm=48.93 num_segments=256 num_words=201
2020-06-09 09:02:12,349: 24) loss=0.248 grad_norm=56.69 num_segments=256 num_words=210
2020-06-09 09:03:10,154: 25) loss=0.238 grad_norm=42.98 num_segments=256 num_words=207
2020-06-09 09:04:31,146: 26) loss=0.253 grad_norm=46.53 num_segments=256 num_words=221
2020-06-09 09:05:27,162: 27) loss=0.268 grad_norm=41.13 num_segments=256 num_words=206
2020-06-09 09:06:24,121: 28) loss=0.282 grad_norm=40.04 num_segments=256 num_words=196
2020-06-09 09:07:19,538: 29) loss=0.317 grad_norm=78.66 num_segments=256 num_words=215
2020-06-09 09:08:19,369: 30) loss=0.305 grad_norm=46.94 num_segments=256 num_words=210
2020-06-09 09:09:17,663: 31) loss=0.313 grad_norm=45.42 num_segments=256 num_words=215
2020-06-09 09:10:13,764: 32) loss=0.319 grad_norm=73.01 num_segments=256 num_words=210
2020-06-09 09:11:12,036: 33) loss=0.268 grad_norm=41.79 num_segments=256 num_words=208
2020-06-09 09:12:10,302: 34) loss=0.293 grad_norm=44.95 num_segments=256 num_words=209
2020-06-09 09:13:13,763: 35) loss=0.264 grad_norm=48.84 num_segments=256 num_words=211
2020-06-09 09:14:08,859: 36) loss=0.256 grad_norm=58.46 num_segments=256 num_words=209
2020-06-09 09:15:03,937: 37) loss=0.247 grad_norm=47.77 num_segments=256 num_words=207
2020-06-09 09:15:53,346: 38) loss=0.284 grad_norm=45.46 num_segments=243 num_words=197
2020-06-09 09:15:53,356: epoch= 9.00
2020-06-09 09:15:53,356:  >> time to evaluate and save:
2020-06-09 09:15:53,382: saved save/MultiViewDataset_IndividualWords.351.pth
2020-06-09 09:15:53,408: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 09:15:53,413: saved MultiViewDataset_IndividualWords successfully
2020-06-09 09:15:54,745: saved save/MultiViewRNN.351.pth
2020-06-09 09:15:54,749: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 09:15:54,756: saved MultiViewRNN successfully
2020-06-09 09:15:57,317: saved save/Adam.351.pth
2020-06-09 09:15:57,322: most_recent linked save/Adam.most_recent.pth
2020-06-09 09:15:57,328: saved Adam successfully
2020-06-09 09:15:57,330: saved save/ReduceLROnPlateau.351.pth
2020-06-09 09:15:57,338: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 09:15:57,343: saved ReduceLROnPlateau successfully
2020-06-09 09:15:57,344: saved config successfully
2020-06-09 09:17:17,911:   >> crossview_ap=0.653 (10966 x 3921 pairs)
2020-06-09 09:18:10,651:   >> acoustic_ap=0.699 (10966 choose 2 pairs)
2020-06-09 09:18:10,656: best_so_far= 0.653 at 351
2020-06-09 09:18:10,687: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 09:18:10,692: saved MultiViewDataset_IndividualWords successfully
2020-06-09 09:18:10,726: best linked save/MultiViewRNN.best.pth
2020-06-09 09:18:10,742: saved MultiViewRNN successfully
2020-06-09 09:18:10,751: best linked save/Adam.best.pth
2020-06-09 09:18:10,758: saved Adam successfully
2020-06-09 09:18:10,789: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 09:18:10,796: saved ReduceLROnPlateau successfully
2020-06-09 09:18:11,484: epoch=9.00 global_step=351 lr=0.001 start_iter=0
2020-06-09 09:18:11,485: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 09:19:08,146: 0) loss=0.300 grad_norm=51.83 num_segments=256 num_words=207
2020-06-09 09:20:06,967: 1) loss=0.243 grad_norm=40.24 num_segments=256 num_words=211
2020-06-09 09:21:01,976: 2) loss=0.261 grad_norm=34.21 num_segments=256 num_words=205
2020-06-09 09:22:05,987: 3) loss=0.238 grad_norm=34.80 num_segments=256 num_words=224
2020-06-09 09:23:05,544: 4) loss=0.266 grad_norm=31.09 num_segments=256 num_words=207
2020-06-09 09:24:01,676: 5) loss=0.245 grad_norm=36.99 num_segments=256 num_words=216
2020-06-09 09:24:58,550: 6) loss=0.271 grad_norm=35.69 num_segments=256 num_words=202
2020-06-09 09:25:54,476: 7) loss=0.247 grad_norm=34.68 num_segments=256 num_words=207
2020-06-09 09:26:49,852: 8) loss=0.230 grad_norm=26.38 num_segments=256 num_words=206
2020-06-09 09:27:45,906: 9) loss=0.238 grad_norm=30.04 num_segments=256 num_words=221
2020-06-09 09:28:48,716: 10) loss=0.236 grad_norm=26.56 num_segments=256 num_words=216
2020-06-09 09:29:44,412: 11) loss=0.232 grad_norm=29.38 num_segments=256 num_words=213
2020-06-09 09:30:42,423: 12) loss=0.220 grad_norm=31.04 num_segments=256 num_words=213
2020-06-09 09:31:38,541: 13) loss=0.284 grad_norm=36.11 num_segments=256 num_words=207
2020-06-09 09:33:08,269: 14) loss=0.257 grad_norm=31.49 num_segments=256 num_words=216
2020-06-09 09:34:03,525: 15) loss=0.225 grad_norm=33.29 num_segments=256 num_words=213
2020-06-09 09:34:59,019: 16) loss=0.236 grad_norm=38.96 num_segments=256 num_words=205
2020-06-09 09:35:55,121: 17) loss=0.248 grad_norm=39.91 num_segments=256 num_words=210
2020-06-09 09:36:54,077: 18) loss=0.251 grad_norm=42.85 num_segments=256 num_words=201
2020-06-09 09:37:52,213: 19) loss=0.395 grad_norm=39.13 num_segments=256 num_words=201
2020-06-09 09:38:46,969: 20) loss=0.245 grad_norm=37.51 num_segments=256 num_words=201
2020-06-09 09:39:42,655: 21) loss=0.243 grad_norm=55.16 num_segments=256 num_words=207
2020-06-09 09:40:37,719: 22) loss=0.418 grad_norm=38.06 num_segments=256 num_words=199
2020-06-09 09:41:33,271: 23) loss=0.253 grad_norm=41.44 num_segments=256 num_words=210
2020-06-09 09:42:29,397: 24) loss=0.243 grad_norm=36.81 num_segments=256 num_words=203
2020-06-09 09:43:24,673: 25) loss=0.238 grad_norm=35.13 num_segments=256 num_words=207
2020-06-09 09:44:21,953: 26) loss=0.227 grad_norm=35.73 num_segments=256 num_words=220
2020-06-09 09:45:19,098: 27) loss=0.267 grad_norm=34.11 num_segments=256 num_words=211
2020-06-09 09:46:17,922: 28) loss=0.237 grad_norm=34.73 num_segments=256 num_words=210
2020-06-09 09:47:20,307: 29) loss=0.295 grad_norm=42.73 num_segments=256 num_words=213
2020-06-09 09:48:18,277: 30) loss=0.265 grad_norm=34.88 num_segments=256 num_words=208
2020-06-09 09:49:14,259: 31) loss=0.271 grad_norm=34.25 num_segments=256 num_words=218
2020-06-09 09:50:09,542: 32) loss=0.238 grad_norm=42.10 num_segments=256 num_words=216
2020-06-09 09:51:06,281: 33) loss=0.319 grad_norm=40.25 num_segments=256 num_words=206
2020-06-09 09:52:05,047: 34) loss=0.244 grad_norm=43.07 num_segments=256 num_words=213
2020-06-09 09:53:04,584: 35) loss=0.253 grad_norm=46.20 num_segments=256 num_words=217
2020-06-09 09:54:01,430: 36) loss=0.299 grad_norm=60.48 num_segments=256 num_words=208
2020-06-09 09:54:57,369: 37) loss=0.244 grad_norm=59.42 num_segments=256 num_words=211
2020-06-09 09:55:47,841: 38) loss=0.252 grad_norm=44.66 num_segments=243 num_words=200
2020-06-09 09:55:47,851: epoch= 10.00
2020-06-09 09:55:47,851:  >> time to evaluate and save:
2020-06-09 09:55:47,875: saved save/MultiViewDataset_IndividualWords.390.pth
2020-06-09 09:55:47,900: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 09:55:47,903: saved MultiViewDataset_IndividualWords successfully
2020-06-09 09:55:49,189: saved save/MultiViewRNN.390.pth
2020-06-09 09:55:49,205: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 09:55:49,213: saved MultiViewRNN successfully
2020-06-09 09:55:51,766: saved save/Adam.390.pth
2020-06-09 09:55:51,781: most_recent linked save/Adam.most_recent.pth
2020-06-09 09:55:51,787: saved Adam successfully
2020-06-09 09:55:51,789: saved save/ReduceLROnPlateau.390.pth
2020-06-09 09:55:51,793: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 09:55:51,797: saved ReduceLROnPlateau successfully
2020-06-09 09:55:51,798: saved config successfully
2020-06-09 09:57:09,234:   >> crossview_ap=0.658 (10966 x 3921 pairs)
2020-06-09 09:58:04,529:   >> acoustic_ap=0.709 (10966 choose 2 pairs)
2020-06-09 09:58:04,532: best_so_far= 0.658 at 390
2020-06-09 09:58:04,551: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 09:58:04,554: saved MultiViewDataset_IndividualWords successfully
2020-06-09 09:58:04,576: best linked save/MultiViewRNN.best.pth
2020-06-09 09:58:04,590: saved MultiViewRNN successfully
2020-06-09 09:58:04,604: best linked save/Adam.best.pth
2020-06-09 09:58:04,610: saved Adam successfully
2020-06-09 09:58:04,629: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 09:58:04,634: saved ReduceLROnPlateau successfully
2020-06-09 09:58:05,802: epoch=10.00 global_step=390 lr=0.001 start_iter=0
2020-06-09 09:58:05,803: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 09:59:03,966: 0) loss=0.240 grad_norm=34.16 num_segments=256 num_words=214
2020-06-09 10:00:00,007: 1) loss=0.238 grad_norm=50.02 num_segments=256 num_words=209
2020-06-09 10:00:57,229: 2) loss=0.226 grad_norm=44.35 num_segments=256 num_words=219
2020-06-09 10:01:54,761: 3) loss=0.245 grad_norm=37.94 num_segments=256 num_words=211
2020-06-09 10:02:50,467: 4) loss=0.243 grad_norm=34.60 num_segments=256 num_words=205
2020-06-09 10:03:47,635: 5) loss=0.236 grad_norm=32.91 num_segments=256 num_words=207
2020-06-09 10:04:42,745: 6) loss=0.217 grad_norm=39.22 num_segments=256 num_words=214
2020-06-09 10:05:39,339: 7) loss=0.224 grad_norm=30.64 num_segments=256 num_words=206
2020-06-09 10:06:35,855: 8) loss=0.223 grad_norm=35.07 num_segments=256 num_words=216
2020-06-09 10:08:21,797: 9) loss=0.226 grad_norm=27.29 num_segments=256 num_words=209
2020-06-09 10:09:19,107: 10) loss=0.350 grad_norm=38.45 num_segments=256 num_words=213
2020-06-09 10:10:22,798: 11) loss=0.225 grad_norm=29.43 num_segments=256 num_words=215
2020-06-09 10:11:21,218: 12) loss=0.227 grad_norm=42.53 num_segments=256 num_words=212
2020-06-09 10:12:20,025: 13) loss=0.211 grad_norm=30.34 num_segments=256 num_words=213
2020-06-09 10:13:24,162: 14) loss=0.306 grad_norm=37.92 num_segments=256 num_words=199
2020-06-09 10:14:27,893: 15) loss=0.236 grad_norm=47.27 num_segments=256 num_words=212
2020-06-09 10:15:27,165: 16) loss=0.214 grad_norm=28.94 num_segments=256 num_words=205
2020-06-09 10:16:28,203: 17) loss=0.254 grad_norm=38.96 num_segments=256 num_words=210
2020-06-09 10:17:29,111: 18) loss=0.224 grad_norm=25.46 num_segments=256 num_words=207
2020-06-09 10:18:28,859: 19) loss=0.217 grad_norm=28.42 num_segments=256 num_words=218
2020-06-09 10:19:32,646: 20) loss=0.232 grad_norm=32.44 num_segments=256 num_words=211
2020-06-09 10:20:36,314: 21) loss=0.231 grad_norm=33.00 num_segments=256 num_words=210
2020-06-09 10:21:36,326: 22) loss=0.250 grad_norm=38.43 num_segments=256 num_words=196
2020-06-09 10:22:36,108: 23) loss=0.212 grad_norm=51.99 num_segments=256 num_words=220
2020-06-09 10:23:38,211: 24) loss=0.234 grad_norm=42.14 num_segments=256 num_words=208
2020-06-09 10:24:40,447: 25) loss=0.232 grad_norm=43.12 num_segments=256 num_words=213
2020-06-09 10:25:43,975: 26) loss=0.253 grad_norm=38.60 num_segments=256 num_words=214
2020-06-09 10:26:50,193: 27) loss=0.233 grad_norm=37.73 num_segments=256 num_words=211
2020-06-09 10:27:51,698: 28) loss=0.271 grad_norm=41.69 num_segments=256 num_words=206
2020-06-09 10:28:53,511: 29) loss=0.297 grad_norm=37.60 num_segments=256 num_words=209
2020-06-09 10:29:56,150: 30) loss=0.230 grad_norm=42.57 num_segments=256 num_words=209
2020-06-09 10:30:53,074: 31) loss=0.233 grad_norm=51.92 num_segments=256 num_words=211
2020-06-09 10:31:54,786: 32) loss=0.240 grad_norm=37.95 num_segments=256 num_words=218
2020-06-09 10:33:03,674: 33) loss=0.223 grad_norm=35.39 num_segments=256 num_words=212
2020-06-09 10:34:18,399: 34) loss=0.232 grad_norm=33.48 num_segments=256 num_words=209
2020-06-09 10:35:39,100: 35) loss=0.243 grad_norm=34.50 num_segments=256 num_words=208
2020-06-09 10:37:04,418: 36) loss=0.250 grad_norm=33.79 num_segments=256 num_words=210
2020-06-09 10:38:31,433: 37) loss=0.251 grad_norm=44.94 num_segments=256 num_words=205
2020-06-09 10:39:47,165: 38) loss=0.236 grad_norm=38.84 num_segments=243 num_words=201
2020-06-09 10:39:47,182: epoch= 11.00
2020-06-09 10:39:47,182:  >> time to evaluate and save:
2020-06-09 10:39:47,238: saved save/MultiViewDataset_IndividualWords.429.pth
2020-06-09 10:39:47,246: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 10:39:47,249: saved MultiViewDataset_IndividualWords successfully
2020-06-09 10:39:48,555: saved save/MultiViewRNN.429.pth
2020-06-09 10:39:48,570: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 10:39:48,578: saved MultiViewRNN successfully
2020-06-09 10:39:51,123: saved save/Adam.429.pth
2020-06-09 10:39:51,129: most_recent linked save/Adam.most_recent.pth
2020-06-09 10:39:51,136: saved Adam successfully
2020-06-09 10:39:51,138: saved save/ReduceLROnPlateau.429.pth
2020-06-09 10:39:51,145: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 10:39:51,149: saved ReduceLROnPlateau successfully
2020-06-09 10:39:51,151: saved config successfully
2020-06-09 10:41:33,745:   >> crossview_ap=0.668 (10966 x 3921 pairs)
2020-06-09 10:42:45,684:   >> acoustic_ap=0.715 (10966 choose 2 pairs)
2020-06-09 10:42:45,688: best_so_far= 0.668 at 429
2020-06-09 10:42:45,721: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 10:42:45,726: saved MultiViewDataset_IndividualWords successfully
2020-06-09 10:42:45,789: best linked save/MultiViewRNN.best.pth
2020-06-09 10:42:45,809: saved MultiViewRNN successfully
2020-06-09 10:42:45,824: best linked save/Adam.best.pth
2020-06-09 10:42:45,834: saved Adam successfully
2020-06-09 10:42:45,853: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 10:42:45,894: saved ReduceLROnPlateau successfully
2020-06-09 10:42:47,411: epoch=11.00 global_step=429 lr=0.001 start_iter=0
2020-06-09 10:42:47,412: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 10:44:08,052: 0) loss=0.223 grad_norm=32.84 num_segments=256 num_words=210
2020-06-09 10:45:26,924: 1) loss=0.200 grad_norm=20.14 num_segments=256 num_words=200
2020-06-09 10:46:48,570: 2) loss=0.216 grad_norm=29.09 num_segments=256 num_words=206
2020-06-09 10:48:14,737: 3) loss=0.219 grad_norm=32.04 num_segments=256 num_words=213
2020-06-09 10:49:37,964: 4) loss=0.224 grad_norm=32.40 num_segments=256 num_words=220
2020-06-09 10:51:03,801: 5) loss=0.220 grad_norm=25.00 num_segments=256 num_words=209
2020-06-09 10:52:28,892: 6) loss=0.197 grad_norm=38.11 num_segments=256 num_words=223
2020-06-09 10:53:55,659: 7) loss=0.228 grad_norm=65.14 num_segments=256 num_words=204
2020-06-09 10:55:20,529: 8) loss=0.239 grad_norm=36.09 num_segments=256 num_words=215
2020-06-09 10:56:45,644: 9) loss=0.246 grad_norm=27.82 num_segments=256 num_words=213
2020-06-09 10:58:01,795: 10) loss=0.270 grad_norm=28.47 num_segments=256 num_words=213
2020-06-09 10:59:11,029: 11) loss=0.249 grad_norm=28.15 num_segments=256 num_words=210
2020-06-09 11:01:30,146: 12) loss=0.277 grad_norm=35.45 num_segments=256 num_words=208
2020-06-09 11:02:28,981: 13) loss=0.236 grad_norm=24.97 num_segments=256 num_words=212
2020-06-09 11:03:27,970: 14) loss=0.235 grad_norm=37.40 num_segments=256 num_words=211
2020-06-09 11:04:32,797: 15) loss=0.229 grad_norm=31.98 num_segments=256 num_words=207
2020-06-09 11:05:32,624: 16) loss=0.210 grad_norm=31.36 num_segments=256 num_words=212
2020-06-09 11:06:35,264: 17) loss=0.231 grad_norm=42.36 num_segments=256 num_words=209
2020-06-09 11:07:39,599: 18) loss=0.217 grad_norm=53.92 num_segments=256 num_words=209
2020-06-09 11:08:43,656: 19) loss=0.223 grad_norm=30.53 num_segments=256 num_words=201
2020-06-09 11:09:45,089: 20) loss=0.215 grad_norm=35.18 num_segments=256 num_words=217
2020-06-09 11:10:44,147: 21) loss=0.226 grad_norm=46.66 num_segments=256 num_words=216
2020-06-09 11:11:48,976: 22) loss=0.241 grad_norm=41.26 num_segments=256 num_words=214
2020-06-09 11:12:49,879: 23) loss=0.210 grad_norm=27.88 num_segments=256 num_words=204
2020-06-09 11:13:51,868: 24) loss=0.222 grad_norm=60.16 num_segments=256 num_words=210
2020-06-09 11:14:51,637: 25) loss=0.233 grad_norm=84.72 num_segments=256 num_words=214
2020-06-09 11:15:51,343: 26) loss=0.203 grad_norm=49.45 num_segments=256 num_words=212
2020-06-09 11:16:49,711: 27) loss=0.238 grad_norm=40.82 num_segments=256 num_words=204
2020-06-09 11:17:30,968: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-09 11:17:31,027: Using 1 GPU(s)
2020-06-09 11:17:31,028: Machine: 0 / 1
2020-06-09 11:17:31,030: Hyperparam tuning-------------------
2020-06-09 11:17:31,030: optim_lr: 0.001
2020-06-09 11:17:31,030: dropout (for both): 0.4
2020-06-09 11:17:31,030: margin: 0.4
2020-06-09 11:17:31,030: ------------------------------------
2020-06-09 11:17:31,033: Calling main function: multiview_trainer.train
2020-06-09 11:17:31,033: Using config file: train_config.json
2020-06-09 11:17:31,033: Using module at multiview_trainer.train
2020-06-09 11:17:33,120: Using module at multiview_vocab.MultiViewVocab
2020-06-09 11:17:33,136: Building vocab_data from config
2020-06-09 11:17:33,435:  >> min_count= 0
2020-06-09 11:17:33,435:  >> # words= 34323 (# removed= 0)
2020-06-09 11:17:33,435:  >> # subwords= 45
2020-06-09 11:17:33,435:     [laughter]= 1
2020-06-09 11:17:33,435:     [noise]= 2
2020-06-09 11:17:33,435:     [vocalized-noise]= 3
2020-06-09 11:17:33,436:     aa= 4
2020-06-09 11:17:33,436:     ae= 5
2020-06-09 11:17:33,436:     ah= 6
2020-06-09 11:17:33,436:     ao= 7
2020-06-09 11:17:33,436:     aw= 8
2020-06-09 11:17:33,436:     ax= 9
2020-06-09 11:17:33,436:     ay= 10
2020-06-09 11:17:33,436:     b= 11
2020-06-09 11:17:33,436:     ch= 12
2020-06-09 11:17:33,436:     d= 13
2020-06-09 11:17:33,436:     dh= 14
2020-06-09 11:17:33,437:     eh= 15
2020-06-09 11:17:33,437:     el= 16
2020-06-09 11:17:33,437:     en= 17
2020-06-09 11:17:33,437:     er= 18
2020-06-09 11:17:33,437:     ey= 19
2020-06-09 11:17:33,437:     f= 20
2020-06-09 11:17:33,437:     g= 21
2020-06-09 11:17:33,437:     hh= 22
2020-06-09 11:17:33,437:     ih= 23
2020-06-09 11:17:33,437:     iy= 24
2020-06-09 11:17:33,437:     jh= 25
2020-06-09 11:17:33,438:     k= 26
2020-06-09 11:17:33,438:     l= 27
2020-06-09 11:17:33,438:     m= 28
2020-06-09 11:17:33,438:     n= 29
2020-06-09 11:17:33,438:     ng= 30
2020-06-09 11:17:33,438:     ow= 31
2020-06-09 11:17:33,438:     oy= 32
2020-06-09 11:17:33,438:     p= 33
2020-06-09 11:17:33,438:     r= 34
2020-06-09 11:17:33,438:     s= 35
2020-06-09 11:17:33,438:     sh= 36
2020-06-09 11:17:33,438:     t= 37
2020-06-09 11:17:33,439:     th= 38
2020-06-09 11:17:33,439:     uh= 39
2020-06-09 11:17:33,439:     uw= 40
2020-06-09 11:17:33,439:     v= 41
2020-06-09 11:17:33,439:     w= 42
2020-06-09 11:17:33,439:     y= 43
2020-06-09 11:17:33,439:     z= 44
2020-06-09 11:17:33,439:     zh= 45
2020-06-09 11:17:33,454: Using module at data.batch_samplers.BatchSampler
2020-06-09 11:17:33,457: Building vocab_sampler from config
2020-06-09 11:17:33,457:  >> # examples= 34323
2020-06-09 11:17:33,457:  >> batch_size= 1000
2020-06-09 11:17:33,457:  >> shuffle= False
2020-06-09 11:17:33,465:  >> BatchSampler; 35 batches
2020-06-09 11:17:33,466: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 11:17:33,858: Building train_data from config
2020-06-09 11:17:42,560:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-09 11:17:42,561:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-09 11:17:42,561:  >> stack= False
2020-06-09 11:17:42,561:  >> seg_durs= (1, None)
2020-06-09 11:17:42,561:  >> # words= 9971 (# ignored= 0)
2020-06-09 11:17:42,561:  >> input_feat_dim= 108
2020-06-09 11:17:42,561:  >> input_num_subwords= 45
2020-06-09 11:17:42,561: Using module at data.batch_samplers.BatchSampler
2020-06-09 11:17:42,562: Building train_sampler from config
2020-06-09 11:17:42,562:  >> # examples= 9971
2020-06-09 11:17:42,562:  >> batch_size= 256
2020-06-09 11:17:42,562:  >> shuffle= True
2020-06-09 11:17:42,570:  >> BatchSampler; 39 batches
2020-06-09 11:17:42,570: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 11:17:42,571: Building dev_data from config
2020-06-09 11:17:51,737:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-09 11:17:51,738:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-09 11:17:51,738:  >> stack= False
2020-06-09 11:17:51,738:  >> seg_durs= (1, None)
2020-06-09 11:17:51,738:  >> # words= 10966 (# ignored= 0)
2020-06-09 11:17:51,739:  >> input_feat_dim= 108
2020-06-09 11:17:51,739:  >> input_num_subwords= 45
2020-06-09 11:17:51,739: Using module at data.batch_samplers.BatchSampler
2020-06-09 11:17:51,739: Building dev_sampler from config
2020-06-09 11:17:51,741:  >> # examples= 10966
2020-06-09 11:17:51,741:  >> batch_size= 256
2020-06-09 11:17:51,741:  >> shuffle= False
2020-06-09 11:17:51,743:  >> BatchSampler; 43 batches
2020-06-09 11:17:51,743: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 11:17:51,743: Building test_data from config
2020-06-09 11:17:59,481:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-09 11:17:59,482:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-09 11:17:59,483:  >> stack= False
2020-06-09 11:17:59,483:  >> seg_durs= (1, None)
2020-06-09 11:17:59,483:  >> # words= 11024 (# ignored= 0)
2020-06-09 11:17:59,483:  >> input_feat_dim= 108
2020-06-09 11:17:59,483:  >> input_num_subwords= 45
2020-06-09 11:17:59,483: Using module at data.batch_samplers.BatchSampler
2020-06-09 11:17:59,483: Building test_sampler from config
2020-06-09 11:17:59,484:  >> # examples= 11024
2020-06-09 11:17:59,484:  >> batch_size= 256
2020-06-09 11:17:59,484:  >> shuffle= False
2020-06-09 11:17:59,486:  >> BatchSampler; 44 batches
2020-06-09 11:17:59,486: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-09 11:17:59,518: Building loss from config
2020-06-09 11:17:59,518:  >> margin= 0.4
2020-06-09 11:17:59,518:  >> k= 16
2020-06-09 11:17:59,518:  >> min_k= 8
2020-06-09 11:17:59,518:  >> extra= 0
2020-06-09 11:17:59,519:  >> average= False
2020-06-09 11:17:59,519:  >> margin_max= 0.5
2020-06-09 11:17:59,519:  >> threshold_max= 9
2020-06-09 11:17:59,519:  >> using obj0+2
2020-06-09 11:17:59,519: Using module at metric.multiview_ap.MultiViewAP
2020-06-09 11:17:59,575: Building eval from config
2020-06-09 11:17:59,576:  >> acoustic_ap= True
2020-06-09 11:17:59,576:  >> crossview_ap= True
2020-06-09 11:17:59,576:  >> full_vocab= False
2020-06-09 11:17:59,576:  >> metric= crossview_ap
2020-06-09 11:17:59,576:  >> mode= max
2020-06-09 11:17:59,576: Using module at multiview_rnn.MultiViewRNN
2020-06-09 11:17:59,602: Building net from config
2020-06-09 11:17:59,604: view1:
2020-06-09 11:17:59,605:  >> cell= GRU
2020-06-09 11:17:59,605:  >> input_size= 108
2020-06-09 11:17:59,605:  >> hidden_size= 512
2020-06-09 11:17:59,605:  >> bidirectional= True
2020-06-09 11:17:59,605:  >> num_layers= 6
2020-06-09 11:17:59,605:  >> dropout between layers= 0.4
2020-06-09 11:17:59,825: view2:
2020-06-09 11:17:59,826:  >> cell= GRU
2020-06-09 11:17:59,826:  >> input_size= 64
2020-06-09 11:17:59,826:  >> hidden_size= 512
2020-06-09 11:17:59,826:  >> bidirectional= True
2020-06-09 11:17:59,826:  >> num_layers= 2
2020-06-09 11:17:59,826:  >> dropout between layers= 0.4
2020-06-09 11:17:59,826:  >> num input embeddings= 45
2020-06-09 11:18:03,600: Using module at optim.adam.Adam
2020-06-09 11:18:03,608: Building optim from config
2020-06-09 11:18:03,608:  >> lr= 0.001
2020-06-09 11:18:03,608:  >> betas= (0.9, 0.999)
2020-06-09 11:18:03,609:  >> eps= 1e-08
2020-06-09 11:18:03,609:  >> weight_decay= 0
2020-06-09 11:18:03,609:  >> amsgrad= False
2020-06-09 11:18:03,609:  >> min_lr= 1e-07
2020-06-09 11:18:03,610: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-09 11:18:03,641: Building sched from config
2020-06-09 11:18:03,641:  >> optim= Adam
2020-06-09 11:18:03,642:  >> decay lr by 0.1
2020-06-09 11:18:03,642:  >> eval_fn= MultiViewAP
2020-06-09 11:18:03,642:  >> patience=4
2020-06-09 11:18:03,643:  >> revert=True
2020-06-09 11:18:03,654: loaded save/MultiViewDataset_IndividualWords.429.pth
2020-06-09 11:18:03,654: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-09 11:18:04,819: loaded save/MultiViewRNN.429.pth
2020-06-09 11:18:04,821: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-09 11:18:07,036: loaded save/Adam.429.pth
2020-06-09 11:18:07,036: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-09 11:18:07,039: loaded save/ReduceLROnPlateau.429.pth
2020-06-09 11:18:07,039: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-09 11:18:07,040: epoch=11.00 global_step=429 lr=0.001 start_iter=0
2020-06-09 11:18:07,040: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 11:21:14,091: 0) loss=0.124 grad_norm=19.91 num_segments=256 num_words=210
2020-06-09 11:24:07,082: 1) loss=0.120 grad_norm=17.45 num_segments=256 num_words=200
2020-06-09 11:26:50,994: 2) loss=0.133 grad_norm=17.58 num_segments=256 num_words=206
2020-06-09 11:29:18,945: 3) loss=0.157 grad_norm=24.98 num_segments=256 num_words=213
2020-06-09 11:31:35,008: 4) loss=0.166 grad_norm=32.94 num_segments=256 num_words=220
2020-06-09 11:33:39,810: 5) loss=0.179 grad_norm=29.07 num_segments=256 num_words=209
2020-06-09 11:35:29,700: 6) loss=0.183 grad_norm=45.01 num_segments=256 num_words=223
2020-06-09 11:37:09,364: 7) loss=0.241 grad_norm=99.05 num_segments=256 num_words=204
2020-06-09 11:38:51,467: 8) loss=0.244 grad_norm=36.19 num_segments=256 num_words=215
2020-06-09 11:40:33,640: 9) loss=0.234 grad_norm=30.52 num_segments=256 num_words=213
2020-06-09 11:42:17,237: 10) loss=0.270 grad_norm=29.28 num_segments=256 num_words=213
2020-06-09 11:44:00,314: 11) loss=0.249 grad_norm=34.21 num_segments=256 num_words=210
2020-06-09 11:45:40,209: 12) loss=0.245 grad_norm=37.45 num_segments=256 num_words=208
2020-06-09 11:47:19,341: 13) loss=0.236 grad_norm=25.92 num_segments=256 num_words=212
2020-06-09 11:49:01,658: 14) loss=0.239 grad_norm=33.13 num_segments=256 num_words=211
2020-06-09 11:50:39,794: 15) loss=0.227 grad_norm=31.34 num_segments=256 num_words=207
2020-06-09 11:52:16,145: 16) loss=0.209 grad_norm=32.59 num_segments=256 num_words=212
2020-06-09 11:53:56,975: 17) loss=0.234 grad_norm=37.03 num_segments=256 num_words=209
2020-06-09 11:55:33,065: 18) loss=0.217 grad_norm=43.33 num_segments=256 num_words=209
2020-06-09 11:57:13,643: 19) loss=0.226 grad_norm=28.01 num_segments=256 num_words=201
2020-06-09 11:58:53,265: 20) loss=0.215 grad_norm=40.31 num_segments=256 num_words=217
2020-06-09 12:00:30,150: 21) loss=0.222 grad_norm=38.48 num_segments=256 num_words=216
2020-06-09 12:02:07,703: 22) loss=0.242 grad_norm=46.57 num_segments=256 num_words=214
2020-06-09 12:03:47,283: 23) loss=0.220 grad_norm=36.23 num_segments=256 num_words=204
2020-06-09 12:05:39,289: 24) loss=0.220 grad_norm=47.11 num_segments=256 num_words=210
2020-06-09 12:07:22,397: 25) loss=0.231 grad_norm=79.85 num_segments=256 num_words=214
2020-06-09 12:09:02,286: 26) loss=0.212 grad_norm=51.12 num_segments=256 num_words=212
2020-06-09 12:10:43,083: 27) loss=0.237 grad_norm=30.83 num_segments=256 num_words=204
2020-06-09 12:12:20,150: 28) loss=0.242 grad_norm=37.90 num_segments=256 num_words=209
2020-06-09 12:14:08,671: 29) loss=0.234 grad_norm=46.51 num_segments=256 num_words=211
2020-06-09 12:15:58,509: 30) loss=0.212 grad_norm=30.44 num_segments=256 num_words=214
2020-06-09 12:18:01,561: 31) loss=0.256 grad_norm=35.03 num_segments=256 num_words=213
2020-06-09 12:19:52,840: 32) loss=0.238 grad_norm=46.91 num_segments=256 num_words=207
2020-06-09 12:21:44,526: 33) loss=0.240 grad_norm=33.43 num_segments=256 num_words=211
2020-06-09 12:23:35,353: 34) loss=0.216 grad_norm=27.26 num_segments=256 num_words=202
2020-06-09 12:25:26,259: 35) loss=0.215 grad_norm=36.71 num_segments=256 num_words=213
2020-06-09 12:27:18,194: 36) loss=0.243 grad_norm=39.68 num_segments=256 num_words=213
2020-06-09 12:29:07,815: 37) loss=0.221 grad_norm=31.66 num_segments=256 num_words=211
2020-06-09 12:30:47,761: 38) loss=0.213 grad_norm=24.84 num_segments=243 num_words=199
2020-06-09 12:30:47,800: epoch= 12.00
2020-06-09 12:30:47,801:  >> time to evaluate and save:
2020-06-09 12:30:47,860: saved save/MultiViewDataset_IndividualWords.468.pth
2020-06-09 12:30:47,990: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 12:30:48,005: saved MultiViewDataset_IndividualWords successfully
2020-06-09 12:30:49,535: saved save/MultiViewRNN.468.pth
2020-06-09 12:30:49,558: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 12:30:50,742: saved MultiViewRNN successfully
2020-06-09 12:30:54,062: saved save/Adam.468.pth
2020-06-09 12:30:54,098: most_recent linked save/Adam.most_recent.pth
2020-06-09 12:30:54,467: saved Adam successfully
2020-06-09 12:30:54,478: saved save/ReduceLROnPlateau.468.pth
2020-06-09 12:30:54,698: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 12:30:54,739: saved ReduceLROnPlateau successfully
2020-06-09 12:30:54,742: saved config successfully
2020-06-09 12:32:53,818:   >> crossview_ap=0.665 (10966 x 3921 pairs)
2020-06-09 12:34:07,477:   >> acoustic_ap=0.724 (10966 choose 2 pairs)
2020-06-09 12:34:07,480: best_so_far= 0.665 at 468
2020-06-09 12:34:07,501: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 12:34:07,506: saved MultiViewDataset_IndividualWords successfully
2020-06-09 12:34:07,519: best linked save/MultiViewRNN.best.pth
2020-06-09 12:34:07,542: saved MultiViewRNN successfully
2020-06-09 12:34:07,569: best linked save/Adam.best.pth
2020-06-09 12:34:07,586: saved Adam successfully
2020-06-09 12:34:07,611: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 12:34:07,620: saved ReduceLROnPlateau successfully
2020-06-09 12:34:07,670: epoch=12.00 global_step=468 lr=0.001 start_iter=0
2020-06-09 12:34:07,671: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 12:36:01,831: 0) loss=0.225 grad_norm=28.95 num_segments=256 num_words=216
2020-06-09 12:38:07,079: 1) loss=0.196 grad_norm=25.34 num_segments=256 num_words=206
2020-06-09 12:39:58,620: 2) loss=0.377 grad_norm=21.55 num_segments=256 num_words=214
2020-06-09 12:41:48,138: 3) loss=0.227 grad_norm=25.12 num_segments=256 num_words=205
2020-06-09 12:43:38,552: 4) loss=0.200 grad_norm=20.94 num_segments=256 num_words=221
2020-06-09 12:45:30,339: 5) loss=0.222 grad_norm=19.90 num_segments=256 num_words=204
2020-06-09 12:47:22,353: 6) loss=0.231 grad_norm=29.45 num_segments=256 num_words=206
2020-06-09 12:49:14,149: 7) loss=0.215 grad_norm=36.39 num_segments=256 num_words=214
2020-06-09 12:51:05,955: 8) loss=0.367 grad_norm=35.24 num_segments=256 num_words=209
2020-06-09 12:52:57,719: 9) loss=0.344 grad_norm=70.18 num_segments=256 num_words=209
2020-06-09 12:54:49,690: 10) loss=0.221 grad_norm=32.12 num_segments=256 num_words=205
2020-06-09 12:56:42,154: 11) loss=0.207 grad_norm=32.91 num_segments=256 num_words=211
2020-06-09 12:58:45,565: 12) loss=0.213 grad_norm=45.69 num_segments=256 num_words=204
2020-06-09 13:00:37,272: 13) loss=0.196 grad_norm=28.37 num_segments=256 num_words=220
2020-06-09 13:02:27,711: 14) loss=0.231 grad_norm=32.27 num_segments=256 num_words=201
2020-06-09 13:04:19,537: 15) loss=0.202 grad_norm=30.52 num_segments=256 num_words=209
2020-06-09 13:06:11,919: 16) loss=0.211 grad_norm=26.54 num_segments=256 num_words=210
2020-06-09 13:08:04,599: 17) loss=0.212 grad_norm=26.02 num_segments=256 num_words=211
2020-06-09 13:09:58,254: 18) loss=0.219 grad_norm=26.83 num_segments=256 num_words=209
2020-06-09 13:11:51,080: 19) loss=0.214 grad_norm=38.51 num_segments=256 num_words=208
2020-06-09 13:13:43,749: 20) loss=0.204 grad_norm=32.91 num_segments=256 num_words=208
2020-06-09 13:15:35,551: 21) loss=0.218 grad_norm=28.30 num_segments=256 num_words=213
2020-06-09 13:17:27,670: 22) loss=0.204 grad_norm=29.65 num_segments=256 num_words=219
2020-06-09 13:19:18,876: 23) loss=0.194 grad_norm=41.05 num_segments=256 num_words=215
2020-06-09 13:21:09,745: 24) loss=0.221 grad_norm=40.39 num_segments=256 num_words=205
2020-06-09 13:23:00,254: 25) loss=0.220 grad_norm=33.58 num_segments=256 num_words=198
2020-06-09 13:25:08,646: 26) loss=0.226 grad_norm=32.72 num_segments=256 num_words=214
2020-06-09 13:26:59,804: 27) loss=0.351 grad_norm=33.34 num_segments=256 num_words=220
2020-06-09 13:28:49,406: 28) loss=0.217 grad_norm=25.07 num_segments=256 num_words=206
2020-06-09 13:30:38,677: 29) loss=0.233 grad_norm=24.13 num_segments=256 num_words=200
2020-06-09 13:32:28,643: 30) loss=0.221 grad_norm=31.49 num_segments=256 num_words=219
2020-06-09 13:34:13,398: 31) loss=0.209 grad_norm=26.55 num_segments=256 num_words=220
2020-06-09 13:35:55,970: 32) loss=0.213 grad_norm=27.69 num_segments=256 num_words=205
2020-06-09 13:37:36,278: 33) loss=0.212 grad_norm=53.84 num_segments=256 num_words=208
2020-06-09 13:39:15,638: 34) loss=0.193 grad_norm=33.92 num_segments=256 num_words=214
2020-06-09 13:40:55,951: 35) loss=0.242 grad_norm=34.55 num_segments=256 num_words=213
2020-06-09 13:42:34,850: 36) loss=0.227 grad_norm=39.81 num_segments=256 num_words=212
2020-06-09 13:44:15,943: 37) loss=0.238 grad_norm=57.07 num_segments=256 num_words=222
2020-06-09 13:45:47,840: 38) loss=0.210 grad_norm=36.79 num_segments=243 num_words=200
2020-06-09 13:45:47,859: epoch= 13.00
2020-06-09 13:45:47,859:  >> time to evaluate and save:
2020-06-09 13:45:47,917: saved save/MultiViewDataset_IndividualWords.507.pth
2020-06-09 13:45:47,934: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 13:45:47,938: saved MultiViewDataset_IndividualWords successfully
2020-06-09 13:45:49,309: saved save/MultiViewRNN.507.pth
2020-06-09 13:45:49,328: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 13:45:49,337: saved MultiViewRNN successfully
2020-06-09 13:45:51,913: saved save/Adam.507.pth
2020-06-09 13:45:51,930: most_recent linked save/Adam.most_recent.pth
2020-06-09 13:45:51,938: saved Adam successfully
2020-06-09 13:45:51,941: saved save/ReduceLROnPlateau.507.pth
2020-06-09 13:45:51,967: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 13:45:51,972: saved ReduceLROnPlateau successfully
2020-06-09 13:45:51,974: saved config successfully
2020-06-09 13:47:28,038:   >> crossview_ap=0.680 (10966 x 3921 pairs)
2020-06-09 13:48:37,025:   >> acoustic_ap=0.719 (10966 choose 2 pairs)
2020-06-09 13:48:37,029: best_so_far= 0.680 at 507
2020-06-09 13:48:37,068: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 13:48:37,076: saved MultiViewDataset_IndividualWords successfully
2020-06-09 13:48:37,102: best linked save/MultiViewRNN.best.pth
2020-06-09 13:48:37,133: saved MultiViewRNN successfully
2020-06-09 13:48:37,145: best linked save/Adam.best.pth
2020-06-09 13:48:37,162: saved Adam successfully
2020-06-09 13:48:37,210: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 13:48:37,315: saved ReduceLROnPlateau successfully
2020-06-09 13:48:37,641: epoch=13.00 global_step=507 lr=0.001 start_iter=0
2020-06-09 13:48:37,641: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 13:50:18,387: 0) loss=0.209 grad_norm=24.70 num_segments=256 num_words=204
2020-06-09 13:51:57,943: 1) loss=0.215 grad_norm=29.18 num_segments=256 num_words=208
2020-06-09 13:53:37,784: 2) loss=0.185 grad_norm=23.09 num_segments=256 num_words=203
2020-06-09 13:55:17,467: 3) loss=0.205 grad_norm=26.27 num_segments=256 num_words=215
2020-06-09 13:57:01,749: 4) loss=0.208 grad_norm=24.99 num_segments=256 num_words=206
2020-06-09 13:59:09,173: 5) loss=0.227 grad_norm=32.10 num_segments=256 num_words=219
2020-06-09 14:00:50,635: 6) loss=0.190 grad_norm=27.37 num_segments=256 num_words=218
2020-06-09 14:02:33,004: 7) loss=0.224 grad_norm=40.16 num_segments=256 num_words=216
2020-06-09 14:04:15,217: 8) loss=0.205 grad_norm=30.21 num_segments=256 num_words=208
2020-06-09 14:05:55,952: 9) loss=0.213 grad_norm=34.78 num_segments=256 num_words=207
2020-06-09 14:07:37,565: 10) loss=0.215 grad_norm=34.00 num_segments=256 num_words=215
2020-06-09 14:09:20,059: 11) loss=0.220 grad_norm=38.10 num_segments=256 num_words=205
2020-06-09 14:11:01,798: 12) loss=0.199 grad_norm=31.33 num_segments=256 num_words=220
2020-06-09 14:12:43,994: 13) loss=0.198 grad_norm=25.52 num_segments=256 num_words=221
2020-06-09 14:14:25,894: 14) loss=0.208 grad_norm=40.35 num_segments=256 num_words=219
2020-06-09 14:16:10,129: 15) loss=0.217 grad_norm=33.18 num_segments=256 num_words=211
2020-06-09 14:17:52,577: 16) loss=0.193 grad_norm=37.76 num_segments=256 num_words=211
2020-06-09 14:19:36,170: 17) loss=0.191 grad_norm=29.14 num_segments=256 num_words=205
2020-06-09 14:21:19,376: 18) loss=0.201 grad_norm=27.41 num_segments=256 num_words=212
2020-06-09 14:23:02,712: 19) loss=0.269 grad_norm=25.36 num_segments=256 num_words=204
2020-06-09 14:24:46,568: 20) loss=0.359 grad_norm=48.85 num_segments=256 num_words=224
2020-06-09 14:26:30,536: 21) loss=0.217 grad_norm=37.04 num_segments=256 num_words=207
2020-06-09 14:28:15,701: 22) loss=0.199 grad_norm=28.34 num_segments=256 num_words=205
2020-06-09 14:29:59,713: 23) loss=0.194 grad_norm=23.63 num_segments=256 num_words=216
2020-06-09 14:31:42,187: 24) loss=0.192 grad_norm=25.67 num_segments=256 num_words=203
2020-06-09 14:33:26,126: 25) loss=0.212 grad_norm=27.33 num_segments=256 num_words=200
2020-06-09 14:35:33,202: 26) loss=0.215 grad_norm=29.38 num_segments=256 num_words=204
2020-06-09 14:37:17,954: 27) loss=0.239 grad_norm=23.52 num_segments=256 num_words=202
2020-06-09 14:39:00,544: 28) loss=0.218 grad_norm=23.29 num_segments=256 num_words=208
2020-06-09 14:40:43,091: 29) loss=0.234 grad_norm=28.55 num_segments=256 num_words=214
2020-06-09 14:42:26,661: 30) loss=0.231 grad_norm=29.92 num_segments=256 num_words=208
2020-06-09 14:44:10,216: 31) loss=0.198 grad_norm=29.31 num_segments=256 num_words=218
2020-06-09 14:45:54,087: 32) loss=0.203 grad_norm=20.61 num_segments=256 num_words=216
2020-06-09 14:47:39,646: 33) loss=0.189 grad_norm=27.32 num_segments=256 num_words=210
2020-06-09 14:49:22,885: 34) loss=0.202 grad_norm=24.20 num_segments=256 num_words=213
2020-06-09 14:51:07,279: 35) loss=0.202 grad_norm=30.83 num_segments=256 num_words=211
2020-06-09 14:52:52,877: 36) loss=0.210 grad_norm=41.62 num_segments=256 num_words=213
2020-06-09 14:54:36,681: 37) loss=0.333 grad_norm=25.48 num_segments=256 num_words=204
2020-06-09 14:56:08,161: 38) loss=0.345 grad_norm=24.55 num_segments=243 num_words=199
2020-06-09 14:56:08,179: epoch= 14.00
2020-06-09 14:56:08,179:  >> time to evaluate and save:
2020-06-09 14:56:08,210: saved save/MultiViewDataset_IndividualWords.546.pth
2020-06-09 14:56:08,227: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 14:56:08,232: saved MultiViewDataset_IndividualWords successfully
2020-06-09 14:56:09,547: saved save/MultiViewRNN.546.pth
2020-06-09 14:56:09,554: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 14:56:09,563: saved MultiViewRNN successfully
2020-06-09 14:56:12,103: saved save/Adam.546.pth
2020-06-09 14:56:12,118: most_recent linked save/Adam.most_recent.pth
2020-06-09 14:56:12,129: saved Adam successfully
2020-06-09 14:56:12,132: saved save/ReduceLROnPlateau.546.pth
2020-06-09 14:56:12,162: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 14:56:12,170: saved ReduceLROnPlateau successfully
2020-06-09 14:56:12,173: saved config successfully
2020-06-09 14:57:49,462:   >> crossview_ap=0.687 (10966 x 3921 pairs)
2020-06-09 14:58:54,310:   >> acoustic_ap=0.726 (10966 choose 2 pairs)
2020-06-09 14:58:54,315: best_so_far= 0.687 at 546
2020-06-09 14:58:54,328: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 14:58:54,334: saved MultiViewDataset_IndividualWords successfully
2020-06-09 14:58:54,351: best linked save/MultiViewRNN.best.pth
2020-06-09 14:58:54,379: saved MultiViewRNN successfully
2020-06-09 14:58:54,388: best linked save/Adam.best.pth
2020-06-09 14:58:54,406: saved Adam successfully
2020-06-09 14:58:54,414: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 14:58:54,433: saved ReduceLROnPlateau successfully
2020-06-09 14:58:55,143: epoch=14.00 global_step=546 lr=0.001 start_iter=0
2020-06-09 14:58:55,143: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 15:00:39,576: 0) loss=0.188 grad_norm=18.74 num_segments=256 num_words=215
2020-06-09 15:02:22,413: 1) loss=0.191 grad_norm=11.57 num_segments=256 num_words=203
2020-06-09 15:04:06,970: 2) loss=0.226 grad_norm=20.72 num_segments=256 num_words=199
2020-06-09 15:05:51,446: 3) loss=0.193 grad_norm=24.43 num_segments=256 num_words=207
2020-06-09 15:07:33,420: 4) loss=0.200 grad_norm=24.31 num_segments=256 num_words=201
2020-06-09 15:09:19,510: 5) loss=0.203 grad_norm=20.27 num_segments=256 num_words=211
2020-06-09 15:11:05,118: 6) loss=0.184 grad_norm=20.01 num_segments=256 num_words=215
2020-06-09 15:12:50,667: 7) loss=0.203 grad_norm=23.45 num_segments=256 num_words=207
2020-06-09 15:14:36,062: 8) loss=0.191 grad_norm=29.74 num_segments=256 num_words=215
2020-06-09 15:16:19,538: 9) loss=0.207 grad_norm=23.80 num_segments=256 num_words=208
2020-06-09 15:18:13,148: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-09 15:18:13,187: Using 1 GPU(s)
2020-06-09 15:18:13,187: Machine: 0 / 1
2020-06-09 15:18:13,191: Hyperparam tuning-------------------
2020-06-09 15:18:13,191: optim_lr: 0.001
2020-06-09 15:18:13,191: dropout (for both): 0.4
2020-06-09 15:18:13,191: margin: 0.4
2020-06-09 15:18:13,192: ------------------------------------
2020-06-09 15:18:13,195: Calling main function: multiview_trainer.train
2020-06-09 15:18:13,195: Using config file: train_config.json
2020-06-09 15:18:13,195: Using module at multiview_trainer.train
2020-06-09 15:18:14,217: Using module at multiview_vocab.MultiViewVocab
2020-06-09 15:18:14,223: Building vocab_data from config
2020-06-09 15:18:14,494:  >> min_count= 0
2020-06-09 15:18:14,494:  >> # words= 34323 (# removed= 0)
2020-06-09 15:18:14,494:  >> # subwords= 45
2020-06-09 15:18:14,494:     [laughter]= 1
2020-06-09 15:18:14,494:     [noise]= 2
2020-06-09 15:18:14,495:     [vocalized-noise]= 3
2020-06-09 15:18:14,495:     aa= 4
2020-06-09 15:18:14,495:     ae= 5
2020-06-09 15:18:14,495:     ah= 6
2020-06-09 15:18:14,495:     ao= 7
2020-06-09 15:18:14,495:     aw= 8
2020-06-09 15:18:14,495:     ax= 9
2020-06-09 15:18:14,495:     ay= 10
2020-06-09 15:18:14,495:     b= 11
2020-06-09 15:18:14,495:     ch= 12
2020-06-09 15:18:14,496:     d= 13
2020-06-09 15:18:14,496:     dh= 14
2020-06-09 15:18:14,496:     eh= 15
2020-06-09 15:18:14,496:     el= 16
2020-06-09 15:18:14,496:     en= 17
2020-06-09 15:18:14,496:     er= 18
2020-06-09 15:18:14,496:     ey= 19
2020-06-09 15:18:14,496:     f= 20
2020-06-09 15:18:14,496:     g= 21
2020-06-09 15:18:14,496:     hh= 22
2020-06-09 15:18:14,496:     ih= 23
2020-06-09 15:18:14,497:     iy= 24
2020-06-09 15:18:14,497:     jh= 25
2020-06-09 15:18:14,497:     k= 26
2020-06-09 15:18:14,497:     l= 27
2020-06-09 15:18:14,497:     m= 28
2020-06-09 15:18:14,497:     n= 29
2020-06-09 15:18:14,497:     ng= 30
2020-06-09 15:18:14,497:     ow= 31
2020-06-09 15:18:14,497:     oy= 32
2020-06-09 15:18:14,497:     p= 33
2020-06-09 15:18:14,497:     r= 34
2020-06-09 15:18:14,498:     s= 35
2020-06-09 15:18:14,498:     sh= 36
2020-06-09 15:18:14,498:     t= 37
2020-06-09 15:18:14,498:     th= 38
2020-06-09 15:18:14,498:     uh= 39
2020-06-09 15:18:14,498:     uw= 40
2020-06-09 15:18:14,498:     v= 41
2020-06-09 15:18:14,498:     w= 42
2020-06-09 15:18:14,498:     y= 43
2020-06-09 15:18:14,498:     z= 44
2020-06-09 15:18:14,499:     zh= 45
2020-06-09 15:18:14,514: Using module at data.batch_samplers.BatchSampler
2020-06-09 15:18:14,516: Building vocab_sampler from config
2020-06-09 15:18:14,517:  >> # examples= 34323
2020-06-09 15:18:14,517:  >> batch_size= 1000
2020-06-09 15:18:14,517:  >> shuffle= False
2020-06-09 15:18:14,525:  >> BatchSampler; 35 batches
2020-06-09 15:18:14,525: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 15:18:14,750: Building train_data from config
2020-06-09 15:18:22,846:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-09 15:18:22,847:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-09 15:18:22,847:  >> stack= False
2020-06-09 15:18:22,847:  >> seg_durs= (1, None)
2020-06-09 15:18:22,847:  >> # words= 9971 (# ignored= 0)
2020-06-09 15:18:22,847:  >> input_feat_dim= 108
2020-06-09 15:18:22,847:  >> input_num_subwords= 45
2020-06-09 15:18:22,848: Using module at data.batch_samplers.BatchSampler
2020-06-09 15:18:22,848: Building train_sampler from config
2020-06-09 15:18:22,849:  >> # examples= 9971
2020-06-09 15:18:22,849:  >> batch_size= 256
2020-06-09 15:18:22,849:  >> shuffle= True
2020-06-09 15:18:22,857:  >> BatchSampler; 39 batches
2020-06-09 15:18:22,857: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 15:18:22,857: Building dev_data from config
2020-06-09 15:18:32,400:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-09 15:18:32,401:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-09 15:18:32,401:  >> stack= False
2020-06-09 15:18:32,401:  >> seg_durs= (1, None)
2020-06-09 15:18:32,401:  >> # words= 10966 (# ignored= 0)
2020-06-09 15:18:32,401:  >> input_feat_dim= 108
2020-06-09 15:18:32,401:  >> input_num_subwords= 45
2020-06-09 15:18:32,401: Using module at data.batch_samplers.BatchSampler
2020-06-09 15:18:32,402: Building dev_sampler from config
2020-06-09 15:18:32,402:  >> # examples= 10966
2020-06-09 15:18:32,402:  >> batch_size= 256
2020-06-09 15:18:32,402:  >> shuffle= False
2020-06-09 15:18:32,404:  >> BatchSampler; 43 batches
2020-06-09 15:18:32,404: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 15:18:32,404: Building test_data from config
2020-06-09 15:18:40,308:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-09 15:18:40,309:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-09 15:18:40,309:  >> stack= False
2020-06-09 15:18:40,309:  >> seg_durs= (1, None)
2020-06-09 15:18:40,309:  >> # words= 11024 (# ignored= 0)
2020-06-09 15:18:40,309:  >> input_feat_dim= 108
2020-06-09 15:18:40,309:  >> input_num_subwords= 45
2020-06-09 15:18:40,309: Using module at data.batch_samplers.BatchSampler
2020-06-09 15:18:40,309: Building test_sampler from config
2020-06-09 15:18:40,310:  >> # examples= 11024
2020-06-09 15:18:40,310:  >> batch_size= 256
2020-06-09 15:18:40,310:  >> shuffle= False
2020-06-09 15:18:40,312:  >> BatchSampler; 44 batches
2020-06-09 15:18:40,312: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-09 15:18:40,324: Building loss from config
2020-06-09 15:18:40,324:  >> margin= 0.4
2020-06-09 15:18:40,324:  >> k= 16
2020-06-09 15:18:40,324:  >> min_k= 8
2020-06-09 15:18:40,324:  >> extra= 0
2020-06-09 15:18:40,324:  >> average= False
2020-06-09 15:18:40,324:  >> margin_max= 0.5
2020-06-09 15:18:40,324:  >> threshold_max= 9
2020-06-09 15:18:40,324:  >> using obj0+2
2020-06-09 15:18:40,325: Using module at metric.multiview_ap.MultiViewAP
2020-06-09 15:18:40,377: Building eval from config
2020-06-09 15:18:40,377:  >> acoustic_ap= True
2020-06-09 15:18:40,378:  >> crossview_ap= True
2020-06-09 15:18:40,378:  >> full_vocab= False
2020-06-09 15:18:40,378:  >> metric= crossview_ap
2020-06-09 15:18:40,378:  >> mode= max
2020-06-09 15:18:40,378: Using module at multiview_rnn.MultiViewRNN
2020-06-09 15:18:40,391: Building net from config
2020-06-09 15:18:40,392: view1:
2020-06-09 15:18:40,393:  >> cell= GRU
2020-06-09 15:18:40,393:  >> input_size= 108
2020-06-09 15:18:40,394:  >> hidden_size= 512
2020-06-09 15:18:40,394:  >> bidirectional= True
2020-06-09 15:18:40,394:  >> num_layers= 6
2020-06-09 15:18:40,394:  >> dropout between layers= 0.4
2020-06-09 15:18:40,617: view2:
2020-06-09 15:18:40,618:  >> cell= GRU
2020-06-09 15:18:40,618:  >> input_size= 64
2020-06-09 15:18:40,618:  >> hidden_size= 512
2020-06-09 15:18:40,618:  >> bidirectional= True
2020-06-09 15:18:40,618:  >> num_layers= 2
2020-06-09 15:18:40,618:  >> dropout between layers= 0.4
2020-06-09 15:18:40,618:  >> num input embeddings= 45
2020-06-09 15:18:44,408: Using module at optim.adam.Adam
2020-06-09 15:18:44,412: Building optim from config
2020-06-09 15:18:44,413:  >> lr= 0.001
2020-06-09 15:18:44,413:  >> betas= (0.9, 0.999)
2020-06-09 15:18:44,413:  >> eps= 1e-08
2020-06-09 15:18:44,413:  >> weight_decay= 0
2020-06-09 15:18:44,413:  >> amsgrad= False
2020-06-09 15:18:44,413:  >> min_lr= 1e-07
2020-06-09 15:18:44,414: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-09 15:18:44,422: Building sched from config
2020-06-09 15:18:44,422:  >> optim= Adam
2020-06-09 15:18:44,423:  >> decay lr by 0.1
2020-06-09 15:18:44,423:  >> eval_fn= MultiViewAP
2020-06-09 15:18:44,424:  >> patience=4
2020-06-09 15:18:44,424:  >> revert=True
2020-06-09 15:18:44,431: loaded save/MultiViewDataset_IndividualWords.546.pth
2020-06-09 15:18:44,431: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-09 15:18:44,570: loaded save/MultiViewRNN.546.pth
2020-06-09 15:18:44,570: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-09 15:18:44,784: loaded save/Adam.546.pth
2020-06-09 15:18:44,784: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-09 15:18:44,786: loaded save/ReduceLROnPlateau.546.pth
2020-06-09 15:18:44,787: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-09 15:18:44,787: epoch=14.00 global_step=546 lr=0.001 start_iter=0
2020-06-09 15:18:44,787: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 15:21:56,731: 0) loss=0.104 grad_norm=16.37 num_segments=256 num_words=215
2020-06-09 15:24:50,023: 1) loss=0.113 grad_norm=8.71 num_segments=256 num_words=203
2020-06-09 15:27:38,997: 2) loss=0.141 grad_norm=14.55 num_segments=256 num_words=199
2020-06-09 15:30:24,223: 3) loss=0.136 grad_norm=27.44 num_segments=256 num_words=207
2020-06-09 15:32:54,607: 4) loss=0.149 grad_norm=26.40 num_segments=256 num_words=201
2020-06-09 15:35:12,285: 5) loss=0.167 grad_norm=21.32 num_segments=256 num_words=211
2020-06-09 15:37:14,837: 6) loss=0.164 grad_norm=19.36 num_segments=256 num_words=215
2020-06-09 15:39:04,273: 7) loss=0.201 grad_norm=23.30 num_segments=256 num_words=207
2020-06-09 15:40:55,957: 8) loss=0.191 grad_norm=22.67 num_segments=256 num_words=215
2020-06-09 15:42:44,923: 9) loss=0.208 grad_norm=24.47 num_segments=256 num_words=208
2020-06-09 15:44:39,539: 10) loss=0.236 grad_norm=25.91 num_segments=256 num_words=203
2020-06-09 15:46:31,187: 11) loss=0.203 grad_norm=40.14 num_segments=256 num_words=218
2020-06-09 15:48:22,429: 12) loss=0.208 grad_norm=23.77 num_segments=256 num_words=210
2020-06-09 15:50:13,889: 13) loss=0.189 grad_norm=33.42 num_segments=256 num_words=218
2020-06-09 15:52:10,059: 14) loss=0.197 grad_norm=30.01 num_segments=256 num_words=215
2020-06-09 15:54:02,319: 15) loss=0.196 grad_norm=26.42 num_segments=256 num_words=215
2020-06-09 15:55:52,399: 16) loss=0.206 grad_norm=24.70 num_segments=256 num_words=207
2020-06-09 15:57:44,280: 17) loss=0.195 grad_norm=27.39 num_segments=256 num_words=212
2020-06-09 15:59:34,401: 18) loss=0.211 grad_norm=31.96 num_segments=256 num_words=214
2020-06-09 16:01:30,417: 19) loss=0.244 grad_norm=38.64 num_segments=256 num_words=212
2020-06-09 16:03:21,514: 20) loss=0.364 grad_norm=38.06 num_segments=256 num_words=213
2020-06-09 16:05:11,378: 21) loss=0.194 grad_norm=39.38 num_segments=256 num_words=211
2020-06-09 16:07:00,887: 22) loss=0.217 grad_norm=21.28 num_segments=256 num_words=203
2020-06-09 16:08:50,804: 23) loss=0.224 grad_norm=24.41 num_segments=256 num_words=209
2020-06-09 16:10:48,766: 24) loss=0.203 grad_norm=20.48 num_segments=256 num_words=208
2020-06-09 16:12:39,871: 25) loss=0.195 grad_norm=20.67 num_segments=256 num_words=202
2020-06-09 16:14:31,712: 26) loss=0.193 grad_norm=32.28 num_segments=256 num_words=212
2020-06-09 16:16:23,284: 27) loss=0.198 grad_norm=28.26 num_segments=256 num_words=211
2020-06-09 16:18:14,676: 28) loss=0.199 grad_norm=27.61 num_segments=256 num_words=214
2020-06-09 16:20:05,175: 29) loss=0.235 grad_norm=23.89 num_segments=256 num_words=211
2020-06-09 16:21:55,696: 30) loss=0.205 grad_norm=18.29 num_segments=256 num_words=222
2020-06-09 16:23:53,103: 31) loss=0.213 grad_norm=15.75 num_segments=256 num_words=206
2020-06-09 16:25:42,351: 32) loss=0.201 grad_norm=22.89 num_segments=256 num_words=213
2020-06-09 16:27:32,723: 33) loss=0.202 grad_norm=27.90 num_segments=256 num_words=206
2020-06-09 16:29:23,900: 34) loss=0.198 grad_norm=23.91 num_segments=256 num_words=203
2020-06-09 16:31:15,637: 35) loss=0.185 grad_norm=25.12 num_segments=256 num_words=211
2020-06-09 16:33:04,975: 36) loss=0.219 grad_norm=36.08 num_segments=256 num_words=207
2020-06-09 16:34:55,875: 37) loss=0.223 grad_norm=21.06 num_segments=256 num_words=200
2020-06-09 16:36:34,307: 38) loss=0.199 grad_norm=16.72 num_segments=243 num_words=197
2020-06-09 16:36:34,327: epoch= 15.00
2020-06-09 16:36:34,328:  >> time to evaluate and save:
2020-06-09 16:36:34,380: saved save/MultiViewDataset_IndividualWords.585.pth
2020-06-09 16:36:34,402: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 16:36:34,408: saved MultiViewDataset_IndividualWords successfully
2020-06-09 16:36:35,725: saved save/MultiViewRNN.585.pth
2020-06-09 16:36:35,733: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 16:36:35,759: saved MultiViewRNN successfully
2020-06-09 16:36:38,314: saved save/Adam.585.pth
2020-06-09 16:36:38,329: most_recent linked save/Adam.most_recent.pth
2020-06-09 16:36:38,346: saved Adam successfully
2020-06-09 16:36:38,348: saved save/ReduceLROnPlateau.585.pth
2020-06-09 16:36:38,359: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 16:36:38,367: saved ReduceLROnPlateau successfully
2020-06-09 16:36:38,369: saved config successfully
2020-06-09 16:38:30,476:   >> crossview_ap=0.685 (10966 x 3921 pairs)
2020-06-09 16:39:40,472:   >> acoustic_ap=0.735 (10966 choose 2 pairs)
2020-06-09 16:39:40,476: best_so_far= 0.685 at 585
2020-06-09 16:39:40,493: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 16:39:40,499: saved MultiViewDataset_IndividualWords successfully
2020-06-09 16:39:40,530: best linked save/MultiViewRNN.best.pth
2020-06-09 16:39:40,558: saved MultiViewRNN successfully
2020-06-09 16:39:40,591: best linked save/Adam.best.pth
2020-06-09 16:39:40,609: saved Adam successfully
2020-06-09 16:39:40,636: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 16:39:40,644: saved ReduceLROnPlateau successfully
2020-06-09 16:39:40,692: epoch=15.00 global_step=585 lr=0.001 start_iter=0
2020-06-09 16:39:40,693: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 16:41:33,487: 0) loss=0.177 grad_norm=21.64 num_segments=256 num_words=219
2020-06-09 16:43:34,925: 1) loss=0.187 grad_norm=17.94 num_segments=256 num_words=215
2020-06-09 16:45:24,329: 2) loss=0.192 grad_norm=18.99 num_segments=256 num_words=205
2020-06-09 16:47:13,821: 3) loss=0.226 grad_norm=24.38 num_segments=256 num_words=213
2020-06-09 16:49:03,539: 4) loss=0.199 grad_norm=26.53 num_segments=256 num_words=212
2020-06-09 16:50:50,345: 5) loss=0.196 grad_norm=28.05 num_segments=256 num_words=200
2020-06-09 16:52:32,860: 6) loss=0.199 grad_norm=22.88 num_segments=256 num_words=219
2020-06-09 16:54:13,300: 7) loss=0.205 grad_norm=23.58 num_segments=256 num_words=213
2020-06-09 16:55:52,546: 8) loss=0.187 grad_norm=18.51 num_segments=256 num_words=210
2020-06-09 16:57:33,094: 9) loss=0.365 grad_norm=20.41 num_segments=256 num_words=211
2020-06-09 16:59:14,750: 10) loss=0.203 grad_norm=27.77 num_segments=256 num_words=201
2020-06-09 17:00:56,668: 11) loss=0.178 grad_norm=23.30 num_segments=256 num_words=200
2020-06-09 17:02:49,529: 12) loss=0.206 grad_norm=18.12 num_segments=256 num_words=205
2020-06-09 17:04:31,890: 13) loss=0.199 grad_norm=22.58 num_segments=256 num_words=212
2020-06-09 17:06:13,862: 14) loss=0.225 grad_norm=40.48 num_segments=256 num_words=214
2020-06-09 17:07:55,632: 15) loss=0.212 grad_norm=24.56 num_segments=256 num_words=206
2020-06-09 17:09:37,596: 16) loss=0.210 grad_norm=24.23 num_segments=256 num_words=207
2020-06-09 17:11:20,107: 17) loss=0.189 grad_norm=38.39 num_segments=256 num_words=216
2020-06-09 17:13:02,587: 18) loss=0.207 grad_norm=20.62 num_segments=256 num_words=216
2020-06-09 17:14:44,088: 19) loss=0.193 grad_norm=26.71 num_segments=256 num_words=215
2020-06-09 17:16:25,096: 20) loss=0.209 grad_norm=20.56 num_segments=256 num_words=194
2020-06-09 17:18:05,380: 21) loss=0.192 grad_norm=29.41 num_segments=256 num_words=216
2020-06-09 17:19:43,317: 22) loss=0.198 grad_norm=26.76 num_segments=256 num_words=202
2020-06-09 17:21:20,715: 23) loss=0.195 grad_norm=30.92 num_segments=256 num_words=214
2020-06-09 17:22:57,776: 24) loss=0.221 grad_norm=27.67 num_segments=256 num_words=202
2020-06-09 17:24:34,811: 25) loss=0.214 grad_norm=35.33 num_segments=256 num_words=212
2020-06-09 17:26:25,993: 26) loss=0.208 grad_norm=35.15 num_segments=256 num_words=214
2020-06-09 17:28:03,258: 27) loss=0.194 grad_norm=23.73 num_segments=256 num_words=220
2020-06-09 17:29:41,159: 28) loss=0.197 grad_norm=20.69 num_segments=256 num_words=205
2020-06-09 17:31:18,485: 29) loss=0.200 grad_norm=29.69 num_segments=256 num_words=212
2020-06-09 17:32:54,810: 30) loss=0.225 grad_norm=30.99 num_segments=256 num_words=198
2020-06-09 17:34:31,703: 31) loss=0.184 grad_norm=19.98 num_segments=256 num_words=224
2020-06-09 17:36:09,234: 32) loss=0.217 grad_norm=24.74 num_segments=256 num_words=214
2020-06-09 17:37:46,613: 33) loss=0.185 grad_norm=43.15 num_segments=256 num_words=225
2020-06-09 17:39:24,276: 34) loss=0.189 grad_norm=24.32 num_segments=256 num_words=220
2020-06-09 17:41:01,728: 35) loss=0.186 grad_norm=23.18 num_segments=256 num_words=210
2020-06-09 17:42:38,648: 36) loss=0.194 grad_norm=27.60 num_segments=256 num_words=209
2020-06-09 17:44:16,636: 37) loss=0.212 grad_norm=39.23 num_segments=256 num_words=212
2020-06-09 17:45:44,624: 38) loss=0.248 grad_norm=24.77 num_segments=243 num_words=200
2020-06-09 17:45:44,641: epoch= 16.00
2020-06-09 17:45:44,641:  >> time to evaluate and save:
2020-06-09 17:45:44,683: saved save/MultiViewDataset_IndividualWords.624.pth
2020-06-09 17:45:44,700: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 17:45:44,707: saved MultiViewDataset_IndividualWords successfully
2020-06-09 17:45:46,020: saved save/MultiViewRNN.624.pth
2020-06-09 17:45:46,031: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 17:45:46,044: saved MultiViewRNN successfully
2020-06-09 17:45:48,731: saved save/Adam.624.pth
2020-06-09 17:45:48,747: most_recent linked save/Adam.most_recent.pth
2020-06-09 17:45:48,760: saved Adam successfully
2020-06-09 17:45:48,763: saved save/ReduceLROnPlateau.624.pth
2020-06-09 17:45:48,772: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 17:45:48,780: saved ReduceLROnPlateau successfully
2020-06-09 17:45:48,783: saved config successfully
2020-06-09 17:47:17,982:   >> crossview_ap=0.684 (10966 x 3921 pairs)
2020-06-09 17:48:12,267:   >> acoustic_ap=0.735 (10966 choose 2 pairs)
2020-06-09 17:48:12,271: best_so_far= 0.685 at 585
2020-06-09 17:48:12,787: epoch=16.00 global_step=624 lr=0.001 start_iter=0
2020-06-09 17:48:12,788: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 17:49:53,146: 0) loss=0.204 grad_norm=17.18 num_segments=256 num_words=215
2020-06-09 17:51:30,654: 1) loss=0.196 grad_norm=22.50 num_segments=256 num_words=213
2020-06-09 17:53:07,842: 2) loss=0.191 grad_norm=40.15 num_segments=256 num_words=214
2020-06-09 17:54:45,510: 3) loss=0.195 grad_norm=34.14 num_segments=256 num_words=219
2020-06-09 17:56:24,576: 4) loss=0.194 grad_norm=22.90 num_segments=256 num_words=220
2020-06-09 17:58:25,042: 5) loss=0.205 grad_norm=31.29 num_segments=256 num_words=222
2020-06-09 18:00:03,502: 6) loss=0.207 grad_norm=40.68 num_segments=256 num_words=205
2020-06-09 18:01:41,188: 7) loss=0.203 grad_norm=28.41 num_segments=256 num_words=201
2020-06-09 18:03:18,387: 8) loss=0.217 grad_norm=28.47 num_segments=256 num_words=203
2020-06-09 18:04:56,167: 9) loss=0.187 grad_norm=24.41 num_segments=256 num_words=213
2020-06-09 18:06:33,459: 10) loss=0.195 grad_norm=15.31 num_segments=256 num_words=212
2020-06-09 18:08:10,821: 11) loss=0.207 grad_norm=28.43 num_segments=256 num_words=210
2020-06-09 18:09:48,834: 12) loss=0.210 grad_norm=28.14 num_segments=256 num_words=202
2020-06-09 18:11:26,256: 13) loss=0.194 grad_norm=16.07 num_segments=256 num_words=214
2020-06-09 18:13:03,695: 14) loss=0.313 grad_norm=19.48 num_segments=256 num_words=214
2020-06-09 18:14:41,144: 15) loss=0.189 grad_norm=23.05 num_segments=256 num_words=200
2020-06-09 18:16:16,802: 16) loss=0.191 grad_norm=16.83 num_segments=256 num_words=216
2020-06-09 18:17:52,999: 17) loss=0.200 grad_norm=16.09 num_segments=256 num_words=206
2020-06-09 18:19:31,416: 18) loss=0.189 grad_norm=19.73 num_segments=256 num_words=213
2020-06-09 18:21:09,704: 19) loss=0.177 grad_norm=31.43 num_segments=256 num_words=218
2020-06-09 18:22:47,569: 20) loss=0.187 grad_norm=18.62 num_segments=256 num_words=222
2020-06-09 18:24:25,588: 21) loss=0.195 grad_norm=19.42 num_segments=256 num_words=201
2020-06-09 18:26:03,930: 22) loss=0.181 grad_norm=18.78 num_segments=256 num_words=212
2020-06-09 18:27:41,745: 23) loss=0.334 grad_norm=24.25 num_segments=256 num_words=210
2020-06-09 18:29:20,277: 24) loss=0.203 grad_norm=20.27 num_segments=256 num_words=217
2020-06-09 18:30:58,366: 25) loss=0.206 grad_norm=16.23 num_segments=256 num_words=200
2020-06-09 18:33:02,135: 26) loss=0.215 grad_norm=29.83 num_segments=256 num_words=212
2020-06-09 18:34:40,249: 27) loss=0.209 grad_norm=32.51 num_segments=256 num_words=214
2020-06-09 18:36:18,079: 28) loss=0.181 grad_norm=24.09 num_segments=256 num_words=210
2020-06-09 18:37:56,007: 29) loss=0.339 grad_norm=19.54 num_segments=256 num_words=227
2020-06-09 18:39:42,437: 30) loss=0.190 grad_norm=14.10 num_segments=256 num_words=210
2020-06-09 18:41:35,347: 31) loss=0.206 grad_norm=19.34 num_segments=256 num_words=213
2020-06-09 18:43:27,902: 32) loss=0.195 grad_norm=24.72 num_segments=256 num_words=216
2020-06-09 18:45:19,164: 33) loss=0.207 grad_norm=21.55 num_segments=256 num_words=200
2020-06-09 18:47:11,631: 34) loss=0.214 grad_norm=34.97 num_segments=256 num_words=212
2020-06-09 18:49:04,498: 35) loss=0.188 grad_norm=19.79 num_segments=256 num_words=209
2020-06-09 18:50:57,126: 36) loss=0.208 grad_norm=22.70 num_segments=256 num_words=199
2020-06-09 18:52:49,820: 37) loss=0.188 grad_norm=19.39 num_segments=256 num_words=215
2020-06-09 18:54:31,880: 38) loss=0.207 grad_norm=24.20 num_segments=243 num_words=195
2020-06-09 18:54:31,901: epoch= 17.00
2020-06-09 18:54:31,901:  >> time to evaluate and save:
2020-06-09 18:54:31,945: saved save/MultiViewDataset_IndividualWords.663.pth
2020-06-09 18:54:31,958: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 18:54:31,965: saved MultiViewDataset_IndividualWords successfully
2020-06-09 18:54:33,416: saved save/MultiViewRNN.663.pth
2020-06-09 18:54:33,442: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 18:54:33,451: saved MultiViewRNN successfully
2020-06-09 18:54:36,033: saved save/Adam.663.pth
2020-06-09 18:54:36,042: most_recent linked save/Adam.most_recent.pth
2020-06-09 18:54:36,051: saved Adam successfully
2020-06-09 18:54:36,054: saved save/ReduceLROnPlateau.663.pth
2020-06-09 18:54:36,061: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 18:54:36,068: saved ReduceLROnPlateau successfully
2020-06-09 18:54:36,070: saved config successfully
2020-06-09 18:56:36,613:   >> crossview_ap=0.688 (10966 x 3921 pairs)
2020-06-09 18:58:11,444:   >> acoustic_ap=0.736 (10966 choose 2 pairs)
2020-06-09 18:58:11,449: best_so_far= 0.688 at 663
2020-06-09 18:58:11,475: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 18:58:11,482: saved MultiViewDataset_IndividualWords successfully
2020-06-09 18:58:11,504: best linked save/MultiViewRNN.best.pth
2020-06-09 18:58:11,536: saved MultiViewRNN successfully
2020-06-09 18:58:11,572: best linked save/Adam.best.pth
2020-06-09 18:58:11,596: saved Adam successfully
2020-06-09 18:58:11,598: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 18:58:11,612: saved ReduceLROnPlateau successfully
2020-06-09 18:58:12,523: epoch=17.00 global_step=663 lr=0.001 start_iter=0
2020-06-09 18:58:12,524: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 19:00:09,576: 0) loss=0.195 grad_norm=16.54 num_segments=256 num_words=202
2020-06-09 19:02:04,947: 1) loss=0.178 grad_norm=17.94 num_segments=256 num_words=218
2020-06-09 19:04:00,481: 2) loss=0.224 grad_norm=20.48 num_segments=256 num_words=203
2020-06-09 19:05:54,985: 3) loss=0.192 grad_norm=17.97 num_segments=256 num_words=211
2020-06-09 19:07:49,003: 4) loss=0.307 grad_norm=24.58 num_segments=256 num_words=210
2020-06-09 19:09:44,258: 5) loss=0.183 grad_norm=20.88 num_segments=256 num_words=206
2020-06-09 19:11:39,142: 6) loss=0.242 grad_norm=16.89 num_segments=256 num_words=199
2020-06-09 19:13:33,701: 7) loss=0.178 grad_norm=31.64 num_segments=256 num_words=211
2020-06-09 19:15:26,365: 8) loss=0.177 grad_norm=12.85 num_segments=256 num_words=208
2020-06-09 19:17:19,669: 9) loss=0.195 grad_norm=16.98 num_segments=256 num_words=207
2020-06-09 19:18:30,448: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-09 19:18:30,487: Using 1 GPU(s)
2020-06-09 19:18:30,488: Machine: 0 / 1
2020-06-09 19:18:30,489: Hyperparam tuning-------------------
2020-06-09 19:18:30,489: optim_lr: 0.001
2020-06-09 19:18:30,489: dropout (for both): 0.4
2020-06-09 19:18:30,489: margin: 0.4
2020-06-09 19:18:30,489: ------------------------------------
2020-06-09 19:18:30,491: Calling main function: multiview_trainer.train
2020-06-09 19:18:30,491: Using config file: train_config.json
2020-06-09 19:18:30,491: Using module at multiview_trainer.train
2020-06-09 19:18:31,484: Using module at multiview_vocab.MultiViewVocab
2020-06-09 19:18:31,490: Building vocab_data from config
2020-06-09 19:18:31,773:  >> min_count= 0
2020-06-09 19:18:31,774:  >> # words= 34323 (# removed= 0)
2020-06-09 19:18:31,774:  >> # subwords= 45
2020-06-09 19:18:31,774:     [laughter]= 1
2020-06-09 19:18:31,774:     [noise]= 2
2020-06-09 19:18:31,774:     [vocalized-noise]= 3
2020-06-09 19:18:31,774:     aa= 4
2020-06-09 19:18:31,774:     ae= 5
2020-06-09 19:18:31,774:     ah= 6
2020-06-09 19:18:31,774:     ao= 7
2020-06-09 19:18:31,774:     aw= 8
2020-06-09 19:18:31,774:     ax= 9
2020-06-09 19:18:31,774:     ay= 10
2020-06-09 19:18:31,774:     b= 11
2020-06-09 19:18:31,775:     ch= 12
2020-06-09 19:18:31,775:     d= 13
2020-06-09 19:18:31,775:     dh= 14
2020-06-09 19:18:31,775:     eh= 15
2020-06-09 19:18:31,775:     el= 16
2020-06-09 19:18:31,775:     en= 17
2020-06-09 19:18:31,775:     er= 18
2020-06-09 19:18:31,775:     ey= 19
2020-06-09 19:18:31,775:     f= 20
2020-06-09 19:18:31,775:     g= 21
2020-06-09 19:18:31,775:     hh= 22
2020-06-09 19:18:31,775:     ih= 23
2020-06-09 19:18:31,775:     iy= 24
2020-06-09 19:18:31,776:     jh= 25
2020-06-09 19:18:31,776:     k= 26
2020-06-09 19:18:31,776:     l= 27
2020-06-09 19:18:31,776:     m= 28
2020-06-09 19:18:31,776:     n= 29
2020-06-09 19:18:31,776:     ng= 30
2020-06-09 19:18:31,776:     ow= 31
2020-06-09 19:18:31,776:     oy= 32
2020-06-09 19:18:31,776:     p= 33
2020-06-09 19:18:31,776:     r= 34
2020-06-09 19:18:31,776:     s= 35
2020-06-09 19:18:31,776:     sh= 36
2020-06-09 19:18:31,776:     t= 37
2020-06-09 19:18:31,776:     th= 38
2020-06-09 19:18:31,777:     uh= 39
2020-06-09 19:18:31,777:     uw= 40
2020-06-09 19:18:31,777:     v= 41
2020-06-09 19:18:31,777:     w= 42
2020-06-09 19:18:31,777:     y= 43
2020-06-09 19:18:31,777:     z= 44
2020-06-09 19:18:31,777:     zh= 45
2020-06-09 19:18:31,792: Using module at data.batch_samplers.BatchSampler
2020-06-09 19:18:31,794: Building vocab_sampler from config
2020-06-09 19:18:31,795:  >> # examples= 34323
2020-06-09 19:18:31,795:  >> batch_size= 1000
2020-06-09 19:18:31,795:  >> shuffle= False
2020-06-09 19:18:31,802:  >> BatchSampler; 35 batches
2020-06-09 19:18:31,802: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 19:18:32,111: Building train_data from config
2020-06-09 19:18:40,676:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-09 19:18:40,681:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-09 19:18:40,681:  >> stack= False
2020-06-09 19:18:40,681:  >> seg_durs= (1, None)
2020-06-09 19:18:40,681:  >> # words= 9971 (# ignored= 0)
2020-06-09 19:18:40,681:  >> input_feat_dim= 108
2020-06-09 19:18:40,681:  >> input_num_subwords= 45
2020-06-09 19:18:40,681: Using module at data.batch_samplers.BatchSampler
2020-06-09 19:18:40,682: Building train_sampler from config
2020-06-09 19:18:40,682:  >> # examples= 9971
2020-06-09 19:18:40,682:  >> batch_size= 256
2020-06-09 19:18:40,682:  >> shuffle= True
2020-06-09 19:18:40,691:  >> BatchSampler; 39 batches
2020-06-09 19:18:40,692: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 19:18:40,692: Building dev_data from config
2020-06-09 19:18:50,694:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-09 19:18:50,695:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-09 19:18:50,695:  >> stack= False
2020-06-09 19:18:50,695:  >> seg_durs= (1, None)
2020-06-09 19:18:50,695:  >> # words= 10966 (# ignored= 0)
2020-06-09 19:18:50,695:  >> input_feat_dim= 108
2020-06-09 19:18:50,695:  >> input_num_subwords= 45
2020-06-09 19:18:50,695: Using module at data.batch_samplers.BatchSampler
2020-06-09 19:18:50,695: Building dev_sampler from config
2020-06-09 19:18:50,696:  >> # examples= 10966
2020-06-09 19:18:50,696:  >> batch_size= 256
2020-06-09 19:18:50,696:  >> shuffle= False
2020-06-09 19:18:50,699:  >> BatchSampler; 43 batches
2020-06-09 19:18:50,699: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 19:18:50,699: Building test_data from config
2020-06-09 19:18:59,234:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-09 19:18:59,235:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-09 19:18:59,235:  >> stack= False
2020-06-09 19:18:59,235:  >> seg_durs= (1, None)
2020-06-09 19:18:59,235:  >> # words= 11024 (# ignored= 0)
2020-06-09 19:18:59,235:  >> input_feat_dim= 108
2020-06-09 19:18:59,235:  >> input_num_subwords= 45
2020-06-09 19:18:59,235: Using module at data.batch_samplers.BatchSampler
2020-06-09 19:18:59,235: Building test_sampler from config
2020-06-09 19:18:59,236:  >> # examples= 11024
2020-06-09 19:18:59,236:  >> batch_size= 256
2020-06-09 19:18:59,236:  >> shuffle= False
2020-06-09 19:18:59,239:  >> BatchSampler; 44 batches
2020-06-09 19:18:59,239: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-09 19:18:59,256: Building loss from config
2020-06-09 19:18:59,256:  >> margin= 0.4
2020-06-09 19:18:59,256:  >> k= 16
2020-06-09 19:18:59,257:  >> min_k= 8
2020-06-09 19:18:59,257:  >> extra= 0
2020-06-09 19:18:59,257:  >> average= False
2020-06-09 19:18:59,257:  >> margin_max= 0.5
2020-06-09 19:18:59,257:  >> threshold_max= 9
2020-06-09 19:18:59,257:  >> using obj0+2
2020-06-09 19:18:59,257: Using module at metric.multiview_ap.MultiViewAP
2020-06-09 19:18:59,303: Building eval from config
2020-06-09 19:18:59,304:  >> acoustic_ap= True
2020-06-09 19:18:59,304:  >> crossview_ap= True
2020-06-09 19:18:59,304:  >> full_vocab= False
2020-06-09 19:18:59,304:  >> metric= crossview_ap
2020-06-09 19:18:59,304:  >> mode= max
2020-06-09 19:18:59,304: Using module at multiview_rnn.MultiViewRNN
2020-06-09 19:18:59,315: Building net from config
2020-06-09 19:18:59,316: view1:
2020-06-09 19:18:59,317:  >> cell= GRU
2020-06-09 19:18:59,317:  >> input_size= 108
2020-06-09 19:18:59,317:  >> hidden_size= 512
2020-06-09 19:18:59,317:  >> bidirectional= True
2020-06-09 19:18:59,318:  >> num_layers= 6
2020-06-09 19:18:59,318:  >> dropout between layers= 0.4
2020-06-09 19:18:59,556: view2:
2020-06-09 19:18:59,556:  >> cell= GRU
2020-06-09 19:18:59,557:  >> input_size= 64
2020-06-09 19:18:59,557:  >> hidden_size= 512
2020-06-09 19:18:59,557:  >> bidirectional= True
2020-06-09 19:18:59,557:  >> num_layers= 2
2020-06-09 19:18:59,557:  >> dropout between layers= 0.4
2020-06-09 19:18:59,557:  >> num input embeddings= 45
2020-06-09 19:19:03,520: Using module at optim.adam.Adam
2020-06-09 19:19:03,525: Building optim from config
2020-06-09 19:19:03,525:  >> lr= 0.001
2020-06-09 19:19:03,525:  >> betas= (0.9, 0.999)
2020-06-09 19:19:03,525:  >> eps= 1e-08
2020-06-09 19:19:03,526:  >> weight_decay= 0
2020-06-09 19:19:03,526:  >> amsgrad= False
2020-06-09 19:19:03,526:  >> min_lr= 1e-07
2020-06-09 19:19:03,527: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-09 19:19:03,534: Building sched from config
2020-06-09 19:19:03,534:  >> optim= Adam
2020-06-09 19:19:03,534:  >> decay lr by 0.1
2020-06-09 19:19:03,535:  >> eval_fn= MultiViewAP
2020-06-09 19:19:03,535:  >> patience=4
2020-06-09 19:19:03,536:  >> revert=True
2020-06-09 19:19:03,542: loaded save/MultiViewDataset_IndividualWords.663.pth
2020-06-09 19:19:03,543: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-09 19:19:03,661: loaded save/MultiViewRNN.663.pth
2020-06-09 19:19:03,661: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-09 19:19:03,870: loaded save/Adam.663.pth
2020-06-09 19:19:03,870: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-09 19:19:03,872: loaded save/ReduceLROnPlateau.663.pth
2020-06-09 19:19:03,872: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-09 19:19:03,873: epoch=17.00 global_step=663 lr=0.001 start_iter=0
2020-06-09 19:19:03,873: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 19:22:32,189: 0) loss=0.115 grad_norm=11.87 num_segments=256 num_words=202
2020-06-09 19:25:45,224: 1) loss=0.104 grad_norm=12.61 num_segments=256 num_words=218
2020-06-09 19:28:44,679: 2) loss=0.139 grad_norm=10.43 num_segments=256 num_words=203
2020-06-09 19:31:32,363: 3) loss=0.130 grad_norm=11.02 num_segments=256 num_words=211
2020-06-09 19:34:06,592: 4) loss=0.229 grad_norm=19.14 num_segments=256 num_words=210
2020-06-09 19:36:26,488: 5) loss=0.145 grad_norm=15.28 num_segments=256 num_words=206
2020-06-09 19:38:31,068: 6) loss=0.216 grad_norm=14.13 num_segments=256 num_words=199
2020-06-09 19:40:22,202: 7) loss=0.176 grad_norm=23.38 num_segments=256 num_words=211
2020-06-09 19:42:16,840: 8) loss=0.178 grad_norm=17.34 num_segments=256 num_words=208
2020-06-09 19:44:06,137: 9) loss=0.195 grad_norm=20.69 num_segments=256 num_words=207
2020-06-09 19:45:59,368: 10) loss=0.229 grad_norm=13.59 num_segments=256 num_words=207
2020-06-09 19:47:51,900: 11) loss=0.221 grad_norm=18.84 num_segments=256 num_words=217
2020-06-09 19:49:43,357: 12) loss=0.183 grad_norm=34.06 num_segments=256 num_words=219
2020-06-09 19:51:33,902: 13) loss=0.237 grad_norm=22.54 num_segments=256 num_words=217
2020-06-09 19:53:27,776: 14) loss=0.191 grad_norm=16.45 num_segments=256 num_words=207
2020-06-09 19:55:17,749: 15) loss=0.184 grad_norm=16.97 num_segments=256 num_words=212
2020-06-09 19:57:07,777: 16) loss=0.185 grad_norm=19.64 num_segments=256 num_words=208
2020-06-09 19:58:59,958: 17) loss=0.183 grad_norm=22.71 num_segments=256 num_words=214
2020-06-09 20:00:51,971: 18) loss=0.185 grad_norm=19.88 num_segments=256 num_words=207
2020-06-09 20:02:47,659: 19) loss=0.212 grad_norm=18.75 num_segments=256 num_words=206
2020-06-09 20:04:37,191: 20) loss=0.201 grad_norm=25.18 num_segments=256 num_words=216
2020-06-09 20:06:28,689: 21) loss=0.192 grad_norm=17.83 num_segments=256 num_words=213
2020-06-09 20:08:19,611: 22) loss=0.196 grad_norm=22.51 num_segments=256 num_words=211
2020-06-09 20:10:10,453: 23) loss=0.364 grad_norm=30.51 num_segments=256 num_words=217
2020-06-09 20:12:08,877: 24) loss=0.198 grad_norm=19.86 num_segments=256 num_words=212
2020-06-09 20:14:00,110: 25) loss=0.204 grad_norm=16.33 num_segments=256 num_words=204
2020-06-09 20:15:51,973: 26) loss=0.332 grad_norm=19.20 num_segments=256 num_words=209
2020-06-09 20:17:39,161: 27) loss=0.311 grad_norm=27.84 num_segments=256 num_words=210
2020-06-09 20:19:23,308: 28) loss=0.188 grad_norm=23.60 num_segments=256 num_words=208
2020-06-09 20:21:05,342: 29) loss=0.204 grad_norm=31.47 num_segments=256 num_words=198
2020-06-09 20:22:51,622: 30) loss=0.195 grad_norm=32.16 num_segments=256 num_words=211
2020-06-09 20:24:42,490: 31) loss=0.215 grad_norm=31.15 num_segments=256 num_words=210
2020-06-09 20:26:24,359: 32) loss=0.197 grad_norm=32.12 num_segments=256 num_words=203
2020-06-09 20:28:06,329: 33) loss=0.190 grad_norm=19.98 num_segments=256 num_words=209
2020-06-09 20:29:42,386: 34) loss=0.182 grad_norm=28.93 num_segments=256 num_words=217
2020-06-09 20:31:18,543: 35) loss=0.226 grad_norm=27.06 num_segments=256 num_words=209
2020-06-09 20:32:54,917: 36) loss=0.192 grad_norm=41.54 num_segments=256 num_words=219
2020-06-09 20:34:31,095: 37) loss=0.192 grad_norm=46.00 num_segments=256 num_words=195
2020-06-09 20:35:57,761: 38) loss=0.186 grad_norm=31.47 num_segments=243 num_words=200
2020-06-09 20:35:57,782: epoch= 18.00
2020-06-09 20:35:57,782:  >> time to evaluate and save:
2020-06-09 20:35:57,814: saved save/MultiViewDataset_IndividualWords.702.pth
2020-06-09 20:35:57,860: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 20:35:57,871: saved MultiViewDataset_IndividualWords successfully
2020-06-09 20:35:59,205: saved save/MultiViewRNN.702.pth
2020-06-09 20:35:59,224: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 20:35:59,264: saved MultiViewRNN successfully
2020-06-09 20:36:01,861: saved save/Adam.702.pth
2020-06-09 20:36:01,873: most_recent linked save/Adam.most_recent.pth
2020-06-09 20:36:01,905: saved Adam successfully
2020-06-09 20:36:01,908: saved save/ReduceLROnPlateau.702.pth
2020-06-09 20:36:01,920: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 20:36:01,941: saved ReduceLROnPlateau successfully
2020-06-09 20:36:01,944: saved config successfully
2020-06-09 20:37:38,087:   >> crossview_ap=0.673 (10966 x 3921 pairs)
2020-06-09 20:38:32,113:   >> acoustic_ap=0.731 (10966 choose 2 pairs)
2020-06-09 20:38:32,117: best_so_far= 0.685 at 585
2020-06-09 20:38:32,177: epoch=18.00 global_step=702 lr=0.001 start_iter=0
2020-06-09 20:38:32,177: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 20:40:10,151: 0) loss=0.176 grad_norm=16.73 num_segments=256 num_words=223
2020-06-09 20:41:55,381: 1) loss=0.190 grad_norm=27.01 num_segments=256 num_words=205
2020-06-09 20:43:30,302: 2) loss=0.229 grad_norm=44.93 num_segments=256 num_words=212
2020-06-09 20:45:18,108: 3) loss=0.191 grad_norm=35.90 num_segments=256 num_words=208
2020-06-09 20:46:57,860: 4) loss=0.176 grad_norm=19.63 num_segments=256 num_words=215
2020-06-09 20:48:32,378: 5) loss=0.200 grad_norm=22.20 num_segments=256 num_words=195
2020-06-09 20:50:07,293: 6) loss=0.177 grad_norm=26.55 num_segments=256 num_words=208
2020-06-09 20:51:41,949: 7) loss=0.195 grad_norm=19.74 num_segments=256 num_words=212
2020-06-09 20:53:18,237: 8) loss=0.217 grad_norm=24.10 num_segments=256 num_words=208
2020-06-09 20:54:55,435: 9) loss=0.203 grad_norm=19.09 num_segments=256 num_words=213
2020-06-09 20:56:31,136: 10) loss=0.196 grad_norm=27.50 num_segments=256 num_words=220
2020-06-09 20:58:06,304: 11) loss=0.166 grad_norm=24.55 num_segments=256 num_words=213
2020-06-09 20:59:52,932: 12) loss=0.228 grad_norm=35.30 num_segments=256 num_words=215
2020-06-09 21:01:27,882: 13) loss=0.208 grad_norm=30.56 num_segments=256 num_words=209
2020-06-09 21:03:02,860: 14) loss=0.202 grad_norm=26.03 num_segments=256 num_words=219
2020-06-09 21:04:37,798: 15) loss=0.177 grad_norm=19.79 num_segments=256 num_words=216
2020-06-09 21:06:12,620: 16) loss=0.195 grad_norm=35.52 num_segments=256 num_words=213
2020-06-09 21:07:47,351: 17) loss=0.340 grad_norm=25.36 num_segments=256 num_words=205
2020-06-09 21:09:22,357: 18) loss=0.190 grad_norm=19.39 num_segments=256 num_words=208
2020-06-09 21:10:57,302: 19) loss=0.174 grad_norm=15.51 num_segments=256 num_words=206
2020-06-09 21:12:32,122: 20) loss=0.206 grad_norm=16.24 num_segments=256 num_words=213
2020-06-09 21:14:07,076: 21) loss=0.180 grad_norm=18.63 num_segments=256 num_words=204
2020-06-09 21:15:42,248: 22) loss=0.184 grad_norm=30.69 num_segments=256 num_words=211
2020-06-09 21:17:17,329: 23) loss=0.194 grad_norm=18.30 num_segments=256 num_words=210
2020-06-09 21:18:52,551: 24) loss=0.182 grad_norm=24.34 num_segments=256 num_words=208
2020-06-09 21:20:28,154: 25) loss=0.211 grad_norm=18.26 num_segments=256 num_words=203
2020-06-09 21:22:17,534: 26) loss=0.191 grad_norm=19.51 num_segments=256 num_words=213
2020-06-09 21:23:52,760: 27) loss=0.183 grad_norm=25.84 num_segments=256 num_words=211
2020-06-09 21:25:28,648: 28) loss=0.191 grad_norm=16.41 num_segments=256 num_words=210
2020-06-09 21:27:03,600: 29) loss=0.200 grad_norm=40.13 num_segments=256 num_words=210
2020-06-09 21:28:38,825: 30) loss=0.199 grad_norm=27.52 num_segments=256 num_words=214
2020-06-09 21:30:14,462: 31) loss=0.190 grad_norm=22.89 num_segments=256 num_words=213
2020-06-09 21:31:49,730: 32) loss=0.180 grad_norm=26.13 num_segments=256 num_words=215
2020-06-09 21:33:24,751: 33) loss=0.194 grad_norm=21.52 num_segments=256 num_words=202
2020-06-09 21:35:00,266: 34) loss=0.200 grad_norm=20.27 num_segments=256 num_words=192
2020-06-09 21:36:35,329: 35) loss=0.197 grad_norm=20.02 num_segments=256 num_words=202
2020-06-09 21:38:10,331: 36) loss=0.196 grad_norm=16.98 num_segments=256 num_words=209
2020-06-09 21:39:45,664: 37) loss=0.177 grad_norm=22.82 num_segments=256 num_words=212
2020-06-09 21:41:11,808: 38) loss=0.192 grad_norm=26.58 num_segments=243 num_words=200
2020-06-09 21:41:11,825: epoch= 19.00
2020-06-09 21:41:11,825:  >> time to evaluate and save:
2020-06-09 21:41:11,870: saved save/MultiViewDataset_IndividualWords.741.pth
2020-06-09 21:41:11,891: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 21:41:11,898: saved MultiViewDataset_IndividualWords successfully
2020-06-09 21:41:13,237: saved save/MultiViewRNN.741.pth
2020-06-09 21:41:13,257: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 21:41:13,270: saved MultiViewRNN successfully
2020-06-09 21:41:15,879: saved save/Adam.741.pth
2020-06-09 21:41:15,890: most_recent linked save/Adam.most_recent.pth
2020-06-09 21:41:15,904: saved Adam successfully
2020-06-09 21:41:15,907: saved save/ReduceLROnPlateau.741.pth
2020-06-09 21:41:15,919: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 21:41:15,931: saved ReduceLROnPlateau successfully
2020-06-09 21:41:15,933: saved config successfully
2020-06-09 21:42:58,517:   >> crossview_ap=0.677 (10966 x 3921 pairs)
2020-06-09 21:43:53,266:   >> acoustic_ap=0.738 (10966 choose 2 pairs)
2020-06-09 21:43:53,275: best_so_far= 0.685 at 585
2020-06-09 21:43:54,097: epoch=19.00 global_step=741 lr=0.001 start_iter=0
2020-06-09 21:43:54,098: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 21:45:31,986: 0) loss=0.206 grad_norm=34.62 num_segments=256 num_words=206
2020-06-09 21:47:07,621: 1) loss=0.209 grad_norm=25.54 num_segments=256 num_words=205
2020-06-09 21:48:43,644: 2) loss=0.222 grad_norm=28.68 num_segments=256 num_words=205
2020-06-09 21:50:20,087: 3) loss=0.195 grad_norm=17.75 num_segments=256 num_words=207
2020-06-09 21:51:58,198: 4) loss=0.179 grad_norm=24.47 num_segments=256 num_words=217
2020-06-09 21:53:56,201: 5) loss=0.198 grad_norm=29.18 num_segments=256 num_words=208
2020-06-09 21:55:33,456: 6) loss=0.183 grad_norm=16.59 num_segments=256 num_words=213
2020-06-09 21:57:10,312: 7) loss=0.201 grad_norm=20.62 num_segments=256 num_words=210
2020-06-09 21:58:46,880: 8) loss=0.178 grad_norm=13.14 num_segments=256 num_words=219
2020-06-09 22:00:24,840: 9) loss=0.187 grad_norm=15.95 num_segments=256 num_words=209
2020-06-09 22:02:01,371: 10) loss=0.199 grad_norm=22.53 num_segments=256 num_words=211
2020-06-09 22:03:38,725: 11) loss=0.193 grad_norm=21.96 num_segments=256 num_words=216
2020-06-09 22:05:16,546: 12) loss=0.206 grad_norm=19.13 num_segments=256 num_words=205
2020-06-09 22:06:52,804: 13) loss=0.188 grad_norm=28.44 num_segments=256 num_words=207
2020-06-09 22:08:30,218: 14) loss=0.197 grad_norm=18.68 num_segments=256 num_words=209
2020-06-09 22:10:06,804: 15) loss=0.192 grad_norm=27.97 num_segments=256 num_words=206
2020-06-09 22:11:42,818: 16) loss=0.216 grad_norm=24.85 num_segments=256 num_words=202
2020-06-09 22:13:20,723: 17) loss=0.179 grad_norm=17.56 num_segments=256 num_words=207
2020-06-09 22:14:58,339: 18) loss=0.185 grad_norm=17.00 num_segments=256 num_words=212
2020-06-09 22:16:35,551: 19) loss=0.184 grad_norm=24.31 num_segments=256 num_words=223
2020-06-09 22:18:23,628: 20) loss=0.213 grad_norm=25.70 num_segments=256 num_words=216
2020-06-09 22:20:01,898: 21) loss=0.186 grad_norm=17.96 num_segments=256 num_words=217
2020-06-09 22:21:39,289: 22) loss=0.196 grad_norm=14.31 num_segments=256 num_words=204
2020-06-09 22:23:17,228: 23) loss=0.168 grad_norm=11.90 num_segments=256 num_words=208
2020-06-09 22:24:55,282: 24) loss=0.220 grad_norm=14.02 num_segments=256 num_words=201
2020-06-09 22:26:33,410: 25) loss=0.200 grad_norm=24.66 num_segments=256 num_words=214
2020-06-09 22:28:36,426: 26) loss=0.201 grad_norm=27.68 num_segments=256 num_words=208
2020-06-09 22:30:15,096: 27) loss=0.311 grad_norm=30.08 num_segments=256 num_words=215
2020-06-09 22:31:52,513: 28) loss=0.203 grad_norm=25.18 num_segments=256 num_words=213
2020-06-09 22:33:30,373: 29) loss=0.187 grad_norm=23.67 num_segments=256 num_words=215
2020-06-09 22:35:08,048: 30) loss=0.203 grad_norm=21.08 num_segments=256 num_words=200
2020-06-09 22:36:45,631: 31) loss=0.186 grad_norm=21.19 num_segments=256 num_words=211
2020-06-09 22:38:23,445: 32) loss=0.315 grad_norm=30.46 num_segments=256 num_words=218
2020-06-09 22:40:01,802: 33) loss=0.200 grad_norm=22.67 num_segments=256 num_words=210
2020-06-09 22:41:39,139: 34) loss=0.231 grad_norm=28.86 num_segments=256 num_words=214
2020-06-09 22:43:17,000: 35) loss=0.218 grad_norm=17.99 num_segments=256 num_words=202
2020-06-09 22:44:55,291: 36) loss=0.182 grad_norm=22.89 num_segments=256 num_words=208
2020-06-09 22:46:32,915: 37) loss=0.198 grad_norm=19.34 num_segments=256 num_words=206
2020-06-09 22:48:00,609: 38) loss=0.186 grad_norm=22.12 num_segments=243 num_words=197
2020-06-09 22:48:00,636: epoch= 20.00
2020-06-09 22:48:00,637:  >> time to evaluate and save:
2020-06-09 22:48:00,677: saved save/MultiViewDataset_IndividualWords.780.pth
2020-06-09 22:48:00,689: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 22:48:00,695: saved MultiViewDataset_IndividualWords successfully
2020-06-09 22:48:02,170: saved save/MultiViewRNN.780.pth
2020-06-09 22:48:02,181: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 22:48:02,195: saved MultiViewRNN successfully
2020-06-09 22:48:04,879: saved save/Adam.780.pth
2020-06-09 22:48:04,897: most_recent linked save/Adam.most_recent.pth
2020-06-09 22:48:04,911: saved Adam successfully
2020-06-09 22:48:04,914: saved save/ReduceLROnPlateau.780.pth
2020-06-09 22:48:04,927: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 22:48:04,940: saved ReduceLROnPlateau successfully
2020-06-09 22:48:04,943: saved config successfully
2020-06-09 22:50:05,524:   >> crossview_ap=0.695 (10966 x 3921 pairs)
2020-06-09 22:51:19,584:   >> acoustic_ap=0.757 (10966 choose 2 pairs)
2020-06-09 22:51:19,589: best_so_far= 0.695 at 780
2020-06-09 22:51:19,598: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 22:51:19,605: saved MultiViewDataset_IndividualWords successfully
2020-06-09 22:51:19,614: best linked save/MultiViewRNN.best.pth
2020-06-09 22:51:19,654: saved MultiViewRNN successfully
2020-06-09 22:51:19,667: best linked save/Adam.best.pth
2020-06-09 22:51:19,697: saved Adam successfully
2020-06-09 22:51:19,710: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 22:51:19,731: saved ReduceLROnPlateau successfully
2020-06-09 22:51:20,556: epoch=20.00 global_step=780 lr=0.001 start_iter=0
2020-06-09 22:51:20,556: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 22:53:03,275: 0) loss=0.183 grad_norm=11.37 num_segments=256 num_words=204
2020-06-09 22:54:40,408: 1) loss=0.182 grad_norm=16.28 num_segments=256 num_words=215
2020-06-09 22:56:16,610: 2) loss=0.202 grad_norm=14.28 num_segments=256 num_words=208
2020-06-09 22:57:52,579: 3) loss=0.200 grad_norm=28.87 num_segments=256 num_words=214
2020-06-09 22:59:29,558: 4) loss=0.339 grad_norm=14.45 num_segments=256 num_words=218
2020-06-09 23:01:06,750: 5) loss=0.218 grad_norm=16.31 num_segments=256 num_words=206
2020-06-09 23:02:43,242: 6) loss=0.183 grad_norm=13.69 num_segments=256 num_words=212
2020-06-09 23:04:19,884: 7) loss=0.181 grad_norm=12.61 num_segments=256 num_words=203
2020-06-09 23:05:56,841: 8) loss=0.212 grad_norm=25.37 num_segments=256 num_words=212
2020-06-09 23:07:32,965: 9) loss=0.208 grad_norm=22.06 num_segments=256 num_words=211
2020-06-09 23:09:09,846: 10) loss=0.168 grad_norm=16.23 num_segments=256 num_words=213
2020-06-09 23:10:46,817: 11) loss=0.312 grad_norm=24.42 num_segments=256 num_words=218
2020-06-09 23:12:23,056: 12) loss=0.199 grad_norm=24.19 num_segments=256 num_words=200
2020-06-09 23:13:59,810: 13) loss=0.177 grad_norm=20.70 num_segments=256 num_words=214
2020-06-09 23:16:18,600: 14) loss=0.205 grad_norm=24.57 num_segments=256 num_words=211
2020-06-09 23:17:56,340: 15) loss=0.191 grad_norm=18.50 num_segments=256 num_words=195
2020-06-09 23:18:50,611: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-09 23:18:50,655: Using 1 GPU(s)
2020-06-09 23:18:50,655: Machine: 0 / 1
2020-06-09 23:18:50,657: Hyperparam tuning-------------------
2020-06-09 23:18:50,657: optim_lr: 0.001
2020-06-09 23:18:50,657: dropout (for both): 0.4
2020-06-09 23:18:50,657: margin: 0.4
2020-06-09 23:18:50,657: ------------------------------------
2020-06-09 23:18:50,660: Calling main function: multiview_trainer.train
2020-06-09 23:18:50,661: Using config file: train_config.json
2020-06-09 23:18:50,661: Using module at multiview_trainer.train
2020-06-09 23:18:51,002: Using module at multiview_vocab.MultiViewVocab
2020-06-09 23:18:51,009: Building vocab_data from config
2020-06-09 23:18:51,295:  >> min_count= 0
2020-06-09 23:18:51,295:  >> # words= 34323 (# removed= 0)
2020-06-09 23:18:51,295:  >> # subwords= 45
2020-06-09 23:18:51,295:     [laughter]= 1
2020-06-09 23:18:51,295:     [noise]= 2
2020-06-09 23:18:51,295:     [vocalized-noise]= 3
2020-06-09 23:18:51,295:     aa= 4
2020-06-09 23:18:51,295:     ae= 5
2020-06-09 23:18:51,295:     ah= 6
2020-06-09 23:18:51,296:     ao= 7
2020-06-09 23:18:51,296:     aw= 8
2020-06-09 23:18:51,296:     ax= 9
2020-06-09 23:18:51,296:     ay= 10
2020-06-09 23:18:51,296:     b= 11
2020-06-09 23:18:51,296:     ch= 12
2020-06-09 23:18:51,296:     d= 13
2020-06-09 23:18:51,296:     dh= 14
2020-06-09 23:18:51,296:     eh= 15
2020-06-09 23:18:51,296:     el= 16
2020-06-09 23:18:51,296:     en= 17
2020-06-09 23:18:51,297:     er= 18
2020-06-09 23:18:51,297:     ey= 19
2020-06-09 23:18:51,297:     f= 20
2020-06-09 23:18:51,297:     g= 21
2020-06-09 23:18:51,297:     hh= 22
2020-06-09 23:18:51,297:     ih= 23
2020-06-09 23:18:51,297:     iy= 24
2020-06-09 23:18:51,297:     jh= 25
2020-06-09 23:18:51,297:     k= 26
2020-06-09 23:18:51,297:     l= 27
2020-06-09 23:18:51,297:     m= 28
2020-06-09 23:18:51,298:     n= 29
2020-06-09 23:18:51,298:     ng= 30
2020-06-09 23:18:51,298:     ow= 31
2020-06-09 23:18:51,298:     oy= 32
2020-06-09 23:18:51,298:     p= 33
2020-06-09 23:18:51,298:     r= 34
2020-06-09 23:18:51,298:     s= 35
2020-06-09 23:18:51,298:     sh= 36
2020-06-09 23:18:51,298:     t= 37
2020-06-09 23:18:51,298:     th= 38
2020-06-09 23:18:51,299:     uh= 39
2020-06-09 23:18:51,299:     uw= 40
2020-06-09 23:18:51,299:     v= 41
2020-06-09 23:18:51,299:     w= 42
2020-06-09 23:18:51,299:     y= 43
2020-06-09 23:18:51,299:     z= 44
2020-06-09 23:18:51,299:     zh= 45
2020-06-09 23:18:51,314: Using module at data.batch_samplers.BatchSampler
2020-06-09 23:18:51,317: Building vocab_sampler from config
2020-06-09 23:18:51,317:  >> # examples= 34323
2020-06-09 23:18:51,317:  >> batch_size= 1000
2020-06-09 23:18:51,318:  >> shuffle= False
2020-06-09 23:18:51,326:  >> BatchSampler; 35 batches
2020-06-09 23:18:51,326: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 23:18:51,491: Building train_data from config
2020-06-09 23:18:59,387:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-09 23:18:59,387:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-09 23:18:59,388:  >> stack= False
2020-06-09 23:18:59,388:  >> seg_durs= (1, None)
2020-06-09 23:18:59,388:  >> # words= 9971 (# ignored= 0)
2020-06-09 23:18:59,388:  >> input_feat_dim= 108
2020-06-09 23:18:59,388:  >> input_num_subwords= 45
2020-06-09 23:18:59,388: Using module at data.batch_samplers.BatchSampler
2020-06-09 23:18:59,389: Building train_sampler from config
2020-06-09 23:18:59,390:  >> # examples= 9971
2020-06-09 23:18:59,390:  >> batch_size= 256
2020-06-09 23:18:59,390:  >> shuffle= True
2020-06-09 23:18:59,398:  >> BatchSampler; 39 batches
2020-06-09 23:18:59,398: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 23:18:59,398: Building dev_data from config
2020-06-09 23:19:08,578:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-09 23:19:08,584:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-09 23:19:08,584:  >> stack= False
2020-06-09 23:19:08,584:  >> seg_durs= (1, None)
2020-06-09 23:19:08,584:  >> # words= 10966 (# ignored= 0)
2020-06-09 23:19:08,584:  >> input_feat_dim= 108
2020-06-09 23:19:08,584:  >> input_num_subwords= 45
2020-06-09 23:19:08,584: Using module at data.batch_samplers.BatchSampler
2020-06-09 23:19:08,584: Building dev_sampler from config
2020-06-09 23:19:08,585:  >> # examples= 10966
2020-06-09 23:19:08,585:  >> batch_size= 256
2020-06-09 23:19:08,585:  >> shuffle= False
2020-06-09 23:19:08,587:  >> BatchSampler; 43 batches
2020-06-09 23:19:08,588: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 23:19:08,588: Building test_data from config
2020-06-09 23:19:16,399:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-09 23:19:16,406:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-09 23:19:16,406:  >> stack= False
2020-06-09 23:19:16,406:  >> seg_durs= (1, None)
2020-06-09 23:19:16,406:  >> # words= 11024 (# ignored= 0)
2020-06-09 23:19:16,406:  >> input_feat_dim= 108
2020-06-09 23:19:16,407:  >> input_num_subwords= 45
2020-06-09 23:19:16,407: Using module at data.batch_samplers.BatchSampler
2020-06-09 23:19:16,407: Building test_sampler from config
2020-06-09 23:19:16,408:  >> # examples= 11024
2020-06-09 23:19:16,408:  >> batch_size= 256
2020-06-09 23:19:16,408:  >> shuffle= False
2020-06-09 23:19:16,412:  >> BatchSampler; 44 batches
2020-06-09 23:19:16,413: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-09 23:19:16,456: Building loss from config
2020-06-09 23:19:16,457:  >> margin= 0.4
2020-06-09 23:19:16,457:  >> k= 16
2020-06-09 23:19:16,457:  >> min_k= 8
2020-06-09 23:19:16,457:  >> extra= 0
2020-06-09 23:19:16,457:  >> average= False
2020-06-09 23:19:16,457:  >> margin_max= 0.5
2020-06-09 23:19:16,457:  >> threshold_max= 9
2020-06-09 23:19:16,457:  >> using obj0+2
2020-06-09 23:19:16,458: Using module at metric.multiview_ap.MultiViewAP
2020-06-09 23:19:16,570: Building eval from config
2020-06-09 23:19:16,571:  >> acoustic_ap= True
2020-06-09 23:19:16,571:  >> crossview_ap= True
2020-06-09 23:19:16,571:  >> full_vocab= False
2020-06-09 23:19:16,571:  >> metric= crossview_ap
2020-06-09 23:19:16,571:  >> mode= max
2020-06-09 23:19:16,571: Using module at multiview_rnn.MultiViewRNN
2020-06-09 23:19:16,673: Building net from config
2020-06-09 23:19:16,679: view1:
2020-06-09 23:19:16,685:  >> cell= GRU
2020-06-09 23:19:16,685:  >> input_size= 108
2020-06-09 23:19:16,685:  >> hidden_size= 512
2020-06-09 23:19:16,685:  >> bidirectional= True
2020-06-09 23:19:16,685:  >> num_layers= 6
2020-06-09 23:19:16,685:  >> dropout between layers= 0.4
2020-06-09 23:19:16,979: view2:
2020-06-09 23:19:16,984:  >> cell= GRU
2020-06-09 23:19:16,984:  >> input_size= 64
2020-06-09 23:19:16,984:  >> hidden_size= 512
2020-06-09 23:19:16,984:  >> bidirectional= True
2020-06-09 23:19:16,984:  >> num_layers= 2
2020-06-09 23:19:16,984:  >> dropout between layers= 0.4
2020-06-09 23:19:16,984:  >> num input embeddings= 45
2020-06-09 23:19:20,553: Using module at optim.adam.Adam
2020-06-09 23:19:20,570: Building optim from config
2020-06-09 23:19:20,570:  >> lr= 0.001
2020-06-09 23:19:20,570:  >> betas= (0.9, 0.999)
2020-06-09 23:19:20,571:  >> eps= 1e-08
2020-06-09 23:19:20,571:  >> weight_decay= 0
2020-06-09 23:19:20,571:  >> amsgrad= False
2020-06-09 23:19:20,571:  >> min_lr= 1e-07
2020-06-09 23:19:20,574: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-09 23:19:20,617: Building sched from config
2020-06-09 23:19:20,617:  >> optim= Adam
2020-06-09 23:19:20,617:  >> decay lr by 0.1
2020-06-09 23:19:20,617:  >> eval_fn= MultiViewAP
2020-06-09 23:19:20,621:  >> patience=4
2020-06-09 23:19:20,621:  >> revert=True
2020-06-09 23:19:20,641: loaded save/MultiViewDataset_IndividualWords.780.pth
2020-06-09 23:19:20,641: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-09 23:19:20,766: loaded save/MultiViewRNN.780.pth
2020-06-09 23:19:20,766: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-09 23:19:20,935: loaded save/Adam.780.pth
2020-06-09 23:19:20,936: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-09 23:19:20,943: loaded save/ReduceLROnPlateau.780.pth
2020-06-09 23:19:20,943: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-09 23:19:20,944: epoch=20.00 global_step=780 lr=0.001 start_iter=0
2020-06-09 23:19:20,944: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 23:22:30,859: 0) loss=0.101 grad_norm=6.08 num_segments=256 num_words=204
2020-06-09 23:25:21,419: 1) loss=0.110 grad_norm=11.32 num_segments=256 num_words=215
2020-06-09 23:28:00,255: 2) loss=0.126 grad_norm=7.83 num_segments=256 num_words=208
2020-06-09 23:30:27,641: 3) loss=0.134 grad_norm=20.35 num_segments=256 num_words=214
2020-06-09 23:32:41,389: 4) loss=0.247 grad_norm=10.34 num_segments=256 num_words=218
2020-06-09 23:34:45,080: 5) loss=0.175 grad_norm=15.82 num_segments=256 num_words=206
2020-06-09 23:36:35,547: 6) loss=0.160 grad_norm=10.79 num_segments=256 num_words=212
2020-06-09 23:38:13,676: 7) loss=0.182 grad_norm=13.39 num_segments=256 num_words=203
2020-06-09 23:39:54,991: 8) loss=0.213 grad_norm=25.35 num_segments=256 num_words=212
2020-06-09 23:41:32,914: 9) loss=0.208 grad_norm=21.27 num_segments=256 num_words=211
2020-06-09 23:43:13,628: 10) loss=0.166 grad_norm=14.21 num_segments=256 num_words=213
2020-06-09 23:44:51,747: 11) loss=0.316 grad_norm=16.01 num_segments=256 num_words=218
2020-06-09 23:46:29,673: 12) loss=0.199 grad_norm=22.38 num_segments=256 num_words=200
2020-06-09 23:48:07,552: 13) loss=0.175 grad_norm=15.79 num_segments=256 num_words=214
2020-06-09 23:49:49,238: 14) loss=0.206 grad_norm=23.15 num_segments=256 num_words=211
2020-06-09 23:51:26,949: 15) loss=0.190 grad_norm=18.67 num_segments=256 num_words=195
2020-06-09 23:53:05,353: 16) loss=0.172 grad_norm=17.53 num_segments=256 num_words=216
2020-06-09 23:54:44,415: 17) loss=0.173 grad_norm=21.10 num_segments=256 num_words=215
2020-06-09 23:56:22,604: 18) loss=0.199 grad_norm=20.81 num_segments=256 num_words=195
2020-06-09 23:58:04,923: 19) loss=0.202 grad_norm=18.71 num_segments=256 num_words=202
2020-06-09 23:59:43,403: 20) loss=0.252 grad_norm=37.74 num_segments=256 num_words=207
2020-06-10 00:01:21,406: 21) loss=0.187 grad_norm=26.66 num_segments=256 num_words=209
2020-06-10 00:02:59,242: 22) loss=0.181 grad_norm=14.36 num_segments=256 num_words=216
2020-06-10 00:04:37,479: 23) loss=0.186 grad_norm=28.04 num_segments=256 num_words=213
2020-06-10 00:06:21,034: 24) loss=0.189 grad_norm=39.47 num_segments=256 num_words=215
2020-06-10 00:07:59,871: 25) loss=0.178 grad_norm=14.74 num_segments=256 num_words=218
2020-06-10 00:09:39,014: 26) loss=0.171 grad_norm=13.95 num_segments=256 num_words=220
2020-06-10 00:11:18,204: 27) loss=0.192 grad_norm=20.11 num_segments=256 num_words=195
2020-06-10 00:12:57,615: 28) loss=0.177 grad_norm=14.52 num_segments=256 num_words=214
2020-06-10 00:14:36,475: 29) loss=0.206 grad_norm=15.25 num_segments=256 num_words=216
2020-06-10 00:16:15,020: 30) loss=0.175 grad_norm=16.35 num_segments=256 num_words=210
2020-06-10 00:18:01,705: 31) loss=0.191 grad_norm=21.22 num_segments=256 num_words=223
2020-06-10 00:19:41,567: 32) loss=0.191 grad_norm=16.94 num_segments=256 num_words=210
2020-06-10 00:21:20,792: 33) loss=0.177 grad_norm=17.41 num_segments=256 num_words=218
2020-06-10 00:23:00,730: 34) loss=0.186 grad_norm=19.51 num_segments=256 num_words=211
2020-06-10 00:24:40,920: 35) loss=0.188 grad_norm=23.45 num_segments=256 num_words=215
2020-06-10 00:26:20,297: 36) loss=0.181 grad_norm=26.11 num_segments=256 num_words=212
2020-06-10 00:28:00,519: 37) loss=0.191 grad_norm=17.67 num_segments=256 num_words=211
2020-06-10 00:29:31,890: 38) loss=0.197 grad_norm=18.37 num_segments=243 num_words=199
2020-06-10 00:29:31,909: epoch= 21.00
2020-06-10 00:29:31,909:  >> time to evaluate and save:
2020-06-10 00:29:31,962: saved save/MultiViewDataset_IndividualWords.819.pth
2020-06-10 00:29:31,965: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 00:29:31,972: saved MultiViewDataset_IndividualWords successfully
2020-06-10 00:29:33,315: saved save/MultiViewRNN.819.pth
2020-06-10 00:29:33,317: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 00:29:33,369: saved MultiViewRNN successfully
2020-06-10 00:29:35,982: saved save/Adam.819.pth
2020-06-10 00:29:35,985: most_recent linked save/Adam.most_recent.pth
2020-06-10 00:29:36,028: saved Adam successfully
2020-06-10 00:29:36,031: saved save/ReduceLROnPlateau.819.pth
2020-06-10 00:29:36,033: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 00:29:36,061: saved ReduceLROnPlateau successfully
2020-06-10 00:29:36,063: saved config successfully
2020-06-10 00:31:14,907:   >> crossview_ap=0.690 (10966 x 3921 pairs)
2020-06-10 00:32:08,969:   >> acoustic_ap=0.747 (10966 choose 2 pairs)
2020-06-10 00:32:08,972: best_so_far= 0.690 at 819
2020-06-10 00:32:08,978: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 00:32:09,027: saved MultiViewDataset_IndividualWords successfully
2020-06-10 00:32:09,034: best linked save/MultiViewRNN.best.pth
2020-06-10 00:32:09,083: saved MultiViewRNN successfully
2020-06-10 00:32:09,088: best linked save/Adam.best.pth
2020-06-10 00:32:09,121: saved Adam successfully
2020-06-10 00:32:09,123: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 00:32:09,143: saved ReduceLROnPlateau successfully
2020-06-10 00:32:10,129: epoch=21.00 global_step=819 lr=0.001 start_iter=0
2020-06-10 00:32:10,129: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 00:33:51,508: 0) loss=0.189 grad_norm=23.11 num_segments=256 num_words=215
2020-06-10 00:35:39,821: 1) loss=0.179 grad_norm=21.29 num_segments=256 num_words=217
2020-06-10 00:37:17,367: 2) loss=0.202 grad_norm=28.63 num_segments=256 num_words=207
2020-06-10 00:38:55,271: 3) loss=0.297 grad_norm=18.44 num_segments=256 num_words=213
2020-06-10 00:40:33,534: 4) loss=0.191 grad_norm=13.37 num_segments=256 num_words=211
2020-06-10 00:42:11,400: 5) loss=0.181 grad_norm=39.74 num_segments=256 num_words=204
2020-06-10 00:43:50,374: 6) loss=0.197 grad_norm=10.83 num_segments=256 num_words=203
2020-06-10 00:45:28,221: 7) loss=0.170 grad_norm=11.97 num_segments=256 num_words=210
2020-06-10 00:47:05,732: 8) loss=0.178 grad_norm=12.56 num_segments=256 num_words=208
2020-06-10 00:48:43,766: 9) loss=0.187 grad_norm=18.33 num_segments=256 num_words=211
2020-06-10 00:50:22,071: 10) loss=0.206 grad_norm=32.24 num_segments=256 num_words=205
2020-06-10 00:51:59,718: 11) loss=0.167 grad_norm=13.37 num_segments=256 num_words=214
2020-06-10 00:53:49,218: 12) loss=0.200 grad_norm=20.33 num_segments=256 num_words=198
2020-06-10 00:55:27,858: 13) loss=0.202 grad_norm=27.57 num_segments=256 num_words=216
2020-06-10 00:57:05,882: 14) loss=0.181 grad_norm=23.87 num_segments=256 num_words=214
2020-06-10 00:58:44,680: 15) loss=0.184 grad_norm=13.07 num_segments=256 num_words=212
2020-06-10 01:00:24,405: 16) loss=0.189 grad_norm=23.31 num_segments=256 num_words=210
2020-06-10 01:02:02,287: 17) loss=0.183 grad_norm=17.04 num_segments=256 num_words=213
2020-06-10 01:03:40,995: 18) loss=0.177 grad_norm=17.33 num_segments=256 num_words=221
2020-06-10 01:05:19,945: 19) loss=0.171 grad_norm=16.63 num_segments=256 num_words=224
2020-06-10 01:06:58,320: 20) loss=0.228 grad_norm=24.48 num_segments=256 num_words=211
2020-06-10 01:08:36,543: 21) loss=0.192 grad_norm=16.58 num_segments=256 num_words=212
2020-06-10 01:10:15,020: 22) loss=0.185 grad_norm=16.28 num_segments=256 num_words=209
2020-06-10 01:11:53,340: 23) loss=0.207 grad_norm=21.06 num_segments=256 num_words=195
2020-06-10 01:13:33,315: 24) loss=0.169 grad_norm=13.00 num_segments=256 num_words=214
2020-06-10 01:15:13,987: 25) loss=0.175 grad_norm=23.47 num_segments=256 num_words=207
2020-06-10 01:17:06,336: 26) loss=0.196 grad_norm=13.16 num_segments=256 num_words=212
2020-06-10 01:18:44,785: 27) loss=0.237 grad_norm=21.59 num_segments=256 num_words=209
2020-06-10 01:20:23,504: 28) loss=0.174 grad_norm=17.41 num_segments=256 num_words=215
2020-06-10 01:22:02,972: 29) loss=0.201 grad_norm=23.70 num_segments=256 num_words=198
2020-06-10 01:23:42,813: 30) loss=0.179 grad_norm=32.23 num_segments=256 num_words=220
2020-06-10 01:25:22,449: 31) loss=0.186 grad_norm=15.90 num_segments=256 num_words=207
2020-06-10 01:27:01,918: 32) loss=0.187 grad_norm=25.77 num_segments=256 num_words=217
2020-06-10 01:28:42,116: 33) loss=0.192 grad_norm=19.95 num_segments=256 num_words=212
2020-06-10 01:30:22,479: 34) loss=0.193 grad_norm=13.79 num_segments=256 num_words=201
2020-06-10 01:32:03,646: 35) loss=0.214 grad_norm=21.41 num_segments=256 num_words=212
2020-06-10 01:33:44,742: 36) loss=0.190 grad_norm=18.22 num_segments=256 num_words=207
2020-06-10 01:35:24,624: 37) loss=0.215 grad_norm=16.33 num_segments=256 num_words=209
2020-06-10 01:37:04,734: 38) loss=0.189 grad_norm=20.03 num_segments=243 num_words=197
2020-06-10 01:37:10,446: epoch= 22.00
2020-06-10 01:37:10,447:  >> time to evaluate and save:
2020-06-10 01:37:11,478: saved save/MultiViewDataset_IndividualWords.858.pth
2020-06-10 01:37:14,073: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 01:37:14,081: saved MultiViewDataset_IndividualWords successfully
2020-06-10 01:37:15,543: saved save/MultiViewRNN.858.pth
2020-06-10 01:37:20,349: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 01:37:33,756: saved MultiViewRNN successfully
2020-06-10 01:37:41,279: saved save/Adam.858.pth
2020-06-10 01:37:43,236: most_recent linked save/Adam.most_recent.pth
2020-06-10 01:37:43,248: saved Adam successfully
2020-06-10 01:37:43,251: saved save/ReduceLROnPlateau.858.pth
2020-06-10 01:37:43,290: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 01:37:43,298: saved ReduceLROnPlateau successfully
2020-06-10 01:37:43,301: saved config successfully
2020-06-10 01:40:18,208:   >> crossview_ap=0.691 (10966 x 3921 pairs)
2020-06-10 01:41:31,443:   >> acoustic_ap=0.748 (10966 choose 2 pairs)
2020-06-10 01:41:31,448: best_so_far= 0.691 at 858
2020-06-10 01:41:31,472: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 01:41:31,480: saved MultiViewDataset_IndividualWords successfully
2020-06-10 01:41:31,497: best linked save/MultiViewRNN.best.pth
2020-06-10 01:41:31,535: saved MultiViewRNN successfully
2020-06-10 01:41:31,598: best linked save/Adam.best.pth
2020-06-10 01:41:31,627: saved Adam successfully
2020-06-10 01:41:31,637: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 01:41:31,645: saved ReduceLROnPlateau successfully
2020-06-10 01:41:32,693: epoch=22.00 global_step=858 lr=0.001 start_iter=0
2020-06-10 01:41:32,693: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 01:43:25,564: 0) loss=0.181 grad_norm=19.78 num_segments=256 num_words=215
2020-06-10 01:45:19,148: 1) loss=0.176 grad_norm=16.41 num_segments=256 num_words=219
2020-06-10 01:47:13,043: 2) loss=0.187 grad_norm=15.58 num_segments=256 num_words=213
2020-06-10 01:49:06,961: 3) loss=0.181 grad_norm=8.22 num_segments=256 num_words=192
2020-06-10 01:51:08,178: 4) loss=0.171 grad_norm=14.20 num_segments=256 num_words=216
2020-06-10 01:53:30,594: 5) loss=0.185 grad_norm=18.09 num_segments=256 num_words=208
2020-06-10 01:55:24,781: 6) loss=0.183 grad_norm=13.32 num_segments=256 num_words=202
2020-06-10 01:57:21,159: 7) loss=0.172 grad_norm=20.13 num_segments=256 num_words=216
2020-06-10 01:59:17,228: 8) loss=0.170 grad_norm=21.22 num_segments=256 num_words=210
2020-06-10 02:01:14,460: 9) loss=0.175 grad_norm=21.04 num_segments=256 num_words=214
2020-06-10 02:03:11,079: 10) loss=0.197 grad_norm=29.65 num_segments=256 num_words=206
2020-06-10 02:05:07,365: 11) loss=0.172 grad_norm=17.45 num_segments=256 num_words=206
2020-06-10 02:07:04,292: 12) loss=0.195 grad_norm=19.93 num_segments=256 num_words=216
2020-06-10 02:09:01,803: 13) loss=0.169 grad_norm=25.86 num_segments=256 num_words=218
2020-06-10 02:10:58,937: 14) loss=0.203 grad_norm=15.48 num_segments=256 num_words=211
2020-06-10 02:12:56,351: 15) loss=0.178 grad_norm=19.77 num_segments=256 num_words=214
2020-06-10 02:14:52,194: 16) loss=0.191 grad_norm=19.27 num_segments=256 num_words=204
2020-06-10 02:16:49,212: 17) loss=0.191 grad_norm=18.79 num_segments=256 num_words=209
2020-06-10 02:18:46,473: 18) loss=0.183 grad_norm=28.94 num_segments=256 num_words=205
2020-06-10 02:20:43,550: 19) loss=0.216 grad_norm=21.53 num_segments=256 num_words=213
2020-06-10 02:22:40,773: 20) loss=0.214 grad_norm=17.76 num_segments=256 num_words=204
2020-06-10 02:24:37,717: 21) loss=0.253 grad_norm=18.98 num_segments=256 num_words=211
2020-06-10 02:26:35,498: 22) loss=0.190 grad_norm=20.31 num_segments=256 num_words=208
2020-06-10 02:28:32,774: 23) loss=0.176 grad_norm=11.78 num_segments=256 num_words=211
2020-06-10 02:30:27,834: 24) loss=0.189 grad_norm=22.39 num_segments=256 num_words=212
2020-06-10 02:32:25,994: 25) loss=0.178 grad_norm=17.57 num_segments=256 num_words=210
2020-06-10 02:34:53,349: 26) loss=0.167 grad_norm=15.13 num_segments=256 num_words=218
2020-06-10 02:36:48,751: 27) loss=0.179 grad_norm=23.38 num_segments=256 num_words=218
2020-06-10 02:38:45,742: 28) loss=0.165 grad_norm=14.35 num_segments=256 num_words=213
2020-06-10 02:40:42,996: 29) loss=0.183 grad_norm=22.06 num_segments=256 num_words=213
2020-06-10 02:42:40,636: 30) loss=0.168 grad_norm=14.21 num_segments=256 num_words=215
2020-06-10 02:44:38,460: 31) loss=0.177 grad_norm=16.62 num_segments=256 num_words=218
2020-06-10 02:46:36,918: 32) loss=0.198 grad_norm=28.65 num_segments=256 num_words=201
2020-06-10 02:48:35,577: 33) loss=0.188 grad_norm=17.17 num_segments=256 num_words=204
2020-06-10 02:50:32,925: 34) loss=0.170 grad_norm=18.53 num_segments=256 num_words=219
2020-06-10 02:52:31,175: 35) loss=0.213 grad_norm=16.40 num_segments=256 num_words=203
2020-06-10 02:54:28,166: 36) loss=0.201 grad_norm=13.56 num_segments=256 num_words=196
2020-06-10 02:56:25,505: 37) loss=0.172 grad_norm=21.74 num_segments=256 num_words=208
2020-06-10 02:58:11,598: 38) loss=0.249 grad_norm=25.64 num_segments=243 num_words=196
2020-06-10 02:58:11,619: epoch= 23.00
2020-06-10 02:58:11,619:  >> time to evaluate and save:
2020-06-10 02:58:11,671: saved save/MultiViewDataset_IndividualWords.897.pth
2020-06-10 02:58:11,716: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 02:58:11,724: saved MultiViewDataset_IndividualWords successfully
2020-06-10 02:58:13,144: saved save/MultiViewRNN.897.pth
2020-06-10 02:58:13,214: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 02:58:13,231: saved MultiViewRNN successfully
2020-06-10 02:58:15,767: saved save/Adam.897.pth
2020-06-10 02:58:15,810: most_recent linked save/Adam.most_recent.pth
2020-06-10 02:58:15,821: saved Adam successfully
2020-06-10 02:58:15,824: saved save/ReduceLROnPlateau.897.pth
2020-06-10 02:58:15,841: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 02:58:15,849: saved ReduceLROnPlateau successfully
2020-06-10 02:58:15,852: saved config successfully
2020-06-10 03:00:14,691:   >> crossview_ap=0.685 (10966 x 3921 pairs)
2020-06-10 03:01:37,693:   >> acoustic_ap=0.735 (10966 choose 2 pairs)
2020-06-10 03:01:37,698: best_so_far= 0.691 at 858
2020-06-10 03:01:38,482: epoch=23.00 global_step=897 lr=0.001 start_iter=0
2020-06-10 03:01:38,483: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 03:03:36,878: 0) loss=0.203 grad_norm=22.47 num_segments=256 num_words=211
2020-06-10 03:05:36,077: 1) loss=0.185 grad_norm=29.52 num_segments=256 num_words=217
2020-06-10 03:07:33,508: 2) loss=0.177 grad_norm=30.10 num_segments=256 num_words=207
2020-06-10 03:09:30,376: 3) loss=0.189 grad_norm=43.46 num_segments=256 num_words=213
2020-06-10 03:11:27,862: 4) loss=0.173 grad_norm=16.26 num_segments=256 num_words=211
2020-06-10 03:13:25,549: 5) loss=0.190 grad_norm=19.09 num_segments=256 num_words=209
2020-06-10 03:15:23,500: 6) loss=0.171 grad_norm=12.37 num_segments=256 num_words=211
2020-06-10 03:17:20,633: 7) loss=0.174 grad_norm=17.15 num_segments=256 num_words=207
2020-06-10 05:12:58,759: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-10 05:12:58,799: Using 1 GPU(s)
2020-06-10 05:12:58,799: Machine: 0 / 1
2020-06-10 05:12:58,823: Hyperparam tuning-------------------
2020-06-10 05:12:58,823: optim_lr: 0.001
2020-06-10 05:12:58,823: dropout (for both): 0.4
2020-06-10 05:12:58,823: margin: 0.4
2020-06-10 05:12:58,823: ------------------------------------
2020-06-10 05:12:58,825: Calling main function: multiview_trainer.train
2020-06-10 05:12:58,825: Using config file: train_config.json
2020-06-10 05:12:58,825: Using module at multiview_trainer.train
2020-06-10 05:13:00,036: Using module at multiview_vocab.MultiViewVocab
2020-06-10 05:13:00,040: Building vocab_data from config
2020-06-10 05:13:00,326:  >> min_count= 0
2020-06-10 05:13:00,326:  >> # words= 34323 (# removed= 0)
2020-06-10 05:13:00,326:  >> # subwords= 45
2020-06-10 05:13:00,326:     [laughter]= 1
2020-06-10 05:13:00,326:     [noise]= 2
2020-06-10 05:13:00,326:     [vocalized-noise]= 3
2020-06-10 05:13:00,326:     aa= 4
2020-06-10 05:13:00,326:     ae= 5
2020-06-10 05:13:00,326:     ah= 6
2020-06-10 05:13:00,326:     ao= 7
2020-06-10 05:13:00,326:     aw= 8
2020-06-10 05:13:00,327:     ax= 9
2020-06-10 05:13:00,327:     ay= 10
2020-06-10 05:13:00,327:     b= 11
2020-06-10 05:13:00,327:     ch= 12
2020-06-10 05:13:00,327:     d= 13
2020-06-10 05:13:00,327:     dh= 14
2020-06-10 05:13:00,327:     eh= 15
2020-06-10 05:13:00,327:     el= 16
2020-06-10 05:13:00,327:     en= 17
2020-06-10 05:13:00,327:     er= 18
2020-06-10 05:13:00,327:     ey= 19
2020-06-10 05:13:00,327:     f= 20
2020-06-10 05:13:00,327:     g= 21
2020-06-10 05:13:00,327:     hh= 22
2020-06-10 05:13:00,327:     ih= 23
2020-06-10 05:13:00,327:     iy= 24
2020-06-10 05:13:00,327:     jh= 25
2020-06-10 05:13:00,327:     k= 26
2020-06-10 05:13:00,327:     l= 27
2020-06-10 05:13:00,328:     m= 28
2020-06-10 05:13:00,328:     n= 29
2020-06-10 05:13:00,328:     ng= 30
2020-06-10 05:13:00,328:     ow= 31
2020-06-10 05:13:00,328:     oy= 32
2020-06-10 05:13:00,328:     p= 33
2020-06-10 05:13:00,328:     r= 34
2020-06-10 05:13:00,328:     s= 35
2020-06-10 05:13:00,328:     sh= 36
2020-06-10 05:13:00,328:     t= 37
2020-06-10 05:13:00,328:     th= 38
2020-06-10 05:13:00,328:     uh= 39
2020-06-10 05:13:00,328:     uw= 40
2020-06-10 05:13:00,328:     v= 41
2020-06-10 05:13:00,328:     w= 42
2020-06-10 05:13:00,328:     y= 43
2020-06-10 05:13:00,328:     z= 44
2020-06-10 05:13:00,328:     zh= 45
2020-06-10 05:13:00,344: Using module at data.batch_samplers.BatchSampler
2020-06-10 05:13:00,345: Building vocab_sampler from config
2020-06-10 05:13:00,346:  >> # examples= 34323
2020-06-10 05:13:00,346:  >> batch_size= 1000
2020-06-10 05:13:00,346:  >> shuffle= False
2020-06-10 05:13:00,354:  >> BatchSampler; 35 batches
2020-06-10 05:13:00,354: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 05:13:00,984: Building train_data from config
2020-06-10 05:13:08,049:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-10 05:13:08,050:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-10 05:13:08,050:  >> stack= False
2020-06-10 05:13:08,050:  >> seg_durs= (1, None)
2020-06-10 05:13:08,050:  >> # words= 9971 (# ignored= 0)
2020-06-10 05:13:08,050:  >> input_feat_dim= 108
2020-06-10 05:13:08,050:  >> input_num_subwords= 45
2020-06-10 05:13:08,050: Using module at data.batch_samplers.BatchSampler
2020-06-10 05:13:08,050: Building train_sampler from config
2020-06-10 05:13:08,051:  >> # examples= 9971
2020-06-10 05:13:08,051:  >> batch_size= 256
2020-06-10 05:13:08,051:  >> shuffle= True
2020-06-10 05:13:08,059:  >> BatchSampler; 39 batches
2020-06-10 05:13:08,059: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 05:13:08,059: Building dev_data from config
2020-06-10 05:13:15,993:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 05:13:15,994:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 05:13:15,994:  >> stack= False
2020-06-10 05:13:15,994:  >> seg_durs= (1, None)
2020-06-10 05:13:15,994:  >> # words= 10966 (# ignored= 0)
2020-06-10 05:13:15,994:  >> input_feat_dim= 108
2020-06-10 05:13:15,994:  >> input_num_subwords= 45
2020-06-10 05:13:15,994: Using module at data.batch_samplers.BatchSampler
2020-06-10 05:13:15,994: Building dev_sampler from config
2020-06-10 05:13:15,995:  >> # examples= 10966
2020-06-10 05:13:15,995:  >> batch_size= 256
2020-06-10 05:13:15,995:  >> shuffle= False
2020-06-10 05:13:15,997:  >> BatchSampler; 43 batches
2020-06-10 05:13:15,997: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 05:13:15,997: Building test_data from config
2020-06-10 05:13:22,975:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 05:13:22,976:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 05:13:22,976:  >> stack= False
2020-06-10 05:13:22,976:  >> seg_durs= (1, None)
2020-06-10 05:13:22,976:  >> # words= 11024 (# ignored= 0)
2020-06-10 05:13:22,976:  >> input_feat_dim= 108
2020-06-10 05:13:22,976:  >> input_num_subwords= 45
2020-06-10 05:13:22,976: Using module at data.batch_samplers.BatchSampler
2020-06-10 05:13:22,976: Building test_sampler from config
2020-06-10 05:13:22,977:  >> # examples= 11024
2020-06-10 05:13:22,977:  >> batch_size= 256
2020-06-10 05:13:22,977:  >> shuffle= False
2020-06-10 05:13:22,980:  >> BatchSampler; 44 batches
2020-06-10 05:13:22,980: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-10 05:13:22,984: Building loss from config
2020-06-10 05:13:22,985:  >> margin= 0.4
2020-06-10 05:13:22,985:  >> k= 16
2020-06-10 05:13:22,985:  >> min_k= 8
2020-06-10 05:13:22,985:  >> extra= 0
2020-06-10 05:13:22,985:  >> average= False
2020-06-10 05:13:22,985:  >> margin_max= 0.5
2020-06-10 05:13:22,985:  >> threshold_max= 9
2020-06-10 05:13:22,985:  >> using obj0+2
2020-06-10 05:13:22,986: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 05:13:23,010: Building eval from config
2020-06-10 05:13:23,011:  >> acoustic_ap= True
2020-06-10 05:13:23,011:  >> crossview_ap= True
2020-06-10 05:13:23,011:  >> full_vocab= False
2020-06-10 05:13:23,011:  >> metric= crossview_ap
2020-06-10 05:13:23,011:  >> mode= max
2020-06-10 05:13:23,011: Using module at multiview_rnn.MultiViewRNN
2020-06-10 05:13:23,018: Building net from config
2020-06-10 05:13:23,019: view1:
2020-06-10 05:13:23,020:  >> cell= GRU
2020-06-10 05:13:23,020:  >> input_size= 108
2020-06-10 05:13:23,020:  >> hidden_size= 512
2020-06-10 05:13:23,020:  >> bidirectional= True
2020-06-10 05:13:23,020:  >> num_layers= 6
2020-06-10 05:13:23,020:  >> dropout between layers= 0.4
2020-06-10 05:13:23,234: view2:
2020-06-10 05:13:23,235:  >> cell= GRU
2020-06-10 05:13:23,235:  >> input_size= 64
2020-06-10 05:13:23,235:  >> hidden_size= 512
2020-06-10 05:13:23,235:  >> bidirectional= True
2020-06-10 05:13:23,235:  >> num_layers= 2
2020-06-10 05:13:23,235:  >> dropout between layers= 0.4
2020-06-10 05:13:23,235:  >> num input embeddings= 45
2020-06-10 05:13:26,093: Using module at optim.adam.Adam
2020-06-10 05:13:26,095: Building optim from config
2020-06-10 05:13:26,096:  >> lr= 0.001
2020-06-10 05:13:26,096:  >> betas= (0.9, 0.999)
2020-06-10 05:13:26,096:  >> eps= 1e-08
2020-06-10 05:13:26,096:  >> weight_decay= 0
2020-06-10 05:13:26,096:  >> amsgrad= False
2020-06-10 05:13:26,096:  >> min_lr= 1e-07
2020-06-10 05:13:26,097: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-10 05:13:26,101: Building sched from config
2020-06-10 05:13:26,101:  >> optim= Adam
2020-06-10 05:13:26,102:  >> decay lr by 0.1
2020-06-10 05:13:26,102:  >> eval_fn= MultiViewAP
2020-06-10 05:13:26,102:  >> patience=4
2020-06-10 05:13:26,102:  >> revert=True
2020-06-10 05:13:26,149: loaded save/MultiViewDataset_IndividualWords.897.pth
2020-06-10 05:13:26,149: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-10 05:13:28,284: loaded save/MultiViewRNN.897.pth
2020-06-10 05:13:28,371: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-10 05:13:32,770: loaded save/Adam.897.pth
2020-06-10 05:13:32,770: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-10 05:13:32,794: loaded save/ReduceLROnPlateau.897.pth
2020-06-10 05:13:32,795: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-10 05:13:32,795: epoch=23.00 global_step=897 lr=0.001 start_iter=0
2020-06-10 05:13:32,795: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 05:15:52,718: 0) loss=0.111 grad_norm=15.14 num_segments=256 num_words=211
2020-06-10 05:17:42,764: 1) loss=0.109 grad_norm=19.75 num_segments=256 num_words=217
2020-06-10 05:19:25,888: 2) loss=0.111 grad_norm=22.03 num_segments=256 num_words=207
2020-06-10 05:21:00,613: 3) loss=0.125 grad_norm=12.51 num_segments=256 num_words=213
2020-06-10 05:22:28,284: 4) loss=0.127 grad_norm=7.14 num_segments=256 num_words=211
2020-06-10 05:23:48,541: 5) loss=0.152 grad_norm=12.88 num_segments=256 num_words=209
2020-06-10 05:24:59,253: 6) loss=0.151 grad_norm=8.05 num_segments=256 num_words=211
2020-06-10 05:26:02,286: 7) loss=0.174 grad_norm=18.82 num_segments=256 num_words=207
2020-06-10 05:27:08,306: 8) loss=0.166 grad_norm=12.86 num_segments=256 num_words=215
2020-06-10 05:28:12,255: 9) loss=0.181 grad_norm=16.53 num_segments=256 num_words=217
2020-06-10 05:29:19,008: 10) loss=0.179 grad_norm=17.15 num_segments=256 num_words=215
2020-06-10 05:30:22,476: 11) loss=0.224 grad_norm=16.28 num_segments=256 num_words=204
2020-06-10 05:31:26,336: 12) loss=0.178 grad_norm=12.48 num_segments=256 num_words=213
2020-06-10 05:32:32,911: 13) loss=0.186 grad_norm=14.09 num_segments=256 num_words=214
2020-06-10 05:33:39,794: 14) loss=0.183 grad_norm=20.90 num_segments=256 num_words=211
2020-06-10 05:34:43,011: 15) loss=0.183 grad_norm=15.75 num_segments=256 num_words=209
2020-06-10 05:35:46,239: 16) loss=0.186 grad_norm=12.77 num_segments=256 num_words=215
2020-06-10 05:36:49,618: 17) loss=0.182 grad_norm=16.81 num_segments=256 num_words=206
2020-06-10 05:37:56,236: 18) loss=0.188 grad_norm=16.51 num_segments=256 num_words=206
2020-06-10 05:39:04,177: 19) loss=0.170 grad_norm=14.93 num_segments=256 num_words=207
2020-06-10 05:40:07,300: 20) loss=0.188 grad_norm=17.76 num_segments=256 num_words=212
2020-06-10 05:41:10,383: 21) loss=0.195 grad_norm=21.42 num_segments=256 num_words=204
2020-06-10 05:42:13,595: 22) loss=0.177 grad_norm=21.13 num_segments=256 num_words=214
2020-06-10 05:43:16,943: 23) loss=0.183 grad_norm=11.55 num_segments=256 num_words=218
2020-06-10 05:44:26,673: 24) loss=0.170 grad_norm=13.37 num_segments=256 num_words=207
2020-06-10 05:45:32,362: 25) loss=0.182 grad_norm=13.70 num_segments=256 num_words=202
2020-06-10 05:46:35,484: 26) loss=0.177 grad_norm=17.71 num_segments=256 num_words=212
2020-06-10 05:47:38,751: 27) loss=0.178 grad_norm=21.58 num_segments=256 num_words=216
2020-06-10 05:48:46,579: 28) loss=0.174 grad_norm=13.86 num_segments=256 num_words=196
2020-06-10 05:49:49,718: 29) loss=0.177 grad_norm=15.12 num_segments=256 num_words=208
2020-06-10 05:50:54,682: 30) loss=0.187 grad_norm=15.87 num_segments=256 num_words=209
2020-06-10 05:52:09,395: 31) loss=0.181 grad_norm=16.70 num_segments=256 num_words=204
2020-06-10 05:53:12,252: 32) loss=0.184 grad_norm=14.47 num_segments=256 num_words=206
2020-06-10 05:54:15,969: 33) loss=0.187 grad_norm=27.61 num_segments=256 num_words=206
2020-06-10 05:55:18,702: 34) loss=0.188 grad_norm=19.07 num_segments=256 num_words=213
2020-06-10 05:56:23,398: 35) loss=0.176 grad_norm=18.30 num_segments=256 num_words=204
2020-06-10 05:57:26,106: 36) loss=0.188 grad_norm=18.44 num_segments=256 num_words=208
2020-06-10 05:58:34,117: 37) loss=0.185 grad_norm=24.35 num_segments=256 num_words=216
2020-06-10 05:59:33,583: 38) loss=0.185 grad_norm=20.66 num_segments=243 num_words=197
2020-06-10 05:59:33,595: epoch= 24.00
2020-06-10 05:59:33,596:  >> time to evaluate and save:
2020-06-10 05:59:33,637: saved save/MultiViewDataset_IndividualWords.936.pth
2020-06-10 05:59:33,669: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 05:59:33,678: saved MultiViewDataset_IndividualWords successfully
2020-06-10 05:59:35,005: saved save/MultiViewRNN.936.pth
2020-06-10 05:59:35,058: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 05:59:35,810: saved MultiViewRNN successfully
2020-06-10 05:59:38,376: saved save/Adam.936.pth
2020-06-10 05:59:38,456: most_recent linked save/Adam.most_recent.pth
2020-06-10 05:59:39,226: saved Adam successfully
2020-06-10 05:59:39,229: saved save/ReduceLROnPlateau.936.pth
2020-06-10 05:59:39,230: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 05:59:39,240: saved ReduceLROnPlateau successfully
2020-06-10 05:59:39,241: saved config successfully
2020-06-10 06:01:10,780:   >> crossview_ap=0.690 (10966 x 3921 pairs)
2020-06-10 06:02:10,698:   >> acoustic_ap=0.749 (10966 choose 2 pairs)
2020-06-10 06:02:10,707: best_so_far= 0.691 at 858
2020-06-10 06:02:12,157: epoch=24.00 global_step=936 lr=0.001 start_iter=0
2020-06-10 06:02:12,157: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 06:03:17,458: 0) loss=0.192 grad_norm=16.39 num_segments=256 num_words=214
2020-06-10 06:04:35,345: 1) loss=0.192 grad_norm=15.49 num_segments=256 num_words=210
2020-06-10 06:05:39,952: 2) loss=0.196 grad_norm=15.91 num_segments=256 num_words=193
2020-06-10 06:06:44,284: 3) loss=0.191 grad_norm=23.51 num_segments=256 num_words=219
2020-06-10 06:07:48,077: 4) loss=0.176 grad_norm=14.19 num_segments=256 num_words=209
2020-06-10 06:08:51,499: 5) loss=0.173 grad_norm=13.31 num_segments=256 num_words=218
2020-06-10 06:09:56,035: 6) loss=0.224 grad_norm=17.82 num_segments=256 num_words=218
2020-06-10 06:10:58,997: 7) loss=0.225 grad_norm=18.90 num_segments=256 num_words=206
2020-06-10 06:12:02,471: 8) loss=0.181 grad_norm=19.95 num_segments=256 num_words=215
2020-06-10 06:13:07,709: 9) loss=0.171 grad_norm=11.84 num_segments=256 num_words=211
2020-06-10 06:14:11,543: 10) loss=0.202 grad_norm=35.92 num_segments=256 num_words=221
2020-06-10 06:15:15,172: 11) loss=0.328 grad_norm=14.88 num_segments=256 num_words=212
2020-06-10 06:16:30,614: 12) loss=0.205 grad_norm=11.78 num_segments=256 num_words=210
2020-06-10 06:17:40,798: 13) loss=0.185 grad_norm=18.49 num_segments=256 num_words=213
2020-06-10 06:18:43,885: 14) loss=0.175 grad_norm=16.72 num_segments=256 num_words=211
2020-06-10 06:19:47,389: 15) loss=0.245 grad_norm=33.11 num_segments=256 num_words=201
2020-06-10 06:20:58,212: 16) loss=0.168 grad_norm=17.23 num_segments=256 num_words=208
2020-06-10 06:22:02,886: 17) loss=0.165 grad_norm=12.52 num_segments=256 num_words=214
2020-06-10 06:23:05,974: 18) loss=0.199 grad_norm=12.46 num_segments=256 num_words=206
2020-06-10 06:24:11,026: 19) loss=0.196 grad_norm=12.90 num_segments=256 num_words=202
2020-06-10 06:25:18,864: 20) loss=0.179 grad_norm=18.98 num_segments=256 num_words=212
2020-06-10 06:26:22,992: 21) loss=0.169 grad_norm=15.22 num_segments=256 num_words=223
2020-06-10 06:27:26,070: 22) loss=0.175 grad_norm=16.21 num_segments=256 num_words=205
2020-06-10 06:28:29,611: 23) loss=0.182 grad_norm=14.89 num_segments=256 num_words=211
2020-06-10 06:29:33,155: 24) loss=0.159 grad_norm=13.65 num_segments=256 num_words=219
2020-06-10 06:30:36,782: 25) loss=0.174 grad_norm=27.89 num_segments=256 num_words=209
2020-06-10 06:31:55,163: 26) loss=0.300 grad_norm=25.07 num_segments=256 num_words=208
2020-06-10 06:32:58,639: 27) loss=0.173 grad_norm=17.01 num_segments=256 num_words=217
2020-06-10 06:34:04,124: 28) loss=0.191 grad_norm=26.19 num_segments=256 num_words=209
2020-06-10 06:35:07,134: 29) loss=0.195 grad_norm=26.32 num_segments=256 num_words=213
2020-06-10 06:36:11,729: 30) loss=0.178 grad_norm=37.42 num_segments=256 num_words=210
2020-06-10 06:37:15,367: 31) loss=0.228 grad_norm=19.85 num_segments=256 num_words=215
2020-06-10 06:38:22,952: 32) loss=0.196 grad_norm=18.20 num_segments=256 num_words=203
2020-06-10 06:39:25,980: 33) loss=0.181 grad_norm=21.35 num_segments=256 num_words=208
2020-06-10 06:40:28,851: 34) loss=0.177 grad_norm=19.21 num_segments=256 num_words=210
2020-06-10 06:41:32,544: 35) loss=0.183 grad_norm=28.84 num_segments=256 num_words=215
2020-06-10 06:42:35,640: 36) loss=0.171 grad_norm=24.91 num_segments=256 num_words=205
2020-06-10 06:43:40,975: 37) loss=0.175 grad_norm=18.29 num_segments=256 num_words=199
2020-06-10 06:44:37,938: 38) loss=0.188 grad_norm=12.17 num_segments=243 num_words=192
2020-06-10 06:44:37,950: epoch= 25.00
2020-06-10 06:44:37,950:  >> time to evaluate and save:
2020-06-10 06:44:37,979: saved save/MultiViewDataset_IndividualWords.975.pth
2020-06-10 06:44:38,016: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 06:44:38,025: saved MultiViewDataset_IndividualWords successfully
2020-06-10 06:44:39,398: saved save/MultiViewRNN.975.pth
2020-06-10 06:44:39,416: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 06:44:39,428: saved MultiViewRNN successfully
2020-06-10 06:44:41,946: saved save/Adam.975.pth
2020-06-10 06:44:41,951: most_recent linked save/Adam.most_recent.pth
2020-06-10 06:44:41,965: saved Adam successfully
2020-06-10 06:44:41,967: saved save/ReduceLROnPlateau.975.pth
2020-06-10 06:44:41,974: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 06:44:41,983: saved ReduceLROnPlateau successfully
2020-06-10 06:44:41,985: saved config successfully
2020-06-10 06:46:08,736:   >> crossview_ap=0.691 (10966 x 3921 pairs)
2020-06-10 06:47:07,598:   >> acoustic_ap=0.749 (10966 choose 2 pairs)
2020-06-10 06:47:07,602: best_so_far= 0.691 at 975
2020-06-10 06:47:07,608: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 06:47:07,615: saved MultiViewDataset_IndividualWords successfully
2020-06-10 06:47:07,616: best linked save/MultiViewRNN.best.pth
2020-06-10 06:47:07,647: saved MultiViewRNN successfully
2020-06-10 06:47:07,678: best linked save/Adam.best.pth
2020-06-10 06:47:07,711: saved Adam successfully
2020-06-10 06:47:07,729: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 06:47:07,741: saved ReduceLROnPlateau successfully
2020-06-10 06:47:08,245: epoch=25.00 global_step=975 lr=0.001 start_iter=0
2020-06-10 06:47:08,245: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 06:48:14,672: 0) loss=0.195 grad_norm=23.76 num_segments=256 num_words=205
2020-06-10 06:49:18,707: 1) loss=0.195 grad_norm=24.22 num_segments=256 num_words=213
2020-06-10 06:50:22,113: 2) loss=0.177 grad_norm=20.07 num_segments=256 num_words=217
2020-06-10 06:51:27,448: 3) loss=0.193 grad_norm=26.63 num_segments=256 num_words=206
2020-06-10 06:52:33,004: 4) loss=0.180 grad_norm=26.55 num_segments=256 num_words=212
2020-06-10 06:53:59,227: 5) loss=0.174 grad_norm=40.90 num_segments=256 num_words=218
2020-06-10 06:55:03,072: 6) loss=0.327 grad_norm=19.91 num_segments=256 num_words=195
2020-06-10 06:56:06,754: 7) loss=0.213 grad_norm=20.00 num_segments=256 num_words=210
2020-06-10 06:57:10,991: 8) loss=0.169 grad_norm=12.52 num_segments=256 num_words=219
2020-06-10 06:58:14,522: 9) loss=0.179 grad_norm=17.20 num_segments=256 num_words=219
2020-06-10 06:59:19,133: 10) loss=0.174 grad_norm=9.88 num_segments=256 num_words=207
2020-06-10 07:00:25,256: 11) loss=0.193 grad_norm=12.69 num_segments=256 num_words=201
2020-06-10 07:01:28,950: 12) loss=0.189 grad_norm=8.99 num_segments=256 num_words=201
2020-06-10 07:02:32,566: 13) loss=0.217 grad_norm=17.47 num_segments=256 num_words=209
2020-06-10 07:03:35,730: 14) loss=0.210 grad_norm=14.29 num_segments=256 num_words=207
2020-06-10 07:04:38,006: 15) loss=0.200 grad_norm=18.31 num_segments=256 num_words=211
2020-06-10 07:05:40,111: 16) loss=0.272 grad_norm=20.31 num_segments=256 num_words=217
2020-06-10 07:06:42,426: 17) loss=0.227 grad_norm=12.02 num_segments=256 num_words=201
2020-06-10 07:07:54,053: 18) loss=0.188 grad_norm=26.02 num_segments=256 num_words=199
2020-06-10 07:08:56,487: 19) loss=0.172 grad_norm=15.42 num_segments=256 num_words=214
2020-06-10 07:09:59,431: 20) loss=0.185 grad_norm=14.30 num_segments=256 num_words=204
2020-06-10 07:11:03,695: 21) loss=0.175 grad_norm=14.01 num_segments=256 num_words=215
2020-06-10 07:12:10,687: 22) loss=0.170 grad_norm=17.69 num_segments=256 num_words=211
2020-06-10 07:13:16,614: 23) loss=0.186 grad_norm=25.12 num_segments=256 num_words=215
2020-06-10 07:14:19,415: 24) loss=0.235 grad_norm=11.26 num_segments=256 num_words=207
2020-06-10 07:15:34,658: 25) loss=0.253 grad_norm=17.69 num_segments=256 num_words=203
2020-06-10 07:17:11,371: 26) loss=0.170 grad_norm=13.97 num_segments=256 num_words=220
2020-06-10 07:18:13,973: 27) loss=0.195 grad_norm=17.06 num_segments=256 num_words=208
2020-06-10 07:19:16,334: 28) loss=0.210 grad_norm=13.42 num_segments=256 num_words=212
2020-06-10 07:20:21,948: 29) loss=0.173 grad_norm=12.68 num_segments=256 num_words=210
2020-06-10 07:21:26,382: 30) loss=0.167 grad_norm=17.54 num_segments=256 num_words=210
2020-06-10 07:22:31,940: 31) loss=0.180 grad_norm=9.61 num_segments=256 num_words=212
2020-06-10 07:23:34,870: 32) loss=0.173 grad_norm=15.21 num_segments=256 num_words=216
2020-06-10 07:24:38,145: 33) loss=0.173 grad_norm=33.35 num_segments=256 num_words=214
2020-06-10 07:25:51,319: 34) loss=0.171 grad_norm=18.63 num_segments=256 num_words=209
2020-06-10 07:26:53,836: 35) loss=0.174 grad_norm=17.61 num_segments=256 num_words=201
2020-06-10 07:27:59,304: 36) loss=0.187 grad_norm=18.83 num_segments=256 num_words=218
2020-06-10 07:29:02,761: 37) loss=0.170 grad_norm=19.54 num_segments=256 num_words=202
2020-06-10 07:30:03,640: 38) loss=0.174 grad_norm=19.52 num_segments=243 num_words=211
2020-06-10 07:30:03,658: epoch= 26.00
2020-06-10 07:30:03,658:  >> time to evaluate and save:
2020-06-10 07:30:03,698: saved save/MultiViewDataset_IndividualWords.1014.pth
2020-06-10 07:30:03,725: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 07:30:03,733: saved MultiViewDataset_IndividualWords successfully
2020-06-10 07:30:05,104: saved save/MultiViewRNN.1014.pth
2020-06-10 07:30:05,125: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 07:30:05,138: saved MultiViewRNN successfully
2020-06-10 07:30:07,711: saved save/Adam.1014.pth
2020-06-10 07:30:07,723: most_recent linked save/Adam.most_recent.pth
2020-06-10 07:30:07,734: saved Adam successfully
2020-06-10 07:30:07,736: saved save/ReduceLROnPlateau.1014.pth
2020-06-10 07:30:07,754: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 07:30:07,762: saved ReduceLROnPlateau successfully
2020-06-10 07:30:07,763: saved config successfully
2020-06-10 07:31:37,783:   >> crossview_ap=0.690 (10966 x 3921 pairs)
2020-06-10 07:32:45,863:   >> acoustic_ap=0.740 (10966 choose 2 pairs)
2020-06-10 07:32:45,866: best_so_far= 0.691 at 975
2020-06-10 07:32:46,556: epoch=26.00 global_step=1014 lr=0.001 start_iter=0
2020-06-10 07:32:46,556: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 07:33:58,517: 0) loss=0.170 grad_norm=18.27 num_segments=256 num_words=212
2020-06-10 07:35:05,094: 1) loss=0.244 grad_norm=15.07 num_segments=256 num_words=198
2020-06-10 07:36:17,585: 2) loss=0.198 grad_norm=12.36 num_segments=256 num_words=212
2020-06-10 07:37:20,984: 3) loss=0.179 grad_norm=14.27 num_segments=256 num_words=212
2020-06-10 07:38:23,603: 4) loss=0.178 grad_norm=14.95 num_segments=256 num_words=206
2020-06-10 07:39:31,989: 5) loss=0.185 grad_norm=14.63 num_segments=256 num_words=204
2020-06-10 07:40:40,895: 6) loss=0.174 grad_norm=28.74 num_segments=256 num_words=208
2020-06-10 07:41:44,030: 7) loss=0.177 grad_norm=18.47 num_segments=256 num_words=215
2020-06-10 07:42:54,097: 8) loss=0.229 grad_norm=12.19 num_segments=256 num_words=198
2020-06-10 07:43:57,923: 9) loss=0.180 grad_norm=9.89 num_segments=256 num_words=204
2020-06-10 07:45:03,760: 10) loss=0.176 grad_norm=17.80 num_segments=256 num_words=208
2020-06-10 07:46:15,465: 11) loss=0.218 grad_norm=14.03 num_segments=256 num_words=205
2020-06-10 07:47:18,579: 12) loss=0.196 grad_norm=12.88 num_segments=256 num_words=210
2020-06-10 07:48:21,359: 13) loss=0.191 grad_norm=14.78 num_segments=256 num_words=212
2020-06-10 07:50:03,740: 14) loss=0.203 grad_norm=19.73 num_segments=256 num_words=205
2020-06-10 07:51:06,617: 15) loss=0.171 grad_norm=16.03 num_segments=256 num_words=211
2020-06-10 07:52:09,622: 16) loss=0.167 grad_norm=12.18 num_segments=256 num_words=209
2020-06-10 07:53:12,521: 17) loss=0.173 grad_norm=19.87 num_segments=256 num_words=212
2020-06-10 07:54:16,159: 18) loss=0.216 grad_norm=24.84 num_segments=256 num_words=204
2020-06-10 07:55:19,049: 19) loss=0.214 grad_norm=15.17 num_segments=256 num_words=209
2020-06-10 07:56:22,150: 20) loss=0.186 grad_norm=18.65 num_segments=256 num_words=220
2020-06-10 07:57:24,801: 21) loss=0.191 grad_norm=18.93 num_segments=256 num_words=207
2020-06-10 07:58:27,533: 22) loss=0.177 grad_norm=11.64 num_segments=256 num_words=218
2020-06-10 07:59:30,449: 23) loss=0.191 grad_norm=20.54 num_segments=256 num_words=208
2020-06-10 08:00:34,236: 24) loss=0.188 grad_norm=19.22 num_segments=256 num_words=208
2020-06-10 08:01:36,978: 25) loss=0.202 grad_norm=31.59 num_segments=256 num_words=213
2020-06-10 08:02:39,726: 26) loss=0.209 grad_norm=37.17 num_segments=256 num_words=211
2020-06-10 08:03:42,903: 27) loss=0.182 grad_norm=18.39 num_segments=256 num_words=216
2020-06-10 08:04:45,624: 28) loss=0.201 grad_norm=15.72 num_segments=256 num_words=221
2020-06-10 08:05:48,563: 29) loss=0.232 grad_norm=14.50 num_segments=256 num_words=210
2020-06-10 08:06:51,294: 30) loss=0.173 grad_norm=14.96 num_segments=256 num_words=214
2020-06-10 08:07:54,493: 31) loss=0.176 grad_norm=17.25 num_segments=256 num_words=214
2020-06-10 08:09:00,692: 32) loss=0.183 grad_norm=17.06 num_segments=256 num_words=213
2020-06-10 08:10:06,655: 33) loss=0.213 grad_norm=14.73 num_segments=256 num_words=213
2020-06-10 08:11:09,566: 34) loss=0.187 grad_norm=7.71 num_segments=256 num_words=202
2020-06-10 08:12:12,991: 35) loss=0.171 grad_norm=11.04 num_segments=256 num_words=211
2020-06-10 08:13:17,713: 36) loss=0.183 grad_norm=15.44 num_segments=256 num_words=220
2020-06-10 08:14:21,042: 37) loss=0.204 grad_norm=18.61 num_segments=256 num_words=204
2020-06-10 08:15:17,695: 38) loss=0.189 grad_norm=9.47 num_segments=243 num_words=197
2020-06-10 08:15:17,712: epoch= 27.00
2020-06-10 08:15:17,712:  >> time to evaluate and save:
2020-06-10 08:15:18,320: saved save/MultiViewDataset_IndividualWords.1053.pth
2020-06-10 08:15:18,322: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 08:15:18,332: saved MultiViewDataset_IndividualWords successfully
2020-06-10 08:15:19,763: saved save/MultiViewRNN.1053.pth
2020-06-10 08:15:19,769: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 08:15:19,783: saved MultiViewRNN successfully
2020-06-10 08:15:22,352: saved save/Adam.1053.pth
2020-06-10 08:15:22,354: most_recent linked save/Adam.most_recent.pth
2020-06-10 08:15:22,366: saved Adam successfully
2020-06-10 08:15:22,369: saved save/ReduceLROnPlateau.1053.pth
2020-06-10 08:15:22,370: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 08:15:22,379: saved ReduceLROnPlateau successfully
2020-06-10 08:15:22,381: saved config successfully
2020-06-10 08:17:09,600:   >> crossview_ap=0.703 (10966 x 3921 pairs)
2020-06-10 08:18:35,429:   >> acoustic_ap=0.760 (10966 choose 2 pairs)
2020-06-10 08:18:35,434: best_so_far= 0.703 at 1053
2020-06-10 08:18:35,464: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 08:18:35,473: saved MultiViewDataset_IndividualWords successfully
2020-06-10 08:18:35,499: best linked save/MultiViewRNN.best.pth
2020-06-10 08:18:35,540: saved MultiViewRNN successfully
2020-06-10 08:18:35,555: best linked save/Adam.best.pth
2020-06-10 08:18:35,586: saved Adam successfully
2020-06-10 08:18:35,604: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 08:18:35,659: saved ReduceLROnPlateau successfully
2020-06-10 08:18:36,932: epoch=27.00 global_step=1053 lr=0.001 start_iter=0
2020-06-10 08:18:36,933: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 08:19:52,277: 0) loss=0.170 grad_norm=17.93 num_segments=256 num_words=216
2020-06-10 08:21:00,568: 1) loss=0.192 grad_norm=17.14 num_segments=256 num_words=211
2020-06-10 08:22:05,379: 2) loss=0.173 grad_norm=11.51 num_segments=256 num_words=211
2020-06-10 08:23:09,284: 3) loss=0.173 grad_norm=7.55 num_segments=256 num_words=219
2020-06-10 08:24:12,884: 4) loss=0.178 grad_norm=19.78 num_segments=256 num_words=205
2020-06-10 08:25:16,846: 5) loss=0.174 grad_norm=12.85 num_segments=256 num_words=212
2020-06-10 08:26:20,551: 6) loss=0.171 grad_norm=10.73 num_segments=256 num_words=204
2020-06-10 08:27:26,099: 7) loss=0.300 grad_norm=17.96 num_segments=256 num_words=214
2020-06-10 08:28:34,148: 8) loss=0.196 grad_norm=17.02 num_segments=256 num_words=217
2020-06-10 08:30:51,719: 9) loss=0.185 grad_norm=10.35 num_segments=256 num_words=213
2020-06-10 08:31:55,203: 10) loss=0.182 grad_norm=34.96 num_segments=256 num_words=197
2020-06-10 08:33:09,006: 11) loss=0.191 grad_norm=24.87 num_segments=256 num_words=207
2020-06-10 08:34:14,927: 12) loss=0.167 grad_norm=16.68 num_segments=256 num_words=218
2020-06-10 08:35:24,235: 13) loss=0.175 grad_norm=14.41 num_segments=256 num_words=211
2020-06-10 08:36:35,117: 14) loss=0.176 grad_norm=23.01 num_segments=256 num_words=214
2020-06-10 08:37:48,165: 15) loss=0.211 grad_norm=10.44 num_segments=256 num_words=199
2020-06-10 08:39:10,675: 16) loss=0.182 grad_norm=15.89 num_segments=256 num_words=203
2020-06-10 08:40:31,019: 17) loss=0.183 grad_norm=16.41 num_segments=256 num_words=208
2020-06-10 08:41:39,164: 18) loss=0.169 grad_norm=26.94 num_segments=256 num_words=217
2020-06-10 08:42:47,976: 19) loss=0.194 grad_norm=33.53 num_segments=256 num_words=206
2020-06-10 08:44:02,485: 20) loss=0.187 grad_norm=24.74 num_segments=256 num_words=204
2020-06-10 08:45:12,576: 21) loss=0.175 grad_norm=8.27 num_segments=256 num_words=211
2020-06-10 08:46:20,630: 22) loss=0.185 grad_norm=15.65 num_segments=256 num_words=213
2020-06-10 08:47:27,905: 23) loss=0.180 grad_norm=19.65 num_segments=256 num_words=206
2020-06-10 08:48:35,169: 24) loss=0.182 grad_norm=19.52 num_segments=256 num_words=216
2020-06-10 08:49:39,994: 25) loss=0.185 grad_norm=14.34 num_segments=256 num_words=211
2020-06-10 08:50:44,647: 26) loss=0.180 grad_norm=8.88 num_segments=256 num_words=206
2020-06-10 08:51:49,278: 27) loss=0.161 grad_norm=11.28 num_segments=256 num_words=227
2020-06-10 08:52:55,048: 28) loss=0.181 grad_norm=17.51 num_segments=256 num_words=210
2020-06-10 08:54:00,267: 29) loss=0.179 grad_norm=20.91 num_segments=256 num_words=222
2020-06-10 08:55:05,503: 30) loss=0.173 grad_norm=12.24 num_segments=256 num_words=214
2020-06-10 08:56:10,134: 31) loss=0.199 grad_norm=25.44 num_segments=256 num_words=208
2020-06-10 08:57:16,244: 32) loss=0.185 grad_norm=11.06 num_segments=256 num_words=214
2020-06-10 08:58:21,732: 33) loss=0.182 grad_norm=18.58 num_segments=256 num_words=221
2020-06-10 08:59:28,108: 34) loss=0.191 grad_norm=24.86 num_segments=256 num_words=212
2020-06-10 09:00:32,526: 35) loss=0.199 grad_norm=24.10 num_segments=256 num_words=212
2020-06-10 09:01:39,780: 36) loss=0.174 grad_norm=16.38 num_segments=256 num_words=205
2020-06-10 09:02:44,201: 37) loss=0.193 grad_norm=12.78 num_segments=256 num_words=204
2020-06-10 09:03:43,304: 38) loss=0.177 grad_norm=10.24 num_segments=243 num_words=193
2020-06-10 09:03:43,318: epoch= 28.00
2020-06-10 09:03:43,318:  >> time to evaluate and save:
2020-06-10 09:03:43,359: saved save/MultiViewDataset_IndividualWords.1092.pth
2020-06-10 09:03:43,365: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 09:03:43,374: saved MultiViewDataset_IndividualWords successfully
2020-06-10 09:03:44,859: saved save/MultiViewRNN.1092.pth
2020-06-10 09:03:44,867: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 09:03:44,882: saved MultiViewRNN successfully
2020-06-10 09:03:47,545: saved save/Adam.1092.pth
2020-06-10 09:03:47,580: most_recent linked save/Adam.most_recent.pth
2020-06-10 09:03:47,596: saved Adam successfully
2020-06-10 09:03:47,598: saved save/ReduceLROnPlateau.1092.pth
2020-06-10 09:03:47,625: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 09:03:47,637: saved ReduceLROnPlateau successfully
2020-06-10 09:03:47,639: saved config successfully
2020-06-10 09:05:35,808:   >> crossview_ap=0.699 (10966 x 3921 pairs)
2020-06-10 09:07:01,925:   >> acoustic_ap=0.753 (10966 choose 2 pairs)
2020-06-10 09:07:01,930: best_so_far= 0.703 at 1053
2020-06-10 09:07:03,712: epoch=28.00 global_step=1092 lr=0.001 start_iter=0
2020-06-10 09:07:03,713: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 09:08:23,868: 0) loss=0.204 grad_norm=13.21 num_segments=256 num_words=203
2020-06-10 09:09:30,027: 1) loss=0.153 grad_norm=15.62 num_segments=256 num_words=217
2020-06-10 09:10:41,107: 2) loss=0.189 grad_norm=9.50 num_segments=256 num_words=208
2020-06-10 09:11:53,252: 3) loss=0.198 grad_norm=16.81 num_segments=256 num_words=218
2020-06-10 09:13:08,183: 4) loss=0.196 grad_norm=14.67 num_segments=256 num_words=212
2020-06-10 09:13:28,139: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-10 09:13:28,189: Using 1 GPU(s)
2020-06-10 09:13:28,189: Machine: 0 / 1
2020-06-10 09:13:28,191: Hyperparam tuning-------------------
2020-06-10 09:13:28,191: optim_lr: 0.001
2020-06-10 09:13:28,191: dropout (for both): 0.4
2020-06-10 09:13:28,191: margin: 0.4
2020-06-10 09:13:28,191: ------------------------------------
2020-06-10 09:13:28,192: Calling main function: multiview_trainer.train
2020-06-10 09:13:28,192: Using config file: train_config.json
2020-06-10 09:13:28,192: Using module at multiview_trainer.train
2020-06-10 09:13:29,228: Using module at multiview_vocab.MultiViewVocab
2020-06-10 09:13:29,276: Building vocab_data from config
2020-06-10 09:13:29,613:  >> min_count= 0
2020-06-10 09:13:29,614:  >> # words= 34323 (# removed= 0)
2020-06-10 09:13:29,614:  >> # subwords= 45
2020-06-10 09:13:29,614:     [laughter]= 1
2020-06-10 09:13:29,614:     [noise]= 2
2020-06-10 09:13:29,614:     [vocalized-noise]= 3
2020-06-10 09:13:29,614:     aa= 4
2020-06-10 09:13:29,614:     ae= 5
2020-06-10 09:13:29,614:     ah= 6
2020-06-10 09:13:29,614:     ao= 7
2020-06-10 09:13:29,614:     aw= 8
2020-06-10 09:13:29,614:     ax= 9
2020-06-10 09:13:29,614:     ay= 10
2020-06-10 09:13:29,615:     b= 11
2020-06-10 09:13:29,615:     ch= 12
2020-06-10 09:13:29,615:     d= 13
2020-06-10 09:13:29,615:     dh= 14
2020-06-10 09:13:29,615:     eh= 15
2020-06-10 09:13:29,615:     el= 16
2020-06-10 09:13:29,615:     en= 17
2020-06-10 09:13:29,615:     er= 18
2020-06-10 09:13:29,615:     ey= 19
2020-06-10 09:13:29,615:     f= 20
2020-06-10 09:13:29,615:     g= 21
2020-06-10 09:13:29,615:     hh= 22
2020-06-10 09:13:29,615:     ih= 23
2020-06-10 09:13:29,615:     iy= 24
2020-06-10 09:13:29,615:     jh= 25
2020-06-10 09:13:29,615:     k= 26
2020-06-10 09:13:29,615:     l= 27
2020-06-10 09:13:29,615:     m= 28
2020-06-10 09:13:29,615:     n= 29
2020-06-10 09:13:29,616:     ng= 30
2020-06-10 09:13:29,616:     ow= 31
2020-06-10 09:13:29,616:     oy= 32
2020-06-10 09:13:29,616:     p= 33
2020-06-10 09:13:29,616:     r= 34
2020-06-10 09:13:29,616:     s= 35
2020-06-10 09:13:29,616:     sh= 36
2020-06-10 09:13:29,616:     t= 37
2020-06-10 09:13:29,616:     th= 38
2020-06-10 09:13:29,616:     uh= 39
2020-06-10 09:13:29,616:     uw= 40
2020-06-10 09:13:29,616:     v= 41
2020-06-10 09:13:29,616:     w= 42
2020-06-10 09:13:29,616:     y= 43
2020-06-10 09:13:29,616:     z= 44
2020-06-10 09:13:29,616:     zh= 45
2020-06-10 09:13:29,637: Using module at data.batch_samplers.BatchSampler
2020-06-10 09:13:29,639: Building vocab_sampler from config
2020-06-10 09:13:29,640:  >> # examples= 34323
2020-06-10 09:13:29,640:  >> batch_size= 1000
2020-06-10 09:13:29,640:  >> shuffle= False
2020-06-10 09:13:29,648:  >> BatchSampler; 35 batches
2020-06-10 09:13:29,648: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 09:13:29,851: Building train_data from config
2020-06-10 09:13:37,075:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-10 09:13:37,076:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-10 09:13:37,076:  >> stack= False
2020-06-10 09:13:37,076:  >> seg_durs= (1, None)
2020-06-10 09:13:37,077:  >> # words= 9971 (# ignored= 0)
2020-06-10 09:13:37,077:  >> input_feat_dim= 108
2020-06-10 09:13:37,077:  >> input_num_subwords= 45
2020-06-10 09:13:37,077: Using module at data.batch_samplers.BatchSampler
2020-06-10 09:13:37,077: Building train_sampler from config
2020-06-10 09:13:37,078:  >> # examples= 9971
2020-06-10 09:13:37,078:  >> batch_size= 256
2020-06-10 09:13:37,078:  >> shuffle= True
2020-06-10 09:13:37,086:  >> BatchSampler; 39 batches
2020-06-10 09:13:37,086: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 09:13:37,086: Building dev_data from config
2020-06-10 09:13:45,186:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 09:13:45,187:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 09:13:45,187:  >> stack= False
2020-06-10 09:13:45,187:  >> seg_durs= (1, None)
2020-06-10 09:13:45,187:  >> # words= 10966 (# ignored= 0)
2020-06-10 09:13:45,187:  >> input_feat_dim= 108
2020-06-10 09:13:45,187:  >> input_num_subwords= 45
2020-06-10 09:13:45,188: Using module at data.batch_samplers.BatchSampler
2020-06-10 09:13:45,188: Building dev_sampler from config
2020-06-10 09:13:45,189:  >> # examples= 10966
2020-06-10 09:13:45,189:  >> batch_size= 256
2020-06-10 09:13:45,189:  >> shuffle= False
2020-06-10 09:13:45,192:  >> BatchSampler; 43 batches
2020-06-10 09:13:45,192: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 09:13:45,192: Building test_data from config
2020-06-10 09:13:52,245:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 09:13:52,245:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 09:13:52,245:  >> stack= False
2020-06-10 09:13:52,245:  >> seg_durs= (1, None)
2020-06-10 09:13:52,245:  >> # words= 11024 (# ignored= 0)
2020-06-10 09:13:52,246:  >> input_feat_dim= 108
2020-06-10 09:13:52,246:  >> input_num_subwords= 45
2020-06-10 09:13:52,246: Using module at data.batch_samplers.BatchSampler
2020-06-10 09:13:52,246: Building test_sampler from config
2020-06-10 09:13:52,246:  >> # examples= 11024
2020-06-10 09:13:52,246:  >> batch_size= 256
2020-06-10 09:13:52,247:  >> shuffle= False
2020-06-10 09:13:52,249:  >> BatchSampler; 44 batches
2020-06-10 09:13:52,249: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-10 09:13:52,257: Building loss from config
2020-06-10 09:13:52,257:  >> margin= 0.4
2020-06-10 09:13:52,258:  >> k= 16
2020-06-10 09:13:52,258:  >> min_k= 8
2020-06-10 09:13:52,258:  >> extra= 0
2020-06-10 09:13:52,258:  >> average= False
2020-06-10 09:13:52,258:  >> margin_max= 0.5
2020-06-10 09:13:52,258:  >> threshold_max= 9
2020-06-10 09:13:52,258:  >> using obj0+2
2020-06-10 09:13:52,258: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 09:13:52,295: Building eval from config
2020-06-10 09:13:52,295:  >> acoustic_ap= True
2020-06-10 09:13:52,296:  >> crossview_ap= True
2020-06-10 09:13:52,296:  >> full_vocab= False
2020-06-10 09:13:52,296:  >> metric= crossview_ap
2020-06-10 09:13:52,296:  >> mode= max
2020-06-10 09:13:52,296: Using module at multiview_rnn.MultiViewRNN
2020-06-10 09:13:52,307: Building net from config
2020-06-10 09:13:51,260: view1:
2020-06-10 09:13:51,261:  >> cell= GRU
2020-06-10 09:13:51,261:  >> input_size= 108
2020-06-10 09:13:51,261:  >> hidden_size= 512
2020-06-10 09:13:51,261:  >> bidirectional= True
2020-06-10 09:13:51,261:  >> num_layers= 6
2020-06-10 09:13:51,261:  >> dropout between layers= 0.4
2020-06-10 09:13:51,473: view2:
2020-06-10 09:13:51,473:  >> cell= GRU
2020-06-10 09:13:51,473:  >> input_size= 64
2020-06-10 09:13:51,473:  >> hidden_size= 512
2020-06-10 09:13:51,473:  >> bidirectional= True
2020-06-10 09:13:51,473:  >> num_layers= 2
2020-06-10 09:13:51,473:  >> dropout between layers= 0.4
2020-06-10 09:13:51,474:  >> num input embeddings= 45
2020-06-10 09:13:54,987: Using module at optim.adam.Adam
2020-06-10 09:13:54,990: Building optim from config
2020-06-10 09:13:54,991:  >> lr= 0.001
2020-06-10 09:13:54,991:  >> betas= (0.9, 0.999)
2020-06-10 09:13:54,991:  >> eps= 1e-08
2020-06-10 09:13:54,991:  >> weight_decay= 0
2020-06-10 09:13:54,991:  >> amsgrad= False
2020-06-10 09:13:54,991:  >> min_lr= 1e-07
2020-06-10 09:13:54,992: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-10 09:13:55,084: Building sched from config
2020-06-10 09:13:55,085:  >> optim= Adam
2020-06-10 09:13:55,085:  >> decay lr by 0.1
2020-06-10 09:13:55,085:  >> eval_fn= MultiViewAP
2020-06-10 09:13:55,085:  >> patience=4
2020-06-10 09:13:55,085:  >> revert=True
2020-06-10 09:13:55,095: loaded save/MultiViewDataset_IndividualWords.1092.pth
2020-06-10 09:13:55,095: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-10 09:13:56,202: loaded save/MultiViewRNN.1092.pth
2020-06-10 09:13:56,202: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-10 09:13:58,399: loaded save/Adam.1092.pth
2020-06-10 09:13:58,400: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-10 09:13:58,402: loaded save/ReduceLROnPlateau.1092.pth
2020-06-10 09:13:58,402: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-10 09:13:58,402: epoch=28.00 global_step=1092 lr=0.001 start_iter=0
2020-06-10 09:13:58,402: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 09:16:08,415: 0) loss=0.110 grad_norm=10.01 num_segments=256 num_words=203
2020-06-10 09:18:04,584: 1) loss=0.088 grad_norm=10.50 num_segments=256 num_words=217
                                                                                      2020-06-10 09:19:52,447: 2) loss=0.117 grad_norm=7.71 num_segments=256 num_words=208
                                                                                     2020-06-10 09:21:32,370: 3) loss=0.128 grad_norm=10.79 num_segments=256 num_words=218
                                                                                      2020-06-10 09:23:02,845: 4) loss=0.141 grad_norm=16.79 num_segments=256 num_words=212
                                                                                      2020-06-10 09:24:26,733: 5) loss=0.148 grad_norm=17.84 num_segments=256 num_words=210
                                                                                      2020-06-10 09:25:40,652: 6) loss=0.164 grad_norm=13.10 num_segments=256 num_words=208
                                                                                      2020-06-10 09:26:47,022: 7) loss=0.179 grad_norm=9.88 num_segments=256 num_words=218
                                                                                     2020-06-10 09:27:54,987: 8) loss=0.174 grad_norm=19.85 num_segments=256 num_words=214
                                                                                      2020-06-10 09:29:00,354: 9) loss=0.170 grad_norm=14.03 num_segments=256 num_words=223
                                                                                      2020-06-10 09:30:09,401: 10) loss=0.173 grad_norm=21.14 num_segments=256 num_words=207
                                                                                       2020-06-10 09:31:15,608: 11) loss=0.235 grad_norm=20.77 num_segments=256 num_words=198
                                                                                       2020-06-10 09:32:21,205: 12) loss=0.185 grad_norm=14.50 num_segments=256 num_words=215
                                                                                       2020-06-10 09:33:27,065: 13) loss=0.194 grad_norm=14.41 num_segments=256 num_words=201
                                                                                       2020-06-10 09:34:37,006: 14) loss=0.162 grad_norm=18.10 num_segments=256 num_words=227
                                                                                       2020-06-10 09:35:42,911: 15) loss=0.185 grad_norm=14.09 num_segments=256 num_words=210
                                                                                       2020-06-10 09:36:49,408: 16) loss=0.210 grad_norm=11.95 num_segments=256 num_words=200
                                                                                       2020-06-10 09:37:55,872: 17) loss=0.167 grad_norm=25.15 num_segments=256 num_words=220
                                                                                       2020-06-10 09:39:01,040: 18) loss=0.164 grad_norm=11.71 num_segments=256 num_words=215
                                                                                       2020-06-10 09:40:11,609: 19) loss=0.194 grad_norm=15.00 num_segments=256 num_words=207
                                                                                       2020-06-10 09:41:17,737: 20) loss=0.176 grad_norm=19.24 num_segments=256 num_words=212
                                                                                       2020-06-10 09:42:23,824: 21) loss=0.183 grad_norm=8.35 num_segments=256 num_words=200
                                                                                      2020-06-10 09:43:29,747: 22) loss=0.164 grad_norm=11.00 num_segments=256 num_words=209
                                                                                       2020-06-10 09:44:35,234: 23) loss=0.312 grad_norm=20.07 num_segments=256 num_words=202
                                                                                       2020-06-10 09:45:47,175: 24) loss=0.184 grad_norm=7.93 num_segments=256 num_words=208
                                                                                      2020-06-10 09:46:52,330: 25) loss=0.159 grad_norm=9.55 num_segments=256 num_words=224
                                                                                      2020-06-10 09:47:58,083: 26) loss=0.194 grad_norm=20.51 num_segments=256 num_words=204
                                                                                       2020-06-10 09:49:04,333: 27) loss=0.188 grad_norm=20.72 num_segments=256 num_words=213
                                                                                       2020-06-10 09:50:09,876: 28) loss=0.178 grad_norm=10.56 num_segments=256 num_words=209
                                                                                       2020-06-10 09:51:15,574: 29) loss=0.182 grad_norm=8.51 num_segments=256 num_words=208
                                                                                      2020-06-10 09:52:22,081: 30) loss=0.242 grad_norm=19.78 num_segments=256 num_words=208
                                                                                       2020-06-10 09:53:35,367: 31) loss=0.200 grad_norm=19.05 num_segments=256 num_words=206
                                                                                       2020-06-10 09:54:40,845: 32) loss=0.173 grad_norm=13.90 num_segments=256 num_words=214
                                                                                       2020-06-10 09:55:46,617: 33) loss=0.171 grad_norm=9.30 num_segments=256 num_words=219
                                                                                      2020-06-10 09:56:52,432: 34) loss=0.160 grad_norm=10.24 num_segments=256 num_words=216
2020-06-10 09:57:35,230: 34) loss=0.160 grad_norm=10.24 num_segments=256 num_words=216
2020-06-10 09:58:42,734: 35) loss=0.286 grad_norm=17.88 num_segments=256 num_words=212
                                                                                       2020-06-10 09:59:49,806: 36) loss=0.178 grad_norm=11.41 num_segments=256 num_words=210
                                                                                       2020-06-10 10:00:56,864: 37) loss=0.194 grad_norm=10.65 num_segments=256 num_words=205
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               2020-06-10 10:01:57,539: 38) loss=0.179 grad_norm=10.82 num_segments=243 num_words=209
2020-06-10 10:01:57,554: epoch= 29.00
2020-06-10 10:01:57,554:  >> time to evaluate and save:
2020-06-10 10:01:57,567: saved MultiViewDataset_IndividualWords successfully
2020-06-10 10:01:58,118: saved MultiViewRNN successfully
2020-06-10 10:01:58,561: saved Adam successfully
2020-06-10 10:01:58,587: saved ReduceLROnPlateau successfully
2020-06-10 10:01:58,589: saved config successfully
                                                                      2020-06-10 10:03:33,326:   >> crossview_ap=0.696 (10966 x 3921 pairs)
                                                                                                                                                                                                                                                                                           2020-06-10 10:04:35,191:   >> acoustic_ap=0.747 (10966 choose 2 pairs)
2020-06-10 10:04:35,194: best_so_far= 0.703 at 1053
2020-06-10 10:04:35,277: epoch=29.00 global_step=1131 lr=0.001 start_iter=0
2020-06-10 10:04:35,277: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
                                                                                     2020-06-10 10:05:44,673: 0) loss=0.189 grad_norm=7.57 num_segments=256 num_words=210
                                                                                      2020-06-10 10:07:03,700: 1) loss=0.183 grad_norm=14.56 num_segments=256 num_words=204
                                                                                      2020-06-10 10:08:10,879: 2) loss=0.200 grad_norm=11.75 num_segments=256 num_words=217
                                                                                      2020-06-10 10:09:18,096: 3) loss=0.164 grad_norm=13.07 num_segments=256 num_words=211
                                                                                      2020-06-10 10:10:25,099: 4) loss=0.200 grad_norm=10.95 num_segments=256 num_words=211
                                                                                      2020-06-10 10:11:31,818: 5) loss=0.174 grad_norm=18.15 num_segments=256 num_words=209
2020-06-10 10:12:38,410: 6) loss=0.299 grad_norm=13.15 num_segments=256 num_words=200
                                                                                      2020-06-10 10:13:45,370: 7) loss=0.186 grad_norm=12.23 num_segments=256 num_words=202
                                                                                     2020-06-10 10:14:49,867: 8) loss=0.184 grad_norm=9.53 num_segments=256 num_words=205
                                                                                      2020-06-10 10:15:55,130: 9) loss=0.165 grad_norm=21.70 num_segments=256 num_words=212
                                                                                       2020-06-10 10:16:59,830: 10) loss=0.181 grad_norm=13.62 num_segments=256 num_words=217
                                                                                       2020-06-10 10:18:04,520: 11) loss=0.180 grad_norm=12.15 num_segments=256 num_words=205
                                                                                       2020-06-10 10:19:22,275: 12) loss=0.180 grad_norm=15.21 num_segments=256 num_words=209
                                                                                       2020-06-10 10:20:27,231: 13) loss=0.191 grad_norm=17.75 num_segments=256 num_words=204
                                                                                      2020-06-10 10:21:32,247: 14) loss=0.168 grad_norm=8.38 num_segments=256 num_words=218
                                                                                       2020-06-10 10:22:37,665: 15) loss=0.186 grad_norm=12.16 num_segments=256 num_words=212
                                                                                       2020-06-10 10:23:43,374: 16) loss=0.197 grad_norm=17.74 num_segments=256 num_words=202
                                                                                       2020-06-10 10:24:49,570: 17) loss=0.187 grad_norm=42.29 num_segments=256 num_words=204
                                                                                       2020-06-10 10:25:54,972: 18) loss=0.196 grad_norm=17.67 num_segments=256 num_words=207
                                                                                       2020-06-10 10:27:00,160: 19) loss=0.168 grad_norm=10.93 num_segments=256 num_words=218
                                                                                       2020-06-10 10:28:05,519: 20) loss=0.194 grad_norm=10.74 num_segments=256 num_words=206
                                                                                       2020-06-10 10:29:11,688: 21) loss=0.179 grad_norm=15.49 num_segments=256 num_words=211
                                                                                       2020-06-10 10:30:18,030: 22) loss=0.327 grad_norm=17.40 num_segments=256 num_words=197
                                                                                       2020-06-10 10:31:25,377: 23) loss=0.200 grad_norm=24.34 num_segments=256 num_words=204
                                                                                       2020-06-10 10:32:32,164: 24) loss=0.184 grad_norm=11.43 num_segments=256 num_words=206
                                                                                       2020-06-10 10:33:39,132: 25) loss=0.182 grad_norm=19.48 num_segments=256 num_words=216
                                                                                       2020-06-10 10:35:03,758: 26) loss=0.175 grad_norm=15.17 num_segments=256 num_words=214
                                                                                       2020-06-10 10:36:10,576: 27) loss=0.325 grad_norm=12.93 num_segments=256 num_words=216
                                                                                       2020-06-10 10:37:17,336: 28) loss=0.158 grad_norm=10.68 num_segments=256 num_words=217
                                                                                       2020-06-10 10:38:24,138: 29) loss=0.184 grad_norm=17.85 num_segments=256 num_words=209
                                                                                       2020-06-10 10:39:30,781: 30) loss=0.285 grad_norm=14.63 num_segments=256 num_words=213
                                                                                       2020-06-10 10:40:37,980: 31) loss=0.166 grad_norm=14.02 num_segments=256 num_words=210
2020-06-10 10:40:55,904: 32) loss=0.184 grad_norm=14.75 num_segments=256 num_words=212
                                                                                       2020-06-10 10:42:02,163: 33) loss=0.175 grad_norm=8.77 num_segments=256 num_words=195
                                                                                      2020-06-10 10:43:09,166: 34) loss=0.201 grad_norm=9.08 num_segments=256 num_words=204
                                                                                      2020-06-10 10:44:15,558: 35) loss=0.185 grad_norm=12.54 num_segments=256 num_words=218
                                                                                       2020-06-10 10:45:21,572: 36) loss=0.156 grad_norm=8.60 num_segments=256 num_words=215
                                                                                      2020-06-10 10:46:27,345: 37) loss=0.167 grad_norm=17.85 num_segments=256 num_words=220
                                                                                       2020-06-10 10:47:27,087: 38) loss=0.160 grad_norm=13.56 num_segments=243 num_words=207
2020-06-10 10:47:27,098: epoch= 30.00
2020-06-10 10:47:27,099:  >> time to evaluate and save:
2020-06-10 10:47:27,165: saved save/MultiViewDataset_IndividualWords.1170.pth
2020-06-10 10:47:27,167: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 10:47:27,175: saved MultiViewDataset_IndividualWords successfully
2020-06-10 10:47:28,474: saved save/MultiViewRNN.1170.pth
2020-06-10 10:47:28,476: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 10:47:28,490: saved MultiViewRNN successfully
2020-06-10 10:47:30,997: saved save/Adam.1170.pth
2020-06-10 10:47:30,999: most_recent linked save/Adam.most_recent.pth
2020-06-10 10:47:31,012: saved Adam successfully
2020-06-10 10:47:31,014: saved save/ReduceLROnPlateau.1170.pth
2020-06-10 10:47:31,016: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 10:47:31,025: saved ReduceLROnPlateau successfully
2020-06-10 10:47:31,027: saved config successfully
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             2020-06-10 10:49:05,597:   >> crossview_ap=0.697 (10966 x 3921 pairs)
                                                                      2020-06-10 10:50:08,500:   >> acoustic_ap=0.760 (10966 choose 2 pairs)
2020-06-10 10:50:08,503: best_so_far= 0.703 at 1053
2020-06-10 10:50:09,064: epoch=30.00 global_step=1170 lr=0.001 start_iter=0
2020-06-10 10:50:09,064: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
                                                                                                                                                                                                                                                                                           2020-06-10 10:51:16,723: 0) loss=0.171 grad_norm=12.61 num_segments=256 num_words=214
                                                                                      2020-06-10 10:52:22,932: 1) loss=0.172 grad_norm=12.42 num_segments=256 num_words=205
                                                                                      2020-06-10 10:53:30,324: 2) loss=0.184 grad_norm=19.61 num_segments=256 num_words=201
                                                                                      2020-06-10 10:54:37,036: 3) loss=0.173 grad_norm=10.55 num_segments=256 num_words=222
                                                                                      2020-06-10 10:55:45,868: 4) loss=0.190 grad_norm=16.78 num_segments=256 num_words=213
                                                                                      2020-06-10 10:57:25,258: 5) loss=0.174 grad_norm=13.28 num_segments=256 num_words=198
                                                                                      2020-06-10 10:58:33,518: 6) loss=0.186 grad_norm=9.68 num_segments=256 num_words=209
                                                                                     2020-06-10 10:59:40,446: 7) loss=0.223 grad_norm=20.05 num_segments=256 num_words=207
                                                                                      2020-06-10 11:00:48,184: 8) loss=0.180 grad_norm=14.72 num_segments=256 num_words=213
                                                                                      2020-06-10 11:01:54,987: 9) loss=0.167 grad_norm=8.67 num_segments=256 num_words=214
                                                                                     2020-06-10 11:03:01,782: 10) loss=0.191 grad_norm=7.75 num_segments=256 num_words=214
                                                                                      2020-06-10 11:04:09,629: 11) loss=0.188 grad_norm=9.25 num_segments=256 num_words=209
                                                                                      2020-06-10 11:05:16,768: 12) loss=0.171 grad_norm=15.38 num_segments=256 num_words=209
                                                                                       2020-06-10 11:06:23,714: 13) loss=0.179 grad_norm=15.09 num_segments=256 num_words=209
                                                                                       2020-06-10 11:07:30,903: 14) loss=0.170 grad_norm=11.90 num_segments=256 num_words=213
                                                                                       2020-06-10 11:08:38,007: 15) loss=0.184 grad_norm=14.14 num_segments=256 num_words=215
                                                                                       2020-06-10 11:09:45,049: 16) loss=0.162 grad_norm=9.75 num_segments=256 num_words=218
                                                                                      2020-06-10 11:10:51,632: 17) loss=0.153 grad_norm=13.49 num_segments=256 num_words=210
                                                                                       2020-06-10 11:11:58,730: 18) loss=0.187 grad_norm=49.49 num_segments=256 num_words=209
                                                                                       2020-06-10 11:13:05,675: 19) loss=0.174 grad_norm=22.41 num_segments=256 num_words=216
                                                                                       2020-06-10 11:14:12,343: 20) loss=0.173 grad_norm=12.38 num_segments=256 num_words=206
                                                                                       2020-06-10 11:15:19,966: 21) loss=0.186 grad_norm=8.52 num_segments=256 num_words=199
                                                                                      2020-06-10 11:16:27,621: 22) loss=0.174 grad_norm=12.95 num_segments=256 num_words=210
                                                                                       2020-06-10 11:17:34,479: 23) loss=0.167 grad_norm=15.35 num_segments=256 num_words=214
                                                                                       2020-06-10 11:18:41,644: 24) loss=0.187 grad_norm=18.08 num_segments=256 num_words=207
                                                                                       2020-06-10 11:19:48,452: 25) loss=0.179 grad_norm=16.69 num_segments=256 num_words=210
                                                                                       2020-06-10 11:21:26,037: 26) loss=0.195 grad_norm=25.87 num_segments=256 num_words=209
                                                                                       2020-06-10 11:22:32,911: 27) loss=0.194 grad_norm=10.78 num_segments=256 num_words=204
                                                                                       2020-06-10 11:23:39,738: 28) loss=0.182 grad_norm=13.07 num_segments=256 num_words=214
2020-06-10 11:23:55,721: 28) loss=0.182 grad_norm=13.07 num_segments=256 num_words=214
                                                                                      2020-06-10 11:25:03,242: 29) loss=0.177 grad_norm=8.93 num_segments=256 num_words=210
                                                                                       2020-06-10 11:26:10,243: 30) loss=0.196 grad_norm=13.23 num_segments=256 num_words=207
                                                                                       2020-06-10 11:27:17,125: 31) loss=0.183 grad_norm=16.93 num_segments=256 num_words=219
                                                                                       2020-06-10 11:28:23,898: 32) loss=0.176 grad_norm=16.50 num_segments=256 num_words=217
                                                                                       2020-06-10 11:29:30,780: 33) loss=0.180 grad_norm=15.46 num_segments=256 num_words=218
                                                                                       2020-06-10 11:30:37,447: 34) loss=0.186 grad_norm=28.38 num_segments=256 num_words=214
                                                                                      2020-06-10 11:31:44,279: 35) loss=0.194 grad_norm=9.91 num_segments=256 num_words=213
                                                                                       2020-06-10 11:32:51,254: 36) loss=0.180 grad_norm=12.06 num_segments=256 num_words=210
2020-06-10 11:33:57,980: 37) loss=0.156 grad_norm=12.22 num_segments=256 num_words=225
2020-06-10 11:34:58,558: 38) loss=0.166 grad_norm=21.30 num_segments=243 num_words=199
2020-06-10 11:34:58,569: epoch= 31.00
2020-06-10 11:34:58,569:  >> time to evaluate and save:
2020-06-10 11:34:58,581: saved MultiViewDataset_IndividualWords successfully
2020-06-10 11:34:58,606: saved MultiViewRNN successfully
2020-06-10 11:34:58,633: saved Adam successfully
2020-06-10 11:34:58,641: saved ReduceLROnPlateau successfully
2020-06-10 11:34:58,643: saved config successfully
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  2020-06-10 11:36:43,766:   >> crossview_ap=0.698 (10966 x 3921 pairs)
                                                                                                                                                                                                                                                                                           2020-06-10 11:38:15,574:   >> acoustic_ap=0.765 (10966 choose 2 pairs)
2020-06-10 11:38:15,579: best_so_far= 0.703 at 1053
2020-06-10 11:38:16,421: epoch=31.00 global_step=1209 lr=0.001 start_iter=0
2020-06-10 11:38:16,421: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
                                                                                      2020-06-10 11:39:26,901: 0) loss=0.182 grad_norm=15.82 num_segments=256 num_words=221
                                                                                      2020-06-10 11:40:34,932: 1) loss=0.172 grad_norm=11.80 num_segments=256 num_words=217
                                                                                      2020-06-10 11:41:42,126: 2) loss=0.164 grad_norm=16.25 num_segments=256 num_words=211
                                                                                      2020-06-10 11:42:48,919: 3) loss=0.175 grad_norm=12.09 num_segments=256 num_words=209
                                                                                      2020-06-10 11:43:56,242: 4) loss=0.208 grad_norm=17.76 num_segments=256 num_words=205
2020-06-10 11:44:28,065: 5) loss=0.161 grad_norm=14.08 num_segments=256 num_words=214
                                                                                      2020-06-10 11:45:35,152: 6) loss=0.191 grad_norm=17.85 num_segments=256 num_words=215
                                                                                      2020-06-10 11:46:42,137: 7) loss=0.183 grad_norm=13.42 num_segments=256 num_words=211
                                                                                      2020-06-10 11:47:48,808: 8) loss=0.178 grad_norm=13.79 num_segments=256 num_words=210
                                                                                      2020-06-10 11:48:55,986: 9) loss=0.177 grad_norm=9.93 num_segments=256 num_words=212
                                                                                     2020-06-10 11:50:02,934: 10) loss=0.165 grad_norm=14.93 num_segments=256 num_words=208
                                                                                       2020-06-10 11:51:10,334: 11) loss=0.177 grad_norm=25.20 num_segments=256 num_words=214
                                                                                       2020-06-10 11:52:17,697: 12) loss=0.186 grad_norm=10.76 num_segments=256 num_words=199
                                                                                       2020-06-10 11:53:24,697: 13) loss=0.182 grad_norm=14.67 num_segments=256 num_words=212
                                                                                       2020-06-10 11:55:15,358: 14) loss=0.170 grad_norm=8.65 num_segments=256 num_words=207
                                                                                      2020-06-10 11:56:23,037: 15) loss=0.160 grad_norm=24.76 num_segments=256 num_words=219
                                                                                       2020-06-10 11:57:29,952: 16) loss=0.179 grad_norm=12.93 num_segments=256 num_words=209
                                                                                       2020-06-10 11:58:37,663: 17) loss=0.178 grad_norm=20.79 num_segments=256 num_words=218
                                                                                       2020-06-10 11:59:44,407: 18) loss=0.167 grad_norm=10.20 num_segments=256 num_words=214
                                                                                       2020-06-10 12:00:51,676: 19) loss=0.182 grad_norm=18.79 num_segments=256 num_words=212
                                                                                       2020-06-10 12:02:00,926: 20) loss=0.167 grad_norm=11.02 num_segments=256 num_words=207
                                                                                       2020-06-10 12:03:08,895: 21) loss=0.188 grad_norm=14.74 num_segments=256 num_words=209
                                                                                       2020-06-10 12:04:15,884: 22) loss=0.178 grad_norm=12.40 num_segments=256 num_words=208
                                                                                       2020-06-10 12:05:22,819: 23) loss=0.163 grad_norm=23.68 num_segments=256 num_words=209
                                                                                       2020-06-10 12:06:29,781: 24) loss=0.170 grad_norm=15.86 num_segments=256 num_words=212
                                                                                       2020-06-10 12:07:36,830: 25) loss=0.183 grad_norm=20.41 num_segments=256 num_words=218
                                                                                       2020-06-10 12:08:44,588: 26) loss=0.181 grad_norm=18.30 num_segments=256 num_words=217
                                                                                       2020-06-10 12:09:51,670: 27) loss=0.202 grad_norm=31.88 num_segments=256 num_words=202
                                                                                       2020-06-10 12:10:59,309: 28) loss=0.181 grad_norm=13.32 num_segments=256 num_words=205
2020-06-10 12:11:34,407: 28) loss=0.181 grad_norm=13.32 num_segments=256 num_words=205
                                                                                       2020-06-10 12:12:40,685: 29) loss=0.337 grad_norm=11.08 num_segments=256 num_words=200
                                                                                       2020-06-10 12:13:46,579: 30) loss=0.170 grad_norm=10.13 num_segments=256 num_words=214
                                                                                       2020-06-10 12:14:52,790: 31) loss=0.183 grad_norm=30.74 num_segments=256 num_words=206
                                                                                       2020-06-10 12:15:59,460: 32) loss=0.173 grad_norm=15.37 num_segments=256 num_words=218
                                                                                       2020-06-10 12:17:05,744: 33) loss=0.192 grad_norm=15.48 num_segments=256 num_words=198
2020-06-10 12:18:11,819: 34) loss=0.169 grad_norm=11.92 num_segments=256 num_words=224
2020-06-10 12:19:17,786: 35) loss=0.285 grad_norm=15.49 num_segments=256 num_words=208
2020-06-10 12:20:23,968: 36) loss=0.167 grad_norm=13.48 num_segments=256 num_words=211
                                                                                      2020-06-10 12:21:29,921: 37) loss=0.163 grad_norm=8.73 num_segments=256 num_words=211
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              2020-06-10 12:22:29,257: 38) loss=0.163 grad_norm=7.12 num_segments=243 num_words=212
2020-06-10 12:22:29,270: epoch= 32.00
2020-06-10 12:22:29,270:  >> time to evaluate and save:
2020-06-10 12:22:29,284: saved MultiViewDataset_IndividualWords successfully
2020-06-10 12:22:29,310: saved MultiViewRNN successfully
2020-06-10 12:22:29,336: saved Adam successfully
2020-06-10 12:22:29,342: saved ReduceLROnPlateau successfully
2020-06-10 12:22:29,344: saved config successfully
2020-06-10 12:24:11,065:   >> crossview_ap=0.698 (10966 x 3921 pairs)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              2020-06-10 12:25:18,457:   >> acoustic_ap=0.746 (10966 choose 2 pairs)
2020-06-10 12:25:18,461: best_so_far= 0.703 at 1053
2020-06-10 12:25:18,462: Reverting to previous best
2020-06-10 12:25:19,573: loaded save/MultiViewRNN.1053.pth
2020-06-10 12:25:19,573: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-10 12:25:21,759: loaded save/Adam.1248.pth
2020-06-10 12:25:21,759: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-10 12:25:21,759: Reducing group lr from 0.001 to 0.0001
2020-06-10 12:25:21,761: best linked save/Adam.best.pth
2020-06-10 12:25:22,890: epoch=32.00 global_step=1248 lr=0.0001 start_iter=0
2020-06-10 12:25:22,890: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
                                                                                     2020-06-10 12:26:31,812: 0) loss=0.176 grad_norm=6.20 num_segments=256 num_words=208
                                                                                     2020-06-10 12:27:38,742: 1) loss=0.184 grad_norm=9.30 num_segments=256 num_words=209
                                                                                      2020-06-10 12:28:44,834: 2) loss=0.183 grad_norm=10.29 num_segments=256 num_words=211
                                                                                      2020-06-10 12:29:52,882: 3) loss=0.171 grad_norm=11.06 num_segments=256 num_words=218
                                                                                     2020-06-10 12:30:59,136: 4) loss=0.170 grad_norm=7.91 num_segments=256 num_words=210
                                                                                     2020-06-10 12:32:05,341: 5) loss=0.192 grad_norm=7.90 num_segments=256 num_words=205
                                                                                      2020-06-10 12:33:12,069: 6) loss=0.180 grad_norm=11.12 num_segments=256 num_words=209
                                                                                     2020-06-10 12:34:19,471: 7) loss=0.174 grad_norm=5.99 num_segments=256 num_words=213
                                                                                      2020-06-10 12:35:25,983: 8) loss=0.197 grad_norm=10.30 num_segments=256 num_words=212
                                                                                     2020-06-10 12:37:49,368: 9) loss=0.199 grad_norm=8.54 num_segments=256 num_words=213
                                                                                      2020-06-10 12:38:57,463: 10) loss=0.193 grad_norm=6.97 num_segments=256 num_words=212
                                                                                       2020-06-10 12:40:11,490: 11) loss=0.163 grad_norm=16.41 num_segments=256 num_words=219
                                                                                      2020-06-10 12:41:19,081: 12) loss=0.178 grad_norm=8.44 num_segments=256 num_words=217
                                                                                      2020-06-10 12:42:26,976: 13) loss=0.177 grad_norm=6.09 num_segments=256 num_words=211
                                                                                      2020-06-10 12:43:34,135: 14) loss=0.183 grad_norm=8.72 num_segments=256 num_words=207
                                                                                      2020-06-10 12:44:42,340: 15) loss=0.171 grad_norm=8.26 num_segments=256 num_words=211
                                                                                      2020-06-10 12:45:50,735: 16) loss=0.165 grad_norm=4.78 num_segments=256 num_words=207
                                                                                      2020-06-10 12:46:58,007: 17) loss=0.178 grad_norm=8.75 num_segments=256 num_words=198
                                                                                      2020-06-10 12:48:06,153: 18) loss=0.159 grad_norm=5.78 num_segments=256 num_words=212
                                                                                      2020-06-10 12:49:14,100: 19) loss=0.194 grad_norm=7.40 num_segments=256 num_words=209
                                                                                      2020-06-10 12:50:21,378: 20) loss=0.176 grad_norm=6.97 num_segments=256 num_words=203
2020-06-10 12:50:53,702: 21) loss=0.168 grad_norm=7.04 num_segments=256 num_words=206
                                                                                      2020-06-10 12:52:00,731: 22) loss=0.185 grad_norm=7.61 num_segments=256 num_words=189
                                                                                      2020-06-10 12:53:07,471: 23) loss=0.180 grad_norm=11.41 num_segments=256 num_words=201
                                                                                       2020-06-10 12:54:14,626: 24) loss=0.294 grad_norm=12.41 num_segments=256 num_words=206
                                                                                      2020-06-10 12:55:21,426: 25) loss=0.176 grad_norm=7.53 num_segments=256 num_words=226
                                                                                      2020-06-10 12:56:28,430: 26) loss=0.195 grad_norm=7.26 num_segments=256 num_words=209
                                                                                      2020-06-10 12:57:35,886: 27) loss=0.299 grad_norm=6.18 num_segments=256 num_words=214
                                                                                      2020-06-10 12:58:42,831: 28) loss=0.191 grad_norm=8.72 num_segments=256 num_words=206
                                                                                      2020-06-10 12:59:49,928: 29) loss=0.176 grad_norm=6.75 num_segments=256 num_words=206
                                                                                      2020-06-10 13:00:56,616: 30) loss=0.180 grad_norm=8.50 num_segments=256 num_words=195
                                                                                      2020-06-10 13:02:03,079: 31) loss=0.169 grad_norm=7.97 num_segments=256 num_words=212
                                                                                      2020-06-10 13:03:10,750: 32) loss=0.180 grad_norm=7.12 num_segments=256 num_words=216
                                                                                      2020-06-10 13:04:17,795: 33) loss=0.193 grad_norm=10.05 num_segments=256 num_words=202
                                                                                      2020-06-10 13:05:24,764: 34) loss=0.164 grad_norm=7.23 num_segments=256 num_words=217
                                                                                      2020-06-10 13:06:31,653: 35) loss=0.183 grad_norm=6.04 num_segments=256 num_words=206
                                                                                      2020-06-10 13:07:38,437: 36) loss=0.159 grad_norm=6.06 num_segments=256 num_words=215
                                                                                      2020-06-10 13:08:45,850: 37) loss=0.166 grad_norm=6.08 num_segments=256 num_words=208
                                                                                      2020-06-10 13:09:46,529: 38) loss=0.156 grad_norm=4.73 num_segments=243 num_words=203
2020-06-10 13:09:46,544: epoch= 33.00
2020-06-10 13:09:46,544:  >> time to evaluate and save:
2020-06-10 13:09:46,587: saved save/MultiViewDataset_IndividualWords.1287.pth
2020-06-10 13:09:46,601: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 13:09:46,610: saved MultiViewDataset_IndividualWords successfully
2020-06-10 13:09:47,921: saved save/MultiViewRNN.1287.pth
2020-06-10 13:09:47,922: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 13:09:47,937: saved MultiViewRNN successfully
2020-06-10 13:09:50,433: saved save/Adam.1287.pth
2020-06-10 13:09:50,435: most_recent linked save/Adam.most_recent.pth
2020-06-10 13:09:50,449: saved Adam successfully
2020-06-10 13:09:50,451: saved save/ReduceLROnPlateau.1287.pth
2020-06-10 13:09:50,457: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 13:09:50,467: saved ReduceLROnPlateau successfully
2020-06-10 13:09:50,469: saved config successfully
2020-06-10 13:10:36,609: 38) loss=0.156 grad_norm=5.03 num_segments=243 num_words=203
2020-06-10 13:10:36,626: epoch= 33.00
2020-06-10 13:10:36,626:  >> time to evaluate and save:
2020-06-10 13:10:36,642: saved MultiViewDataset_IndividualWords successfully
2020-06-10 13:10:36,669: saved MultiViewRNN successfully
2020-06-10 13:10:36,697: saved Adam successfully
2020-06-10 13:10:36,704: saved ReduceLROnPlateau successfully
2020-06-10 13:10:36,705: saved config successfully
                                                                      2020-06-10 13:12:37,689:   >> acoustic_ap=0.770 (10966 choose 2 pairs)
2020-06-10 13:12:37,764: best_so_far= 0.718 at 1287
2020-06-10 13:12:38,175: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 13:12:38,188: saved MultiViewDataset_IndividualWords successfully
2020-06-10 13:12:38,210: best linked save/MultiViewRNN.best.pth
2020-06-10 13:12:40,320: saved MultiViewRNN successfully
2020-06-10 13:12:40,321: best linked save/Adam.best.pth
2020-06-10 13:12:40,362: saved Adam successfully
2020-06-10 13:12:40,373: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 13:12:40,513: saved ReduceLROnPlateau successfully
2020-06-10 13:12:42,616: epoch=33.00 global_step=1287 lr=0.0001 start_iter=0
2020-06-10 13:12:42,616: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 13:14:12,610: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-10 13:14:12,675: Using 1 GPU(s)
2020-06-10 13:14:12,676: Machine: 0 / 1
2020-06-10 13:14:12,681: Hyperparam tuning-------------------
2020-06-10 13:14:12,681: optim_lr: 0.001
2020-06-10 13:14:12,681: dropout (for both): 0.4
2020-06-10 13:14:12,681: margin: 0.4
2020-06-10 13:14:12,681: ------------------------------------
2020-06-10 13:14:12,683: Calling main function: multiview_trainer.train
2020-06-10 13:14:12,683: Using config file: train_config.json
2020-06-10 13:14:12,683: Using module at multiview_trainer.train
2020-06-10 13:14:15,239: Using module at multiview_vocab.MultiViewVocab
2020-06-10 13:14:15,243: Building vocab_data from config
2020-06-10 13:14:15,595:  >> min_count= 0
2020-06-10 13:14:15,595:  >> # words= 34323 (# removed= 0)
2020-06-10 13:14:15,596:  >> # subwords= 45
2020-06-10 13:14:15,596:     [laughter]= 1
2020-06-10 13:14:15,596:     [noise]= 2
2020-06-10 13:14:15,596:     [vocalized-noise]= 3
2020-06-10 13:14:15,596:     aa= 4
2020-06-10 13:14:15,596:     ae= 5
2020-06-10 13:14:15,596:     ah= 6
2020-06-10 13:14:15,596:     ao= 7
2020-06-10 13:14:15,596:     aw= 8
2020-06-10 13:14:15,596:     ax= 9
2020-06-10 13:14:15,596:     ay= 10
2020-06-10 13:14:15,596:     b= 11
2020-06-10 13:14:15,596:     ch= 12
2020-06-10 13:14:15,596:     d= 13
2020-06-10 13:14:15,596:     dh= 14
2020-06-10 13:14:15,596:     eh= 15
2020-06-10 13:14:15,596:     el= 16
2020-06-10 13:14:15,596:     en= 17
2020-06-10 13:14:15,597:     er= 18
2020-06-10 13:14:15,597:     ey= 19
2020-06-10 13:14:15,597:     f= 20
2020-06-10 13:14:15,597:     g= 21
2020-06-10 13:14:15,597:     hh= 22
2020-06-10 13:14:15,597:     ih= 23
2020-06-10 13:14:15,597:     iy= 24
2020-06-10 13:14:15,597:     jh= 25
2020-06-10 13:14:15,597:     k= 26
2020-06-10 13:14:15,597:     l= 27
2020-06-10 13:14:15,597:     m= 28
2020-06-10 13:14:15,597:     n= 29
2020-06-10 13:14:15,597:     ng= 30
2020-06-10 13:14:15,597:     ow= 31
2020-06-10 13:14:15,597:     oy= 32
2020-06-10 13:14:15,597:     p= 33
2020-06-10 13:14:15,597:     r= 34
2020-06-10 13:14:15,597:     s= 35
2020-06-10 13:14:15,597:     sh= 36
2020-06-10 13:14:15,598:     t= 37
2020-06-10 13:14:15,598:     th= 38
2020-06-10 13:14:15,598:     uh= 39
2020-06-10 13:14:15,598:     uw= 40
2020-06-10 13:14:15,598:     v= 41
2020-06-10 13:14:15,598:     w= 42
2020-06-10 13:14:15,598:     y= 43
2020-06-10 13:14:15,598:     z= 44
2020-06-10 13:14:15,598:     zh= 45
2020-06-10 13:14:15,614: Using module at data.batch_samplers.BatchSampler
2020-06-10 13:14:15,615: Building vocab_sampler from config
2020-06-10 13:14:15,616:  >> # examples= 34323
2020-06-10 13:14:15,616:  >> batch_size= 1000
2020-06-10 13:14:15,616:  >> shuffle= False
2020-06-10 13:14:15,624:  >> BatchSampler; 35 batches
2020-06-10 13:14:15,624: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 13:14:16,683: Building train_data from config
2020-06-10 13:14:24,700:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-10 13:14:24,701:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-10 13:14:24,701:  >> stack= False
2020-06-10 13:14:24,701:  >> seg_durs= (1, None)
2020-06-10 13:14:24,701:  >> # words= 9971 (# ignored= 0)
2020-06-10 13:14:24,701:  >> input_feat_dim= 108
2020-06-10 13:14:24,701:  >> input_num_subwords= 45
2020-06-10 13:14:24,702: Using module at data.batch_samplers.BatchSampler
2020-06-10 13:14:24,702: Building train_sampler from config
2020-06-10 13:14:24,703:  >> # examples= 9971
2020-06-10 13:14:24,703:  >> batch_size= 256
2020-06-10 13:14:24,703:  >> shuffle= True
2020-06-10 13:14:24,714:  >> BatchSampler; 39 batches
2020-06-10 13:14:24,714: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 13:14:24,715: Building dev_data from config
2020-06-10 13:14:33,184:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 13:14:33,184:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 13:14:33,184:  >> stack= False
2020-06-10 13:14:33,184:  >> seg_durs= (1, None)
2020-06-10 13:14:33,184:  >> # words= 10966 (# ignored= 0)
2020-06-10 13:14:33,184:  >> input_feat_dim= 108
2020-06-10 13:14:33,184:  >> input_num_subwords= 45
2020-06-10 13:14:33,184: Using module at data.batch_samplers.BatchSampler
2020-06-10 13:14:33,184: Building dev_sampler from config
2020-06-10 13:14:33,185:  >> # examples= 10966
2020-06-10 13:14:33,185:  >> batch_size= 256
2020-06-10 13:14:33,185:  >> shuffle= False
2020-06-10 13:14:33,187:  >> BatchSampler; 43 batches
2020-06-10 13:14:33,188: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 13:14:33,188: Building test_data from config
2020-06-10 13:14:40,639:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 13:14:40,640:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 13:14:40,640:  >> stack= False
2020-06-10 13:14:40,640:  >> seg_durs= (1, None)
2020-06-10 13:14:40,640:  >> # words= 11024 (# ignored= 0)
2020-06-10 13:14:40,640:  >> input_feat_dim= 108
2020-06-10 13:14:40,640:  >> input_num_subwords= 45
2020-06-10 13:14:40,640: Using module at data.batch_samplers.BatchSampler
2020-06-10 13:14:40,641: Building test_sampler from config
2020-06-10 13:14:40,641:  >> # examples= 11024
2020-06-10 13:14:40,641:  >> batch_size= 256
2020-06-10 13:14:40,641:  >> shuffle= False
2020-06-10 13:14:40,644:  >> BatchSampler; 44 batches
2020-06-10 13:14:40,644: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-10 13:14:40,649: Building loss from config
2020-06-10 13:14:40,649:  >> margin= 0.4
2020-06-10 13:14:40,649:  >> k= 16
2020-06-10 13:14:40,649:  >> min_k= 8
2020-06-10 13:14:40,649:  >> extra= 0
2020-06-10 13:14:40,650:  >> average= False
2020-06-10 13:14:40,650:  >> margin_max= 0.5
2020-06-10 13:14:40,650:  >> threshold_max= 9
2020-06-10 13:14:40,650:  >> using obj0+2
2020-06-10 13:14:40,650: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 13:14:40,677: Building eval from config
2020-06-10 13:14:40,678:  >> acoustic_ap= True
2020-06-10 13:14:40,678:  >> crossview_ap= True
2020-06-10 13:14:40,678:  >> full_vocab= False
2020-06-10 13:14:40,678:  >> metric= crossview_ap
2020-06-10 13:14:40,678:  >> mode= max
2020-06-10 13:14:40,678: Using module at multiview_rnn.MultiViewRNN
2020-06-10 13:14:40,684: Building net from config
2020-06-10 13:14:40,686: view1:
2020-06-10 13:14:40,686:  >> cell= GRU
2020-06-10 13:14:40,686:  >> input_size= 108
2020-06-10 13:14:40,686:  >> hidden_size= 512
2020-06-10 13:14:40,686:  >> bidirectional= True
2020-06-10 13:14:40,686:  >> num_layers= 6
2020-06-10 13:14:40,687:  >> dropout between layers= 0.4
2020-06-10 13:14:40,899: view2:
2020-06-10 13:14:40,900:  >> cell= GRU
2020-06-10 13:14:40,900:  >> input_size= 64
2020-06-10 13:14:40,900:  >> hidden_size= 512
2020-06-10 13:14:40,900:  >> bidirectional= True
2020-06-10 13:14:40,900:  >> num_layers= 2
2020-06-10 13:14:40,900:  >> dropout between layers= 0.4
2020-06-10 13:14:40,900:  >> num input embeddings= 45
2020-06-10 13:14:44,584: Using module at optim.adam.Adam
2020-06-10 13:14:44,949: Building optim from config
2020-06-10 13:14:44,950:  >> lr= 0.001
2020-06-10 13:14:44,950:  >> betas= (0.9, 0.999)
2020-06-10 13:14:44,950:  >> eps= 1e-08
2020-06-10 13:14:44,950:  >> weight_decay= 0
2020-06-10 13:14:44,950:  >> amsgrad= False
2020-06-10 13:14:44,950:  >> min_lr= 1e-07
2020-06-10 13:14:44,952: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-10 13:14:44,956: Building sched from config
2020-06-10 13:14:44,957:  >> optim= Adam
2020-06-10 13:14:44,957:  >> decay lr by 0.1
2020-06-10 13:14:44,957:  >> eval_fn= MultiViewAP
2020-06-10 13:14:44,958:  >> patience=4
2020-06-10 13:14:44,958:  >> revert=True
2020-06-10 13:14:44,973: loaded save/MultiViewDataset_IndividualWords.1287.pth
2020-06-10 13:14:44,973: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-10 13:14:47,274: loaded save/MultiViewRNN.1287.pth
2020-06-10 13:14:47,525: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-10 13:14:50,488: loaded save/Adam.1287.pth
2020-06-10 13:14:50,488: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-10 13:14:50,490: loaded save/ReduceLROnPlateau.1287.pth
2020-06-10 13:14:50,490: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-10 13:14:50,491: epoch=33.00 global_step=1287 lr=0.0001 start_iter=0
2020-06-10 13:14:50,491: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 13:17:01,686: 0) loss=0.097 grad_norm=5.46 num_segments=256 num_words=205
2020-06-10 13:18:58,829: 1) loss=0.102 grad_norm=5.64 num_segments=256 num_words=214
2020-06-10 13:20:47,133: 2) loss=0.107 grad_norm=3.80 num_segments=256 num_words=213
2020-06-10 13:22:28,168: 3) loss=0.121 grad_norm=3.38 num_segments=256 num_words=210
2020-06-10 13:24:02,634: 4) loss=0.129 grad_norm=3.43 num_segments=256 num_words=206
2020-06-10 13:25:31,680: 5) loss=0.131 grad_norm=4.50 num_segments=256 num_words=204
2020-06-10 13:26:48,046: 6) loss=0.164 grad_norm=5.46 num_segments=256 num_words=212
2020-06-10 13:27:59,122: 7) loss=0.195 grad_norm=7.79 num_segments=256 num_words=201
2020-06-10 13:29:08,792: 8) loss=0.170 grad_norm=4.54 num_segments=256 num_words=212
2020-06-10 13:30:15,825: 9) loss=0.178 grad_norm=7.30 num_segments=256 num_words=206
2020-06-10 13:31:28,786: 10) loss=0.186 grad_norm=5.85 num_segments=256 num_words=214
2020-06-10 13:32:36,708: 11) loss=0.167 grad_norm=5.67 num_segments=256 num_words=218
2020-06-10 13:33:44,497: 12) loss=0.169 grad_norm=4.19 num_segments=256 num_words=220
2020-06-10 13:34:52,206: 13) loss=0.180 grad_norm=5.12 num_segments=256 num_words=214
2020-06-10 13:36:05,653: 14) loss=0.183 grad_norm=3.89 num_segments=256 num_words=220
2020-06-10 13:37:12,636: 15) loss=0.215 grad_norm=6.49 num_segments=256 num_words=199
2020-06-10 13:38:19,232: 16) loss=0.163 grad_norm=4.41 num_segments=256 num_words=217
2020-06-10 13:39:26,876: 17) loss=0.181 grad_norm=4.37 num_segments=256 num_words=214
2020-06-10 13:40:33,311: 18) loss=0.168 grad_norm=5.66 num_segments=256 num_words=205
2020-06-10 13:41:46,961: 19) loss=0.295 grad_norm=7.16 num_segments=256 num_words=220
2020-06-10 13:42:56,235: 20) loss=0.179 grad_norm=6.56 num_segments=256 num_words=213
2020-06-10 13:44:07,178: 21) loss=0.171 grad_norm=3.19 num_segments=256 num_words=220
2020-06-10 13:45:15,895: 22) loss=0.281 grad_norm=6.47 num_segments=256 num_words=217
2020-06-10 13:46:25,220: 23) loss=0.177 grad_norm=9.73 num_segments=256 num_words=209
2020-06-10 13:47:39,811: 24) loss=0.181 grad_norm=3.75 num_segments=256 num_words=211
2020-06-10 13:48:46,079: 25) loss=0.160 grad_norm=3.35 num_segments=256 num_words=211
2020-06-10 13:49:54,063: 26) loss=0.177 grad_norm=9.06 num_segments=256 num_words=211
2020-06-10 13:51:01,783: 27) loss=0.165 grad_norm=4.20 num_segments=256 num_words=211
2020-06-10 13:52:10,624: 28) loss=0.179 grad_norm=3.82 num_segments=256 num_words=201
2020-06-10 13:53:22,025: 29) loss=0.187 grad_norm=5.11 num_segments=256 num_words=213
2020-06-10 13:54:26,496: 30) loss=0.174 grad_norm=4.44 num_segments=256 num_words=205
2020-06-10 13:55:38,614: 31) loss=0.168 grad_norm=3.68 num_segments=256 num_words=211
2020-06-10 13:56:41,553: 32) loss=0.176 grad_norm=4.99 num_segments=256 num_words=215
2020-06-10 13:57:46,030: 33) loss=0.174 grad_norm=6.13 num_segments=256 num_words=211
2020-06-10 13:58:50,974: 34) loss=0.188 grad_norm=6.25 num_segments=256 num_words=207
2020-06-10 13:59:56,123: 35) loss=0.159 grad_norm=4.23 num_segments=256 num_words=211
2020-06-10 14:00:58,462: 36) loss=0.163 grad_norm=4.39 num_segments=256 num_words=218
2020-06-10 14:02:05,451: 37) loss=0.175 grad_norm=5.50 num_segments=256 num_words=216
2020-06-10 14:03:01,992: 38) loss=0.190 grad_norm=4.96 num_segments=243 num_words=187
2020-06-10 14:03:02,003: epoch= 34.00
2020-06-10 14:03:02,003:  >> time to evaluate and save:
2020-06-10 14:03:02,033: saved save/MultiViewDataset_IndividualWords.1326.pth
2020-06-10 14:03:02,035: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 14:03:02,045: saved MultiViewDataset_IndividualWords successfully
2020-06-10 14:03:03,350: saved save/MultiViewRNN.1326.pth
2020-06-10 14:03:03,351: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 14:03:03,404: saved MultiViewRNN successfully
2020-06-10 14:03:05,982: saved save/Adam.1326.pth
2020-06-10 14:03:06,035: most_recent linked save/Adam.most_recent.pth
2020-06-10 14:03:06,089: saved Adam successfully
2020-06-10 14:03:06,091: saved save/ReduceLROnPlateau.1326.pth
2020-06-10 14:03:06,093: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 14:03:06,195: saved ReduceLROnPlateau successfully
2020-06-10 14:03:06,196: saved config successfully
2020-06-10 14:04:44,296:   >> crossview_ap=0.721 (10966 x 3921 pairs)
2020-06-10 14:05:51,187:   >> acoustic_ap=0.776 (10966 choose 2 pairs)
2020-06-10 14:05:51,190: best_so_far= 0.721 at 1326
2020-06-10 14:05:51,194: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 14:05:51,355: saved MultiViewDataset_IndividualWords successfully
2020-06-10 14:05:51,356: best linked save/MultiViewRNN.best.pth
2020-06-10 14:05:51,410: saved MultiViewRNN successfully
2020-06-10 14:05:51,412: best linked save/Adam.best.pth
2020-06-10 14:05:51,464: saved Adam successfully
2020-06-10 14:05:51,465: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 14:05:51,482: saved ReduceLROnPlateau successfully
2020-06-10 14:05:51,541: epoch=34.00 global_step=1326 lr=0.0001 start_iter=0
2020-06-10 14:05:51,541: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 14:07:08,883: 0) loss=0.168 grad_norm=5.59 num_segments=256 num_words=214
2020-06-10 14:08:32,193: 1) loss=0.167 grad_norm=3.86 num_segments=256 num_words=206
2020-06-10 14:09:38,347: 2) loss=0.160 grad_norm=5.43 num_segments=256 num_words=214
2020-06-10 14:10:43,342: 3) loss=0.188 grad_norm=5.29 num_segments=256 num_words=213
2020-06-10 14:11:46,807: 4) loss=0.220 grad_norm=5.68 num_segments=256 num_words=206
2020-06-10 14:12:48,729: 5) loss=0.168 grad_norm=3.31 num_segments=256 num_words=208
2020-06-10 14:13:52,782: 6) loss=0.176 grad_norm=4.36 num_segments=256 num_words=205
2020-06-10 14:14:59,021: 7) loss=0.178 grad_norm=4.86 num_segments=256 num_words=207
2020-06-10 14:16:03,052: 8) loss=0.187 grad_norm=4.69 num_segments=256 num_words=206
2020-06-10 14:17:06,460: 9) loss=0.179 grad_norm=4.17 num_segments=256 num_words=211
2020-06-10 14:18:12,054: 10) loss=0.176 grad_norm=6.41 num_segments=256 num_words=203
2020-06-10 14:19:15,320: 11) loss=0.162 grad_norm=7.50 num_segments=256 num_words=220
2020-06-10 14:20:31,682: 12) loss=0.164 grad_norm=4.57 num_segments=256 num_words=214
2020-06-10 14:21:41,629: 13) loss=0.192 grad_norm=3.07 num_segments=256 num_words=207
2020-06-10 14:22:44,708: 14) loss=0.190 grad_norm=3.44 num_segments=256 num_words=206
2020-06-10 14:23:48,292: 15) loss=0.165 grad_norm=4.15 num_segments=256 num_words=208
2020-06-10 14:24:55,913: 16) loss=0.288 grad_norm=5.56 num_segments=256 num_words=213
2020-06-10 14:26:05,827: 17) loss=0.179 grad_norm=5.98 num_segments=256 num_words=213
2020-06-10 14:27:13,594: 18) loss=0.179 grad_norm=3.75 num_segments=256 num_words=211
2020-06-10 14:28:21,325: 19) loss=0.185 grad_norm=5.91 num_segments=256 num_words=204
2020-06-10 14:29:28,692: 20) loss=0.169 grad_norm=18.17 num_segments=256 num_words=216
2020-06-10 14:30:35,645: 21) loss=0.176 grad_norm=3.69 num_segments=256 num_words=209
2020-06-10 14:31:47,267: 22) loss=0.173 grad_norm=4.94 num_segments=256 num_words=205
2020-06-10 14:32:55,501: 23) loss=0.171 grad_norm=4.45 num_segments=256 num_words=204
2020-06-10 14:34:04,721: 24) loss=0.167 grad_norm=4.37 num_segments=256 num_words=211
2020-06-10 14:35:12,695: 25) loss=0.160 grad_norm=5.12 num_segments=256 num_words=211
2020-06-10 14:36:37,487: 26) loss=0.170 grad_norm=3.70 num_segments=256 num_words=216
2020-06-10 14:37:45,215: 27) loss=0.167 grad_norm=4.11 num_segments=256 num_words=219
2020-06-10 14:38:52,894: 28) loss=0.162 grad_norm=3.67 num_segments=256 num_words=215
2020-06-10 14:39:59,386: 29) loss=0.164 grad_norm=3.88 num_segments=256 num_words=210
2020-06-10 14:41:06,750: 30) loss=0.171 grad_norm=6.63 num_segments=256 num_words=213
2020-06-10 14:42:16,046: 31) loss=0.189 grad_norm=4.89 num_segments=256 num_words=213
2020-06-10 14:43:24,689: 32) loss=0.191 grad_norm=5.44 num_segments=256 num_words=209
2020-06-10 14:44:31,204: 33) loss=0.164 grad_norm=3.39 num_segments=256 num_words=217
2020-06-10 14:45:37,877: 34) loss=0.294 grad_norm=7.13 num_segments=256 num_words=226
2020-06-10 14:46:45,105: 35) loss=0.172 grad_norm=4.87 num_segments=256 num_words=215
2020-06-10 14:47:51,986: 36) loss=0.170 grad_norm=3.34 num_segments=256 num_words=211
2020-06-10 14:49:00,250: 37) loss=0.164 grad_norm=3.59 num_segments=256 num_words=211
2020-06-10 14:50:03,530: 38) loss=0.160 grad_norm=4.01 num_segments=243 num_words=196
2020-06-10 14:50:03,542: epoch= 35.00
2020-06-10 14:50:03,542:  >> time to evaluate and save:
2020-06-10 14:50:03,587: saved save/MultiViewDataset_IndividualWords.1365.pth
2020-06-10 14:50:03,596: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 14:50:03,609: saved MultiViewDataset_IndividualWords successfully
2020-06-10 14:50:05,011: saved save/MultiViewRNN.1365.pth
2020-06-10 14:50:05,020: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 14:50:05,068: saved MultiViewRNN successfully
2020-06-10 14:50:07,631: saved save/Adam.1365.pth
2020-06-10 14:50:07,648: most_recent linked save/Adam.most_recent.pth
2020-06-10 14:50:07,666: saved Adam successfully
2020-06-10 14:50:07,669: saved save/ReduceLROnPlateau.1365.pth
2020-06-10 14:50:07,682: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 14:50:07,696: saved ReduceLROnPlateau successfully
2020-06-10 14:50:07,698: saved config successfully
2020-06-10 14:51:45,385:   >> crossview_ap=0.723 (10966 x 3921 pairs)
2020-06-10 14:52:51,579:   >> acoustic_ap=0.780 (10966 choose 2 pairs)
2020-06-10 14:52:51,582: best_so_far= 0.723 at 1365
2020-06-10 14:52:52,464: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 14:52:52,519: saved MultiViewDataset_IndividualWords successfully
2020-06-10 14:52:52,711: best linked save/MultiViewRNN.best.pth
2020-06-10 14:52:52,767: saved MultiViewRNN successfully
2020-06-10 14:52:52,771: best linked save/Adam.best.pth
2020-06-10 14:52:52,811: saved Adam successfully
2020-06-10 14:52:52,876: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 14:52:52,927: saved ReduceLROnPlateau successfully
2020-06-10 14:52:53,541: epoch=35.00 global_step=1365 lr=0.0001 start_iter=0
2020-06-10 14:52:53,542: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 14:54:10,287: 0) loss=0.168 grad_norm=4.10 num_segments=256 num_words=216
2020-06-10 14:55:27,386: 1) loss=0.179 grad_norm=2.84 num_segments=256 num_words=213
2020-06-10 14:56:43,577: 2) loss=0.165 grad_norm=3.78 num_segments=256 num_words=212
2020-06-10 14:58:07,350: 3) loss=0.182 grad_norm=3.97 num_segments=256 num_words=206
2020-06-10 14:59:32,105: 4) loss=0.187 grad_norm=4.10 num_segments=256 num_words=211
2020-06-10 15:01:15,628: 5) loss=0.173 grad_norm=3.97 num_segments=256 num_words=205
2020-06-10 15:02:27,191: 6) loss=0.187 grad_norm=3.26 num_segments=256 num_words=202
2020-06-10 15:03:40,466: 7) loss=0.183 grad_norm=4.55 num_segments=256 num_words=210
2020-06-10 15:04:48,262: 8) loss=0.157 grad_norm=3.54 num_segments=256 num_words=214
2020-06-10 15:05:55,482: 9) loss=0.162 grad_norm=4.13 num_segments=256 num_words=204
2020-06-10 15:07:03,153: 10) loss=0.173 grad_norm=4.81 num_segments=256 num_words=203
2020-06-10 15:08:15,361: 11) loss=0.163 grad_norm=3.23 num_segments=256 num_words=216
2020-06-10 15:09:31,587: 12) loss=0.160 grad_norm=4.21 num_segments=256 num_words=219
2020-06-10 15:10:45,692: 13) loss=0.176 grad_norm=3.20 num_segments=256 num_words=216
2020-06-10 15:12:01,346: 14) loss=0.162 grad_norm=3.79 num_segments=256 num_words=214
2020-06-10 15:13:21,207: 15) loss=0.174 grad_norm=3.99 num_segments=256 num_words=210
2020-06-10 15:14:37,715: 16) loss=0.177 grad_norm=2.98 num_segments=256 num_words=203
2020-06-10 15:15:45,823: 17) loss=0.167 grad_norm=2.75 num_segments=256 num_words=209
2020-06-10 15:16:56,111: 18) loss=0.158 grad_norm=3.58 num_segments=256 num_words=216
2020-06-10 15:18:06,070: 19) loss=0.161 grad_norm=3.47 num_segments=256 num_words=207
2020-06-10 15:19:16,805: 20) loss=0.170 grad_norm=3.10 num_segments=256 num_words=204
2020-06-10 15:20:28,169: 21) loss=0.158 grad_norm=3.50 num_segments=256 num_words=216
2020-06-10 15:21:39,818: 22) loss=0.174 grad_norm=2.92 num_segments=256 num_words=206
2020-06-10 15:22:49,559: 23) loss=0.178 grad_norm=3.26 num_segments=256 num_words=208
2020-06-10 15:24:02,418: 24) loss=0.177 grad_norm=3.73 num_segments=256 num_words=207
2020-06-10 15:25:14,338: 25) loss=0.192 grad_norm=5.87 num_segments=256 num_words=207
2020-06-10 15:26:54,551: 26) loss=0.166 grad_norm=4.50 num_segments=256 num_words=212
2020-06-10 15:28:09,259: 27) loss=0.174 grad_norm=3.59 num_segments=256 num_words=209
2020-06-10 15:29:22,593: 28) loss=0.195 grad_norm=4.34 num_segments=256 num_words=220
2020-06-10 15:30:31,008: 29) loss=0.177 grad_norm=4.34 num_segments=256 num_words=208
2020-06-10 15:31:40,155: 30) loss=0.230 grad_norm=3.57 num_segments=256 num_words=202
2020-06-10 15:32:49,582: 31) loss=0.168 grad_norm=3.98 num_segments=256 num_words=208
2020-06-10 15:33:58,794: 32) loss=0.198 grad_norm=5.11 num_segments=256 num_words=213
2020-06-10 15:35:08,526: 33) loss=0.167 grad_norm=3.05 num_segments=256 num_words=204
2020-06-10 15:36:17,511: 34) loss=0.177 grad_norm=3.15 num_segments=256 num_words=212
2020-06-10 15:37:27,619: 35) loss=0.158 grad_norm=3.05 num_segments=256 num_words=211
2020-06-10 15:38:38,028: 36) loss=0.186 grad_norm=6.11 num_segments=256 num_words=204
2020-06-10 15:39:46,477: 37) loss=0.171 grad_norm=5.71 num_segments=256 num_words=206
2020-06-10 15:40:50,466: 38) loss=0.181 grad_norm=3.06 num_segments=243 num_words=197
2020-06-10 15:40:50,486: epoch= 36.00
2020-06-10 15:40:50,486:  >> time to evaluate and save:
2020-06-10 15:40:50,540: saved save/MultiViewDataset_IndividualWords.1404.pth
2020-06-10 15:40:50,586: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 15:40:50,598: saved MultiViewDataset_IndividualWords successfully
2020-06-10 15:40:51,867: saved save/MultiViewRNN.1404.pth
2020-06-10 15:40:51,880: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 15:40:51,916: saved MultiViewRNN successfully
2020-06-10 15:40:54,414: saved save/Adam.1404.pth
2020-06-10 15:40:54,436: most_recent linked save/Adam.most_recent.pth
2020-06-10 15:40:54,452: saved Adam successfully
2020-06-10 15:40:54,454: saved save/ReduceLROnPlateau.1404.pth
2020-06-10 15:40:54,481: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 15:40:54,496: saved ReduceLROnPlateau successfully
2020-06-10 15:40:54,498: saved config successfully
2020-06-10 15:42:28,529:   >> crossview_ap=0.724 (10966 x 3921 pairs)
2020-06-10 15:43:30,377:   >> acoustic_ap=0.780 (10966 choose 2 pairs)
2020-06-10 15:43:30,381: best_so_far= 0.724 at 1404
2020-06-10 15:43:30,407: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 15:43:30,419: saved MultiViewDataset_IndividualWords successfully
2020-06-10 15:43:30,469: best linked save/MultiViewRNN.best.pth
2020-06-10 15:43:30,519: saved MultiViewRNN successfully
2020-06-10 15:43:30,552: best linked save/Adam.best.pth
2020-06-10 15:43:30,593: saved Adam successfully
2020-06-10 15:43:30,638: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 15:43:30,663: saved ReduceLROnPlateau successfully
2020-06-10 15:43:31,795: epoch=36.00 global_step=1404 lr=0.0001 start_iter=0
2020-06-10 15:43:31,796: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 15:44:45,173: 0) loss=0.182 grad_norm=4.54 num_segments=256 num_words=210
2020-06-10 15:45:57,436: 1) loss=0.157 grad_norm=4.06 num_segments=256 num_words=221
2020-06-10 15:47:05,888: 2) loss=0.181 grad_norm=2.68 num_segments=256 num_words=207
2020-06-10 15:48:15,743: 3) loss=0.170 grad_norm=3.73 num_segments=256 num_words=213
2020-06-10 15:49:26,466: 4) loss=0.204 grad_norm=3.69 num_segments=256 num_words=202
2020-06-10 15:50:36,075: 5) loss=0.195 grad_norm=6.25 num_segments=256 num_words=210
2020-06-10 15:51:47,372: 6) loss=0.206 grad_norm=4.37 num_segments=256 num_words=216
2020-06-10 15:52:55,857: 7) loss=0.194 grad_norm=3.20 num_segments=256 num_words=204
2020-06-10 15:54:07,465: 8) loss=0.161 grad_norm=3.73 num_segments=256 num_words=214
2020-06-10 15:55:13,927: 9) loss=0.167 grad_norm=3.87 num_segments=256 num_words=214
2020-06-10 15:56:20,952: 10) loss=0.164 grad_norm=3.04 num_segments=256 num_words=217
2020-06-10 15:57:28,915: 11) loss=0.161 grad_norm=4.99 num_segments=256 num_words=208
2020-06-10 15:58:38,388: 12) loss=0.188 grad_norm=4.03 num_segments=256 num_words=211
2020-06-10 15:59:43,928: 13) loss=0.167 grad_norm=3.91 num_segments=256 num_words=209
2020-06-10 16:01:27,065: 14) loss=0.160 grad_norm=4.02 num_segments=256 num_words=220
2020-06-10 16:02:31,317: 15) loss=0.167 grad_norm=4.16 num_segments=256 num_words=214
2020-06-10 16:03:36,656: 16) loss=0.165 grad_norm=2.72 num_segments=256 num_words=222
2020-06-10 16:04:41,068: 17) loss=0.194 grad_norm=5.08 num_segments=256 num_words=198
2020-06-10 16:05:46,727: 18) loss=0.162 grad_norm=3.49 num_segments=256 num_words=209
2020-06-10 16:06:52,527: 19) loss=0.180 grad_norm=3.94 num_segments=256 num_words=210
2020-06-10 16:07:58,753: 20) loss=0.163 grad_norm=2.86 num_segments=256 num_words=201
2020-06-10 16:09:03,950: 21) loss=0.184 grad_norm=3.44 num_segments=256 num_words=196
2020-06-10 16:10:09,226: 22) loss=0.192 grad_norm=3.82 num_segments=256 num_words=204
2020-06-10 16:11:14,468: 23) loss=0.169 grad_norm=2.84 num_segments=256 num_words=204
2020-06-10 16:12:20,031: 24) loss=0.175 grad_norm=3.61 num_segments=256 num_words=221
2020-06-10 16:13:25,104: 25) loss=0.182 grad_norm=3.62 num_segments=256 num_words=210
2020-06-10 16:14:30,627: 26) loss=0.182 grad_norm=5.01 num_segments=256 num_words=200
2020-06-10 16:15:36,360: 27) loss=0.169 grad_norm=2.83 num_segments=256 num_words=213
2020-06-10 16:16:44,116: 28) loss=0.165 grad_norm=2.91 num_segments=256 num_words=201
2020-06-10 16:17:50,396: 29) loss=0.167 grad_norm=2.97 num_segments=256 num_words=207
2020-06-10 16:18:55,557: 30) loss=0.178 grad_norm=4.24 num_segments=256 num_words=207
2020-06-10 16:20:00,731: 31) loss=0.166 grad_norm=4.04 num_segments=256 num_words=215
2020-06-10 16:21:08,016: 32) loss=0.170 grad_norm=6.39 num_segments=256 num_words=223
2020-06-10 16:22:13,833: 33) loss=0.174 grad_norm=3.72 num_segments=256 num_words=213
2020-06-10 16:23:19,175: 34) loss=0.203 grad_norm=3.27 num_segments=256 num_words=206
2020-06-10 16:24:24,807: 35) loss=0.182 grad_norm=4.89 num_segments=256 num_words=214
2020-06-10 16:25:30,288: 36) loss=0.171 grad_norm=2.93 num_segments=256 num_words=208
2020-06-10 16:26:35,685: 37) loss=0.151 grad_norm=3.30 num_segments=256 num_words=218
2020-06-10 16:27:37,113: 38) loss=0.273 grad_norm=4.92 num_segments=243 num_words=199
2020-06-10 16:27:37,144: epoch= 37.00
2020-06-10 16:27:37,144:  >> time to evaluate and save:
2020-06-10 16:27:37,185: saved save/MultiViewDataset_IndividualWords.1443.pth
2020-06-10 16:27:37,201: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 16:27:37,211: saved MultiViewDataset_IndividualWords successfully
2020-06-10 16:27:38,583: saved save/MultiViewRNN.1443.pth
2020-06-10 16:27:38,590: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 16:27:38,645: saved MultiViewRNN successfully
2020-06-10 16:27:41,215: saved save/Adam.1443.pth
2020-06-10 16:27:41,220: most_recent linked save/Adam.most_recent.pth
2020-06-10 16:27:41,236: saved Adam successfully
2020-06-10 16:27:41,238: saved save/ReduceLROnPlateau.1443.pth
2020-06-10 16:27:41,247: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 16:27:41,262: saved ReduceLROnPlateau successfully
2020-06-10 16:27:41,263: saved config successfully
2020-06-10 16:29:21,287:   >> crossview_ap=0.726 (10966 x 3921 pairs)
2020-06-10 16:30:28,957:   >> acoustic_ap=0.781 (10966 choose 2 pairs)
2020-06-10 16:30:28,961: best_so_far= 0.726 at 1443
2020-06-10 16:30:28,973: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 16:30:28,982: saved MultiViewDataset_IndividualWords successfully
2020-06-10 16:30:28,998: best linked save/MultiViewRNN.best.pth
2020-06-10 16:30:29,045: saved MultiViewRNN successfully
2020-06-10 16:30:29,059: best linked save/Adam.best.pth
2020-06-10 16:30:29,100: saved Adam successfully
2020-06-10 16:30:29,106: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 16:30:29,280: saved ReduceLROnPlateau successfully
2020-06-10 16:30:30,588: epoch=37.00 global_step=1443 lr=0.0001 start_iter=0
2020-06-10 16:30:30,589: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 16:31:46,130: 0) loss=0.155 grad_norm=3.79 num_segments=256 num_words=209
2020-06-10 16:32:58,326: 1) loss=0.178 grad_norm=3.29 num_segments=256 num_words=203
2020-06-10 16:34:08,460: 2) loss=0.293 grad_norm=6.32 num_segments=256 num_words=210
2020-06-10 16:35:15,883: 3) loss=0.166 grad_norm=4.04 num_segments=256 num_words=211
2020-06-10 16:36:26,224: 4) loss=0.174 grad_norm=3.30 num_segments=256 num_words=206
2020-06-10 16:37:34,421: 5) loss=0.268 grad_norm=4.76 num_segments=256 num_words=204
2020-06-10 16:38:38,599: 6) loss=0.188 grad_norm=4.93 num_segments=256 num_words=215
2020-06-10 16:39:42,169: 7) loss=0.180 grad_norm=3.10 num_segments=256 num_words=214
2020-06-10 16:40:46,419: 8) loss=0.173 grad_norm=4.41 num_segments=256 num_words=213
2020-06-10 16:42:35,371: 9) loss=0.165 grad_norm=4.11 num_segments=256 num_words=216
2020-06-10 16:43:38,864: 10) loss=0.195 grad_norm=4.33 num_segments=256 num_words=210
2020-06-10 16:44:46,878: 11) loss=0.183 grad_norm=3.08 num_segments=256 num_words=219
2020-06-10 16:45:47,536: 12) loss=0.186 grad_norm=3.40 num_segments=256 num_words=209
2020-06-10 16:46:50,682: 13) loss=0.158 grad_norm=3.28 num_segments=256 num_words=213
2020-06-10 16:47:51,282: 14) loss=0.218 grad_norm=4.19 num_segments=256 num_words=199
2020-06-10 16:48:51,973: 15) loss=0.148 grad_norm=3.83 num_segments=256 num_words=216
2020-06-10 16:49:52,705: 16) loss=0.179 grad_norm=3.44 num_segments=256 num_words=211
2020-06-10 16:50:53,536: 17) loss=0.182 grad_norm=3.71 num_segments=256 num_words=209
2020-06-10 16:51:54,690: 18) loss=0.166 grad_norm=3.23 num_segments=256 num_words=214
2020-06-10 16:52:55,328: 19) loss=0.284 grad_norm=6.66 num_segments=256 num_words=215
2020-06-10 16:53:56,073: 20) loss=0.202 grad_norm=3.28 num_segments=256 num_words=205
2020-06-10 16:54:56,921: 21) loss=0.190 grad_norm=5.52 num_segments=256 num_words=206
2020-06-10 16:55:58,139: 22) loss=0.151 grad_norm=2.43 num_segments=256 num_words=211
2020-06-10 16:56:58,950: 23) loss=0.179 grad_norm=4.78 num_segments=256 num_words=208
2020-06-10 16:58:00,079: 24) loss=0.169 grad_norm=2.86 num_segments=256 num_words=207
2020-06-10 16:59:01,078: 25) loss=0.157 grad_norm=2.73 num_segments=256 num_words=217
2020-06-10 17:00:01,988: 26) loss=0.180 grad_norm=5.74 num_segments=256 num_words=213
2020-06-10 17:01:03,120: 27) loss=0.173 grad_norm=3.13 num_segments=256 num_words=204
2020-06-10 17:02:04,326: 28) loss=0.180 grad_norm=4.37 num_segments=256 num_words=210
2020-06-10 17:03:05,572: 29) loss=0.161 grad_norm=2.69 num_segments=256 num_words=208
2020-06-10 17:04:06,670: 30) loss=0.168 grad_norm=3.42 num_segments=256 num_words=211
2020-06-10 17:05:08,299: 31) loss=0.184 grad_norm=3.51 num_segments=256 num_words=206
2020-06-10 17:06:09,269: 32) loss=0.176 grad_norm=5.44 num_segments=256 num_words=215
2020-06-10 17:07:10,401: 33) loss=0.174 grad_norm=4.96 num_segments=256 num_words=216
2020-06-10 17:08:11,679: 34) loss=0.162 grad_norm=3.61 num_segments=256 num_words=219
2020-06-10 17:09:12,718: 35) loss=0.219 grad_norm=5.25 num_segments=256 num_words=204
2020-06-10 17:10:13,836: 36) loss=0.193 grad_norm=3.68 num_segments=256 num_words=197
2020-06-10 17:11:14,706: 37) loss=0.178 grad_norm=3.13 num_segments=256 num_words=219
2020-06-10 17:12:10,006: 38) loss=0.210 grad_norm=3.80 num_segments=243 num_words=199
2020-06-10 17:12:10,016: epoch= 38.00
2020-06-10 17:12:10,016:  >> time to evaluate and save:
2020-06-10 17:12:10,052: saved save/MultiViewDataset_IndividualWords.1482.pth
2020-06-10 17:12:10,067: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 17:12:10,079: saved MultiViewDataset_IndividualWords successfully
2020-06-10 17:12:11,457: saved save/MultiViewRNN.1482.pth
2020-06-10 17:12:11,469: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 17:12:11,502: saved MultiViewRNN successfully
2020-06-10 17:12:14,025: saved save/Adam.1482.pth
2020-06-10 17:12:14,036: most_recent linked save/Adam.most_recent.pth
2020-06-10 17:12:14,051: saved Adam successfully
2020-06-10 17:12:14,053: saved save/ReduceLROnPlateau.1482.pth
2020-06-10 17:12:14,059: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 17:12:14,070: saved ReduceLROnPlateau successfully
2020-06-10 17:12:14,071: saved config successfully
2020-06-10 17:13:54,724:   >> crossview_ap=0.727 (10966 x 3921 pairs)
2020-06-10 17:14:34,077: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-10 17:14:34,129: Using 1 GPU(s)
2020-06-10 17:14:34,130: Machine: 0 / 1
2020-06-10 17:14:34,133: Hyperparam tuning-------------------
2020-06-10 17:14:34,133: optim_lr: 0.001
2020-06-10 17:14:34,134: dropout (for both): 0.4
2020-06-10 17:14:34,134: margin: 0.4
2020-06-10 17:14:34,134: ------------------------------------
2020-06-10 17:14:34,138: Calling main function: multiview_trainer.train
2020-06-10 17:14:34,138: Using config file: train_config.json
2020-06-10 17:14:34,138: Using module at multiview_trainer.train
2020-06-10 17:14:35,332: Using module at multiview_vocab.MultiViewVocab
2020-06-10 17:14:35,391: Building vocab_data from config
2020-06-10 17:14:35,673:  >> min_count= 0
2020-06-10 17:14:35,673:  >> # words= 34323 (# removed= 0)
2020-06-10 17:14:35,673:  >> # subwords= 45
2020-06-10 17:14:35,673:     [laughter]= 1
2020-06-10 17:14:35,673:     [noise]= 2
2020-06-10 17:14:35,673:     [vocalized-noise]= 3
2020-06-10 17:14:35,674:     aa= 4
2020-06-10 17:14:35,674:     ae= 5
2020-06-10 17:14:35,674:     ah= 6
2020-06-10 17:14:35,674:     ao= 7
2020-06-10 17:14:35,674:     aw= 8
2020-06-10 17:14:35,674:     ax= 9
2020-06-10 17:14:35,674:     ay= 10
2020-06-10 17:14:35,674:     b= 11
2020-06-10 17:14:35,674:     ch= 12
2020-06-10 17:14:35,674:     d= 13
2020-06-10 17:14:35,675:     dh= 14
2020-06-10 17:14:35,675:     eh= 15
2020-06-10 17:14:35,675:     el= 16
2020-06-10 17:14:35,675:     en= 17
2020-06-10 17:14:35,675:     er= 18
2020-06-10 17:14:35,675:     ey= 19
2020-06-10 17:14:35,675:     f= 20
2020-06-10 17:14:35,675:     g= 21
2020-06-10 17:14:35,675:     hh= 22
2020-06-10 17:14:35,675:     ih= 23
2020-06-10 17:14:35,675:     iy= 24
2020-06-10 17:14:35,676:     jh= 25
2020-06-10 17:14:35,676:     k= 26
2020-06-10 17:14:35,676:     l= 27
2020-06-10 17:14:35,676:     m= 28
2020-06-10 17:14:35,676:     n= 29
2020-06-10 17:14:35,676:     ng= 30
2020-06-10 17:14:35,676:     ow= 31
2020-06-10 17:14:35,676:     oy= 32
2020-06-10 17:14:35,676:     p= 33
2020-06-10 17:14:35,676:     r= 34
2020-06-10 17:14:35,676:     s= 35
2020-06-10 17:14:35,677:     sh= 36
2020-06-10 17:14:35,677:     t= 37
2020-06-10 17:14:35,677:     th= 38
2020-06-10 17:14:35,677:     uh= 39
2020-06-10 17:14:35,677:     uw= 40
2020-06-10 17:14:35,677:     v= 41
2020-06-10 17:14:35,677:     w= 42
2020-06-10 17:14:35,677:     y= 43
2020-06-10 17:14:35,677:     z= 44
2020-06-10 17:14:35,677:     zh= 45
2020-06-10 17:14:35,693: Using module at data.batch_samplers.BatchSampler
2020-06-10 17:14:35,701: Building vocab_sampler from config
2020-06-10 17:14:35,702:  >> # examples= 34323
2020-06-10 17:14:35,702:  >> batch_size= 1000
2020-06-10 17:14:35,702:  >> shuffle= False
2020-06-10 17:14:35,710:  >> BatchSampler; 35 batches
2020-06-10 17:14:35,710: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 17:14:36,268: Building train_data from config
2020-06-10 17:14:44,096:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-10 17:14:44,097:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-10 17:14:44,097:  >> stack= False
2020-06-10 17:14:44,097:  >> seg_durs= (1, None)
2020-06-10 17:14:44,098:  >> # words= 9971 (# ignored= 0)
2020-06-10 17:14:44,098:  >> input_feat_dim= 108
2020-06-10 17:14:44,098:  >> input_num_subwords= 45
2020-06-10 17:14:44,098: Using module at data.batch_samplers.BatchSampler
2020-06-10 17:14:44,098: Building train_sampler from config
2020-06-10 17:14:44,099:  >> # examples= 9971
2020-06-10 17:14:44,099:  >> batch_size= 256
2020-06-10 17:14:44,099:  >> shuffle= True
2020-06-10 17:14:44,106:  >> BatchSampler; 39 batches
2020-06-10 17:14:44,106: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 17:14:44,106: Building dev_data from config
2020-06-10 17:14:53,405:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 17:14:53,406:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 17:14:53,406:  >> stack= False
2020-06-10 17:14:53,406:  >> seg_durs= (1, None)
2020-06-10 17:14:53,406:  >> # words= 10966 (# ignored= 0)
2020-06-10 17:14:53,406:  >> input_feat_dim= 108
2020-06-10 17:14:53,406:  >> input_num_subwords= 45
2020-06-10 17:14:53,406: Using module at data.batch_samplers.BatchSampler
2020-06-10 17:14:53,407: Building dev_sampler from config
2020-06-10 17:14:53,407:  >> # examples= 10966
2020-06-10 17:14:53,407:  >> batch_size= 256
2020-06-10 17:14:53,407:  >> shuffle= False
2020-06-10 17:14:53,410:  >> BatchSampler; 43 batches
2020-06-10 17:14:53,410: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 17:14:53,410: Building test_data from config
2020-06-10 17:15:00,900:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 17:15:00,901:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 17:15:00,901:  >> stack= False
2020-06-10 17:15:00,901:  >> seg_durs= (1, None)
2020-06-10 17:15:00,901:  >> # words= 11024 (# ignored= 0)
2020-06-10 17:15:00,901:  >> input_feat_dim= 108
2020-06-10 17:15:00,901:  >> input_num_subwords= 45
2020-06-10 17:15:00,902: Using module at data.batch_samplers.BatchSampler
2020-06-10 17:15:00,902: Building test_sampler from config
2020-06-10 17:15:00,903:  >> # examples= 11024
2020-06-10 17:15:00,904:  >> batch_size= 256
2020-06-10 17:15:00,904:  >> shuffle= False
2020-06-10 17:15:00,906:  >> BatchSampler; 44 batches
2020-06-10 17:15:00,906: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-10 17:15:00,986: Building loss from config
2020-06-10 17:15:00,987:  >> margin= 0.4
2020-06-10 17:15:00,987:  >> k= 16
2020-06-10 17:15:00,987:  >> min_k= 8
2020-06-10 17:15:00,987:  >> extra= 0
2020-06-10 17:15:00,987:  >> average= False
2020-06-10 17:15:00,987:  >> margin_max= 0.5
2020-06-10 17:15:00,987:  >> threshold_max= 9
2020-06-10 17:15:00,987:  >> using obj0+2
2020-06-10 17:15:00,988: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 17:15:01,089: Building eval from config
2020-06-10 17:15:01,090:  >> acoustic_ap= True
2020-06-10 17:15:01,090:  >> crossview_ap= True
2020-06-10 17:15:01,090:  >> full_vocab= False
2020-06-10 17:15:01,090:  >> metric= crossview_ap
2020-06-10 17:15:01,090:  >> mode= max
2020-06-10 17:15:01,090: Using module at multiview_rnn.MultiViewRNN
2020-06-10 17:15:01,119: Building net from config
2020-06-10 17:15:01,121: view1:
2020-06-10 17:15:01,123:  >> cell= GRU
2020-06-10 17:15:01,123:  >> input_size= 108
2020-06-10 17:15:01,123:  >> hidden_size= 512
2020-06-10 17:15:01,123:  >> bidirectional= True
2020-06-10 17:15:01,123:  >> num_layers= 6
2020-06-10 17:15:01,123:  >> dropout between layers= 0.4
2020-06-10 17:15:01,362: view2:
2020-06-10 17:15:01,363:  >> cell= GRU
2020-06-10 17:15:01,363:  >> input_size= 64
2020-06-10 17:15:01,363:  >> hidden_size= 512
2020-06-10 17:15:01,363:  >> bidirectional= True
2020-06-10 17:15:01,363:  >> num_layers= 2
2020-06-10 17:15:01,364:  >> dropout between layers= 0.4
2020-06-10 17:15:01,364:  >> num input embeddings= 45
2020-06-10 17:15:05,280: Using module at optim.adam.Adam
2020-06-10 17:15:05,289: Building optim from config
2020-06-10 17:15:05,289:  >> lr= 0.001
2020-06-10 17:15:05,289:  >> betas= (0.9, 0.999)
2020-06-10 17:15:05,289:  >> eps= 1e-08
2020-06-10 17:15:05,289:  >> weight_decay= 0
2020-06-10 17:15:05,289:  >> amsgrad= False
2020-06-10 17:15:05,290:  >> min_lr= 1e-07
2020-06-10 17:15:05,291: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-10 17:15:05,325: Building sched from config
2020-06-10 17:15:05,325:  >> optim= Adam
2020-06-10 17:15:05,325:  >> decay lr by 0.1
2020-06-10 17:15:05,325:  >> eval_fn= MultiViewAP
2020-06-10 17:15:05,326:  >> patience=4
2020-06-10 17:15:05,326:  >> revert=True
2020-06-10 17:15:05,339: loaded save/MultiViewDataset_IndividualWords.1482.pth
2020-06-10 17:15:05,339: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-10 17:15:06,672: loaded save/MultiViewRNN.1482.pth
2020-06-10 17:15:06,672: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-10 17:15:08,896: loaded save/Adam.1482.pth
2020-06-10 17:15:08,897: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-10 17:15:08,900: loaded save/ReduceLROnPlateau.1482.pth
2020-06-10 17:15:08,900: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-10 17:15:08,900: epoch=38.00 global_step=1482 lr=0.0001 start_iter=0
2020-06-10 17:15:08,900: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 17:18:07,941: 0) loss=0.095 grad_norm=1.61 num_segments=256 num_words=206
2020-06-10 17:20:54,403: 1) loss=0.106 grad_norm=2.13 num_segments=256 num_words=216
2020-06-10 17:23:27,022: 2) loss=0.106 grad_norm=2.26 num_segments=256 num_words=199
2020-06-10 17:25:48,321: 3) loss=0.121 grad_norm=2.31 num_segments=256 num_words=205
2020-06-10 17:27:57,946: 4) loss=0.120 grad_norm=2.34 num_segments=256 num_words=208
2020-06-10 17:29:56,699: 5) loss=0.149 grad_norm=3.34 num_segments=256 num_words=196
2020-06-10 17:31:42,548: 6) loss=0.164 grad_norm=3.51 num_segments=256 num_words=203
2020-06-10 17:33:17,400: 7) loss=0.160 grad_norm=3.18 num_segments=256 num_words=207
2020-06-10 17:34:54,341: 8) loss=0.177 grad_norm=3.62 num_segments=256 num_words=207
2020-06-10 17:36:28,690: 9) loss=0.318 grad_norm=5.85 num_segments=256 num_words=211
2020-06-10 17:38:06,035: 10) loss=0.189 grad_norm=5.42 num_segments=256 num_words=209
2020-06-10 17:39:40,352: 11) loss=0.180 grad_norm=4.72 num_segments=256 num_words=223
2020-06-10 17:41:14,583: 12) loss=0.175 grad_norm=3.20 num_segments=256 num_words=202
2020-06-10 17:42:48,652: 13) loss=0.181 grad_norm=3.88 num_segments=256 num_words=209
2020-06-10 17:44:26,713: 14) loss=0.170 grad_norm=3.61 num_segments=256 num_words=207
2020-06-10 17:46:01,265: 15) loss=0.171 grad_norm=3.21 num_segments=256 num_words=209
2020-06-10 17:47:35,834: 16) loss=0.178 grad_norm=2.59 num_segments=256 num_words=200
2020-06-10 17:49:11,311: 17) loss=0.183 grad_norm=4.26 num_segments=256 num_words=216
2020-06-10 17:50:46,418: 18) loss=0.175 grad_norm=3.37 num_segments=256 num_words=222
2020-06-10 17:52:24,988: 19) loss=0.164 grad_norm=3.94 num_segments=256 num_words=219
2020-06-10 17:54:00,120: 20) loss=0.181 grad_norm=5.72 num_segments=256 num_words=213
2020-06-10 17:55:35,139: 21) loss=0.178 grad_norm=2.94 num_segments=256 num_words=206
2020-06-10 17:57:08,838: 22) loss=0.181 grad_norm=3.29 num_segments=256 num_words=209
2020-06-10 17:58:43,006: 23) loss=0.180 grad_norm=3.17 num_segments=256 num_words=209
2020-06-10 18:00:22,690: 24) loss=0.173 grad_norm=3.60 num_segments=256 num_words=215
2020-06-10 18:01:56,666: 25) loss=0.178 grad_norm=3.22 num_segments=256 num_words=208
2020-06-10 18:03:31,019: 26) loss=0.172 grad_norm=4.37 num_segments=256 num_words=213
2020-06-10 18:05:06,110: 27) loss=0.178 grad_norm=3.46 num_segments=256 num_words=215
2020-06-10 18:06:40,982: 28) loss=0.174 grad_norm=3.27 num_segments=256 num_words=213
2020-06-10 18:08:15,569: 29) loss=0.163 grad_norm=2.26 num_segments=256 num_words=210
2020-06-10 18:09:50,737: 30) loss=0.185 grad_norm=4.74 num_segments=256 num_words=212
2020-06-10 18:11:31,543: 31) loss=0.187 grad_norm=2.88 num_segments=256 num_words=209
2020-06-10 18:13:05,640: 32) loss=0.164 grad_norm=3.07 num_segments=256 num_words=219
2020-06-10 18:14:40,736: 33) loss=0.169 grad_norm=3.37 num_segments=256 num_words=220
2020-06-10 18:16:15,379: 34) loss=0.164 grad_norm=2.67 num_segments=256 num_words=209
2020-06-10 18:17:49,871: 35) loss=0.177 grad_norm=2.79 num_segments=256 num_words=214
2020-06-10 18:19:24,740: 36) loss=0.153 grad_norm=4.19 num_segments=256 num_words=212
2020-06-10 18:20:59,783: 37) loss=0.167 grad_norm=3.40 num_segments=256 num_words=215
2020-06-10 18:22:24,848: 38) loss=0.301 grad_norm=4.73 num_segments=243 num_words=196
2020-06-10 18:22:24,865: epoch= 39.00
2020-06-10 18:22:24,865:  >> time to evaluate and save:
2020-06-10 18:22:24,924: saved save/MultiViewDataset_IndividualWords.1521.pth
2020-06-10 18:22:24,942: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 18:22:24,967: saved MultiViewDataset_IndividualWords successfully
2020-06-10 18:22:26,377: saved save/MultiViewRNN.1521.pth
2020-06-10 18:22:26,392: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 18:22:27,472: saved MultiViewRNN successfully
2020-06-10 18:22:30,098: saved save/Adam.1521.pth
2020-06-10 18:22:30,110: most_recent linked save/Adam.most_recent.pth
2020-06-10 18:22:31,115: saved Adam successfully
2020-06-10 18:22:31,215: saved save/ReduceLROnPlateau.1521.pth
2020-06-10 18:22:31,232: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 18:22:31,281: saved ReduceLROnPlateau successfully
2020-06-10 18:22:31,284: saved config successfully
2020-06-10 18:24:16,897:   >> crossview_ap=0.729 (10966 x 3921 pairs)
2020-06-10 18:25:19,018:   >> acoustic_ap=0.783 (10966 choose 2 pairs)
2020-06-10 18:25:19,023: best_so_far= 0.729 at 1521
2020-06-10 18:25:19,059: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 18:25:19,108: saved MultiViewDataset_IndividualWords successfully
2020-06-10 18:25:19,117: best linked save/MultiViewRNN.best.pth
2020-06-10 18:25:19,230: saved MultiViewRNN successfully
2020-06-10 18:25:19,241: best linked save/Adam.best.pth
2020-06-10 18:25:19,346: saved Adam successfully
2020-06-10 18:25:19,359: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 18:25:19,380: saved ReduceLROnPlateau successfully
2020-06-10 18:25:19,468: epoch=39.00 global_step=1521 lr=0.0001 start_iter=0
2020-06-10 18:25:19,469: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 18:26:59,695: 0) loss=0.184 grad_norm=3.19 num_segments=256 num_words=208
2020-06-10 18:28:46,671: 1) loss=0.172 grad_norm=4.26 num_segments=256 num_words=206
2020-06-10 18:30:22,501: 2) loss=0.168 grad_norm=4.58 num_segments=256 num_words=212
2020-06-10 18:31:58,316: 3) loss=0.165 grad_norm=3.11 num_segments=256 num_words=211
2020-06-10 18:33:34,864: 4) loss=0.162 grad_norm=3.18 num_segments=256 num_words=219
2020-06-10 18:35:11,033: 5) loss=0.186 grad_norm=3.93 num_segments=256 num_words=208
2020-06-10 18:36:47,041: 6) loss=0.158 grad_norm=3.81 num_segments=256 num_words=202
2020-06-10 18:38:22,896: 7) loss=0.160 grad_norm=2.79 num_segments=256 num_words=213
2020-06-10 18:39:59,768: 8) loss=0.167 grad_norm=2.89 num_segments=256 num_words=214
2020-06-10 18:41:38,695: 9) loss=0.158 grad_norm=2.82 num_segments=256 num_words=212
2020-06-10 18:43:16,637: 10) loss=0.169 grad_norm=2.89 num_segments=256 num_words=210
2020-06-10 18:44:55,276: 11) loss=0.185 grad_norm=2.90 num_segments=256 num_words=208
2020-06-10 18:46:43,875: 12) loss=0.179 grad_norm=3.34 num_segments=256 num_words=202
2020-06-10 18:48:21,745: 13) loss=0.168 grad_norm=3.20 num_segments=256 num_words=220
2020-06-10 18:50:00,480: 14) loss=0.167 grad_norm=3.12 num_segments=256 num_words=214
2020-06-10 18:51:38,363: 15) loss=0.166 grad_norm=2.60 num_segments=256 num_words=212
2020-06-10 18:53:15,941: 16) loss=0.192 grad_norm=3.13 num_segments=256 num_words=199
2020-06-10 18:54:55,321: 17) loss=0.178 grad_norm=3.14 num_segments=256 num_words=200
2020-06-10 18:56:33,396: 18) loss=0.161 grad_norm=3.07 num_segments=256 num_words=212
2020-06-10 18:58:11,595: 19) loss=0.171 grad_norm=2.98 num_segments=256 num_words=210
2020-06-10 18:59:50,767: 20) loss=0.165 grad_norm=2.95 num_segments=256 num_words=208
2020-06-10 19:01:28,688: 21) loss=0.168 grad_norm=3.36 num_segments=256 num_words=207
2020-06-10 19:03:07,128: 22) loss=0.160 grad_norm=5.11 num_segments=256 num_words=221
2020-06-10 19:04:46,069: 23) loss=0.161 grad_norm=3.00 num_segments=256 num_words=216
2020-06-10 19:06:24,145: 24) loss=0.162 grad_norm=2.77 num_segments=256 num_words=216
2020-06-10 19:08:02,336: 25) loss=0.167 grad_norm=3.14 num_segments=256 num_words=213
2020-06-10 19:09:54,396: 26) loss=0.166 grad_norm=3.26 num_segments=256 num_words=205
2020-06-10 19:11:32,245: 27) loss=0.186 grad_norm=4.16 num_segments=256 num_words=209
2020-06-10 19:13:10,784: 28) loss=0.173 grad_norm=2.23 num_segments=256 num_words=207
2020-06-10 19:14:49,536: 29) loss=0.179 grad_norm=4.77 num_segments=256 num_words=210
2020-06-10 19:16:28,166: 30) loss=0.353 grad_norm=4.34 num_segments=256 num_words=204
2020-06-10 19:18:06,498: 31) loss=0.222 grad_norm=3.65 num_segments=256 num_words=203
2020-06-10 19:19:45,813: 32) loss=0.150 grad_norm=2.78 num_segments=256 num_words=220
2020-06-10 19:21:24,159: 33) loss=0.186 grad_norm=3.51 num_segments=256 num_words=199
2020-06-10 19:23:02,412: 34) loss=0.161 grad_norm=3.90 num_segments=256 num_words=216
2020-06-10 19:24:41,345: 35) loss=0.181 grad_norm=3.17 num_segments=256 num_words=209
2020-06-10 19:26:19,483: 36) loss=0.205 grad_norm=5.62 num_segments=256 num_words=210
2020-06-10 19:27:58,004: 37) loss=0.186 grad_norm=4.25 num_segments=256 num_words=211
2020-06-10 19:29:27,650: 38) loss=0.159 grad_norm=2.75 num_segments=243 num_words=211
2020-06-10 19:29:27,674: epoch= 40.00
2020-06-10 19:29:27,674:  >> time to evaluate and save:
2020-06-10 19:29:27,739: saved save/MultiViewDataset_IndividualWords.1560.pth
2020-06-10 19:29:27,771: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 19:29:27,795: saved MultiViewDataset_IndividualWords successfully
2020-06-10 19:29:29,212: saved save/MultiViewRNN.1560.pth
2020-06-10 19:29:29,222: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 19:29:29,285: saved MultiViewRNN successfully
2020-06-10 19:29:31,880: saved save/Adam.1560.pth
2020-06-10 19:29:31,893: most_recent linked save/Adam.most_recent.pth
2020-06-10 19:29:31,916: saved Adam successfully
2020-06-10 19:29:31,919: saved save/ReduceLROnPlateau.1560.pth
2020-06-10 19:29:31,927: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 19:29:31,944: saved ReduceLROnPlateau successfully
2020-06-10 19:29:31,947: saved config successfully
2020-06-10 19:31:10,669:   >> crossview_ap=0.729 (10966 x 3921 pairs)
2020-06-10 19:32:12,462:   >> acoustic_ap=0.783 (10966 choose 2 pairs)
2020-06-10 19:32:12,477: best_so_far= 0.729 at 1560
2020-06-10 19:32:12,548: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 19:32:12,569: saved MultiViewDataset_IndividualWords successfully
2020-06-10 19:32:12,593: best linked save/MultiViewRNN.best.pth
2020-06-10 19:32:12,712: saved MultiViewRNN successfully
2020-06-10 19:32:12,744: best linked save/Adam.best.pth
2020-06-10 19:32:12,834: saved Adam successfully
2020-06-10 19:32:12,865: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 19:32:12,928: saved ReduceLROnPlateau successfully
2020-06-10 19:32:13,594: epoch=40.00 global_step=1560 lr=0.0001 start_iter=0
2020-06-10 19:32:13,595: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 19:33:53,860: 0) loss=0.175 grad_norm=2.26 num_segments=256 num_words=204
2020-06-10 19:35:31,141: 1) loss=0.171 grad_norm=2.56 num_segments=256 num_words=210
2020-06-10 19:37:08,187: 2) loss=0.165 grad_norm=2.96 num_segments=256 num_words=205
2020-06-10 19:38:44,953: 3) loss=0.169 grad_norm=2.75 num_segments=256 num_words=213
2020-06-10 19:40:23,778: 4) loss=0.162 grad_norm=4.21 num_segments=256 num_words=211
2020-06-10 19:42:21,816: 5) loss=0.184 grad_norm=3.49 num_segments=256 num_words=200
2020-06-10 19:43:59,499: 6) loss=0.168 grad_norm=2.51 num_segments=256 num_words=206
2020-06-10 19:45:37,616: 7) loss=0.194 grad_norm=4.00 num_segments=256 num_words=221
2020-06-10 19:47:15,858: 8) loss=0.153 grad_norm=2.91 num_segments=256 num_words=202
2020-06-10 19:48:54,334: 9) loss=0.160 grad_norm=2.27 num_segments=256 num_words=211
2020-06-10 19:50:33,020: 10) loss=0.167 grad_norm=4.26 num_segments=256 num_words=220
2020-06-10 19:52:11,324: 11) loss=0.163 grad_norm=3.03 num_segments=256 num_words=213
2020-06-10 19:53:49,781: 12) loss=0.182 grad_norm=2.84 num_segments=256 num_words=213
2020-06-10 19:55:28,219: 13) loss=0.165 grad_norm=3.39 num_segments=256 num_words=210
2020-06-10 19:57:06,257: 14) loss=0.154 grad_norm=2.80 num_segments=256 num_words=220
2020-06-10 19:58:44,513: 15) loss=0.165 grad_norm=2.83 num_segments=256 num_words=218
2020-06-10 20:00:22,279: 16) loss=0.142 grad_norm=3.10 num_segments=256 num_words=211
2020-06-10 20:02:00,238: 17) loss=0.170 grad_norm=2.36 num_segments=256 num_words=214
2020-06-10 20:03:38,653: 18) loss=0.162 grad_norm=2.77 num_segments=256 num_words=207
2020-06-10 20:05:17,802: 19) loss=0.325 grad_norm=3.99 num_segments=256 num_words=220
2020-06-10 20:06:56,216: 20) loss=0.159 grad_norm=3.39 num_segments=256 num_words=216
2020-06-10 20:08:34,723: 21) loss=0.188 grad_norm=3.95 num_segments=256 num_words=204
2020-06-10 20:10:13,894: 22) loss=0.183 grad_norm=4.91 num_segments=256 num_words=207
2020-06-10 20:11:51,624: 23) loss=0.159 grad_norm=3.26 num_segments=256 num_words=214
2020-06-10 20:13:29,557: 24) loss=0.183 grad_norm=3.12 num_segments=256 num_words=203
2020-06-10 20:15:08,316: 25) loss=0.170 grad_norm=3.17 num_segments=256 num_words=213
2020-06-10 20:17:08,235: 26) loss=0.199 grad_norm=4.00 num_segments=256 num_words=212
2020-06-10 20:18:46,892: 27) loss=0.169 grad_norm=3.15 num_segments=256 num_words=210
2020-06-10 20:20:25,679: 28) loss=0.161 grad_norm=3.98 num_segments=256 num_words=210
2020-06-10 20:22:04,327: 29) loss=0.173 grad_norm=3.72 num_segments=256 num_words=214
2020-06-10 20:23:43,036: 30) loss=0.165 grad_norm=4.21 num_segments=256 num_words=206
2020-06-10 20:25:21,568: 31) loss=0.187 grad_norm=4.19 num_segments=256 num_words=216
2020-06-10 20:27:00,182: 32) loss=0.175 grad_norm=3.43 num_segments=256 num_words=213
2020-06-10 20:28:38,122: 33) loss=0.173 grad_norm=3.44 num_segments=256 num_words=205
2020-06-10 20:30:15,759: 34) loss=0.183 grad_norm=6.12 num_segments=256 num_words=211
2020-06-10 20:31:52,166: 35) loss=0.170 grad_norm=3.00 num_segments=256 num_words=206
2020-06-10 20:33:29,117: 36) loss=0.177 grad_norm=2.60 num_segments=256 num_words=208
2020-06-10 20:35:06,530: 37) loss=0.163 grad_norm=2.90 num_segments=256 num_words=212
2020-06-10 20:36:34,020: 38) loss=0.162 grad_norm=2.62 num_segments=243 num_words=213
2020-06-10 20:36:34,040: epoch= 41.00
2020-06-10 20:36:34,040:  >> time to evaluate and save:
2020-06-10 20:36:34,076: saved save/MultiViewDataset_IndividualWords.1599.pth
2020-06-10 20:36:34,097: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 20:36:34,111: saved MultiViewDataset_IndividualWords successfully
2020-06-10 20:36:35,563: saved save/MultiViewRNN.1599.pth
2020-06-10 20:36:35,577: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 20:36:35,657: saved MultiViewRNN successfully
2020-06-10 20:36:38,211: saved save/Adam.1599.pth
2020-06-10 20:36:38,222: most_recent linked save/Adam.most_recent.pth
2020-06-10 20:36:38,241: saved Adam successfully
2020-06-10 20:36:38,244: saved save/ReduceLROnPlateau.1599.pth
2020-06-10 20:36:38,251: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 20:36:38,266: saved ReduceLROnPlateau successfully
2020-06-10 20:36:38,268: saved config successfully
2020-06-10 20:38:29,047:   >> crossview_ap=0.729 (10966 x 3921 pairs)
2020-06-10 20:39:30,581:   >> acoustic_ap=0.784 (10966 choose 2 pairs)
2020-06-10 20:39:30,592: best_so_far= 0.729 at 1599
2020-06-10 20:39:30,608: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 20:39:30,624: saved MultiViewDataset_IndividualWords successfully
2020-06-10 20:39:30,639: best linked save/MultiViewRNN.best.pth
2020-06-10 20:39:30,726: saved MultiViewRNN successfully
2020-06-10 20:39:30,736: best linked save/Adam.best.pth
2020-06-10 20:39:30,816: saved Adam successfully
2020-06-10 20:39:30,819: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 20:39:31,057: saved ReduceLROnPlateau successfully
2020-06-10 20:39:32,289: epoch=41.00 global_step=1599 lr=0.0001 start_iter=0
2020-06-10 20:39:32,289: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 20:41:12,527: 0) loss=0.193 grad_norm=3.77 num_segments=256 num_words=197
2020-06-10 20:42:49,979: 1) loss=0.180 grad_norm=3.51 num_segments=256 num_words=210
2020-06-10 20:44:29,037: 2) loss=0.187 grad_norm=4.26 num_segments=256 num_words=216
2020-06-10 20:46:06,606: 3) loss=0.169 grad_norm=4.42 num_segments=256 num_words=209
2020-06-10 20:47:43,772: 4) loss=0.180 grad_norm=3.00 num_segments=256 num_words=213
2020-06-10 20:49:21,576: 5) loss=0.173 grad_norm=3.00 num_segments=256 num_words=222
2020-06-10 20:50:58,828: 6) loss=0.190 grad_norm=3.73 num_segments=256 num_words=212
2020-06-10 20:52:35,897: 7) loss=0.193 grad_norm=3.53 num_segments=256 num_words=196
2020-06-10 20:54:15,876: 8) loss=0.172 grad_norm=3.61 num_segments=256 num_words=209
2020-06-10 20:55:55,708: 9) loss=0.181 grad_norm=2.69 num_segments=256 num_words=207
2020-06-10 20:57:34,270: 10) loss=0.182 grad_norm=3.01 num_segments=256 num_words=215
2020-06-10 20:59:13,518: 11) loss=0.148 grad_norm=3.19 num_segments=256 num_words=219
2020-06-10 21:00:52,972: 12) loss=0.172 grad_norm=2.56 num_segments=256 num_words=211
2020-06-10 21:02:31,861: 13) loss=0.183 grad_norm=6.71 num_segments=256 num_words=209
2020-06-10 21:04:47,387: 14) loss=0.172 grad_norm=3.15 num_segments=256 num_words=211
2020-06-10 21:06:27,272: 15) loss=0.169 grad_norm=2.11 num_segments=256 num_words=210
2020-06-10 21:08:06,306: 16) loss=0.195 grad_norm=3.03 num_segments=256 num_words=200
2020-06-10 21:09:45,901: 17) loss=0.162 grad_norm=4.60 num_segments=256 num_words=221
2020-06-10 21:11:25,605: 18) loss=0.158 grad_norm=2.54 num_segments=256 num_words=221
2020-06-10 21:13:05,701: 19) loss=0.172 grad_norm=2.93 num_segments=256 num_words=211
2020-06-10 21:14:45,694: 20) loss=0.166 grad_norm=2.89 num_segments=256 num_words=215
2020-06-10 21:15:20,449: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-10 21:15:20,500: Using 1 GPU(s)
2020-06-10 21:15:20,502: Machine: 0 / 1
2020-06-10 21:15:20,505: Hyperparam tuning-------------------
2020-06-10 21:15:20,505: optim_lr: 0.001
2020-06-10 21:15:20,505: dropout (for both): 0.4
2020-06-10 21:15:20,505: margin: 0.4
2020-06-10 21:15:20,506: ------------------------------------
2020-06-10 21:15:20,510: Calling main function: multiview_trainer.train
2020-06-10 21:15:20,510: Using config file: train_config.json
2020-06-10 21:15:20,510: Using module at multiview_trainer.train
2020-06-10 21:15:22,596: Using module at multiview_vocab.MultiViewVocab
2020-06-10 21:15:22,661: Building vocab_data from config
2020-06-10 21:15:22,993:  >> min_count= 0
2020-06-10 21:15:22,993:  >> # words= 34323 (# removed= 0)
2020-06-10 21:15:22,993:  >> # subwords= 45
2020-06-10 21:15:22,994:     [laughter]= 1
2020-06-10 21:15:22,994:     [noise]= 2
2020-06-10 21:15:22,994:     [vocalized-noise]= 3
2020-06-10 21:15:22,994:     aa= 4
2020-06-10 21:15:22,994:     ae= 5
2020-06-10 21:15:22,994:     ah= 6
2020-06-10 21:15:22,994:     ao= 7
2020-06-10 21:15:22,994:     aw= 8
2020-06-10 21:15:22,994:     ax= 9
2020-06-10 21:15:22,994:     ay= 10
2020-06-10 21:15:22,995:     b= 11
2020-06-10 21:15:22,995:     ch= 12
2020-06-10 21:15:22,995:     d= 13
2020-06-10 21:15:22,995:     dh= 14
2020-06-10 21:15:22,995:     eh= 15
2020-06-10 21:15:22,995:     el= 16
2020-06-10 21:15:22,995:     en= 17
2020-06-10 21:15:22,995:     er= 18
2020-06-10 21:15:22,995:     ey= 19
2020-06-10 21:15:22,995:     f= 20
2020-06-10 21:15:22,995:     g= 21
2020-06-10 21:15:22,996:     hh= 22
2020-06-10 21:15:22,996:     ih= 23
2020-06-10 21:15:22,996:     iy= 24
2020-06-10 21:15:22,996:     jh= 25
2020-06-10 21:15:22,996:     k= 26
2020-06-10 21:15:22,996:     l= 27
2020-06-10 21:15:22,996:     m= 28
2020-06-10 21:15:22,996:     n= 29
2020-06-10 21:15:22,996:     ng= 30
2020-06-10 21:15:22,996:     ow= 31
2020-06-10 21:15:22,996:     oy= 32
2020-06-10 21:15:22,997:     p= 33
2020-06-10 21:15:22,997:     r= 34
2020-06-10 21:15:22,997:     s= 35
2020-06-10 21:15:22,997:     sh= 36
2020-06-10 21:15:22,997:     t= 37
2020-06-10 21:15:22,997:     th= 38
2020-06-10 21:15:22,997:     uh= 39
2020-06-10 21:15:22,997:     uw= 40
2020-06-10 21:15:22,997:     v= 41
2020-06-10 21:15:22,997:     w= 42
2020-06-10 21:15:22,997:     y= 43
2020-06-10 21:15:22,998:     z= 44
2020-06-10 21:15:22,998:     zh= 45
2020-06-10 21:15:23,013: Using module at data.batch_samplers.BatchSampler
2020-06-10 21:15:23,016: Building vocab_sampler from config
2020-06-10 21:15:23,016:  >> # examples= 34323
2020-06-10 21:15:23,017:  >> batch_size= 1000
2020-06-10 21:15:23,017:  >> shuffle= False
2020-06-10 21:15:23,025:  >> BatchSampler; 35 batches
2020-06-10 21:15:23,025: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 21:15:23,334: Building train_data from config
2020-06-10 21:15:31,132:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-10 21:15:31,132:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-10 21:15:31,132:  >> stack= False
2020-06-10 21:15:31,132:  >> seg_durs= (1, None)
2020-06-10 21:15:31,133:  >> # words= 9971 (# ignored= 0)
2020-06-10 21:15:31,133:  >> input_feat_dim= 108
2020-06-10 21:15:31,133:  >> input_num_subwords= 45
2020-06-10 21:15:31,133: Using module at data.batch_samplers.BatchSampler
2020-06-10 21:15:31,133: Building train_sampler from config
2020-06-10 21:15:31,134:  >> # examples= 9971
2020-06-10 21:15:31,134:  >> batch_size= 256
2020-06-10 21:15:31,134:  >> shuffle= True
2020-06-10 21:15:31,141:  >> BatchSampler; 39 batches
2020-06-10 21:15:31,141: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 21:15:31,141: Building dev_data from config
2020-06-10 21:15:40,001:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 21:15:40,002:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 21:15:40,002:  >> stack= False
2020-06-10 21:15:40,002:  >> seg_durs= (1, None)
2020-06-10 21:15:40,002:  >> # words= 10966 (# ignored= 0)
2020-06-10 21:15:40,002:  >> input_feat_dim= 108
2020-06-10 21:15:40,002:  >> input_num_subwords= 45
2020-06-10 21:15:40,002: Using module at data.batch_samplers.BatchSampler
2020-06-10 21:15:40,003: Building dev_sampler from config
2020-06-10 21:15:40,003:  >> # examples= 10966
2020-06-10 21:15:40,003:  >> batch_size= 256
2020-06-10 21:15:40,004:  >> shuffle= False
2020-06-10 21:15:40,006:  >> BatchSampler; 43 batches
2020-06-10 21:15:40,006: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 21:15:40,006: Building test_data from config
2020-06-10 21:15:47,428:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 21:15:47,428:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 21:15:47,428:  >> stack= False
2020-06-10 21:15:47,428:  >> seg_durs= (1, None)
2020-06-10 21:15:47,429:  >> # words= 11024 (# ignored= 0)
2020-06-10 21:15:47,429:  >> input_feat_dim= 108
2020-06-10 21:15:47,429:  >> input_num_subwords= 45
2020-06-10 21:15:47,429: Using module at data.batch_samplers.BatchSampler
2020-06-10 21:15:47,429: Building test_sampler from config
2020-06-10 21:15:47,429:  >> # examples= 11024
2020-06-10 21:15:47,429:  >> batch_size= 256
2020-06-10 21:15:47,429:  >> shuffle= False
2020-06-10 21:15:47,431:  >> BatchSampler; 44 batches
2020-06-10 21:15:47,431: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-10 21:15:47,466: Building loss from config
2020-06-10 21:15:47,466:  >> margin= 0.4
2020-06-10 21:15:47,466:  >> k= 16
2020-06-10 21:15:47,466:  >> min_k= 8
2020-06-10 21:15:47,466:  >> extra= 0
2020-06-10 21:15:47,466:  >> average= False
2020-06-10 21:15:47,466:  >> margin_max= 0.5
2020-06-10 21:15:47,467:  >> threshold_max= 9
2020-06-10 21:15:47,467:  >> using obj0+2
2020-06-10 21:15:47,467: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 21:15:47,522: Building eval from config
2020-06-10 21:15:47,522:  >> acoustic_ap= True
2020-06-10 21:15:47,522:  >> crossview_ap= True
2020-06-10 21:15:47,522:  >> full_vocab= False
2020-06-10 21:15:47,522:  >> metric= crossview_ap
2020-06-10 21:15:47,522:  >> mode= max
2020-06-10 21:15:47,522: Using module at multiview_rnn.MultiViewRNN
2020-06-10 21:15:47,533: Building net from config
2020-06-10 21:15:47,535: view1:
2020-06-10 21:15:47,536:  >> cell= GRU
2020-06-10 21:15:47,536:  >> input_size= 108
2020-06-10 21:15:47,536:  >> hidden_size= 512
2020-06-10 21:15:47,536:  >> bidirectional= True
2020-06-10 21:15:47,536:  >> num_layers= 6
2020-06-10 21:15:47,536:  >> dropout between layers= 0.4
2020-06-10 21:15:47,753: view2:
2020-06-10 21:15:47,754:  >> cell= GRU
2020-06-10 21:15:47,754:  >> input_size= 64
2020-06-10 21:15:47,754:  >> hidden_size= 512
2020-06-10 21:15:47,754:  >> bidirectional= True
2020-06-10 21:15:47,754:  >> num_layers= 2
2020-06-10 21:15:47,754:  >> dropout between layers= 0.4
2020-06-10 21:15:47,754:  >> num input embeddings= 45
2020-06-10 21:15:51,605: Using module at optim.adam.Adam
2020-06-10 21:15:51,640: Building optim from config
2020-06-10 21:15:51,641:  >> lr= 0.001
2020-06-10 21:15:51,641:  >> betas= (0.9, 0.999)
2020-06-10 21:15:51,641:  >> eps= 1e-08
2020-06-10 21:15:51,641:  >> weight_decay= 0
2020-06-10 21:15:51,641:  >> amsgrad= False
2020-06-10 21:15:51,641:  >> min_lr= 1e-07
2020-06-10 21:15:51,648: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-10 21:15:51,714: Building sched from config
2020-06-10 21:15:51,715:  >> optim= Adam
2020-06-10 21:15:51,715:  >> decay lr by 0.1
2020-06-10 21:15:51,715:  >> eval_fn= MultiViewAP
2020-06-10 21:15:51,716:  >> patience=4
2020-06-10 21:15:51,717:  >> revert=True
2020-06-10 21:15:51,729: loaded save/MultiViewDataset_IndividualWords.1599.pth
2020-06-10 21:15:51,730: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-10 21:15:51,861: loaded save/MultiViewRNN.1599.pth
2020-06-10 21:15:51,861: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-10 21:15:52,037: loaded save/Adam.1599.pth
2020-06-10 21:15:52,038: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-10 21:15:52,040: loaded save/ReduceLROnPlateau.1599.pth
2020-06-10 21:15:52,040: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
2020-06-10 21:15:52,040: epoch=41.00 global_step=1599 lr=0.0001 start_iter=0
2020-06-10 21:15:52,040: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 21:18:56,107: 0) loss=0.112 grad_norm=1.62 num_segments=256 num_words=197
2020-06-10 21:22:07,927: 1) loss=0.105 grad_norm=2.42 num_segments=256 num_words=210
2020-06-10 21:25:06,606: 2) loss=0.114 grad_norm=2.97 num_segments=256 num_words=216
2020-06-10 21:27:52,403: 3) loss=0.115 grad_norm=2.03 num_segments=256 num_words=209
2020-06-10 21:30:24,208: 4) loss=0.133 grad_norm=2.48 num_segments=256 num_words=213
2020-06-10 21:32:43,263: 5) loss=0.139 grad_norm=2.41 num_segments=256 num_words=222
2020-06-10 21:34:47,294: 6) loss=0.163 grad_norm=2.97 num_segments=256 num_words=212
2020-06-10 21:36:37,809: 7) loss=0.193 grad_norm=3.64 num_segments=256 num_words=196
2020-06-10 21:38:30,928: 8) loss=0.174 grad_norm=3.78 num_segments=256 num_words=209
2020-06-10 21:40:21,065: 9) loss=0.181 grad_norm=2.77 num_segments=256 num_words=207
2020-06-10 21:42:14,435: 10) loss=0.182 grad_norm=3.03 num_segments=256 num_words=215
2020-06-10 21:44:04,184: 11) loss=0.148 grad_norm=3.22 num_segments=256 num_words=219
2020-06-10 21:45:53,815: 12) loss=0.172 grad_norm=2.49 num_segments=256 num_words=211
2020-06-10 21:47:43,831: 13) loss=0.184 grad_norm=3.86 num_segments=256 num_words=209
2020-06-10 21:49:37,677: 14) loss=0.172 grad_norm=3.15 num_segments=256 num_words=211
2020-06-10 21:51:27,444: 15) loss=0.169 grad_norm=2.50 num_segments=256 num_words=210
2020-06-10 21:53:16,418: 16) loss=0.195 grad_norm=2.77 num_segments=256 num_words=200
2020-06-10 21:55:04,919: 17) loss=0.162 grad_norm=4.14 num_segments=256 num_words=221
2020-06-10 21:56:53,458: 18) loss=0.157 grad_norm=2.61 num_segments=256 num_words=221
2020-06-10 21:58:48,018: 19) loss=0.172 grad_norm=2.94 num_segments=256 num_words=211
2020-06-10 22:00:38,228: 20) loss=0.166 grad_norm=2.83 num_segments=256 num_words=215
2020-06-10 22:02:28,173: 21) loss=0.170 grad_norm=3.15 num_segments=256 num_words=212
2020-06-10 22:04:18,182: 22) loss=0.178 grad_norm=2.74 num_segments=256 num_words=209
2020-06-10 22:06:08,129: 23) loss=0.175 grad_norm=3.51 num_segments=256 num_words=212
2020-06-10 22:08:03,891: 24) loss=0.164 grad_norm=3.66 num_segments=256 num_words=220
2020-06-10 22:09:52,252: 25) loss=0.161 grad_norm=3.46 num_segments=256 num_words=207
2020-06-10 22:11:42,653: 26) loss=0.156 grad_norm=2.72 num_segments=256 num_words=209
2020-06-10 22:13:33,000: 27) loss=0.173 grad_norm=2.57 num_segments=256 num_words=212
2020-06-10 22:15:22,306: 28) loss=0.170 grad_norm=2.88 num_segments=256 num_words=211
2020-06-10 22:17:12,925: 29) loss=0.160 grad_norm=2.83 num_segments=256 num_words=210
2020-06-10 22:19:01,350: 30) loss=0.173 grad_norm=2.89 num_segments=256 num_words=203
2020-06-10 22:21:00,206: 31) loss=0.161 grad_norm=3.23 num_segments=256 num_words=210
2020-06-10 22:22:50,522: 32) loss=0.165 grad_norm=3.69 num_segments=256 num_words=201
2020-06-10 22:24:41,078: 33) loss=0.172 grad_norm=5.29 num_segments=256 num_words=214
2020-06-10 22:26:32,235: 34) loss=0.178 grad_norm=2.87 num_segments=256 num_words=216
2020-06-10 22:28:21,615: 35) loss=0.177 grad_norm=2.32 num_segments=256 num_words=204
2020-06-10 22:30:10,155: 36) loss=0.199 grad_norm=4.54 num_segments=256 num_words=203
2020-06-10 22:31:58,342: 37) loss=0.220 grad_norm=4.91 num_segments=256 num_words=213
2020-06-10 22:33:38,428: 38) loss=0.148 grad_norm=3.78 num_segments=243 num_words=200
2020-06-10 22:33:38,448: epoch= 42.00
2020-06-10 22:33:38,449:  >> time to evaluate and save:
2020-06-10 22:33:38,518: saved save/MultiViewDataset_IndividualWords.1638.pth
2020-06-10 22:33:38,553: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 22:33:38,570: saved MultiViewDataset_IndividualWords successfully
2020-06-10 22:33:39,939: saved save/MultiViewRNN.1638.pth
2020-06-10 22:33:39,952: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 22:33:40,026: saved MultiViewRNN successfully
2020-06-10 22:33:42,628: saved save/Adam.1638.pth
2020-06-10 22:33:42,644: most_recent linked save/Adam.most_recent.pth
2020-06-10 22:33:42,708: saved Adam successfully
2020-06-10 22:33:42,711: saved save/ReduceLROnPlateau.1638.pth
2020-06-10 22:33:42,736: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 22:33:42,765: saved ReduceLROnPlateau successfully
2020-06-10 22:33:42,767: saved config successfully
2020-06-10 22:35:31,111:   >> crossview_ap=0.729 (10966 x 3921 pairs)
2020-06-10 22:36:53,725:   >> acoustic_ap=0.785 (10966 choose 2 pairs)
2020-06-10 22:36:53,733: best_so_far= 0.729 at 1638
2020-06-10 22:36:53,820: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 22:36:53,878: saved MultiViewDataset_IndividualWords successfully
2020-06-10 22:36:53,906: best linked save/MultiViewRNN.best.pth
2020-06-10 22:36:54,379: saved MultiViewRNN successfully
2020-06-10 22:36:54,403: best linked save/Adam.best.pth
2020-06-10 22:36:54,736: saved Adam successfully
2020-06-10 22:36:54,772: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 22:36:54,964: saved ReduceLROnPlateau successfully
2020-06-10 22:36:55,023: epoch=42.00 global_step=1638 lr=0.0001 start_iter=0
2020-06-10 22:36:55,023: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 22:38:36,860: 0) loss=0.182 grad_norm=3.42 num_segments=256 num_words=207
2020-06-10 22:40:25,296: 1) loss=0.160 grad_norm=2.75 num_segments=256 num_words=208
2020-06-10 22:42:03,108: 2) loss=0.182 grad_norm=3.28 num_segments=256 num_words=210
2020-06-10 22:43:44,438: 3) loss=0.173 grad_norm=3.07 num_segments=256 num_words=209
2020-06-10 22:45:37,390: 4) loss=0.187 grad_norm=4.61 num_segments=256 num_words=209
2020-06-10 22:47:29,745: 5) loss=0.171 grad_norm=2.40 num_segments=256 num_words=210
2020-06-10 22:49:22,062: 6) loss=0.156 grad_norm=3.07 num_segments=256 num_words=223
2020-06-10 22:51:14,366: 7) loss=0.155 grad_norm=2.72 num_segments=256 num_words=207
2020-06-10 22:53:06,429: 8) loss=0.164 grad_norm=3.49 num_segments=256 num_words=217
2020-06-10 22:54:58,737: 9) loss=0.171 grad_norm=3.01 num_segments=256 num_words=212
2020-06-10 22:56:50,531: 10) loss=0.178 grad_norm=3.67 num_segments=256 num_words=205
2020-06-10 22:58:41,665: 11) loss=0.180 grad_norm=3.20 num_segments=256 num_words=203
2020-06-10 23:00:47,462: 12) loss=0.158 grad_norm=2.93 num_segments=256 num_words=215
2020-06-10 23:02:39,142: 13) loss=0.167 grad_norm=2.60 num_segments=256 num_words=215
2020-06-10 23:04:31,666: 14) loss=0.167 grad_norm=2.87 num_segments=256 num_words=212
2020-06-10 23:06:22,946: 15) loss=0.154 grad_norm=2.79 num_segments=256 num_words=217
2020-06-10 23:08:15,537: 16) loss=0.175 grad_norm=4.59 num_segments=256 num_words=203
2020-06-10 23:10:07,609: 17) loss=0.150 grad_norm=3.07 num_segments=256 num_words=210
2020-06-10 23:12:00,179: 18) loss=0.168 grad_norm=2.47 num_segments=256 num_words=210
2020-06-10 23:13:52,387: 19) loss=0.161 grad_norm=2.65 num_segments=256 num_words=212
2020-06-10 23:15:45,113: 20) loss=0.190 grad_norm=3.21 num_segments=256 num_words=209
2020-06-10 23:17:37,610: 21) loss=0.173 grad_norm=3.96 num_segments=256 num_words=214
2020-06-10 23:19:28,926: 22) loss=0.175 grad_norm=2.79 num_segments=256 num_words=214
2020-06-10 23:21:20,271: 23) loss=0.287 grad_norm=5.58 num_segments=256 num_words=207
2020-06-10 23:23:13,861: 24) loss=0.185 grad_norm=4.74 num_segments=256 num_words=208
2020-06-10 23:25:06,769: 25) loss=0.283 grad_norm=4.48 num_segments=256 num_words=208
2020-06-10 23:27:16,405: 26) loss=0.172 grad_norm=2.59 num_segments=256 num_words=202
2020-06-10 23:29:09,023: 27) loss=0.159 grad_norm=2.84 num_segments=256 num_words=209
2020-06-10 23:30:59,664: 28) loss=0.200 grad_norm=3.40 num_segments=256 num_words=200
2020-06-10 23:32:52,326: 29) loss=0.163 grad_norm=3.08 num_segments=256 num_words=210
2020-06-10 23:34:45,662: 30) loss=0.157 grad_norm=3.32 num_segments=256 num_words=225
2020-06-10 23:36:37,285: 31) loss=0.186 grad_norm=2.94 num_segments=256 num_words=206
2020-06-10 23:38:29,676: 32) loss=0.155 grad_norm=2.93 num_segments=256 num_words=219
2020-06-10 23:40:21,072: 33) loss=0.177 grad_norm=3.26 num_segments=256 num_words=206
2020-06-10 23:42:12,692: 34) loss=0.187 grad_norm=3.32 num_segments=256 num_words=203
2020-06-10 23:44:06,832: 35) loss=0.162 grad_norm=3.29 num_segments=256 num_words=214
2020-06-10 23:46:00,646: 36) loss=0.178 grad_norm=2.80 num_segments=256 num_words=217
2020-06-10 23:47:54,278: 37) loss=0.169 grad_norm=2.93 num_segments=256 num_words=214
2020-06-10 23:49:34,479: 38) loss=0.212 grad_norm=4.18 num_segments=243 num_words=194
2020-06-10 23:49:34,499: epoch= 43.00
2020-06-10 23:49:34,499:  >> time to evaluate and save:
2020-06-10 23:49:34,572: saved save/MultiViewDataset_IndividualWords.1677.pth
2020-06-10 23:49:34,589: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 23:49:34,604: saved MultiViewDataset_IndividualWords successfully
2020-06-10 23:49:36,009: saved save/MultiViewRNN.1677.pth
2020-06-10 23:49:36,018: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 23:49:36,047: saved MultiViewRNN successfully
2020-06-10 23:49:38,614: saved save/Adam.1677.pth
2020-06-10 23:49:38,621: most_recent linked save/Adam.most_recent.pth
2020-06-10 23:49:38,639: saved Adam successfully
2020-06-10 23:49:38,642: saved save/ReduceLROnPlateau.1677.pth
2020-06-10 23:49:38,650: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 23:49:38,665: saved ReduceLROnPlateau successfully
2020-06-10 23:49:38,667: saved config successfully
2020-06-10 23:51:30,842:   >> crossview_ap=0.729 (10966 x 3921 pairs)
2020-06-10 23:52:51,120:   >> acoustic_ap=0.785 (10966 choose 2 pairs)
2020-06-10 23:52:51,124: best_so_far= 0.729 at 1638
2020-06-10 23:52:52,000: epoch=43.00 global_step=1677 lr=0.0001 start_iter=0
2020-06-10 23:52:52,000: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 23:54:53,326: 0) loss=0.150 grad_norm=3.07 num_segments=256 num_words=217
2020-06-10 23:56:48,097: 1) loss=0.169 grad_norm=2.46 num_segments=256 num_words=213
2020-06-10 23:58:41,564: 2) loss=0.146 grad_norm=3.06 num_segments=256 num_words=212
2020-06-11 00:00:35,223: 3) loss=0.154 grad_norm=3.09 num_segments=256 num_words=210
2020-06-11 00:02:30,522: 4) loss=0.176 grad_norm=3.50 num_segments=256 num_words=209
2020-06-11 00:04:46,803: 5) loss=0.189 grad_norm=2.97 num_segments=256 num_words=204
2020-06-11 00:06:37,364: 6) loss=0.161 grad_norm=2.73 num_segments=256 num_words=220
2020-06-11 00:08:28,488: 7) loss=0.175 grad_norm=2.75 num_segments=256 num_words=219
2020-06-11 00:10:20,043: 8) loss=0.179 grad_norm=3.27 num_segments=256 num_words=209
2020-06-11 00:12:11,216: 9) loss=0.175 grad_norm=3.04 num_segments=256 num_words=214
2020-06-11 00:14:02,223: 10) loss=0.188 grad_norm=3.57 num_segments=256 num_words=212
2020-06-11 00:15:53,885: 11) loss=0.176 grad_norm=2.80 num_segments=256 num_words=209
2020-06-11 00:17:44,988: 12) loss=0.165 grad_norm=3.10 num_segments=256 num_words=215
2020-06-11 00:19:37,196: 13) loss=0.166 grad_norm=2.53 num_segments=256 num_words=213
2020-06-11 00:21:29,862: 14) loss=0.173 grad_norm=2.48 num_segments=256 num_words=211
2020-06-11 00:23:20,972: 15) loss=0.178 grad_norm=2.65 num_segments=256 num_words=211
2020-06-11 00:25:14,102: 16) loss=0.172 grad_norm=3.21 num_segments=256 num_words=213
2020-06-11 00:27:07,122: 17) loss=0.170 grad_norm=2.07 num_segments=256 num_words=212
2020-06-11 00:29:00,699: 18) loss=0.185 grad_norm=2.95 num_segments=256 num_words=211
2020-06-11 00:30:54,005: 19) loss=0.191 grad_norm=3.27 num_segments=256 num_words=210
2020-06-11 00:32:48,403: 20) loss=0.185 grad_norm=2.91 num_segments=256 num_words=193
2020-06-11 00:34:41,941: 21) loss=0.159 grad_norm=2.78 num_segments=256 num_words=211
2020-06-11 00:36:35,788: 22) loss=0.279 grad_norm=5.37 num_segments=256 num_words=210
2020-06-11 00:38:28,432: 23) loss=0.183 grad_norm=3.39 num_segments=256 num_words=204
2020-06-11 00:40:19,661: 24) loss=0.168 grad_norm=2.63 num_segments=256 num_words=217
2020-06-11 00:42:10,622: 25) loss=0.165 grad_norm=2.94 num_segments=256 num_words=204
2020-06-11 00:44:28,708: 26) loss=0.167 grad_norm=3.01 num_segments=256 num_words=218
2020-06-11 00:46:21,724: 27) loss=0.172 grad_norm=3.12 num_segments=256 num_words=207
2020-06-11 00:48:14,473: 28) loss=0.169 grad_norm=2.50 num_segments=256 num_words=202
2020-06-11 00:50:06,870: 29) loss=0.166 grad_norm=2.81 num_segments=256 num_words=205
2020-06-11 00:51:59,135: 30) loss=0.166 grad_norm=2.96 num_segments=256 num_words=207
2020-06-11 00:53:50,455: 31) loss=0.262 grad_norm=6.50 num_segments=256 num_words=218
2020-06-11 00:55:42,367: 32) loss=0.163 grad_norm=2.99 num_segments=256 num_words=208
2020-06-11 00:57:36,202: 33) loss=0.179 grad_norm=4.04 num_segments=256 num_words=209
2020-06-11 00:59:28,921: 34) loss=0.160 grad_norm=2.63 num_segments=256 num_words=213
2020-06-11 01:01:22,641: 35) loss=0.207 grad_norm=3.73 num_segments=256 num_words=211
2020-06-11 01:03:15,523: 36) loss=0.185 grad_norm=2.89 num_segments=256 num_words=197
2020-06-11 01:05:08,960: 37) loss=0.159 grad_norm=4.15 num_segments=256 num_words=217
2020-06-11 01:06:51,083: 38) loss=0.161 grad_norm=2.91 num_segments=243 num_words=207
2020-06-11 01:06:51,104: epoch= 44.00
2020-06-11 01:06:51,104:  >> time to evaluate and save:
2020-06-11 01:06:51,152: saved save/MultiViewDataset_IndividualWords.1716.pth
2020-06-11 01:06:51,176: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-11 01:06:51,190: saved MultiViewDataset_IndividualWords successfully
2020-06-11 01:06:52,585: saved save/MultiViewRNN.1716.pth
2020-06-11 01:06:52,595: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-11 01:06:52,614: saved MultiViewRNN successfully
2020-06-11 01:06:55,284: saved save/Adam.1716.pth
2020-06-11 01:06:55,290: most_recent linked save/Adam.most_recent.pth
2020-06-11 01:06:55,309: saved Adam successfully
2020-06-11 01:06:55,312: saved save/ReduceLROnPlateau.1716.pth
2020-06-11 01:06:55,341: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-11 01:06:55,355: saved ReduceLROnPlateau successfully
2020-06-11 01:06:55,358: saved config successfully
2020-06-11 01:09:08,329:   >> crossview_ap=0.731 (10966 x 3921 pairs)
2020-06-11 01:10:52,649:   >> acoustic_ap=0.786 (10966 choose 2 pairs)
2020-06-11 01:10:52,680: best_so_far= 0.731 at 1716
2020-06-11 01:10:52,722: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-11 01:10:52,740: saved MultiViewDataset_IndividualWords successfully
2020-06-11 01:10:52,771: best linked save/MultiViewRNN.best.pth
2020-06-11 01:10:52,856: saved MultiViewRNN successfully
2020-06-11 01:10:52,878: best linked save/Adam.best.pth
2020-06-11 01:10:52,957: saved Adam successfully
2020-06-11 01:10:52,973: best linked save/ReduceLROnPlateau.best.pth
2020-06-11 01:10:52,997: saved ReduceLROnPlateau successfully
2020-06-11 01:10:54,193: epoch=44.00 global_step=1716 lr=0.0001 start_iter=0
2020-06-11 01:10:54,194: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-11 01:12:51,453: 0) loss=0.183 grad_norm=2.27 num_segments=256 num_words=206
2020-06-11 01:14:46,188: 1) loss=0.153 grad_norm=2.70 num_segments=256 num_words=208
2020-06-11 01:15:27,683: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-11 01:15:27,714: Using 1 GPU(s)
2020-06-11 01:15:27,714: Machine: 0 / 1
2020-06-11 01:15:27,744: Hyperparam tuning-------------------
2020-06-11 01:15:27,745: optim_lr: 0.001
2020-06-11 01:15:27,745: dropout (for both): 0.4
2020-06-11 01:15:27,745: margin: 0.4
2020-06-11 01:15:27,745: ------------------------------------
2020-06-11 01:15:27,745: Calling main function: multiview_evaluator.evaluate
2020-06-11 01:15:27,745: Using config file: eval_config.json
2020-06-11 01:15:27,745: Using module at multiview_evaluator.evaluate
2020-06-11 01:15:27,785: Using module at multiview_vocab.MultiViewVocab
2020-06-11 01:15:27,790: Building vocab_data from config
2020-06-11 01:15:28,131:  >> min_count= 0
2020-06-11 01:15:28,132:  >> # words= 34323 (# removed= 0)
2020-06-11 01:15:28,132:  >> # subwords= 45
2020-06-11 01:15:28,132:     [laughter]= 1
2020-06-11 01:15:28,132:     [noise]= 2
2020-06-11 01:15:28,132:     [vocalized-noise]= 3
2020-06-11 01:15:28,132:     aa= 4
2020-06-11 01:15:28,132:     ae= 5
2020-06-11 01:15:28,132:     ah= 6
2020-06-11 01:15:28,132:     ao= 7
2020-06-11 01:15:28,132:     aw= 8
2020-06-11 01:15:28,132:     ax= 9
2020-06-11 01:15:28,133:     ay= 10
2020-06-11 01:15:28,133:     b= 11
2020-06-11 01:15:28,133:     ch= 12
2020-06-11 01:15:28,133:     d= 13
2020-06-11 01:15:28,133:     dh= 14
2020-06-11 01:15:28,133:     eh= 15
2020-06-11 01:15:28,133:     el= 16
2020-06-11 01:15:28,133:     en= 17
2020-06-11 01:15:28,133:     er= 18
2020-06-11 01:15:28,133:     ey= 19
2020-06-11 01:15:28,133:     f= 20
2020-06-11 01:15:28,133:     g= 21
2020-06-11 01:15:28,133:     hh= 22
2020-06-11 01:15:28,133:     ih= 23
2020-06-11 01:15:28,134:     iy= 24
2020-06-11 01:15:28,134:     jh= 25
2020-06-11 01:15:28,134:     k= 26
2020-06-11 01:15:28,134:     l= 27
2020-06-11 01:15:28,134:     m= 28
2020-06-11 01:15:28,134:     n= 29
2020-06-11 01:15:28,134:     ng= 30
2020-06-11 01:15:28,134:     ow= 31
2020-06-11 01:15:28,134:     oy= 32
2020-06-11 01:15:28,134:     p= 33
2020-06-11 01:15:28,134:     r= 34
2020-06-11 01:15:28,134:     s= 35
2020-06-11 01:15:28,134:     sh= 36
2020-06-11 01:15:28,135:     t= 37
2020-06-11 01:15:28,135:     th= 38
2020-06-11 01:15:28,135:     uh= 39
2020-06-11 01:15:28,135:     uw= 40
2020-06-11 01:15:28,135:     v= 41
2020-06-11 01:15:28,135:     w= 42
2020-06-11 01:15:28,135:     y= 43
2020-06-11 01:15:28,135:     z= 44
2020-06-11 01:15:28,135:     zh= 45
2020-06-11 01:15:28,150: Using module at data.batch_samplers.BatchSampler
2020-06-11 01:15:28,152: Building vocab_sampler from config
2020-06-11 01:15:28,152:  >> # examples= 34323
2020-06-11 01:15:28,152:  >> batch_size= 1000
2020-06-11 01:15:28,152:  >> shuffle= False
2020-06-11 01:15:28,160:  >> BatchSampler; 35 batches
2020-06-11 01:15:28,160: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-11 01:15:28,402: Building dev_data from config
2020-06-11 01:15:38,469:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-11 01:15:38,470:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-11 01:15:38,470:  >> stack= False
2020-06-11 01:15:38,470:  >> seg_durs= (1, None)
2020-06-11 01:15:38,470:  >> # words= 10966 (# ignored= 0)
2020-06-11 01:15:38,470:  >> input_feat_dim= 108
2020-06-11 01:15:38,470:  >> input_num_subwords= 45
2020-06-11 01:15:38,471: Using module at data.batch_samplers.BatchSampler
2020-06-11 01:15:38,471: Building dev_sampler from config
2020-06-11 01:15:38,471:  >> # examples= 10966
2020-06-11 01:15:38,471:  >> batch_size= 256
2020-06-11 01:15:38,472:  >> shuffle= False
2020-06-11 01:15:38,475:  >> BatchSampler; 43 batches
2020-06-11 01:15:38,475: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-11 01:15:38,475: Building test_data from config
2020-06-11 01:15:47,067:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-11 01:15:47,067:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-11 01:15:47,067:  >> stack= False
2020-06-11 01:15:47,067:  >> seg_durs= (1, None)
2020-06-11 01:15:47,068:  >> # words= 11024 (# ignored= 0)
2020-06-11 01:15:47,068:  >> input_feat_dim= 108
2020-06-11 01:15:47,068:  >> input_num_subwords= 45
2020-06-11 01:15:47,068: Using module at data.batch_samplers.BatchSampler
2020-06-11 01:15:47,068: Building test_sampler from config
2020-06-11 01:15:47,069:  >> # examples= 11024
2020-06-11 01:15:47,069:  >> batch_size= 256
2020-06-11 01:15:47,069:  >> shuffle= False
2020-06-11 01:15:47,072:  >> BatchSampler; 44 batches
2020-06-11 01:15:47,072: Using module at metric.multiview_ap.MultiViewAP
2020-06-11 01:15:48,593: Building eval from config
2020-06-11 01:15:48,593:  >> acoustic_ap= True
2020-06-11 01:15:48,594:  >> crossview_ap= True
2020-06-11 01:15:48,594:  >> full_vocab= False
2020-06-11 01:15:48,594:  >> metric= crossview_ap
2020-06-11 01:15:48,594:  >> mode= max
2020-06-11 01:15:48,594: Using module at multiview_rnn.MultiViewRNN
2020-06-11 01:15:48,606: Building net from config
2020-06-11 01:15:48,607: view1:
2020-06-11 01:15:48,608:  >> cell= GRU
2020-06-11 01:15:48,608:  >> input_size= 108
2020-06-11 01:15:48,608:  >> hidden_size= 512
2020-06-11 01:15:48,608:  >> bidirectional= True
2020-06-11 01:15:48,608:  >> num_layers= 6
2020-06-11 01:15:48,609:  >> dropout between layers= 0.4
2020-06-11 01:15:48,857: view2:
2020-06-11 01:15:48,859:  >> cell= GRU
2020-06-11 01:15:48,859:  >> input_size= 64
2020-06-11 01:15:48,859:  >> hidden_size= 512
2020-06-11 01:15:48,859:  >> bidirectional= True
2020-06-11 01:15:48,859:  >> num_layers= 2
2020-06-11 01:15:48,859:  >> dropout between layers= 0.4
2020-06-11 01:15:48,859:  >> num input embeddings= 45
2020-06-11 01:15:53,082: loaded save/MultiViewRNN.1716.pth
2020-06-11 01:15:53,082: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0+2-phones-edit
