2020-06-07 10:00:35,227: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-07 10:00:35,228: Using CPU
2020-06-07 10:00:35,228: Machine: 0 / 1
2020-06-07 10:00:35,228: Hyperparam tuning-------------------
2020-06-07 10:00:35,228: optim_lr: 0.001
2020-06-07 10:00:35,228: dropout (for both): 0.4
2020-06-07 10:00:35,228: margin: 0.4
2020-06-07 10:00:35,228: ------------------------------------
2020-06-07 10:00:35,231: Calling main function: multiview_trainer.train
2020-06-07 10:00:35,231: Using config file: train_config.json
2020-06-07 10:00:35,231: Using module at multiview_trainer.train
2020-06-07 10:01:05,730: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-07 10:01:05,731: Using CPU
2020-06-07 10:01:05,731: Machine: 0 / 1
2020-06-07 10:01:05,731: Hyperparam tuning-------------------
2020-06-07 10:01:05,731: optim_lr: 0.001
2020-06-07 10:01:05,732: dropout (for both): 0.4
2020-06-07 10:01:05,732: margin: 0.4
2020-06-07 10:01:05,732: ------------------------------------
2020-06-07 10:01:05,734: Calling main function: multiview_trainer.train
2020-06-07 10:01:05,734: Using config file: train_config.json
2020-06-07 10:01:05,734: Using module at multiview_trainer.train
2020-06-07 10:01:07,258: Using module at multiview_vocab.MultiViewVocab
2020-06-07 10:01:07,261: Building vocab_data from config
2020-06-07 10:01:07,556:  >> min_count= 0
2020-06-07 10:01:07,556:  >> # words= 34323 (# removed= 0)
2020-06-07 10:01:07,556:  >> # subwords= 45
2020-06-07 10:01:07,557:     [laughter]= 1
2020-06-07 10:01:07,557:     [noise]= 2
2020-06-07 10:01:07,557:     [vocalized-noise]= 3
2020-06-07 10:01:07,557:     aa= 4
2020-06-07 10:01:07,557:     ae= 5
2020-06-07 10:01:07,557:     ah= 6
2020-06-07 10:01:07,557:     ao= 7
2020-06-07 10:01:07,557:     aw= 8
2020-06-07 10:01:07,557:     ax= 9
2020-06-07 10:01:07,557:     ay= 10
2020-06-07 10:01:07,557:     b= 11
2020-06-07 10:01:07,558:     ch= 12
2020-06-07 10:01:07,558:     d= 13
2020-06-07 10:01:07,558:     dh= 14
2020-06-07 10:01:07,558:     eh= 15
2020-06-07 10:01:07,558:     el= 16
2020-06-07 10:01:07,558:     en= 17
2020-06-07 10:01:07,558:     er= 18
2020-06-07 10:01:07,558:     ey= 19
2020-06-07 10:01:07,558:     f= 20
2020-06-07 10:01:07,558:     g= 21
2020-06-07 10:01:07,558:     hh= 22
2020-06-07 10:01:07,559:     ih= 23
2020-06-07 10:01:07,559:     iy= 24
2020-06-07 10:01:07,559:     jh= 25
2020-06-07 10:01:07,559:     k= 26
2020-06-07 10:01:07,559:     l= 27
2020-06-07 10:01:07,559:     m= 28
2020-06-07 10:01:07,559:     n= 29
2020-06-07 10:01:07,559:     ng= 30
2020-06-07 10:01:07,559:     ow= 31
2020-06-07 10:01:07,559:     oy= 32
2020-06-07 10:01:07,559:     p= 33
2020-06-07 10:01:07,560:     r= 34
2020-06-07 10:01:07,560:     s= 35
2020-06-07 10:01:07,560:     sh= 36
2020-06-07 10:01:07,560:     t= 37
2020-06-07 10:01:07,560:     th= 38
2020-06-07 10:01:07,560:     uh= 39
2020-06-07 10:01:07,560:     uw= 40
2020-06-07 10:01:07,560:     v= 41
2020-06-07 10:01:07,560:     w= 42
2020-06-07 10:01:07,560:     y= 43
2020-06-07 10:01:07,561:     z= 44
2020-06-07 10:01:07,561:     zh= 45
2020-06-07 10:01:07,576: Using module at data.batch_samplers.BatchSampler
2020-06-07 10:01:07,579: Building vocab_sampler from config
2020-06-07 10:01:07,579:  >> # examples= 34323
2020-06-07 10:01:07,579:  >> batch_size= 1000
2020-06-07 10:01:07,579:  >> shuffle= False
2020-06-07 10:01:07,587:  >> BatchSampler; 35 batches
2020-06-07 10:01:07,587: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 10:01:08,169: Building train_data from config
2020-06-07 10:01:17,469:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-07 10:01:17,469:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-07 10:01:17,469:  >> stack= False
2020-06-07 10:01:17,469:  >> seg_durs= (1, None)
2020-06-07 10:01:17,469:  >> # words= 9971 (# ignored= 0)
2020-06-07 10:01:17,469:  >> input_feat_dim= 108
2020-06-07 10:01:17,469:  >> input_num_subwords= 45
2020-06-07 10:01:17,469: Using module at data.batch_samplers.BatchSampler
2020-06-07 10:01:17,470: Building train_sampler from config
2020-06-07 10:01:17,470:  >> # examples= 9971
2020-06-07 10:01:17,470:  >> batch_size= 256
2020-06-07 10:01:17,470:  >> shuffle= True
2020-06-07 10:01:17,483:  >> BatchSampler; 39 batches
2020-06-07 10:01:17,483: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 10:01:17,483: Building dev_data from config
2020-06-07 10:01:28,147:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-07 10:01:28,148:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-07 10:01:28,148:  >> stack= False
2020-06-07 10:01:28,148:  >> seg_durs= (1, None)
2020-06-07 10:01:28,149:  >> # words= 10966 (# ignored= 0)
2020-06-07 10:01:28,150:  >> input_feat_dim= 108
2020-06-07 10:01:28,150:  >> input_num_subwords= 45
2020-06-07 10:01:28,150: Using module at data.batch_samplers.BatchSampler
2020-06-07 10:01:28,150: Building dev_sampler from config
2020-06-07 10:01:28,151:  >> # examples= 10966
2020-06-07 10:01:28,151:  >> batch_size= 256
2020-06-07 10:01:28,151:  >> shuffle= False
2020-06-07 10:01:28,155:  >> BatchSampler; 43 batches
2020-06-07 10:01:28,156: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 10:01:28,156: Building test_data from config
2020-06-07 10:01:37,543:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-07 10:01:37,543:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-07 10:01:37,543:  >> stack= False
2020-06-07 10:01:37,543:  >> seg_durs= (1, None)
2020-06-07 10:01:37,543:  >> # words= 11024 (# ignored= 0)
2020-06-07 10:01:37,543:  >> input_feat_dim= 108
2020-06-07 10:01:37,543:  >> input_num_subwords= 45
2020-06-07 10:01:37,544: Using module at data.batch_samplers.BatchSampler
2020-06-07 10:01:37,544: Building test_sampler from config
2020-06-07 10:01:37,544:  >> # examples= 11024
2020-06-07 10:01:37,544:  >> batch_size= 256
2020-06-07 10:01:37,544:  >> shuffle= False
2020-06-07 10:01:37,547:  >> BatchSampler; 44 batches
2020-06-07 10:01:37,547: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-07 10:11:00,673: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-07 10:11:00,673: Using CPU
2020-06-07 10:11:00,674: Machine: 0 / 1
2020-06-07 10:11:00,674: Hyperparam tuning-------------------
2020-06-07 10:11:00,674: optim_lr: 0.001
2020-06-07 10:11:00,674: dropout (for both): 0.4
2020-06-07 10:11:00,675: margin: 0.4
2020-06-07 10:11:00,675: ------------------------------------
2020-06-07 10:11:00,677: Calling main function: multiview_trainer.train
2020-06-07 10:11:00,677: Using config file: train_config.json
2020-06-07 10:11:00,677: Using module at multiview_trainer.train
2020-06-07 10:11:00,959: Using module at multiview_vocab.MultiViewVocab
2020-06-07 10:11:00,960: Building vocab_data from config
2020-06-07 10:11:01,358:  >> min_count= 0
2020-06-07 10:11:01,359:  >> # words= 34323 (# removed= 0)
2020-06-07 10:11:01,359:  >> # subwords= 45
2020-06-07 10:11:01,359:     [laughter]= 1
2020-06-07 10:11:01,359:     [noise]= 2
2020-06-07 10:11:01,359:     [vocalized-noise]= 3
2020-06-07 10:11:01,359:     aa= 4
2020-06-07 10:11:01,359:     ae= 5
2020-06-07 10:11:01,360:     ah= 6
2020-06-07 10:11:01,360:     ao= 7
2020-06-07 10:11:01,360:     aw= 8
2020-06-07 10:11:01,360:     ax= 9
2020-06-07 10:11:01,360:     ay= 10
2020-06-07 10:11:01,360:     b= 11
2020-06-07 10:11:01,360:     ch= 12
2020-06-07 10:11:01,361:     d= 13
2020-06-07 10:11:01,361:     dh= 14
2020-06-07 10:11:01,361:     eh= 15
2020-06-07 10:11:01,361:     el= 16
2020-06-07 10:11:01,361:     en= 17
2020-06-07 10:11:01,361:     er= 18
2020-06-07 10:11:01,361:     ey= 19
2020-06-07 10:11:01,362:     f= 20
2020-06-07 10:11:01,362:     g= 21
2020-06-07 10:11:01,362:     hh= 22
2020-06-07 10:11:01,362:     ih= 23
2020-06-07 10:11:01,362:     iy= 24
2020-06-07 10:11:01,362:     jh= 25
2020-06-07 10:11:01,362:     k= 26
2020-06-07 10:11:01,362:     l= 27
2020-06-07 10:11:01,363:     m= 28
2020-06-07 10:11:01,363:     n= 29
2020-06-07 10:11:01,363:     ng= 30
2020-06-07 10:11:01,363:     ow= 31
2020-06-07 10:11:01,363:     oy= 32
2020-06-07 10:11:01,363:     p= 33
2020-06-07 10:11:01,363:     r= 34
2020-06-07 10:11:01,364:     s= 35
2020-06-07 10:11:01,364:     sh= 36
2020-06-07 10:11:01,364:     t= 37
2020-06-07 10:11:01,364:     th= 38
2020-06-07 10:11:01,364:     uh= 39
2020-06-07 10:11:01,364:     uw= 40
2020-06-07 10:11:01,364:     v= 41
2020-06-07 10:11:01,365:     w= 42
2020-06-07 10:11:01,365:     y= 43
2020-06-07 10:11:01,365:     z= 44
2020-06-07 10:11:01,365:     zh= 45
2020-06-07 10:11:01,389: Using module at data.batch_samplers.BatchSampler
2020-06-07 10:11:01,390: Building vocab_sampler from config
2020-06-07 10:11:01,393:  >> # examples= 34323
2020-06-07 10:11:01,394:  >> batch_size= 1000
2020-06-07 10:11:01,394:  >> shuffle= False
2020-06-07 10:11:01,402:  >> BatchSampler; 35 batches
2020-06-07 10:11:01,403: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 10:11:01,544: Building train_data from config
2020-06-07 10:11:12,006:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-07 10:11:12,007:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-07 10:11:12,007:  >> stack= False
2020-06-07 10:11:12,007:  >> seg_durs= (1, None)
2020-06-07 10:11:12,007:  >> # words= 9971 (# ignored= 0)
2020-06-07 10:11:12,008:  >> input_feat_dim= 108
2020-06-07 10:11:12,008:  >> input_num_subwords= 45
2020-06-07 10:11:12,008: Using module at data.batch_samplers.BatchSampler
2020-06-07 10:11:12,008: Building train_sampler from config
2020-06-07 10:11:12,009:  >> # examples= 9971
2020-06-07 10:11:12,009:  >> batch_size= 256
2020-06-07 10:11:12,009:  >> shuffle= True
2020-06-07 10:11:12,019:  >> BatchSampler; 39 batches
2020-06-07 10:11:12,019: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 10:11:12,019: Building dev_data from config
2020-06-07 10:11:23,416:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-07 10:11:23,416:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-07 10:11:23,416:  >> stack= False
2020-06-07 10:11:23,416:  >> seg_durs= (1, None)
2020-06-07 10:11:23,416:  >> # words= 10966 (# ignored= 0)
2020-06-07 10:11:23,416:  >> input_feat_dim= 108
2020-06-07 10:11:23,417:  >> input_num_subwords= 45
2020-06-07 10:11:23,417: Using module at data.batch_samplers.BatchSampler
2020-06-07 10:11:23,417: Building dev_sampler from config
2020-06-07 10:11:23,417:  >> # examples= 10966
2020-06-07 10:11:23,417:  >> batch_size= 256
2020-06-07 10:11:23,418:  >> shuffle= False
2020-06-07 10:11:23,420:  >> BatchSampler; 43 batches
2020-06-07 10:11:23,420: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 10:11:23,421: Building test_data from config
2020-06-07 10:11:33,744:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-07 10:11:33,744:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-07 10:11:33,744:  >> stack= False
2020-06-07 10:11:33,744:  >> seg_durs= (1, None)
2020-06-07 10:11:33,744:  >> # words= 11024 (# ignored= 0)
2020-06-07 10:11:33,744:  >> input_feat_dim= 108
2020-06-07 10:11:33,745:  >> input_num_subwords= 45
2020-06-07 10:11:33,745: Using module at data.batch_samplers.BatchSampler
2020-06-07 10:11:33,745: Building test_sampler from config
2020-06-07 10:11:33,746:  >> # examples= 11024
2020-06-07 10:11:33,746:  >> batch_size= 256
2020-06-07 10:11:33,746:  >> shuffle= False
2020-06-07 10:11:33,749:  >> BatchSampler; 44 batches
2020-06-07 10:11:33,749: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-07 10:11:33,783: Building loss from config
2020-06-07 10:11:33,784:  >> margin= 0.4
2020-06-07 10:11:33,784:  >> k= 16
2020-06-07 10:11:33,784:  >> min_k= 8
2020-06-07 10:11:33,784:  >> extra= 0
2020-06-07 10:11:33,785:  >> average= False
2020-06-07 10:11:33,785: Using module at metric.multiview_ap.MultiViewAP
2020-06-07 10:11:33,874: Building eval from config
2020-06-07 10:11:33,875:  >> acoustic_ap= True
2020-06-07 10:11:33,875:  >> crossview_ap= True
2020-06-07 10:11:33,875:  >> full_vocab= False
2020-06-07 10:11:33,875:  >> metric= crossview_ap
2020-06-07 10:11:33,875:  >> mode= max
2020-06-07 10:11:33,875: Using module at multiview_rnn.MultiViewRNN
2020-06-07 10:11:33,882: Building net from config
2020-06-07 10:11:33,883: view1:
2020-06-07 10:11:33,884:  >> cell= GRU
2020-06-07 10:11:33,884:  >> input_size= 108
2020-06-07 10:11:33,884:  >> hidden_size= 512
2020-06-07 10:11:33,884:  >> bidirectional= True
2020-06-07 10:11:33,884:  >> num_layers= 6
2020-06-07 10:11:33,884:  >> dropout between layers= 0.4
2020-06-07 10:11:34,163: view2:
2020-06-07 10:11:34,163:  >> cell= GRU
2020-06-07 10:11:34,163:  >> input_size= 64
2020-06-07 10:11:34,163:  >> hidden_size= 512
2020-06-07 10:11:34,163:  >> bidirectional= True
2020-06-07 10:11:34,164:  >> num_layers= 2
2020-06-07 10:11:34,164:  >> dropout between layers= 0.4
2020-06-07 10:11:34,164:  >> num input embeddings= 45
2020-06-07 10:11:34,238: Using module at optim.adam.Adam
2020-06-07 10:11:34,240: Building optim from config
2020-06-07 10:11:34,240:  >> lr= 0.001
2020-06-07 10:11:34,240:  >> betas= (0.9, 0.999)
2020-06-07 10:11:34,240:  >> eps= 1e-08
2020-06-07 10:11:34,240:  >> weight_decay= 0
2020-06-07 10:11:34,240:  >> amsgrad= False
2020-06-07 10:11:34,241:  >> min_lr= 1e-07
2020-06-07 10:11:34,241: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-07 10:11:34,249: Building sched from config
2020-06-07 10:11:34,250:  >> optim= Adam
2020-06-07 10:11:34,250:  >> decay lr by 0.1
2020-06-07 10:11:34,250:  >> eval_fn= MultiViewAP
2020-06-07 10:11:34,250:  >> patience=4
2020-06-07 10:11:34,250:  >> revert=True
2020-06-07 10:11:34,250: epoch=0.00 global_step=0 lr=0.001 start_iter=0
2020-06-07 10:11:34,251: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 10:12:41,809: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-07 10:12:41,809: Using CPU
2020-06-07 10:12:41,809: Machine: 0 / 1
2020-06-07 10:12:41,810: Hyperparam tuning-------------------
2020-06-07 10:12:41,810: optim_lr: 0.001
2020-06-07 10:12:41,810: dropout (for both): 0.4
2020-06-07 10:12:41,810: margin: 0.4
2020-06-07 10:12:41,810: ------------------------------------
2020-06-07 10:12:41,812: Calling main function: multiview_trainer.train
2020-06-07 10:12:41,812: Using config file: train_config.json
2020-06-07 10:12:41,812: Using module at multiview_trainer.train
2020-06-07 10:12:42,067: Using module at multiview_vocab.MultiViewVocab
2020-06-07 10:12:42,068: Building vocab_data from config
2020-06-07 10:12:42,361:  >> min_count= 0
2020-06-07 10:12:42,361:  >> # words= 34323 (# removed= 0)
2020-06-07 10:12:42,361:  >> # subwords= 45
2020-06-07 10:12:42,362:     [laughter]= 1
2020-06-07 10:12:42,362:     [noise]= 2
2020-06-07 10:12:42,362:     [vocalized-noise]= 3
2020-06-07 10:12:42,362:     aa= 4
2020-06-07 10:12:42,362:     ae= 5
2020-06-07 10:12:42,362:     ah= 6
2020-06-07 10:12:42,362:     ao= 7
2020-06-07 10:12:42,362:     aw= 8
2020-06-07 10:12:42,362:     ax= 9
2020-06-07 10:12:42,363:     ay= 10
2020-06-07 10:12:42,363:     b= 11
2020-06-07 10:12:42,363:     ch= 12
2020-06-07 10:12:42,363:     d= 13
2020-06-07 10:12:42,363:     dh= 14
2020-06-07 10:12:42,363:     eh= 15
2020-06-07 10:12:42,363:     el= 16
2020-06-07 10:12:42,363:     en= 17
2020-06-07 10:12:42,363:     er= 18
2020-06-07 10:12:42,363:     ey= 19
2020-06-07 10:12:42,363:     f= 20
2020-06-07 10:12:42,364:     g= 21
2020-06-07 10:12:42,364:     hh= 22
2020-06-07 10:12:42,364:     ih= 23
2020-06-07 10:12:42,364:     iy= 24
2020-06-07 10:12:42,364:     jh= 25
2020-06-07 10:12:42,364:     k= 26
2020-06-07 10:12:42,364:     l= 27
2020-06-07 10:12:42,364:     m= 28
2020-06-07 10:12:42,364:     n= 29
2020-06-07 10:12:42,364:     ng= 30
2020-06-07 10:12:42,365:     ow= 31
2020-06-07 10:12:42,365:     oy= 32
2020-06-07 10:12:42,365:     p= 33
2020-06-07 10:12:42,365:     r= 34
2020-06-07 10:12:42,365:     s= 35
2020-06-07 10:12:42,365:     sh= 36
2020-06-07 10:12:42,365:     t= 37
2020-06-07 10:12:42,365:     th= 38
2020-06-07 10:12:42,365:     uh= 39
2020-06-07 10:12:42,365:     uw= 40
2020-06-07 10:12:42,365:     v= 41
2020-06-07 10:12:42,366:     w= 42
2020-06-07 10:12:42,366:     y= 43
2020-06-07 10:12:42,366:     z= 44
2020-06-07 10:12:42,366:     zh= 45
2020-06-07 10:12:42,382: Using module at data.batch_samplers.BatchSampler
2020-06-07 10:12:42,382: Building vocab_sampler from config
2020-06-07 10:12:42,383:  >> # examples= 34323
2020-06-07 10:12:42,383:  >> batch_size= 1000
2020-06-07 10:12:42,383:  >> shuffle= False
2020-06-07 10:12:42,391:  >> BatchSampler; 35 batches
2020-06-07 10:12:42,391: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 10:12:42,503: Building train_data from config
2020-06-07 10:12:51,607:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-07 10:12:51,607:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-07 10:12:51,607:  >> stack= False
2020-06-07 10:12:51,607:  >> seg_durs= (1, None)
2020-06-07 10:12:51,607:  >> # words= 9971 (# ignored= 0)
2020-06-07 10:12:51,607:  >> input_feat_dim= 108
2020-06-07 10:12:51,607:  >> input_num_subwords= 45
2020-06-07 10:12:51,607: Using module at data.batch_samplers.BatchSampler
2020-06-07 10:12:51,608: Building train_sampler from config
2020-06-07 10:12:51,608:  >> # examples= 9971
2020-06-07 10:12:51,608:  >> batch_size= 256
2020-06-07 10:12:51,608:  >> shuffle= True
2020-06-07 10:12:51,618:  >> BatchSampler; 39 batches
2020-06-07 10:12:51,619: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 10:12:51,619: Building dev_data from config
2020-06-07 10:13:03,836:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-07 10:13:03,837:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-07 10:13:03,837:  >> stack= False
2020-06-07 10:13:03,837:  >> seg_durs= (1, None)
2020-06-07 10:13:03,838:  >> # words= 10966 (# ignored= 0)
2020-06-07 10:13:03,838:  >> input_feat_dim= 108
2020-06-07 10:13:03,838:  >> input_num_subwords= 45
2020-06-07 10:13:03,839: Using module at data.batch_samplers.BatchSampler
2020-06-07 10:13:03,839: Building dev_sampler from config
2020-06-07 10:13:03,839:  >> # examples= 10966
2020-06-07 10:13:03,840:  >> batch_size= 256
2020-06-07 10:13:03,840:  >> shuffle= False
2020-06-07 10:13:03,843:  >> BatchSampler; 43 batches
2020-06-07 10:13:03,843: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 10:13:03,843: Building test_data from config
2020-06-07 10:13:14,543:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-07 10:13:14,544:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-07 10:13:14,544:  >> stack= False
2020-06-07 10:13:14,544:  >> seg_durs= (1, None)
2020-06-07 10:13:14,544:  >> # words= 11024 (# ignored= 0)
2020-06-07 10:13:14,544:  >> input_feat_dim= 108
2020-06-07 10:13:14,544:  >> input_num_subwords= 45
2020-06-07 10:13:14,544: Using module at data.batch_samplers.BatchSampler
2020-06-07 10:13:14,544: Building test_sampler from config
2020-06-07 10:13:14,545:  >> # examples= 11024
2020-06-07 10:13:14,545:  >> batch_size= 256
2020-06-07 10:13:14,545:  >> shuffle= False
2020-06-07 10:13:14,548:  >> BatchSampler; 44 batches
2020-06-07 10:13:14,548: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-07 10:13:14,609: Building loss from config
2020-06-07 10:13:14,609:  >> margin= 0.4
2020-06-07 10:13:14,610:  >> k= 16
2020-06-07 10:13:14,610:  >> min_k= 8
2020-06-07 10:13:14,610:  >> extra= 0
2020-06-07 10:13:14,610:  >> average= False
2020-06-07 10:13:14,610: Using module at metric.multiview_ap.MultiViewAP
2020-06-07 10:13:14,665: Building eval from config
2020-06-07 10:13:14,666:  >> acoustic_ap= True
2020-06-07 10:13:14,666:  >> crossview_ap= True
2020-06-07 10:13:14,666:  >> full_vocab= False
2020-06-07 10:13:14,666:  >> metric= crossview_ap
2020-06-07 10:13:14,666:  >> mode= max
2020-06-07 10:13:14,666: Using module at multiview_rnn.MultiViewRNN
2020-06-07 10:13:14,668: Building net from config
2020-06-07 10:13:14,669: view1:
2020-06-07 10:13:14,669:  >> cell= GRU
2020-06-07 10:13:14,669:  >> input_size= 108
2020-06-07 10:13:14,670:  >> hidden_size= 512
2020-06-07 10:13:14,670:  >> bidirectional= True
2020-06-07 10:13:14,670:  >> num_layers= 6
2020-06-07 10:13:14,670:  >> dropout between layers= 0.4
2020-06-07 10:13:14,958: view2:
2020-06-07 10:13:14,959:  >> cell= GRU
2020-06-07 10:13:14,959:  >> input_size= 64
2020-06-07 10:13:14,960:  >> hidden_size= 512
2020-06-07 10:13:14,960:  >> bidirectional= True
2020-06-07 10:13:14,960:  >> num_layers= 2
2020-06-07 10:13:14,961:  >> dropout between layers= 0.4
2020-06-07 10:13:14,961:  >> num input embeddings= 45
2020-06-07 10:13:15,077: Using module at optim.adam.Adam
2020-06-07 10:13:15,078: Building optim from config
2020-06-07 10:13:15,079:  >> lr= 0.001
2020-06-07 10:13:15,079:  >> betas= (0.9, 0.999)
2020-06-07 10:13:15,079:  >> eps= 1e-08
2020-06-07 10:13:15,079:  >> weight_decay= 0
2020-06-07 10:13:15,079:  >> amsgrad= False
2020-06-07 10:13:15,080:  >> min_lr= 1e-07
2020-06-07 10:13:15,081: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-07 10:13:15,082: Building sched from config
2020-06-07 10:13:15,083:  >> optim= Adam
2020-06-07 10:13:15,083:  >> decay lr by 0.1
2020-06-07 10:13:15,083:  >> eval_fn= MultiViewAP
2020-06-07 10:13:15,084:  >> patience=4
2020-06-07 10:13:15,084:  >> revert=True
2020-06-07 10:13:15,084: epoch=0.00 global_step=0 lr=0.001 start_iter=0
2020-06-07 10:13:15,084: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 10:14:51,102: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-07 10:14:51,102: Using CPU
2020-06-07 10:14:51,102: Machine: 0 / 1
2020-06-07 10:14:51,103: Hyperparam tuning-------------------
2020-06-07 10:14:51,103: optim_lr: 0.001
2020-06-07 10:14:51,103: dropout (for both): 0.4
2020-06-07 10:14:51,103: margin: 0.4
2020-06-07 10:14:51,104: ------------------------------------
2020-06-07 10:14:51,106: Calling main function: multiview_trainer.train
2020-06-07 10:14:51,106: Using config file: train_config.json
2020-06-07 10:14:51,106: Using module at multiview_trainer.train
2020-06-07 10:14:51,377: Using module at multiview_vocab.MultiViewVocab
2020-06-07 10:14:51,378: Building vocab_data from config
2020-06-07 10:14:51,684:  >> min_count= 0
2020-06-07 10:14:51,684:  >> # words= 34323 (# removed= 0)
2020-06-07 10:14:51,684:  >> # subwords= 45
2020-06-07 10:14:51,684:     [laughter]= 1
2020-06-07 10:14:51,684:     [noise]= 2
2020-06-07 10:14:51,685:     [vocalized-noise]= 3
2020-06-07 10:14:51,685:     aa= 4
2020-06-07 10:14:51,685:     ae= 5
2020-06-07 10:14:51,685:     ah= 6
2020-06-07 10:14:51,685:     ao= 7
2020-06-07 10:14:51,685:     aw= 8
2020-06-07 10:14:51,685:     ax= 9
2020-06-07 10:14:51,685:     ay= 10
2020-06-07 10:14:51,685:     b= 11
2020-06-07 10:14:51,686:     ch= 12
2020-06-07 10:14:51,686:     d= 13
2020-06-07 10:14:51,686:     dh= 14
2020-06-07 10:14:51,686:     eh= 15
2020-06-07 10:14:51,686:     el= 16
2020-06-07 10:14:51,686:     en= 17
2020-06-07 10:14:51,686:     er= 18
2020-06-07 10:14:51,686:     ey= 19
2020-06-07 10:14:51,686:     f= 20
2020-06-07 10:14:51,686:     g= 21
2020-06-07 10:14:51,687:     hh= 22
2020-06-07 10:14:51,687:     ih= 23
2020-06-07 10:14:51,687:     iy= 24
2020-06-07 10:14:51,687:     jh= 25
2020-06-07 10:14:51,687:     k= 26
2020-06-07 10:14:51,687:     l= 27
2020-06-07 10:14:51,687:     m= 28
2020-06-07 10:14:51,687:     n= 29
2020-06-07 10:14:51,687:     ng= 30
2020-06-07 10:14:51,687:     ow= 31
2020-06-07 10:14:51,687:     oy= 32
2020-06-07 10:14:51,688:     p= 33
2020-06-07 10:14:51,688:     r= 34
2020-06-07 10:14:51,688:     s= 35
2020-06-07 10:14:51,688:     sh= 36
2020-06-07 10:14:51,688:     t= 37
2020-06-07 10:14:51,688:     th= 38
2020-06-07 10:14:51,688:     uh= 39
2020-06-07 10:14:51,688:     uw= 40
2020-06-07 10:14:51,688:     v= 41
2020-06-07 10:14:51,688:     w= 42
2020-06-07 10:14:51,689:     y= 43
2020-06-07 10:14:51,689:     z= 44
2020-06-07 10:14:51,689:     zh= 45
2020-06-07 10:14:51,705: Using module at data.batch_samplers.BatchSampler
2020-06-07 10:14:51,706: Building vocab_sampler from config
2020-06-07 10:14:51,707:  >> # examples= 34323
2020-06-07 10:14:51,707:  >> batch_size= 1000
2020-06-07 10:14:51,707:  >> shuffle= False
2020-06-07 10:14:51,715:  >> BatchSampler; 35 batches
2020-06-07 10:14:51,715: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 10:14:51,818: Building train_data from config
2020-06-07 10:15:03,136:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-07 10:15:03,136:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-07 10:15:03,137:  >> stack= False
2020-06-07 10:15:03,137:  >> seg_durs= (1, None)
2020-06-07 10:15:03,137:  >> # words= 9971 (# ignored= 0)
2020-06-07 10:15:03,137:  >> input_feat_dim= 108
2020-06-07 10:15:03,138:  >> input_num_subwords= 45
2020-06-07 10:15:03,139: Using module at data.batch_samplers.BatchSampler
2020-06-07 10:15:03,139: Building train_sampler from config
2020-06-07 10:15:03,139:  >> # examples= 9971
2020-06-07 10:15:03,140:  >> batch_size= 256
2020-06-07 10:15:03,140:  >> shuffle= True
2020-06-07 10:15:03,155:  >> BatchSampler; 39 batches
2020-06-07 10:15:03,155: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 10:15:03,156: Building dev_data from config
2020-06-07 10:15:16,404:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-07 10:15:16,405:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-07 10:15:16,405:  >> stack= False
2020-06-07 10:15:16,405:  >> seg_durs= (1, None)
2020-06-07 10:15:16,405:  >> # words= 10966 (# ignored= 0)
2020-06-07 10:15:16,405:  >> input_feat_dim= 108
2020-06-07 10:15:16,405:  >> input_num_subwords= 45
2020-06-07 10:15:16,405: Using module at data.batch_samplers.BatchSampler
2020-06-07 10:15:16,406: Building dev_sampler from config
2020-06-07 10:15:16,406:  >> # examples= 10966
2020-06-07 10:15:16,406:  >> batch_size= 256
2020-06-07 10:15:16,406:  >> shuffle= False
2020-06-07 10:15:16,409:  >> BatchSampler; 43 batches
2020-06-07 10:15:16,409: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 10:15:16,409: Building test_data from config
2020-06-07 10:15:28,654:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-07 10:15:28,655:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-07 10:15:28,655:  >> stack= False
2020-06-07 10:15:28,655:  >> seg_durs= (1, None)
2020-06-07 10:15:28,655:  >> # words= 11024 (# ignored= 0)
2020-06-07 10:15:28,655:  >> input_feat_dim= 108
2020-06-07 10:15:28,655:  >> input_num_subwords= 45
2020-06-07 10:15:28,656: Using module at data.batch_samplers.BatchSampler
2020-06-07 10:15:28,656: Building test_sampler from config
2020-06-07 10:15:28,656:  >> # examples= 11024
2020-06-07 10:15:28,657:  >> batch_size= 256
2020-06-07 10:15:28,657:  >> shuffle= False
2020-06-07 10:15:28,661:  >> BatchSampler; 44 batches
2020-06-07 10:15:28,662: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-07 10:15:28,704: Building loss from config
2020-06-07 10:15:28,705:  >> margin= 0.4
2020-06-07 10:15:28,705:  >> k= 16
2020-06-07 10:15:28,705:  >> min_k= 8
2020-06-07 10:15:28,705:  >> extra= 0
2020-06-07 10:15:28,705:  >> average= False
2020-06-07 10:15:28,706: Using module at metric.multiview_ap.MultiViewAP
2020-06-07 10:15:28,757: Building eval from config
2020-06-07 10:15:28,758:  >> acoustic_ap= True
2020-06-07 10:15:28,758:  >> crossview_ap= True
2020-06-07 10:15:28,758:  >> full_vocab= False
2020-06-07 10:15:28,758:  >> metric= crossview_ap
2020-06-07 10:15:28,758:  >> mode= max
2020-06-07 10:15:28,758: Using module at multiview_rnn.MultiViewRNN
2020-06-07 10:15:28,760: Building net from config
2020-06-07 10:15:28,761: view1:
2020-06-07 10:15:28,761:  >> cell= GRU
2020-06-07 10:15:28,761:  >> input_size= 108
2020-06-07 10:15:28,762:  >> hidden_size= 512
2020-06-07 10:15:28,762:  >> bidirectional= True
2020-06-07 10:15:28,762:  >> num_layers= 6
2020-06-07 10:15:28,762:  >> dropout between layers= 0.4
2020-06-07 10:15:29,159: view2:
2020-06-07 10:15:29,159:  >> cell= GRU
2020-06-07 10:15:29,160:  >> input_size= 64
2020-06-07 10:15:29,160:  >> hidden_size= 512
2020-06-07 10:15:29,160:  >> bidirectional= True
2020-06-07 10:15:29,160:  >> num_layers= 2
2020-06-07 10:15:29,160:  >> dropout between layers= 0.4
2020-06-07 10:15:29,160:  >> num input embeddings= 45
2020-06-07 10:15:29,234: Using module at optim.adam.Adam
2020-06-07 10:15:29,235: Building optim from config
2020-06-07 10:15:29,236:  >> lr= 0.001
2020-06-07 10:15:29,236:  >> betas= (0.9, 0.999)
2020-06-07 10:15:29,236:  >> eps= 1e-08
2020-06-07 10:15:29,236:  >> weight_decay= 0
2020-06-07 10:15:29,236:  >> amsgrad= False
2020-06-07 10:15:29,236:  >> min_lr= 1e-07
2020-06-07 10:15:29,237: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-07 10:15:29,238: Building sched from config
2020-06-07 10:15:29,238:  >> optim= Adam
2020-06-07 10:15:29,238:  >> decay lr by 0.1
2020-06-07 10:15:29,238:  >> eval_fn= MultiViewAP
2020-06-07 10:15:29,239:  >> patience=4
2020-06-07 10:15:29,239:  >> revert=True
2020-06-07 10:15:29,239: epoch=0.00 global_step=0 lr=0.001 start_iter=0
2020-06-07 10:15:29,239: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 10:21:05,930: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-07 10:21:05,930: Using CPU
2020-06-07 10:21:05,930: Machine: 0 / 1
2020-06-07 10:21:05,931: Hyperparam tuning-------------------
2020-06-07 10:21:05,931: optim_lr: 0.001
2020-06-07 10:21:05,931: dropout (for both): 0.4
2020-06-07 10:21:05,931: margin: 0.4
2020-06-07 10:21:05,931: ------------------------------------
2020-06-07 10:21:05,935: Calling main function: multiview_trainer.train
2020-06-07 10:21:05,935: Using config file: train_config.json
2020-06-07 10:21:05,935: Using module at multiview_trainer.train
2020-06-07 10:21:06,200: Using module at multiview_vocab.MultiViewVocab
2020-06-07 10:21:06,202: Building vocab_data from config
2020-06-07 10:21:06,563:  >> min_count= 0
2020-06-07 10:21:06,563:  >> # words= 34323 (# removed= 0)
2020-06-07 10:21:06,563:  >> # subwords= 45
2020-06-07 10:21:06,563:     [laughter]= 1
2020-06-07 10:21:06,563:     [noise]= 2
2020-06-07 10:21:06,563:     [vocalized-noise]= 3
2020-06-07 10:21:06,564:     aa= 4
2020-06-07 10:21:06,564:     ae= 5
2020-06-07 10:21:06,564:     ah= 6
2020-06-07 10:21:06,564:     ao= 7
2020-06-07 10:21:06,564:     aw= 8
2020-06-07 10:21:06,564:     ax= 9
2020-06-07 10:21:06,564:     ay= 10
2020-06-07 10:21:06,564:     b= 11
2020-06-07 10:21:06,564:     ch= 12
2020-06-07 10:21:06,565:     d= 13
2020-06-07 10:21:06,565:     dh= 14
2020-06-07 10:21:06,565:     eh= 15
2020-06-07 10:21:06,565:     el= 16
2020-06-07 10:21:06,565:     en= 17
2020-06-07 10:21:06,565:     er= 18
2020-06-07 10:21:06,565:     ey= 19
2020-06-07 10:21:06,565:     f= 20
2020-06-07 10:21:06,565:     g= 21
2020-06-07 10:21:06,565:     hh= 22
2020-06-07 10:21:06,566:     ih= 23
2020-06-07 10:21:06,566:     iy= 24
2020-06-07 10:21:06,566:     jh= 25
2020-06-07 10:21:06,566:     k= 26
2020-06-07 10:21:06,566:     l= 27
2020-06-07 10:21:06,566:     m= 28
2020-06-07 10:21:06,566:     n= 29
2020-06-07 10:21:06,566:     ng= 30
2020-06-07 10:21:06,566:     ow= 31
2020-06-07 10:21:06,566:     oy= 32
2020-06-07 10:21:06,566:     p= 33
2020-06-07 10:21:06,567:     r= 34
2020-06-07 10:21:06,567:     s= 35
2020-06-07 10:21:06,567:     sh= 36
2020-06-07 10:21:06,567:     t= 37
2020-06-07 10:21:06,567:     th= 38
2020-06-07 10:21:06,567:     uh= 39
2020-06-07 10:21:06,567:     uw= 40
2020-06-07 10:21:06,567:     v= 41
2020-06-07 10:21:06,567:     w= 42
2020-06-07 10:21:06,567:     y= 43
2020-06-07 10:21:06,567:     z= 44
2020-06-07 10:21:06,568:     zh= 45
2020-06-07 10:21:06,584: Using module at data.batch_samplers.BatchSampler
2020-06-07 10:21:06,585: Building vocab_sampler from config
2020-06-07 10:21:06,585:  >> # examples= 34323
2020-06-07 10:21:06,585:  >> batch_size= 1000
2020-06-07 10:21:06,585:  >> shuffle= False
2020-06-07 10:21:06,594:  >> BatchSampler; 35 batches
2020-06-07 10:21:06,594: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 10:21:06,696: Building train_data from config
2020-06-07 10:21:16,462:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-07 10:21:16,463:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-07 10:21:16,463:  >> stack= False
2020-06-07 10:21:16,463:  >> seg_durs= (1, None)
2020-06-07 10:21:16,463:  >> # words= 9971 (# ignored= 0)
2020-06-07 10:21:16,463:  >> input_feat_dim= 108
2020-06-07 10:21:16,464:  >> input_num_subwords= 45
2020-06-07 10:21:16,464: Using module at data.batch_samplers.BatchSampler
2020-06-07 10:21:16,465: Building train_sampler from config
2020-06-07 10:21:16,465:  >> # examples= 9971
2020-06-07 10:21:16,465:  >> batch_size= 256
2020-06-07 10:21:16,466:  >> shuffle= True
2020-06-07 10:21:16,478:  >> BatchSampler; 39 batches
2020-06-07 10:21:16,479: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 10:21:16,479: Building dev_data from config
2020-06-07 10:21:27,873:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-07 10:21:27,874:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-07 10:21:27,874:  >> stack= False
2020-06-07 10:21:27,874:  >> seg_durs= (1, None)
2020-06-07 10:21:27,874:  >> # words= 10966 (# ignored= 0)
2020-06-07 10:21:27,874:  >> input_feat_dim= 108
2020-06-07 10:21:27,874:  >> input_num_subwords= 45
2020-06-07 10:21:27,875: Using module at data.batch_samplers.BatchSampler
2020-06-07 10:21:27,876: Building dev_sampler from config
2020-06-07 10:21:27,876:  >> # examples= 10966
2020-06-07 10:21:27,876:  >> batch_size= 256
2020-06-07 10:21:27,876:  >> shuffle= False
2020-06-07 10:21:27,881:  >> BatchSampler; 43 batches
2020-06-07 10:21:27,881: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 10:21:27,881: Building test_data from config
2020-06-07 10:21:37,742:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-07 10:21:37,742:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-07 10:21:37,743:  >> stack= False
2020-06-07 10:21:37,743:  >> seg_durs= (1, None)
2020-06-07 10:21:37,743:  >> # words= 11024 (# ignored= 0)
2020-06-07 10:21:37,743:  >> input_feat_dim= 108
2020-06-07 10:21:37,743:  >> input_num_subwords= 45
2020-06-07 10:21:37,743: Using module at data.batch_samplers.BatchSampler
2020-06-07 10:21:37,743: Building test_sampler from config
2020-06-07 10:21:37,744:  >> # examples= 11024
2020-06-07 10:21:37,744:  >> batch_size= 256
2020-06-07 10:21:37,744:  >> shuffle= False
2020-06-07 10:21:37,747:  >> BatchSampler; 44 batches
2020-06-07 10:21:37,747: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-07 10:21:37,777: Building loss from config
2020-06-07 10:21:37,777:  >> margin= 0.4
2020-06-07 10:21:37,778:  >> k= 16
2020-06-07 10:21:37,778:  >> min_k= 8
2020-06-07 10:21:37,778:  >> extra= 0
2020-06-07 10:21:37,778:  >> average= False
2020-06-07 10:21:37,778: Using module at metric.multiview_ap.MultiViewAP
2020-06-07 10:21:37,833: Building eval from config
2020-06-07 10:21:37,834:  >> acoustic_ap= True
2020-06-07 10:21:37,834:  >> crossview_ap= True
2020-06-07 10:21:37,834:  >> full_vocab= False
2020-06-07 10:21:37,835:  >> metric= crossview_ap
2020-06-07 10:21:37,835:  >> mode= max
2020-06-07 10:21:37,835: Using module at multiview_rnn.MultiViewRNN
2020-06-07 10:21:37,837: Building net from config
2020-06-07 10:21:37,839: view1:
2020-06-07 10:21:37,840:  >> cell= GRU
2020-06-07 10:21:37,840:  >> input_size= 108
2020-06-07 10:21:37,840:  >> hidden_size= 512
2020-06-07 10:21:37,840:  >> bidirectional= True
2020-06-07 10:21:37,840:  >> num_layers= 6
2020-06-07 10:21:37,840:  >> dropout between layers= 0.4
2020-06-07 10:21:38,241: view2:
2020-06-07 10:21:38,242:  >> cell= GRU
2020-06-07 10:21:38,242:  >> input_size= 64
2020-06-07 10:21:38,242:  >> hidden_size= 512
2020-06-07 10:21:38,242:  >> bidirectional= True
2020-06-07 10:21:38,243:  >> num_layers= 2
2020-06-07 10:21:38,244:  >> dropout between layers= 0.4
2020-06-07 10:21:38,244:  >> num input embeddings= 45
2020-06-07 10:21:38,322: Using module at optim.adam.Adam
2020-06-07 10:21:38,323: Building optim from config
2020-06-07 10:21:38,323:  >> lr= 0.001
2020-06-07 10:21:38,323:  >> betas= (0.9, 0.999)
2020-06-07 10:21:38,324:  >> eps= 1e-08
2020-06-07 10:21:38,324:  >> weight_decay= 0
2020-06-07 10:21:38,324:  >> amsgrad= False
2020-06-07 10:21:38,324:  >> min_lr= 1e-07
2020-06-07 10:21:38,325: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-07 10:21:38,326: Building sched from config
2020-06-07 10:21:38,326:  >> optim= Adam
2020-06-07 10:21:38,326:  >> decay lr by 0.1
2020-06-07 10:21:38,327:  >> eval_fn= MultiViewAP
2020-06-07 10:21:38,327:  >> patience=4
2020-06-07 10:21:38,327:  >> revert=True
2020-06-07 10:21:38,327: epoch=0.00 global_step=0 lr=0.001 start_iter=0
2020-06-07 10:21:38,327: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 13:59:10,075: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-09 13:59:10,146: Using 1 GPU(s)
2020-06-09 13:59:10,146: Machine: 0 / 1
2020-06-09 13:59:10,148: Hyperparam tuning-------------------
2020-06-09 13:59:10,148: optim_lr: 0.001
2020-06-09 13:59:10,148: dropout (for both): 0.4
2020-06-09 13:59:10,148: margin: 0.4
2020-06-09 13:59:10,148: ------------------------------------
2020-06-09 13:59:10,150: Calling main function: multiview_trainer.train
2020-06-09 13:59:10,150: Using config file: train_config.json
2020-06-09 13:59:10,150: Using module at multiview_trainer.train
2020-06-09 13:59:10,406: Using module at multiview_vocab.MultiViewVocab
2020-06-09 13:59:10,424: Building vocab_data from config
2020-06-09 13:59:10,705:  >> min_count= 0
2020-06-09 13:59:10,705:  >> # words= 34323 (# removed= 0)
2020-06-09 13:59:10,705:  >> # subwords= 45
2020-06-09 13:59:10,705:     [laughter]= 1
2020-06-09 13:59:10,705:     [noise]= 2
2020-06-09 13:59:10,705:     [vocalized-noise]= 3
2020-06-09 13:59:10,705:     aa= 4
2020-06-09 13:59:10,705:     ae= 5
2020-06-09 13:59:10,706:     ah= 6
2020-06-09 13:59:10,706:     ao= 7
2020-06-09 13:59:10,706:     aw= 8
2020-06-09 13:59:10,706:     ax= 9
2020-06-09 13:59:10,706:     ay= 10
2020-06-09 13:59:10,706:     b= 11
2020-06-09 13:59:10,706:     ch= 12
2020-06-09 13:59:10,706:     d= 13
2020-06-09 13:59:10,706:     dh= 14
2020-06-09 13:59:10,706:     eh= 15
2020-06-09 13:59:10,706:     el= 16
2020-06-09 13:59:10,706:     en= 17
2020-06-09 13:59:10,706:     er= 18
2020-06-09 13:59:10,706:     ey= 19
2020-06-09 13:59:10,706:     f= 20
2020-06-09 13:59:10,706:     g= 21
2020-06-09 13:59:10,706:     hh= 22
2020-06-09 13:59:10,706:     ih= 23
2020-06-09 13:59:10,706:     iy= 24
2020-06-09 13:59:10,707:     jh= 25
2020-06-09 13:59:10,707:     k= 26
2020-06-09 13:59:10,707:     l= 27
2020-06-09 13:59:10,707:     m= 28
2020-06-09 13:59:10,707:     n= 29
2020-06-09 13:59:10,707:     ng= 30
2020-06-09 13:59:10,707:     ow= 31
2020-06-09 13:59:10,707:     oy= 32
2020-06-09 13:59:10,707:     p= 33
2020-06-09 13:59:10,707:     r= 34
2020-06-09 13:59:10,707:     s= 35
2020-06-09 13:59:10,707:     sh= 36
2020-06-09 13:59:10,707:     t= 37
2020-06-09 13:59:10,707:     th= 38
2020-06-09 13:59:10,707:     uh= 39
2020-06-09 13:59:10,707:     uw= 40
2020-06-09 13:59:10,707:     v= 41
2020-06-09 13:59:10,707:     w= 42
2020-06-09 13:59:10,708:     y= 43
2020-06-09 13:59:10,708:     z= 44
2020-06-09 13:59:10,708:     zh= 45
2020-06-09 13:59:10,722: Using module at data.batch_samplers.BatchSampler
2020-06-09 13:59:10,728: Building vocab_sampler from config
2020-06-09 13:59:10,728:  >> # examples= 34323
2020-06-09 13:59:10,728:  >> batch_size= 1000
2020-06-09 13:59:10,729:  >> shuffle= False
2020-06-09 13:59:10,736:  >> BatchSampler; 35 batches
2020-06-09 13:59:10,736: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 13:59:10,832: Building train_data from config
2020-06-09 13:59:17,287:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-09 13:59:17,288:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-09 13:59:17,288:  >> stack= False
2020-06-09 13:59:17,288:  >> seg_durs= (1, None)
2020-06-09 13:59:17,288:  >> # words= 9971 (# ignored= 0)
2020-06-09 13:59:17,288:  >> input_feat_dim= 108
2020-06-09 13:59:17,288:  >> input_num_subwords= 45
2020-06-09 13:59:17,288: Using module at data.batch_samplers.BatchSampler
2020-06-09 13:59:17,288: Building train_sampler from config
2020-06-09 13:59:17,289:  >> # examples= 9971
2020-06-09 13:59:17,289:  >> batch_size= 256
2020-06-09 13:59:17,289:  >> shuffle= True
2020-06-09 13:59:17,296:  >> BatchSampler; 39 batches
2020-06-09 13:59:17,296: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 13:59:17,296: Building dev_data from config
2020-06-09 13:59:24,659:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-09 13:59:24,660:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-09 13:59:24,660:  >> stack= False
2020-06-09 13:59:24,660:  >> seg_durs= (1, None)
2020-06-09 13:59:24,660:  >> # words= 10966 (# ignored= 0)
2020-06-09 13:59:24,660:  >> input_feat_dim= 108
2020-06-09 13:59:24,660:  >> input_num_subwords= 45
2020-06-09 13:59:24,660: Using module at data.batch_samplers.BatchSampler
2020-06-09 13:59:24,660: Building dev_sampler from config
2020-06-09 13:59:24,661:  >> # examples= 10966
2020-06-09 13:59:24,661:  >> batch_size= 256
2020-06-09 13:59:24,661:  >> shuffle= False
2020-06-09 13:59:24,663:  >> BatchSampler; 43 batches
2020-06-09 13:59:24,663: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 13:59:24,663: Building test_data from config
2020-06-09 13:59:30,444:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-09 13:59:30,444:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-09 13:59:30,444:  >> stack= False
2020-06-09 13:59:30,444:  >> seg_durs= (1, None)
2020-06-09 13:59:30,445:  >> # words= 11024 (# ignored= 0)
2020-06-09 13:59:30,445:  >> input_feat_dim= 108
2020-06-09 13:59:30,445:  >> input_num_subwords= 45
2020-06-09 13:59:30,445: Using module at data.batch_samplers.BatchSampler
2020-06-09 13:59:30,445: Building test_sampler from config
2020-06-09 13:59:30,445:  >> # examples= 11024
2020-06-09 13:59:30,445:  >> batch_size= 256
2020-06-09 13:59:30,445:  >> shuffle= False
2020-06-09 13:59:30,447:  >> BatchSampler; 44 batches
2020-06-09 13:59:30,447: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-09 13:59:30,484: Building loss from config
2020-06-09 13:59:30,484:  >> margin= 0.4
2020-06-09 13:59:30,484:  >> k= 16
2020-06-09 13:59:30,484:  >> min_k= 8
2020-06-09 13:59:30,484:  >> extra= 0
2020-06-09 13:59:30,484:  >> average= False
2020-06-09 13:59:30,485: Using module at metric.multiview_ap.MultiViewAP
2020-06-09 13:59:30,596: Building eval from config
2020-06-09 13:59:30,596:  >> acoustic_ap= True
2020-06-09 13:59:30,596:  >> crossview_ap= True
2020-06-09 13:59:30,596:  >> full_vocab= False
2020-06-09 13:59:30,596:  >> metric= crossview_ap
2020-06-09 13:59:30,596:  >> mode= max
2020-06-09 13:59:30,596: Using module at multiview_rnn.MultiViewRNN
2020-06-09 13:59:30,633: Building net from config
2020-06-09 13:59:30,635: view1:
2020-06-09 13:59:30,636:  >> cell= GRU
2020-06-09 13:59:30,636:  >> input_size= 108
2020-06-09 13:59:30,636:  >> hidden_size= 512
2020-06-09 13:59:30,636:  >> bidirectional= True
2020-06-09 13:59:30,636:  >> num_layers= 6
2020-06-09 13:59:30,636:  >> dropout between layers= 0.4
2020-06-09 13:59:30,853: view2:
2020-06-09 13:59:30,854:  >> cell= GRU
2020-06-09 13:59:30,854:  >> input_size= 64
2020-06-09 13:59:30,854:  >> hidden_size= 512
2020-06-09 13:59:30,854:  >> bidirectional= True
2020-06-09 13:59:30,854:  >> num_layers= 2
2020-06-09 13:59:30,854:  >> dropout between layers= 0.4
2020-06-09 13:59:30,855:  >> num input embeddings= 45
2020-06-09 13:59:34,057: Using module at optim.adam.Adam
2020-06-09 13:59:34,066: Building optim from config
2020-06-09 13:59:34,066:  >> lr= 0.001
2020-06-09 13:59:34,066:  >> betas= (0.9, 0.999)
2020-06-09 13:59:34,066:  >> eps= 1e-08
2020-06-09 13:59:34,066:  >> weight_decay= 0
2020-06-09 13:59:34,066:  >> amsgrad= False
2020-06-09 13:59:34,066:  >> min_lr= 1e-07
2020-06-09 13:59:34,067: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-09 13:59:34,086: Building sched from config
2020-06-09 13:59:34,087:  >> optim= Adam
2020-06-09 13:59:34,087:  >> decay lr by 0.1
2020-06-09 13:59:34,087:  >> eval_fn= MultiViewAP
2020-06-09 13:59:34,087:  >> patience=4
2020-06-09 13:59:34,087:  >> revert=True
2020-06-09 13:59:34,087: epoch=0.00 global_step=0 lr=0.001 start_iter=0
2020-06-09 13:59:34,088: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 14:04:36,114: 0) loss=0.588 grad_norm=52.17 num_segments=256 num_words=204
2020-06-09 14:09:18,264: 1) loss=0.611 grad_norm=43.80 num_segments=256 num_words=211
2020-06-09 14:13:38,861: 2) loss=0.634 grad_norm=63.32 num_segments=256 num_words=202
2020-06-09 14:17:39,825: 3) loss=0.626 grad_norm=47.27 num_segments=256 num_words=218
2020-06-09 14:21:21,447: 4) loss=0.586 grad_norm=50.19 num_segments=256 num_words=204
2020-06-09 14:24:38,665: 5) loss=0.531 grad_norm=77.50 num_segments=256 num_words=194
2020-06-09 14:27:41,435: 6) loss=0.654 grad_norm=58.35 num_segments=256 num_words=218
2020-06-09 14:30:22,062: 7) loss=0.610 grad_norm=64.13 num_segments=256 num_words=207
2020-06-09 14:33:01,008: 8) loss=0.583 grad_norm=46.41 num_segments=256 num_words=207
2020-06-09 14:35:43,164: 9) loss=0.564 grad_norm=55.49 num_segments=256 num_words=217
2020-06-09 14:38:25,149: 10) loss=0.550 grad_norm=46.74 num_segments=256 num_words=218
2020-06-09 14:41:08,181: 11) loss=0.551 grad_norm=46.03 num_segments=256 num_words=208
2020-06-09 14:43:52,518: 12) loss=0.633 grad_norm=60.11 num_segments=256 num_words=223
2020-06-09 14:46:35,409: 13) loss=0.562 grad_norm=40.77 num_segments=256 num_words=211
2020-06-09 14:49:17,405: 14) loss=0.613 grad_norm=46.42 num_segments=256 num_words=216
2020-06-09 14:51:57,735: 15) loss=0.540 grad_norm=53.50 num_segments=256 num_words=198
2020-06-09 14:54:38,309: 16) loss=0.549 grad_norm=41.49 num_segments=256 num_words=209
2020-06-09 14:57:19,176: 17) loss=0.575 grad_norm=38.76 num_segments=256 num_words=210
2020-06-09 15:00:01,835: 18) loss=0.532 grad_norm=39.04 num_segments=256 num_words=209
2020-06-09 15:02:42,814: 19) loss=0.515 grad_norm=48.78 num_segments=256 num_words=210
2020-06-09 15:05:25,509: 20) loss=0.566 grad_norm=42.62 num_segments=256 num_words=212
2020-06-09 15:08:08,767: 21) loss=0.555 grad_norm=53.61 num_segments=256 num_words=216
2020-06-09 15:10:52,271: 22) loss=0.566 grad_norm=48.45 num_segments=256 num_words=209
2020-06-09 15:13:37,325: 23) loss=0.552 grad_norm=31.89 num_segments=256 num_words=220
2020-06-09 15:16:18,811: 24) loss=0.525 grad_norm=52.29 num_segments=256 num_words=202
2020-06-09 15:18:59,657: 25) loss=0.538 grad_norm=46.61 num_segments=256 num_words=207
2020-06-09 15:21:39,810: 26) loss=0.515 grad_norm=36.95 num_segments=256 num_words=209
2020-06-09 15:24:18,010: 27) loss=0.488 grad_norm=51.68 num_segments=256 num_words=204
2020-06-09 15:27:02,049: 28) loss=0.532 grad_norm=46.03 num_segments=256 num_words=216
2020-06-09 15:30:06,466: 29) loss=0.528 grad_norm=44.27 num_segments=256 num_words=207
2020-06-09 15:33:23,682: 30) loss=0.576 grad_norm=49.37 num_segments=256 num_words=220
2020-06-09 15:36:35,097: 31) loss=0.524 grad_norm=45.17 num_segments=256 num_words=212
2020-06-09 15:39:59,138: 32) loss=0.486 grad_norm=44.12 num_segments=256 num_words=210
2020-06-09 15:43:24,642: 33) loss=0.527 grad_norm=38.57 num_segments=256 num_words=202
2020-06-09 15:46:30,195: 34) loss=0.473 grad_norm=52.02 num_segments=256 num_words=213
2020-06-09 15:49:46,578: 35) loss=0.515 grad_norm=37.55 num_segments=256 num_words=205
2020-06-09 15:53:01,411: 36) loss=0.505 grad_norm=54.05 num_segments=256 num_words=208
2020-06-09 15:56:07,039: 37) loss=0.471 grad_norm=35.43 num_segments=256 num_words=209
2020-06-09 15:59:01,995: 38) loss=0.497 grad_norm=49.24 num_segments=243 num_words=211
2020-06-09 15:59:02,005: epoch= 1.00
2020-06-09 15:59:02,005:  >> time to evaluate and save:
2020-06-09 15:59:02,042: saved save/MultiViewDataset_IndividualWords.39.pth
2020-06-09 15:59:02,043: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 15:59:02,044: saved MultiViewDataset_IndividualWords successfully
2020-06-09 15:59:03,436: saved save/MultiViewRNN.39.pth
2020-06-09 15:59:03,437: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 15:59:03,438: saved MultiViewRNN successfully
2020-06-09 15:59:05,985: saved save/Adam.39.pth
2020-06-09 15:59:05,986: most_recent linked save/Adam.most_recent.pth
2020-06-09 15:59:05,987: saved Adam successfully
2020-06-09 15:59:05,989: saved save/ReduceLROnPlateau.39.pth
2020-06-09 15:59:05,990: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 15:59:05,991: saved ReduceLROnPlateau successfully
2020-06-09 15:59:05,993: saved config successfully
2020-06-09 16:00:34,053:   >> crossview_ap=0.049 (10966 x 3921 pairs)
2020-06-09 16:01:30,863:   >> acoustic_ap=0.084 (10966 choose 2 pairs)
2020-06-09 16:01:30,866: best_so_far= 0.049 at 39
2020-06-09 16:01:30,868: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 16:01:30,869: saved MultiViewDataset_IndividualWords successfully
2020-06-09 16:01:30,870: best linked save/MultiViewRNN.best.pth
2020-06-09 16:01:30,871: saved MultiViewRNN successfully
2020-06-09 16:01:30,872: best linked save/Adam.best.pth
2020-06-09 16:01:30,873: saved Adam successfully
2020-06-09 16:01:30,873: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 16:01:30,874: saved ReduceLROnPlateau successfully
2020-06-09 16:01:30,936: epoch=1.00 global_step=39 lr=0.001 start_iter=0
2020-06-09 16:01:30,937: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 16:04:35,373: 0) loss=0.535 grad_norm=45.57 num_segments=256 num_words=218
2020-06-09 16:07:38,889: 1) loss=0.509 grad_norm=37.60 num_segments=256 num_words=212
2020-06-09 16:10:44,602: 2) loss=0.530 grad_norm=33.97 num_segments=256 num_words=209
2020-06-09 16:13:48,573: 3) loss=0.469 grad_norm=43.62 num_segments=256 num_words=211
2020-06-09 16:16:54,600: 4) loss=0.486 grad_norm=39.69 num_segments=256 num_words=215
2020-06-09 16:19:56,765: 5) loss=0.534 grad_norm=32.39 num_segments=256 num_words=213
2020-06-09 16:23:21,270: 6) loss=0.515 grad_norm=39.87 num_segments=256 num_words=216
2020-06-09 16:26:35,353: 7) loss=0.458 grad_norm=36.29 num_segments=256 num_words=203
2020-06-09 16:29:56,468: 8) loss=0.479 grad_norm=30.38 num_segments=256 num_words=218
2020-06-09 16:33:17,828: 9) loss=0.495 grad_norm=32.88 num_segments=256 num_words=212
2020-06-09 16:36:21,144: 10) loss=0.483 grad_norm=34.26 num_segments=256 num_words=208
2020-06-09 16:39:35,715: 11) loss=0.477 grad_norm=41.02 num_segments=256 num_words=213
2020-06-09 16:42:58,411: 12) loss=0.463 grad_norm=41.13 num_segments=256 num_words=218
2020-06-09 16:45:42,380: 13) loss=0.494 grad_norm=38.38 num_segments=256 num_words=208
2020-06-09 16:48:26,400: 14) loss=0.468 grad_norm=31.16 num_segments=256 num_words=213
2020-06-09 16:51:07,158: 15) loss=0.488 grad_norm=39.23 num_segments=256 num_words=200
2020-06-09 16:53:48,618: 16) loss=0.423 grad_norm=39.66 num_segments=256 num_words=208
2020-06-09 16:56:27,999: 17) loss=0.428 grad_norm=44.36 num_segments=256 num_words=210
2020-06-09 16:59:07,633: 18) loss=0.476 grad_norm=35.46 num_segments=256 num_words=200
2020-06-09 17:01:48,671: 19) loss=0.457 grad_norm=37.63 num_segments=256 num_words=221
2020-06-09 17:04:27,654: 20) loss=0.487 grad_norm=44.79 num_segments=256 num_words=209
2020-06-09 17:07:07,292: 21) loss=0.412 grad_norm=35.99 num_segments=256 num_words=203
2020-06-09 17:09:46,681: 22) loss=0.463 grad_norm=37.85 num_segments=256 num_words=210
2020-06-09 17:12:32,528: 23) loss=0.519 grad_norm=40.93 num_segments=256 num_words=222
2020-06-09 17:15:13,697: 24) loss=0.440 grad_norm=35.53 num_segments=256 num_words=215
2020-06-09 17:17:54,624: 25) loss=0.436 grad_norm=43.22 num_segments=256 num_words=205
2020-06-09 17:20:38,297: 26) loss=0.469 grad_norm=40.33 num_segments=256 num_words=215
2020-06-09 17:23:21,390: 27) loss=0.456 grad_norm=31.95 num_segments=256 num_words=213
2020-06-09 17:26:04,518: 28) loss=0.458 grad_norm=61.70 num_segments=256 num_words=214
2020-06-09 17:28:44,684: 29) loss=0.404 grad_norm=65.32 num_segments=256 num_words=205
2020-06-09 17:31:24,841: 30) loss=0.498 grad_norm=38.86 num_segments=256 num_words=209
2020-06-09 17:34:06,334: 31) loss=0.454 grad_norm=47.30 num_segments=256 num_words=209
2020-06-09 17:36:48,163: 32) loss=0.477 grad_norm=57.53 num_segments=256 num_words=200
2020-06-09 17:39:28,418: 33) loss=0.421 grad_norm=42.17 num_segments=256 num_words=201
2020-06-09 17:42:09,537: 34) loss=0.395 grad_norm=39.63 num_segments=256 num_words=211
2020-06-09 17:44:51,121: 35) loss=0.444 grad_norm=32.95 num_segments=256 num_words=206
2020-06-09 17:47:30,884: 36) loss=0.428 grad_norm=39.21 num_segments=256 num_words=210
2020-06-09 17:50:10,554: 37) loss=0.378 grad_norm=35.60 num_segments=256 num_words=204
2020-06-09 17:52:35,026: 38) loss=0.419 grad_norm=40.62 num_segments=243 num_words=196
2020-06-09 17:52:35,035: epoch= 2.00
2020-06-09 17:52:35,035:  >> time to evaluate and save:
2020-06-09 17:52:35,084: saved save/MultiViewDataset_IndividualWords.78.pth
2020-06-09 17:52:35,113: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 17:52:35,115: saved MultiViewDataset_IndividualWords successfully
2020-06-09 17:52:36,453: saved save/MultiViewRNN.78.pth
2020-06-09 17:52:36,459: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 17:52:36,465: saved MultiViewRNN successfully
2020-06-09 17:52:39,041: saved save/Adam.78.pth
2020-06-09 17:52:39,049: most_recent linked save/Adam.most_recent.pth
2020-06-09 17:52:39,053: saved Adam successfully
2020-06-09 17:52:39,056: saved save/ReduceLROnPlateau.78.pth
2020-06-09 17:52:39,075: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 17:52:39,077: saved ReduceLROnPlateau successfully
2020-06-09 17:52:39,078: saved config successfully
2020-06-09 17:53:53,006:   >> crossview_ap=0.175 (10966 x 3921 pairs)
2020-06-09 17:54:50,817:   >> acoustic_ap=0.206 (10966 choose 2 pairs)
2020-06-09 17:54:50,822: best_so_far= 0.175 at 78
2020-06-09 17:54:50,844: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 17:54:50,845: saved MultiViewDataset_IndividualWords successfully
2020-06-09 17:54:50,856: best linked save/MultiViewRNN.best.pth
2020-06-09 17:54:50,860: saved MultiViewRNN successfully
2020-06-09 17:54:50,877: best linked save/Adam.best.pth
2020-06-09 17:54:50,880: saved Adam successfully
2020-06-09 17:54:50,887: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 17:54:50,888: saved ReduceLROnPlateau successfully
2020-06-09 17:54:50,950: epoch=2.00 global_step=78 lr=0.001 start_iter=0
2020-06-09 17:54:50,950: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 17:57:34,775: 0) loss=0.431 grad_norm=31.09 num_segments=256 num_words=199
2020-06-09 17:59:55,638: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-09 17:59:55,719: Using 1 GPU(s)
2020-06-09 17:59:55,720: Machine: 0 / 1
2020-06-09 17:59:55,722: Hyperparam tuning-------------------
2020-06-09 17:59:55,722: optim_lr: 0.001
2020-06-09 17:59:55,722: dropout (for both): 0.4
2020-06-09 17:59:55,722: margin: 0.4
2020-06-09 17:59:55,722: ------------------------------------
2020-06-09 17:59:55,802: Calling main function: multiview_trainer.train
2020-06-09 17:59:55,802: Using config file: train_config.json
2020-06-09 17:59:55,802: Using module at multiview_trainer.train
2020-06-09 18:00:01,986: Using module at multiview_vocab.MultiViewVocab
2020-06-09 18:00:01,994: Building vocab_data from config
2020-06-09 18:00:02,293:  >> min_count= 0
2020-06-09 18:00:02,293:  >> # words= 34323 (# removed= 0)
2020-06-09 18:00:02,293:  >> # subwords= 45
2020-06-09 18:00:02,293:     [laughter]= 1
2020-06-09 18:00:02,293:     [noise]= 2
2020-06-09 18:00:02,293:     [vocalized-noise]= 3
2020-06-09 18:00:02,293:     aa= 4
2020-06-09 18:00:02,293:     ae= 5
2020-06-09 18:00:02,293:     ah= 6
2020-06-09 18:00:02,293:     ao= 7
2020-06-09 18:00:02,293:     aw= 8
2020-06-09 18:00:02,293:     ax= 9
2020-06-09 18:00:02,293:     ay= 10
2020-06-09 18:00:02,294:     b= 11
2020-06-09 18:00:02,294:     ch= 12
2020-06-09 18:00:02,294:     d= 13
2020-06-09 18:00:02,294:     dh= 14
2020-06-09 18:00:02,294:     eh= 15
2020-06-09 18:00:02,294:     el= 16
2020-06-09 18:00:02,294:     en= 17
2020-06-09 18:00:02,294:     er= 18
2020-06-09 18:00:02,294:     ey= 19
2020-06-09 18:00:02,294:     f= 20
2020-06-09 18:00:02,294:     g= 21
2020-06-09 18:00:02,294:     hh= 22
2020-06-09 18:00:02,294:     ih= 23
2020-06-09 18:00:02,294:     iy= 24
2020-06-09 18:00:02,294:     jh= 25
2020-06-09 18:00:02,294:     k= 26
2020-06-09 18:00:02,294:     l= 27
2020-06-09 18:00:02,294:     m= 28
2020-06-09 18:00:02,294:     n= 29
2020-06-09 18:00:02,294:     ng= 30
2020-06-09 18:00:02,294:     ow= 31
2020-06-09 18:00:02,295:     oy= 32
2020-06-09 18:00:02,295:     p= 33
2020-06-09 18:00:02,295:     r= 34
2020-06-09 18:00:02,295:     s= 35
2020-06-09 18:00:02,295:     sh= 36
2020-06-09 18:00:02,295:     t= 37
2020-06-09 18:00:02,295:     th= 38
2020-06-09 18:00:02,295:     uh= 39
2020-06-09 18:00:02,295:     uw= 40
2020-06-09 18:00:02,295:     v= 41
2020-06-09 18:00:02,295:     w= 42
2020-06-09 18:00:02,295:     y= 43
2020-06-09 18:00:02,295:     z= 44
2020-06-09 18:00:02,295:     zh= 45
2020-06-09 18:00:02,307: Using module at data.batch_samplers.BatchSampler
2020-06-09 18:00:02,314: Building vocab_sampler from config
2020-06-09 18:00:02,314:  >> # examples= 34323
2020-06-09 18:00:02,314:  >> batch_size= 1000
2020-06-09 18:00:02,315:  >> shuffle= False
2020-06-09 18:00:02,321:  >> BatchSampler; 35 batches
2020-06-09 18:00:02,321: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 18:00:04,904: Building train_data from config
2020-06-09 18:00:11,139:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-09 18:00:11,139:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-09 18:00:11,139:  >> stack= False
2020-06-09 18:00:11,139:  >> seg_durs= (1, None)
2020-06-09 18:00:11,139:  >> # words= 9971 (# ignored= 0)
2020-06-09 18:00:11,139:  >> input_feat_dim= 108
2020-06-09 18:00:11,139:  >> input_num_subwords= 45
2020-06-09 18:00:11,139: Using module at data.batch_samplers.BatchSampler
2020-06-09 18:00:11,140: Building train_sampler from config
2020-06-09 18:00:11,140:  >> # examples= 9971
2020-06-09 18:00:11,140:  >> batch_size= 256
2020-06-09 18:00:11,140:  >> shuffle= True
2020-06-09 18:00:11,146:  >> BatchSampler; 39 batches
2020-06-09 18:00:11,146: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 18:00:11,146: Building dev_data from config
2020-06-09 18:00:18,157:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-09 18:00:18,157:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-09 18:00:18,157:  >> stack= False
2020-06-09 18:00:18,157:  >> seg_durs= (1, None)
2020-06-09 18:00:18,157:  >> # words= 10966 (# ignored= 0)
2020-06-09 18:00:18,157:  >> input_feat_dim= 108
2020-06-09 18:00:18,158:  >> input_num_subwords= 45
2020-06-09 18:00:18,158: Using module at data.batch_samplers.BatchSampler
2020-06-09 18:00:18,158: Building dev_sampler from config
2020-06-09 18:00:18,158:  >> # examples= 10966
2020-06-09 18:00:18,158:  >> batch_size= 256
2020-06-09 18:00:18,158:  >> shuffle= False
2020-06-09 18:00:18,160:  >> BatchSampler; 43 batches
2020-06-09 18:00:18,160: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 18:00:18,160: Building test_data from config
2020-06-09 18:00:24,182:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-09 18:00:24,183:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-09 18:00:24,183:  >> stack= False
2020-06-09 18:00:24,183:  >> seg_durs= (1, None)
2020-06-09 18:00:24,183:  >> # words= 11024 (# ignored= 0)
2020-06-09 18:00:24,183:  >> input_feat_dim= 108
2020-06-09 18:00:24,183:  >> input_num_subwords= 45
2020-06-09 18:00:24,183: Using module at data.batch_samplers.BatchSampler
2020-06-09 18:00:24,183: Building test_sampler from config
2020-06-09 18:00:24,184:  >> # examples= 11024
2020-06-09 18:00:24,184:  >> batch_size= 256
2020-06-09 18:00:24,184:  >> shuffle= False
2020-06-09 18:00:24,185:  >> BatchSampler; 44 batches
2020-06-09 18:00:24,185: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-09 18:00:24,390: Building loss from config
2020-06-09 18:00:24,390:  >> margin= 0.4
2020-06-09 18:00:24,391:  >> k= 16
2020-06-09 18:00:24,391:  >> min_k= 8
2020-06-09 18:00:24,391:  >> extra= 0
2020-06-09 18:00:24,391:  >> average= False
2020-06-09 18:00:24,391: Using module at metric.multiview_ap.MultiViewAP
2020-06-09 18:00:25,323: Building eval from config
2020-06-09 18:00:25,323:  >> acoustic_ap= True
2020-06-09 18:00:25,323:  >> crossview_ap= True
2020-06-09 18:00:25,323:  >> full_vocab= False
2020-06-09 18:00:25,323:  >> metric= crossview_ap
2020-06-09 18:00:25,324:  >> mode= max
2020-06-09 18:00:25,324: Using module at multiview_rnn.MultiViewRNN
2020-06-09 18:00:25,379: Building net from config
2020-06-09 18:00:25,380: view1:
2020-06-09 18:00:25,381:  >> cell= GRU
2020-06-09 18:00:25,381:  >> input_size= 108
2020-06-09 18:00:25,382:  >> hidden_size= 512
2020-06-09 18:00:25,382:  >> bidirectional= True
2020-06-09 18:00:25,382:  >> num_layers= 6
2020-06-09 18:00:25,382:  >> dropout between layers= 0.4
2020-06-09 18:00:25,609: view2:
2020-06-09 18:00:25,610:  >> cell= GRU
2020-06-09 18:00:25,610:  >> input_size= 64
2020-06-09 18:00:25,610:  >> hidden_size= 512
2020-06-09 18:00:25,610:  >> bidirectional= True
2020-06-09 18:00:25,610:  >> num_layers= 2
2020-06-09 18:00:25,610:  >> dropout between layers= 0.4
2020-06-09 18:00:25,610:  >> num input embeddings= 45
2020-06-09 18:00:35,483: Using module at optim.adam.Adam
2020-06-09 18:00:36,684: Building optim from config
2020-06-09 18:00:36,685:  >> lr= 0.001
2020-06-09 18:00:36,685:  >> betas= (0.9, 0.999)
2020-06-09 18:00:36,685:  >> eps= 1e-08
2020-06-09 18:00:36,685:  >> weight_decay= 0
2020-06-09 18:00:36,685:  >> amsgrad= False
2020-06-09 18:00:36,686:  >> min_lr= 1e-07
2020-06-09 18:00:36,760: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-09 18:00:37,403: Building sched from config
2020-06-09 18:00:37,404:  >> optim= Adam
2020-06-09 18:00:37,404:  >> decay lr by 0.1
2020-06-09 18:00:37,404:  >> eval_fn= MultiViewAP
2020-06-09 18:00:37,406:  >> patience=4
2020-06-09 18:00:37,406:  >> revert=True
2020-06-09 18:00:37,421: loaded save/MultiViewDataset_IndividualWords.78.pth
2020-06-09 18:00:37,421: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-weighted
2020-06-09 18:00:38,531: loaded save/MultiViewRNN.78.pth
2020-06-09 18:00:38,531: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-weighted
2020-06-09 18:00:40,736: loaded save/Adam.78.pth
2020-06-09 18:00:40,736: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-weighted
2020-06-09 18:00:40,738: loaded save/ReduceLROnPlateau.78.pth
2020-06-09 18:00:40,738: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-weighted
2020-06-09 18:00:40,738: epoch=2.00 global_step=78 lr=0.001 start_iter=0
2020-06-09 18:00:40,738: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 18:05:24,144: 0) loss=0.368 grad_norm=33.44 num_segments=256 num_words=199
2020-06-09 18:10:02,634: 1) loss=0.388 grad_norm=35.61 num_segments=256 num_words=217
2020-06-09 18:14:24,627: 2) loss=0.362 grad_norm=35.50 num_segments=256 num_words=208
2020-06-09 18:18:19,055: 3) loss=0.331 grad_norm=32.70 num_segments=256 num_words=209
2020-06-09 18:21:58,708: 4) loss=0.384 grad_norm=33.28 num_segments=256 num_words=210
2020-06-09 18:25:13,207: 5) loss=0.357 grad_norm=42.33 num_segments=256 num_words=208
2020-06-09 18:28:06,949: 6) loss=0.388 grad_norm=44.33 num_segments=256 num_words=212
2020-06-09 18:30:40,824: 7) loss=0.430 grad_norm=30.38 num_segments=256 num_words=218
2020-06-09 18:33:13,166: 8) loss=0.372 grad_norm=42.23 num_segments=256 num_words=210
2020-06-09 18:35:46,203: 9) loss=0.399 grad_norm=38.89 num_segments=256 num_words=217
2020-06-09 18:38:15,676: 10) loss=0.393 grad_norm=29.09 num_segments=256 num_words=208
2020-06-09 18:40:56,813: 11) loss=0.383 grad_norm=34.11 num_segments=256 num_words=197
2020-06-09 18:43:45,107: 12) loss=0.368 grad_norm=30.10 num_segments=256 num_words=219
2020-06-09 18:46:30,043: 13) loss=0.394 grad_norm=39.58 num_segments=256 num_words=200
2020-06-09 18:49:14,725: 14) loss=0.421 grad_norm=33.55 num_segments=256 num_words=212
2020-06-09 18:52:00,769: 15) loss=0.393 grad_norm=43.76 num_segments=256 num_words=211
2020-06-09 18:54:42,828: 16) loss=0.421 grad_norm=28.22 num_segments=256 num_words=209
2020-06-09 18:57:32,111: 17) loss=0.479 grad_norm=41.53 num_segments=256 num_words=218
2020-06-09 19:00:21,092: 18) loss=0.413 grad_norm=38.98 num_segments=256 num_words=214
2020-06-09 19:03:03,192: 19) loss=0.400 grad_norm=36.99 num_segments=256 num_words=206
2020-06-09 19:05:46,509: 20) loss=0.394 grad_norm=38.65 num_segments=256 num_words=209
2020-06-09 19:08:35,389: 21) loss=0.407 grad_norm=40.29 num_segments=256 num_words=212
2020-06-09 19:11:24,312: 22) loss=0.393 grad_norm=40.14 num_segments=256 num_words=212
2020-06-09 19:14:16,544: 23) loss=0.405 grad_norm=35.82 num_segments=256 num_words=217
2020-06-09 19:17:08,099: 24) loss=0.390 grad_norm=37.05 num_segments=256 num_words=214
2020-06-09 19:19:57,790: 25) loss=0.383 grad_norm=35.40 num_segments=256 num_words=227
2020-06-09 19:22:42,909: 26) loss=0.420 grad_norm=40.40 num_segments=256 num_words=202
2020-06-09 19:25:25,257: 27) loss=0.385 grad_norm=41.63 num_segments=256 num_words=206
2020-06-09 19:28:08,181: 28) loss=0.367 grad_norm=34.63 num_segments=256 num_words=210
2020-06-09 19:30:52,436: 29) loss=0.402 grad_norm=45.42 num_segments=256 num_words=206
2020-06-09 19:33:42,498: 30) loss=0.386 grad_norm=33.08 num_segments=256 num_words=210
2020-06-09 19:36:26,337: 31) loss=0.432 grad_norm=39.97 num_segments=256 num_words=219
2020-06-09 19:39:11,824: 32) loss=0.399 grad_norm=42.55 num_segments=256 num_words=216
2020-06-09 19:41:56,468: 33) loss=0.393 grad_norm=41.96 num_segments=256 num_words=221
2020-06-09 19:44:43,931: 34) loss=0.321 grad_norm=35.18 num_segments=256 num_words=199
2020-06-09 19:47:28,812: 35) loss=0.377 grad_norm=37.11 num_segments=256 num_words=206
2020-06-09 19:50:13,289: 36) loss=0.363 grad_norm=48.69 num_segments=256 num_words=210
2020-06-09 19:52:59,592: 37) loss=0.421 grad_norm=46.09 num_segments=256 num_words=212
2020-06-09 19:55:29,361: 38) loss=0.394 grad_norm=32.68 num_segments=243 num_words=200
2020-06-09 19:55:29,373: epoch= 3.00
2020-06-09 19:55:29,373:  >> time to evaluate and save:
2020-06-09 19:55:29,405: saved save/MultiViewDataset_IndividualWords.117.pth
2020-06-09 19:55:29,421: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 19:55:29,425: saved MultiViewDataset_IndividualWords successfully
2020-06-09 19:55:30,711: saved save/MultiViewRNN.117.pth
2020-06-09 19:55:30,721: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 19:55:30,765: saved MultiViewRNN successfully
2020-06-09 19:55:33,237: saved save/Adam.117.pth
2020-06-09 19:55:33,249: most_recent linked save/Adam.most_recent.pth
2020-06-09 19:55:33,307: saved Adam successfully
2020-06-09 19:55:33,309: saved save/ReduceLROnPlateau.117.pth
2020-06-09 19:55:33,318: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 19:55:33,321: saved ReduceLROnPlateau successfully
2020-06-09 19:55:33,322: saved config successfully
2020-06-09 19:57:02,531:   >> crossview_ap=0.330 (10966 x 3921 pairs)
2020-06-09 19:58:01,055:   >> acoustic_ap=0.345 (10966 choose 2 pairs)
2020-06-09 19:58:01,057: best_so_far= 0.330 at 117
2020-06-09 19:58:01,073: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 19:58:01,076: saved MultiViewDataset_IndividualWords successfully
2020-06-09 19:58:01,077: best linked save/MultiViewRNN.best.pth
2020-06-09 19:58:01,081: saved MultiViewRNN successfully
2020-06-09 19:58:01,082: best linked save/Adam.best.pth
2020-06-09 19:58:01,086: saved Adam successfully
2020-06-09 19:58:01,091: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 19:58:01,093: saved ReduceLROnPlateau successfully
2020-06-09 19:58:01,128: epoch=3.00 global_step=117 lr=0.001 start_iter=0
2020-06-09 19:58:01,128: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 20:00:49,865: 0) loss=0.369 grad_norm=49.30 num_segments=256 num_words=215
2020-06-09 20:03:37,943: 1) loss=0.397 grad_norm=46.98 num_segments=256 num_words=215
2020-06-09 20:06:20,996: 2) loss=0.336 grad_norm=32.10 num_segments=256 num_words=210
2020-06-09 20:09:09,343: 3) loss=0.300 grad_norm=45.24 num_segments=256 num_words=216
2020-06-09 20:11:54,043: 4) loss=0.314 grad_norm=44.45 num_segments=256 num_words=208
2020-06-09 20:14:38,338: 5) loss=0.374 grad_norm=30.94 num_segments=256 num_words=211
2020-06-09 20:17:31,559: 6) loss=0.298 grad_norm=39.21 num_segments=256 num_words=208
2020-06-09 20:20:14,351: 7) loss=0.331 grad_norm=41.07 num_segments=256 num_words=205
2020-06-09 20:22:56,776: 8) loss=0.373 grad_norm=33.86 num_segments=256 num_words=219
2020-06-09 20:25:34,081: 9) loss=0.321 grad_norm=35.48 num_segments=256 num_words=202
2020-06-09 20:28:16,982: 10) loss=0.330 grad_norm=34.81 num_segments=256 num_words=207
2020-06-09 20:30:50,661: 11) loss=0.353 grad_norm=41.02 num_segments=256 num_words=206
2020-06-09 20:33:24,746: 12) loss=0.350 grad_norm=40.21 num_segments=256 num_words=207
2020-06-09 20:36:00,313: 13) loss=0.405 grad_norm=34.46 num_segments=256 num_words=204
2020-06-09 20:38:34,056: 14) loss=0.324 grad_norm=35.02 num_segments=256 num_words=206
2020-06-09 20:41:04,643: 15) loss=0.330 grad_norm=49.99 num_segments=256 num_words=200
2020-06-09 20:43:37,037: 16) loss=0.353 grad_norm=43.66 num_segments=256 num_words=206
2020-06-09 20:46:25,859: 17) loss=0.337 grad_norm=39.94 num_segments=256 num_words=210
2020-06-09 20:49:02,619: 18) loss=0.404 grad_norm=48.01 num_segments=256 num_words=215
2020-06-09 20:51:36,436: 19) loss=0.348 grad_norm=39.20 num_segments=256 num_words=198
2020-06-09 20:54:10,470: 20) loss=0.339 grad_norm=36.90 num_segments=256 num_words=211
2020-06-09 20:56:47,535: 21) loss=0.423 grad_norm=33.18 num_segments=256 num_words=215
2020-06-09 20:59:18,435: 22) loss=0.338 grad_norm=45.32 num_segments=256 num_words=204
2020-06-09 21:01:54,350: 23) loss=0.373 grad_norm=42.15 num_segments=256 num_words=221
2020-06-09 21:04:30,878: 24) loss=0.403 grad_norm=35.19 num_segments=256 num_words=211
2020-06-09 21:07:06,709: 25) loss=0.277 grad_norm=32.39 num_segments=256 num_words=205
2020-06-09 21:09:44,914: 26) loss=0.342 grad_norm=29.93 num_segments=256 num_words=214
2020-06-09 21:12:19,141: 27) loss=0.315 grad_norm=30.05 num_segments=256 num_words=215
2020-06-09 21:14:53,612: 28) loss=0.335 grad_norm=28.79 num_segments=256 num_words=221
2020-06-09 21:17:25,721: 29) loss=0.326 grad_norm=32.85 num_segments=256 num_words=212
2020-06-09 21:20:00,912: 30) loss=0.322 grad_norm=29.41 num_segments=256 num_words=210
2020-06-09 21:22:36,212: 31) loss=0.309 grad_norm=29.58 num_segments=256 num_words=216
2020-06-09 21:25:11,609: 32) loss=0.349 grad_norm=27.49 num_segments=256 num_words=214
2020-06-09 21:27:45,026: 33) loss=0.296 grad_norm=40.36 num_segments=256 num_words=204
2020-06-09 21:30:20,242: 34) loss=0.285 grad_norm=31.95 num_segments=256 num_words=209
2020-06-09 21:32:55,452: 35) loss=0.340 grad_norm=30.64 num_segments=256 num_words=208
2020-06-09 21:35:32,625: 36) loss=0.291 grad_norm=40.38 num_segments=256 num_words=218
2020-06-09 21:38:09,353: 37) loss=0.285 grad_norm=36.86 num_segments=256 num_words=200
2020-06-09 21:40:28,939: 38) loss=0.315 grad_norm=37.62 num_segments=243 num_words=207
2020-06-09 21:40:28,952: epoch= 4.00
2020-06-09 21:40:28,952:  >> time to evaluate and save:
2020-06-09 21:40:28,999: saved save/MultiViewDataset_IndividualWords.156.pth
2020-06-09 21:40:29,013: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 21:40:29,015: saved MultiViewDataset_IndividualWords successfully
2020-06-09 21:40:30,629: saved save/MultiViewRNN.156.pth
2020-06-09 21:40:30,641: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 21:40:30,647: saved MultiViewRNN successfully
2020-06-09 21:40:33,169: saved save/Adam.156.pth
2020-06-09 21:40:33,181: most_recent linked save/Adam.most_recent.pth
2020-06-09 21:40:33,186: saved Adam successfully
2020-06-09 21:40:33,188: saved save/ReduceLROnPlateau.156.pth
2020-06-09 21:40:33,203: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 21:40:33,205: saved ReduceLROnPlateau successfully
2020-06-09 21:40:33,207: saved config successfully
2020-06-09 21:41:46,155:   >> crossview_ap=0.447 (10966 x 3921 pairs)
2020-06-09 21:42:38,842:   >> acoustic_ap=0.455 (10966 choose 2 pairs)
2020-06-09 21:42:38,844: best_so_far= 0.447 at 156
2020-06-09 21:42:38,858: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 21:42:38,860: saved MultiViewDataset_IndividualWords successfully
2020-06-09 21:42:38,883: best linked save/MultiViewRNN.best.pth
2020-06-09 21:42:38,888: saved MultiViewRNN successfully
2020-06-09 21:42:38,911: best linked save/Adam.best.pth
2020-06-09 21:42:38,917: saved Adam successfully
2020-06-09 21:42:38,947: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 21:42:38,950: saved ReduceLROnPlateau successfully
2020-06-09 21:42:39,023: epoch=4.00 global_step=156 lr=0.001 start_iter=0
2020-06-09 21:42:39,023: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 21:45:20,167: 0) loss=0.294 grad_norm=34.01 num_segments=256 num_words=214
2020-06-09 21:48:00,596: 1) loss=0.306 grad_norm=41.65 num_segments=256 num_words=216
2020-06-09 21:50:39,835: 2) loss=0.345 grad_norm=52.24 num_segments=256 num_words=201
2020-06-09 21:53:22,489: 3) loss=0.339 grad_norm=33.84 num_segments=256 num_words=213
2020-06-09 21:56:04,100: 4) loss=0.291 grad_norm=30.87 num_segments=256 num_words=220
2020-06-09 21:58:42,092: 5) loss=0.336 grad_norm=28.91 num_segments=256 num_words=204
2020-06-09 21:59:54,373: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-09 21:59:54,415: Using 1 GPU(s)
2020-06-09 21:59:54,415: Machine: 0 / 1
2020-06-09 21:59:54,417: Hyperparam tuning-------------------
2020-06-09 21:59:54,417: optim_lr: 0.001
2020-06-09 21:59:54,417: dropout (for both): 0.4
2020-06-09 21:59:54,417: margin: 0.4
2020-06-09 21:59:54,417: ------------------------------------
2020-06-09 21:59:54,419: Calling main function: multiview_trainer.train
2020-06-09 21:59:54,419: Using config file: train_config.json
2020-06-09 21:59:54,419: Using module at multiview_trainer.train
2020-06-09 21:59:54,597: Using module at multiview_vocab.MultiViewVocab
2020-06-09 21:59:54,600: Building vocab_data from config
2020-06-09 21:59:54,817:  >> min_count= 0
2020-06-09 21:59:54,817:  >> # words= 34323 (# removed= 0)
2020-06-09 21:59:54,817:  >> # subwords= 45
2020-06-09 21:59:54,817:     [laughter]= 1
2020-06-09 21:59:54,817:     [noise]= 2
2020-06-09 21:59:54,817:     [vocalized-noise]= 3
2020-06-09 21:59:54,817:     aa= 4
2020-06-09 21:59:54,817:     ae= 5
2020-06-09 21:59:54,817:     ah= 6
2020-06-09 21:59:54,817:     ao= 7
2020-06-09 21:59:54,817:     aw= 8
2020-06-09 21:59:54,817:     ax= 9
2020-06-09 21:59:54,817:     ay= 10
2020-06-09 21:59:54,817:     b= 11
2020-06-09 21:59:54,818:     ch= 12
2020-06-09 21:59:54,818:     d= 13
2020-06-09 21:59:54,818:     dh= 14
2020-06-09 21:59:54,818:     eh= 15
2020-06-09 21:59:54,818:     el= 16
2020-06-09 21:59:54,818:     en= 17
2020-06-09 21:59:54,818:     er= 18
2020-06-09 21:59:54,818:     ey= 19
2020-06-09 21:59:54,818:     f= 20
2020-06-09 21:59:54,818:     g= 21
2020-06-09 21:59:54,818:     hh= 22
2020-06-09 21:59:54,818:     ih= 23
2020-06-09 21:59:54,818:     iy= 24
2020-06-09 21:59:54,818:     jh= 25
2020-06-09 21:59:54,818:     k= 26
2020-06-09 21:59:54,818:     l= 27
2020-06-09 21:59:54,818:     m= 28
2020-06-09 21:59:54,818:     n= 29
2020-06-09 21:59:54,818:     ng= 30
2020-06-09 21:59:54,818:     ow= 31
2020-06-09 21:59:54,818:     oy= 32
2020-06-09 21:59:54,819:     p= 33
2020-06-09 21:59:54,819:     r= 34
2020-06-09 21:59:54,819:     s= 35
2020-06-09 21:59:54,819:     sh= 36
2020-06-09 21:59:54,819:     t= 37
2020-06-09 21:59:54,819:     th= 38
2020-06-09 21:59:54,819:     uh= 39
2020-06-09 21:59:54,819:     uw= 40
2020-06-09 21:59:54,819:     v= 41
2020-06-09 21:59:54,819:     w= 42
2020-06-09 21:59:54,819:     y= 43
2020-06-09 21:59:54,819:     z= 44
2020-06-09 21:59:54,819:     zh= 45
2020-06-09 21:59:54,831: Using module at data.batch_samplers.BatchSampler
2020-06-09 21:59:54,832: Building vocab_sampler from config
2020-06-09 21:59:54,833:  >> # examples= 34323
2020-06-09 21:59:54,833:  >> batch_size= 1000
2020-06-09 21:59:54,833:  >> shuffle= False
2020-06-09 21:59:54,839:  >> BatchSampler; 35 batches
2020-06-09 21:59:54,839: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 21:59:54,908: Building train_data from config
2020-06-09 22:00:01,446:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-09 22:00:01,447:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-09 22:00:01,447:  >> stack= False
2020-06-09 22:00:01,447:  >> seg_durs= (1, None)
2020-06-09 22:00:01,447:  >> # words= 9971 (# ignored= 0)
2020-06-09 22:00:01,447:  >> input_feat_dim= 108
2020-06-09 22:00:01,447:  >> input_num_subwords= 45
2020-06-09 22:00:01,447: Using module at data.batch_samplers.BatchSampler
2020-06-09 22:00:01,447: Building train_sampler from config
2020-06-09 22:00:01,448:  >> # examples= 9971
2020-06-09 22:00:01,448:  >> batch_size= 256
2020-06-09 22:00:01,448:  >> shuffle= True
2020-06-09 22:00:01,454:  >> BatchSampler; 39 batches
2020-06-09 22:00:01,454: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 22:00:01,454: Building dev_data from config
2020-06-09 22:00:08,854:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-09 22:00:08,854:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-09 22:00:08,854:  >> stack= False
2020-06-09 22:00:08,855:  >> seg_durs= (1, None)
2020-06-09 22:00:08,855:  >> # words= 10966 (# ignored= 0)
2020-06-09 22:00:08,855:  >> input_feat_dim= 108
2020-06-09 22:00:08,855:  >> input_num_subwords= 45
2020-06-09 22:00:08,855: Using module at data.batch_samplers.BatchSampler
2020-06-09 22:00:08,855: Building dev_sampler from config
2020-06-09 22:00:08,855:  >> # examples= 10966
2020-06-09 22:00:08,855:  >> batch_size= 256
2020-06-09 22:00:08,855:  >> shuffle= False
2020-06-09 22:00:08,857:  >> BatchSampler; 43 batches
2020-06-09 22:00:08,857: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-09 22:00:08,857: Building test_data from config
2020-06-09 22:00:14,954:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-09 22:00:14,954:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-09 22:00:14,954:  >> stack= False
2020-06-09 22:00:14,954:  >> seg_durs= (1, None)
2020-06-09 22:00:14,954:  >> # words= 11024 (# ignored= 0)
2020-06-09 22:00:14,954:  >> input_feat_dim= 108
2020-06-09 22:00:14,955:  >> input_num_subwords= 45
2020-06-09 22:00:14,955: Using module at data.batch_samplers.BatchSampler
2020-06-09 22:00:14,955: Building test_sampler from config
2020-06-09 22:00:14,955:  >> # examples= 11024
2020-06-09 22:00:14,955:  >> batch_size= 256
2020-06-09 22:00:14,955:  >> shuffle= False
2020-06-09 22:00:14,957:  >> BatchSampler; 44 batches
2020-06-09 22:00:14,957: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-09 22:00:14,964: Building loss from config
2020-06-09 22:00:14,964:  >> margin= 0.4
2020-06-09 22:00:14,964:  >> k= 16
2020-06-09 22:00:14,964:  >> min_k= 8
2020-06-09 22:00:14,965:  >> extra= 0
2020-06-09 22:00:14,965:  >> average= False
2020-06-09 22:00:14,965: Using module at metric.multiview_ap.MultiViewAP
2020-06-09 22:00:14,996: Building eval from config
2020-06-09 22:00:14,996:  >> acoustic_ap= True
2020-06-09 22:00:14,996:  >> crossview_ap= True
2020-06-09 22:00:14,996:  >> full_vocab= False
2020-06-09 22:00:14,996:  >> metric= crossview_ap
2020-06-09 22:00:14,996:  >> mode= max
2020-06-09 22:00:14,996: Using module at multiview_rnn.MultiViewRNN
2020-06-09 22:00:15,002: Building net from config
2020-06-09 22:00:15,003: view1:
2020-06-09 22:00:15,004:  >> cell= GRU
2020-06-09 22:00:15,004:  >> input_size= 108
2020-06-09 22:00:15,004:  >> hidden_size= 512
2020-06-09 22:00:15,004:  >> bidirectional= True
2020-06-09 22:00:15,004:  >> num_layers= 6
2020-06-09 22:00:15,004:  >> dropout between layers= 0.4
2020-06-09 22:00:15,181: view2:
2020-06-09 22:00:15,182:  >> cell= GRU
2020-06-09 22:00:15,182:  >> input_size= 64
2020-06-09 22:00:15,182:  >> hidden_size= 512
2020-06-09 22:00:15,182:  >> bidirectional= True
2020-06-09 22:00:15,182:  >> num_layers= 2
2020-06-09 22:00:15,182:  >> dropout between layers= 0.4
2020-06-09 22:00:15,182:  >> num input embeddings= 45
2020-06-09 22:00:17,490: Using module at optim.adam.Adam
2020-06-09 22:00:17,492: Building optim from config
2020-06-09 22:00:17,492:  >> lr= 0.001
2020-06-09 22:00:17,492:  >> betas= (0.9, 0.999)
2020-06-09 22:00:17,492:  >> eps= 1e-08
2020-06-09 22:00:17,492:  >> weight_decay= 0
2020-06-09 22:00:17,492:  >> amsgrad= False
2020-06-09 22:00:17,492:  >> min_lr= 1e-07
2020-06-09 22:00:17,493: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-09 22:00:17,497: Building sched from config
2020-06-09 22:00:17,497:  >> optim= Adam
2020-06-09 22:00:17,497:  >> decay lr by 0.1
2020-06-09 22:00:17,497:  >> eval_fn= MultiViewAP
2020-06-09 22:00:17,497:  >> patience=4
2020-06-09 22:00:17,498:  >> revert=True
2020-06-09 22:00:17,503: loaded save/MultiViewDataset_IndividualWords.156.pth
2020-06-09 22:00:17,503: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-weighted
2020-06-09 22:00:17,567: loaded save/MultiViewRNN.156.pth
2020-06-09 22:00:17,567: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-weighted
2020-06-09 22:00:17,655: loaded save/Adam.156.pth
2020-06-09 22:00:17,656: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-weighted
2020-06-09 22:00:17,657: loaded save/ReduceLROnPlateau.156.pth
2020-06-09 22:00:17,657: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-weighted
2020-06-09 22:00:17,657: epoch=4.00 global_step=156 lr=0.001 start_iter=0
2020-06-09 22:00:17,657: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 22:05:24,879: 0) loss=0.239 grad_norm=36.90 num_segments=256 num_words=214
2020-06-09 22:10:07,443: 1) loss=0.254 grad_norm=41.24 num_segments=256 num_words=216
2020-06-09 22:14:29,150: 2) loss=0.277 grad_norm=53.50 num_segments=256 num_words=201
2020-06-09 22:18:31,112: 3) loss=0.296 grad_norm=36.13 num_segments=256 num_words=213
2020-06-09 22:22:10,937: 4) loss=0.272 grad_norm=32.15 num_segments=256 num_words=220
2020-06-09 22:25:28,914: 5) loss=0.293 grad_norm=23.25 num_segments=256 num_words=204
2020-06-09 22:28:30,097: 6) loss=0.402 grad_norm=29.82 num_segments=256 num_words=206
2020-06-09 22:31:11,520: 7) loss=0.299 grad_norm=37.54 num_segments=256 num_words=216
2020-06-09 22:33:52,299: 8) loss=0.283 grad_norm=28.38 num_segments=256 num_words=215
2020-06-09 22:36:33,309: 9) loss=0.282 grad_norm=32.87 num_segments=256 num_words=211
2020-06-09 22:39:16,267: 10) loss=0.338 grad_norm=43.86 num_segments=256 num_words=220
2020-06-09 22:41:58,713: 11) loss=0.338 grad_norm=32.64 num_segments=256 num_words=219
2020-06-09 22:44:36,108: 12) loss=0.274 grad_norm=48.09 num_segments=256 num_words=212
2020-06-09 22:47:17,577: 13) loss=0.252 grad_norm=30.41 num_segments=256 num_words=210
2020-06-09 22:49:56,821: 14) loss=0.278 grad_norm=29.28 num_segments=256 num_words=195
2020-06-09 22:52:38,589: 15) loss=0.306 grad_norm=35.00 num_segments=256 num_words=210
2020-06-09 22:55:20,182: 16) loss=0.254 grad_norm=35.55 num_segments=256 num_words=206
2020-06-09 22:58:02,646: 17) loss=0.299 grad_norm=37.15 num_segments=256 num_words=212
2020-06-09 23:00:44,249: 18) loss=0.384 grad_norm=32.69 num_segments=256 num_words=211
2020-06-09 23:03:26,371: 19) loss=0.293 grad_norm=34.44 num_segments=256 num_words=205
2020-06-09 23:06:05,609: 20) loss=0.336 grad_norm=28.10 num_segments=256 num_words=200
2020-06-09 23:08:47,700: 21) loss=0.297 grad_norm=31.10 num_segments=256 num_words=214
2020-06-09 23:11:27,749: 22) loss=0.283 grad_norm=28.69 num_segments=256 num_words=212
2020-06-09 23:14:09,574: 23) loss=0.325 grad_norm=23.29 num_segments=256 num_words=213
2020-06-09 23:16:50,297: 24) loss=0.341 grad_norm=36.18 num_segments=256 num_words=213
2020-06-09 23:19:29,964: 25) loss=0.271 grad_norm=40.69 num_segments=256 num_words=208
2020-06-09 23:22:08,626: 26) loss=0.364 grad_norm=26.46 num_segments=256 num_words=209
2020-06-09 23:24:50,423: 27) loss=0.340 grad_norm=27.44 num_segments=256 num_words=229
2020-06-09 23:27:31,540: 28) loss=0.331 grad_norm=37.29 num_segments=256 num_words=213
2020-06-09 23:30:08,540: 29) loss=0.281 grad_norm=30.37 num_segments=256 num_words=212
2020-06-09 23:32:46,212: 30) loss=0.280 grad_norm=37.89 num_segments=256 num_words=218
2020-06-09 23:35:23,331: 31) loss=0.318 grad_norm=43.58 num_segments=256 num_words=219
2020-06-09 23:38:01,504: 32) loss=0.283 grad_norm=43.52 num_segments=256 num_words=220
2020-06-09 23:40:38,234: 33) loss=0.276 grad_norm=42.37 num_segments=256 num_words=205
2020-06-09 23:43:16,242: 34) loss=0.326 grad_norm=29.33 num_segments=256 num_words=209
2020-06-09 23:45:54,206: 35) loss=0.307 grad_norm=35.62 num_segments=256 num_words=206
2020-06-09 23:48:30,349: 36) loss=0.325 grad_norm=34.45 num_segments=256 num_words=208
2020-06-09 23:51:15,640: 37) loss=0.300 grad_norm=24.20 num_segments=256 num_words=209
2020-06-09 23:53:41,526: 38) loss=0.296 grad_norm=47.68 num_segments=243 num_words=202
2020-06-09 23:53:41,538: epoch= 5.00
2020-06-09 23:53:41,538:  >> time to evaluate and save:
2020-06-09 23:53:41,576: saved save/MultiViewDataset_IndividualWords.195.pth
2020-06-09 23:53:41,588: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-09 23:53:41,589: saved MultiViewDataset_IndividualWords successfully
2020-06-09 23:53:42,873: saved save/MultiViewRNN.195.pth
2020-06-09 23:53:42,881: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-09 23:53:42,892: saved MultiViewRNN successfully
2020-06-09 23:53:45,405: saved save/Adam.195.pth
2020-06-09 23:53:45,413: most_recent linked save/Adam.most_recent.pth
2020-06-09 23:53:45,422: saved Adam successfully
2020-06-09 23:53:45,424: saved save/ReduceLROnPlateau.195.pth
2020-06-09 23:53:45,428: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-09 23:53:45,431: saved ReduceLROnPlateau successfully
2020-06-09 23:53:45,433: saved config successfully
2020-06-09 23:55:02,576:   >> crossview_ap=0.527 (10966 x 3921 pairs)
2020-06-09 23:55:54,573:   >> acoustic_ap=0.540 (10966 choose 2 pairs)
2020-06-09 23:55:54,575: best_so_far= 0.527 at 195
2020-06-09 23:55:54,602: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-09 23:55:54,603: saved MultiViewDataset_IndividualWords successfully
2020-06-09 23:55:54,616: best linked save/MultiViewRNN.best.pth
2020-06-09 23:55:54,623: saved MultiViewRNN successfully
2020-06-09 23:55:54,649: best linked save/Adam.best.pth
2020-06-09 23:55:54,656: saved Adam successfully
2020-06-09 23:55:54,693: best linked save/ReduceLROnPlateau.best.pth
2020-06-09 23:55:54,697: saved ReduceLROnPlateau successfully
2020-06-09 23:55:54,741: epoch=5.00 global_step=195 lr=0.001 start_iter=0
2020-06-09 23:55:54,741: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-09 23:58:38,190: 0) loss=0.317 grad_norm=33.95 num_segments=256 num_words=210
2020-06-10 00:01:23,222: 1) loss=0.262 grad_norm=31.17 num_segments=256 num_words=208
2020-06-10 00:04:06,199: 2) loss=0.285 grad_norm=37.26 num_segments=256 num_words=205
2020-06-10 00:06:50,812: 3) loss=0.264 grad_norm=29.91 num_segments=256 num_words=210
2020-06-10 00:09:35,024: 4) loss=0.289 grad_norm=31.38 num_segments=256 num_words=205
2020-06-10 00:12:18,748: 5) loss=0.237 grad_norm=34.17 num_segments=256 num_words=210
2020-06-10 00:15:02,050: 6) loss=0.263 grad_norm=30.12 num_segments=256 num_words=207
2020-06-10 00:17:45,535: 7) loss=0.237 grad_norm=30.67 num_segments=256 num_words=209
2020-06-10 00:20:29,316: 8) loss=0.291 grad_norm=42.38 num_segments=256 num_words=210
2020-06-10 00:23:09,930: 9) loss=0.275 grad_norm=36.68 num_segments=256 num_words=211
2020-06-10 00:25:52,754: 10) loss=0.237 grad_norm=33.39 num_segments=256 num_words=205
2020-06-10 00:28:35,576: 11) loss=0.266 grad_norm=51.05 num_segments=256 num_words=211
2020-06-10 00:31:17,990: 12) loss=0.261 grad_norm=49.71 num_segments=256 num_words=207
2020-06-10 00:33:49,696: 13) loss=0.263 grad_norm=32.58 num_segments=256 num_words=207
2020-06-10 00:36:21,719: 14) loss=0.288 grad_norm=34.98 num_segments=256 num_words=211
2020-06-10 00:38:49,884: 15) loss=0.313 grad_norm=29.80 num_segments=256 num_words=207
2020-06-10 00:41:22,978: 16) loss=0.263 grad_norm=26.49 num_segments=256 num_words=201
2020-06-10 00:44:07,649: 17) loss=0.247 grad_norm=25.47 num_segments=256 num_words=218
2020-06-10 00:46:51,638: 18) loss=0.317 grad_norm=35.62 num_segments=256 num_words=215
2020-06-10 00:49:36,908: 19) loss=0.297 grad_norm=37.33 num_segments=256 num_words=216
2020-06-10 00:52:21,213: 20) loss=0.286 grad_norm=40.81 num_segments=256 num_words=216
2020-06-10 00:55:06,012: 21) loss=0.250 grad_norm=29.89 num_segments=256 num_words=215
2020-06-10 00:57:50,393: 22) loss=0.244 grad_norm=32.46 num_segments=256 num_words=214
2020-06-10 01:00:30,237: 23) loss=0.249 grad_norm=32.94 num_segments=256 num_words=201
2020-06-10 01:03:11,671: 24) loss=0.334 grad_norm=29.68 num_segments=256 num_words=214
2020-06-10 01:05:54,273: 25) loss=0.243 grad_norm=27.04 num_segments=256 num_words=221
2020-06-10 01:08:37,512: 26) loss=0.267 grad_norm=36.82 num_segments=256 num_words=215
2020-06-10 01:11:17,251: 27) loss=0.265 grad_norm=29.65 num_segments=256 num_words=212
2020-06-10 01:13:55,553: 28) loss=0.243 grad_norm=25.66 num_segments=256 num_words=210
2020-06-10 01:16:33,480: 29) loss=0.284 grad_norm=45.32 num_segments=256 num_words=208
2020-06-10 01:19:10,825: 30) loss=0.256 grad_norm=29.60 num_segments=256 num_words=203
2020-06-10 01:21:47,963: 31) loss=0.269 grad_norm=36.74 num_segments=256 num_words=211
2020-06-10 01:24:26,867: 32) loss=0.244 grad_norm=30.00 num_segments=256 num_words=216
2020-06-10 01:27:05,087: 33) loss=0.258 grad_norm=30.87 num_segments=256 num_words=207
2020-06-10 01:29:43,859: 34) loss=0.265 grad_norm=33.70 num_segments=256 num_words=210
2020-06-10 01:32:22,268: 35) loss=0.266 grad_norm=30.00 num_segments=256 num_words=205
2020-06-10 01:35:04,851: 36) loss=0.254 grad_norm=33.24 num_segments=256 num_words=212
2020-06-10 01:37:54,870: 37) loss=0.213 grad_norm=27.73 num_segments=256 num_words=206
2020-06-10 01:40:37,386: 38) loss=0.236 grad_norm=27.70 num_segments=243 num_words=200
2020-06-10 01:40:40,802: epoch= 6.00
2020-06-10 01:40:40,802:  >> time to evaluate and save:
2020-06-10 01:40:40,860: saved save/MultiViewDataset_IndividualWords.234.pth
2020-06-10 01:40:40,908: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 01:40:40,911: saved MultiViewDataset_IndividualWords successfully
2020-06-10 01:40:43,021: saved save/MultiViewRNN.234.pth
2020-06-10 01:40:43,126: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 01:40:43,133: saved MultiViewRNN successfully
2020-06-10 01:40:45,716: saved save/Adam.234.pth
2020-06-10 01:40:53,203: most_recent linked save/Adam.most_recent.pth
2020-06-10 01:40:53,209: saved Adam successfully
2020-06-10 01:40:53,211: saved save/ReduceLROnPlateau.234.pth
2020-06-10 01:40:53,240: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 01:40:53,244: saved ReduceLROnPlateau successfully
2020-06-10 01:40:53,246: saved config successfully
2020-06-10 01:42:49,971:   >> crossview_ap=0.583 (10966 x 3921 pairs)
2020-06-10 01:43:46,082:   >> acoustic_ap=0.605 (10966 choose 2 pairs)
2020-06-10 01:43:46,093: best_so_far= 0.583 at 234
2020-06-10 01:43:46,138: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 01:43:46,141: saved MultiViewDataset_IndividualWords successfully
2020-06-10 01:43:46,174: best linked save/MultiViewRNN.best.pth
2020-06-10 01:43:46,184: saved MultiViewRNN successfully
2020-06-10 01:43:46,207: best linked save/Adam.best.pth
2020-06-10 01:43:46,217: saved Adam successfully
2020-06-10 01:43:46,222: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 01:43:46,225: saved ReduceLROnPlateau successfully
2020-06-10 01:43:46,288: epoch=6.00 global_step=234 lr=0.001 start_iter=0
2020-06-10 01:43:46,288: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 01:46:38,281: 0) loss=0.236 grad_norm=34.16 num_segments=256 num_words=212
2020-06-10 01:49:30,121: 1) loss=0.271 grad_norm=27.34 num_segments=256 num_words=213
2020-06-10 01:52:17,053: 2) loss=0.380 grad_norm=34.45 num_segments=256 num_words=221
2020-06-10 01:55:02,228: 3) loss=0.299 grad_norm=26.01 num_segments=256 num_words=211
2020-06-10 01:57:46,871: 4) loss=0.284 grad_norm=31.23 num_segments=256 num_words=205
2020-06-10 05:12:58,788: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-10 05:12:58,841: Using 1 GPU(s)
2020-06-10 05:12:58,841: Machine: 0 / 1
2020-06-10 05:12:58,863: Hyperparam tuning-------------------
2020-06-10 05:12:58,863: optim_lr: 0.001
2020-06-10 05:12:58,863: dropout (for both): 0.4
2020-06-10 05:12:58,863: margin: 0.4
2020-06-10 05:12:58,864: ------------------------------------
2020-06-10 05:12:58,865: Calling main function: multiview_trainer.train
2020-06-10 05:12:58,865: Using config file: train_config.json
2020-06-10 05:12:58,865: Using module at multiview_trainer.train
2020-06-10 05:13:00,036: Using module at multiview_vocab.MultiViewVocab
2020-06-10 05:13:00,044: Building vocab_data from config
2020-06-10 05:13:00,336:  >> min_count= 0
2020-06-10 05:13:00,336:  >> # words= 34323 (# removed= 0)
2020-06-10 05:13:00,336:  >> # subwords= 45
2020-06-10 05:13:00,336:     [laughter]= 1
2020-06-10 05:13:00,336:     [noise]= 2
2020-06-10 05:13:00,336:     [vocalized-noise]= 3
2020-06-10 05:13:00,337:     aa= 4
2020-06-10 05:13:00,337:     ae= 5
2020-06-10 05:13:00,337:     ah= 6
2020-06-10 05:13:00,337:     ao= 7
2020-06-10 05:13:00,337:     aw= 8
2020-06-10 05:13:00,337:     ax= 9
2020-06-10 05:13:00,337:     ay= 10
2020-06-10 05:13:00,337:     b= 11
2020-06-10 05:13:00,337:     ch= 12
2020-06-10 05:13:00,337:     d= 13
2020-06-10 05:13:00,337:     dh= 14
2020-06-10 05:13:00,337:     eh= 15
2020-06-10 05:13:00,337:     el= 16
2020-06-10 05:13:00,337:     en= 17
2020-06-10 05:13:00,337:     er= 18
2020-06-10 05:13:00,337:     ey= 19
2020-06-10 05:13:00,337:     f= 20
2020-06-10 05:13:00,337:     g= 21
2020-06-10 05:13:00,337:     hh= 22
2020-06-10 05:13:00,338:     ih= 23
2020-06-10 05:13:00,338:     iy= 24
2020-06-10 05:13:00,338:     jh= 25
2020-06-10 05:13:00,338:     k= 26
2020-06-10 05:13:00,338:     l= 27
2020-06-10 05:13:00,338:     m= 28
2020-06-10 05:13:00,338:     n= 29
2020-06-10 05:13:00,338:     ng= 30
2020-06-10 05:13:00,338:     ow= 31
2020-06-10 05:13:00,338:     oy= 32
2020-06-10 05:13:00,338:     p= 33
2020-06-10 05:13:00,338:     r= 34
2020-06-10 05:13:00,338:     s= 35
2020-06-10 05:13:00,338:     sh= 36
2020-06-10 05:13:00,338:     t= 37
2020-06-10 05:13:00,338:     th= 38
2020-06-10 05:13:00,338:     uh= 39
2020-06-10 05:13:00,338:     uw= 40
2020-06-10 05:13:00,338:     v= 41
2020-06-10 05:13:00,339:     w= 42
2020-06-10 05:13:00,339:     y= 43
2020-06-10 05:13:00,339:     z= 44
2020-06-10 05:13:00,339:     zh= 45
2020-06-10 05:13:00,354: Using module at data.batch_samplers.BatchSampler
2020-06-10 05:13:00,393: Building vocab_sampler from config
2020-06-10 05:13:00,394:  >> # examples= 34323
2020-06-10 05:13:00,394:  >> batch_size= 1000
2020-06-10 05:13:00,394:  >> shuffle= False
2020-06-10 05:13:00,408:  >> BatchSampler; 35 batches
2020-06-10 05:13:00,408: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 05:13:00,984: Building train_data from config
2020-06-10 05:13:07,980:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-10 05:13:07,980:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-10 05:13:07,980:  >> stack= False
2020-06-10 05:13:07,980:  >> seg_durs= (1, None)
2020-06-10 05:13:07,980:  >> # words= 9971 (# ignored= 0)
2020-06-10 05:13:07,980:  >> input_feat_dim= 108
2020-06-10 05:13:07,981:  >> input_num_subwords= 45
2020-06-10 05:13:07,981: Using module at data.batch_samplers.BatchSampler
2020-06-10 05:13:07,981: Building train_sampler from config
2020-06-10 05:13:07,981:  >> # examples= 9971
2020-06-10 05:13:07,981:  >> batch_size= 256
2020-06-10 05:13:07,981:  >> shuffle= True
2020-06-10 05:13:07,990:  >> BatchSampler; 39 batches
2020-06-10 05:13:07,990: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 05:13:07,990: Building dev_data from config
2020-06-10 05:13:15,847:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 05:13:15,850:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 05:13:15,850:  >> stack= False
2020-06-10 05:13:15,850:  >> seg_durs= (1, None)
2020-06-10 05:13:15,850:  >> # words= 10966 (# ignored= 0)
2020-06-10 05:13:15,850:  >> input_feat_dim= 108
2020-06-10 05:13:15,850:  >> input_num_subwords= 45
2020-06-10 05:13:15,851: Using module at data.batch_samplers.BatchSampler
2020-06-10 05:13:15,851: Building dev_sampler from config
2020-06-10 05:13:15,851:  >> # examples= 10966
2020-06-10 05:13:15,851:  >> batch_size= 256
2020-06-10 05:13:15,851:  >> shuffle= False
2020-06-10 05:13:15,854:  >> BatchSampler; 43 batches
2020-06-10 05:13:15,854: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 05:13:15,854: Building test_data from config
2020-06-10 05:13:22,560:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 05:13:22,561:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 05:13:22,561:  >> stack= False
2020-06-10 05:13:22,561:  >> seg_durs= (1, None)
2020-06-10 05:13:22,561:  >> # words= 11024 (# ignored= 0)
2020-06-10 05:13:22,561:  >> input_feat_dim= 108
2020-06-10 05:13:22,561:  >> input_num_subwords= 45
2020-06-10 05:13:22,561: Using module at data.batch_samplers.BatchSampler
2020-06-10 05:13:22,561: Building test_sampler from config
2020-06-10 05:13:22,562:  >> # examples= 11024
2020-06-10 05:13:22,562:  >> batch_size= 256
2020-06-10 05:13:22,562:  >> shuffle= False
2020-06-10 05:13:22,564:  >> BatchSampler; 44 batches
2020-06-10 05:13:22,564: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-10 05:13:22,600: Building loss from config
2020-06-10 05:13:22,600:  >> margin= 0.4
2020-06-10 05:13:22,600:  >> k= 16
2020-06-10 05:13:22,600:  >> min_k= 8
2020-06-10 05:13:22,600:  >> extra= 0
2020-06-10 05:13:22,600:  >> average= False
2020-06-10 05:13:22,601: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 05:13:22,637: Building eval from config
2020-06-10 05:13:22,638:  >> acoustic_ap= True
2020-06-10 05:13:22,638:  >> crossview_ap= True
2020-06-10 05:13:22,638:  >> full_vocab= False
2020-06-10 05:13:22,638:  >> metric= crossview_ap
2020-06-10 05:13:22,638:  >> mode= max
2020-06-10 05:13:22,638: Using module at multiview_rnn.MultiViewRNN
2020-06-10 05:13:22,671: Building net from config
2020-06-10 05:13:22,672: view1:
2020-06-10 05:13:22,673:  >> cell= GRU
2020-06-10 05:13:22,673:  >> input_size= 108
2020-06-10 05:13:22,673:  >> hidden_size= 512
2020-06-10 05:13:22,673:  >> bidirectional= True
2020-06-10 05:13:22,673:  >> num_layers= 6
2020-06-10 05:13:22,673:  >> dropout between layers= 0.4
2020-06-10 05:13:22,889: view2:
2020-06-10 05:13:22,890:  >> cell= GRU
2020-06-10 05:13:22,890:  >> input_size= 64
2020-06-10 05:13:22,890:  >> hidden_size= 512
2020-06-10 05:13:22,890:  >> bidirectional= True
2020-06-10 05:13:22,890:  >> num_layers= 2
2020-06-10 05:13:22,890:  >> dropout between layers= 0.4
2020-06-10 05:13:22,890:  >> num input embeddings= 45
2020-06-10 05:13:26,080: Using module at optim.adam.Adam
2020-06-10 05:13:26,096: Building optim from config
2020-06-10 05:13:26,097:  >> lr= 0.001
2020-06-10 05:13:26,097:  >> betas= (0.9, 0.999)
2020-06-10 05:13:26,097:  >> eps= 1e-08
2020-06-10 05:13:26,097:  >> weight_decay= 0
2020-06-10 05:13:26,097:  >> amsgrad= False
2020-06-10 05:13:26,097:  >> min_lr= 1e-07
2020-06-10 05:13:26,098: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-10 05:13:26,125: Building sched from config
2020-06-10 05:13:26,126:  >> optim= Adam
2020-06-10 05:13:26,126:  >> decay lr by 0.1
2020-06-10 05:13:26,126:  >> eval_fn= MultiViewAP
2020-06-10 05:13:26,127:  >> patience=4
2020-06-10 05:13:26,127:  >> revert=True
2020-06-10 05:13:26,156: loaded save/MultiViewDataset_IndividualWords.234.pth
2020-06-10 05:13:26,156: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-weighted
2020-06-10 05:13:28,417: loaded save/MultiViewRNN.234.pth
2020-06-10 05:13:28,422: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-weighted
2020-06-10 05:13:32,812: loaded save/Adam.234.pth
2020-06-10 05:13:32,813: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-weighted
2020-06-10 05:13:32,831: loaded save/ReduceLROnPlateau.234.pth
2020-06-10 05:13:32,831: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-weighted
2020-06-10 05:13:32,831: epoch=6.00 global_step=234 lr=0.001 start_iter=0
2020-06-10 05:13:32,831: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 05:19:29,767: 0) loss=0.182 grad_norm=33.89 num_segments=256 num_words=212
2020-06-10 05:24:55,452: 1) loss=0.210 grad_norm=27.60 num_segments=256 num_words=213
2020-06-10 05:30:02,036: 2) loss=0.288 grad_norm=30.06 num_segments=256 num_words=221
2020-06-10 05:34:43,573: 3) loss=0.239 grad_norm=24.86 num_segments=256 num_words=211
2020-06-10 05:38:59,358: 4) loss=0.229 grad_norm=27.47 num_segments=256 num_words=205
2020-06-10 05:42:53,009: 5) loss=0.248 grad_norm=26.52 num_segments=256 num_words=203
2020-06-10 05:46:22,297: 6) loss=0.234 grad_norm=28.11 num_segments=256 num_words=211
2020-06-10 05:49:29,153: 7) loss=0.209 grad_norm=30.93 num_segments=256 num_words=209
2020-06-10 05:52:38,992: 8) loss=0.225 grad_norm=33.88 num_segments=256 num_words=214
2020-06-10 05:55:45,489: 9) loss=0.250 grad_norm=27.15 num_segments=256 num_words=219
2020-06-10 05:58:52,171: 10) loss=0.223 grad_norm=29.92 num_segments=256 num_words=202
2020-06-10 06:02:03,270: 11) loss=0.243 grad_norm=33.76 num_segments=256 num_words=216
2020-06-10 06:05:12,761: 12) loss=0.237 grad_norm=42.14 num_segments=256 num_words=217
2020-06-10 06:08:18,192: 13) loss=0.286 grad_norm=33.73 num_segments=256 num_words=210
2020-06-10 06:11:28,342: 14) loss=0.214 grad_norm=31.23 num_segments=256 num_words=211
2020-06-10 06:14:33,365: 15) loss=0.252 grad_norm=30.70 num_segments=256 num_words=205
2020-06-10 06:17:40,587: 16) loss=0.212 grad_norm=24.71 num_segments=256 num_words=205
2020-06-10 06:20:48,249: 17) loss=0.272 grad_norm=29.05 num_segments=256 num_words=210
2020-06-10 06:23:54,810: 18) loss=0.198 grad_norm=27.92 num_segments=256 num_words=209
2020-06-10 06:27:01,511: 19) loss=0.336 grad_norm=31.98 num_segments=256 num_words=211
2020-06-10 06:30:09,723: 20) loss=0.212 grad_norm=30.63 num_segments=256 num_words=204
2020-06-10 06:33:14,881: 21) loss=0.228 grad_norm=34.54 num_segments=256 num_words=207
2020-06-10 06:36:20,975: 22) loss=0.287 grad_norm=31.36 num_segments=256 num_words=214
2020-06-10 06:39:25,918: 23) loss=0.174 grad_norm=24.40 num_segments=256 num_words=212
2020-06-10 06:42:30,641: 24) loss=0.238 grad_norm=27.28 num_segments=256 num_words=208
2020-06-10 06:45:36,592: 25) loss=0.229 grad_norm=34.91 num_segments=256 num_words=218
2020-06-10 06:48:43,033: 26) loss=0.244 grad_norm=42.95 num_segments=256 num_words=213
2020-06-10 06:51:52,771: 27) loss=0.252 grad_norm=30.83 num_segments=256 num_words=217
2020-06-10 06:55:03,686: 28) loss=0.263 grad_norm=24.76 num_segments=256 num_words=211
2020-06-10 06:58:10,275: 29) loss=0.219 grad_norm=32.34 num_segments=256 num_words=213
2020-06-10 07:01:16,954: 30) loss=0.197 grad_norm=28.31 num_segments=256 num_words=214
2020-06-10 07:04:26,551: 31) loss=0.248 grad_norm=29.96 num_segments=256 num_words=210
2020-06-10 07:07:25,064: 32) loss=0.223 grad_norm=25.88 num_segments=256 num_words=194
2020-06-10 07:11:02,541: 33) loss=0.249 grad_norm=28.70 num_segments=256 num_words=215
2020-06-10 07:14:32,094: 34) loss=0.223 grad_norm=30.40 num_segments=256 num_words=219
2020-06-10 07:17:57,318: 35) loss=0.308 grad_norm=24.21 num_segments=256 num_words=214
2020-06-10 07:21:14,471: 36) loss=0.208 grad_norm=27.63 num_segments=256 num_words=214
2020-06-10 07:24:24,818: 37) loss=0.234 grad_norm=39.67 num_segments=256 num_words=207
2020-06-10 07:27:10,245: 38) loss=0.229 grad_norm=28.40 num_segments=243 num_words=201
2020-06-10 07:27:10,255: epoch= 7.00
2020-06-10 07:27:10,255:  >> time to evaluate and save:
2020-06-10 07:27:10,301: saved save/MultiViewDataset_IndividualWords.273.pth
2020-06-10 07:27:10,324: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 07:27:10,360: removed save/MultiViewDataset_IndividualWords.39.pth
2020-06-10 07:27:10,360: saved MultiViewDataset_IndividualWords successfully
2020-06-10 07:27:11,842: saved save/MultiViewRNN.273.pth
2020-06-10 07:27:11,866: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 07:27:12,206: removed save/MultiViewRNN.39.pth
2020-06-10 07:27:12,206: saved MultiViewRNN successfully
2020-06-10 07:27:14,804: saved save/Adam.273.pth
2020-06-10 07:27:14,805: most_recent linked save/Adam.most_recent.pth
2020-06-10 07:27:15,137: removed save/Adam.39.pth
2020-06-10 07:27:15,138: saved Adam successfully
2020-06-10 07:27:15,140: saved save/ReduceLROnPlateau.273.pth
2020-06-10 07:27:15,150: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 07:27:15,155: saved ReduceLROnPlateau successfully
2020-06-10 07:27:15,156: saved config successfully
2020-06-10 07:28:45,228:   >> crossview_ap=0.618 (10966 x 3921 pairs)
2020-06-10 07:29:46,744:   >> acoustic_ap=0.657 (10966 choose 2 pairs)
2020-06-10 07:29:46,747: best_so_far= 0.618 at 273
2020-06-10 07:29:46,757: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 07:29:46,760: saved MultiViewDataset_IndividualWords successfully
2020-06-10 07:29:46,761: best linked save/MultiViewRNN.best.pth
2020-06-10 07:29:46,769: saved MultiViewRNN successfully
2020-06-10 07:29:46,771: best linked save/Adam.best.pth
2020-06-10 07:29:46,773: saved Adam successfully
2020-06-10 07:29:46,774: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 07:29:46,779: saved ReduceLROnPlateau successfully
2020-06-10 07:29:46,854: epoch=7.00 global_step=273 lr=0.001 start_iter=0
2020-06-10 07:29:46,854: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 07:32:50,340: 0) loss=0.211 grad_norm=20.04 num_segments=256 num_words=207
2020-06-10 07:36:03,427: 1) loss=0.213 grad_norm=25.73 num_segments=256 num_words=207
2020-06-10 07:39:21,270: 2) loss=0.206 grad_norm=29.10 num_segments=256 num_words=213
2020-06-10 07:42:52,839: 3) loss=0.245 grad_norm=28.23 num_segments=256 num_words=215
2020-06-10 07:46:20,636: 4) loss=0.203 grad_norm=24.98 num_segments=256 num_words=213
2020-06-10 07:50:00,878: 5) loss=0.214 grad_norm=26.63 num_segments=256 num_words=213
2020-06-10 07:53:52,320: 6) loss=0.189 grad_norm=24.22 num_segments=256 num_words=217
2020-06-10 07:56:54,491: 7) loss=0.235 grad_norm=25.03 num_segments=256 num_words=202
2020-06-10 08:00:00,375: 8) loss=0.238 grad_norm=25.71 num_segments=256 num_words=210
2020-06-10 08:03:10,963: 9) loss=0.258 grad_norm=26.57 num_segments=256 num_words=211
2020-06-10 08:06:17,196: 10) loss=0.236 grad_norm=35.37 num_segments=256 num_words=211
2020-06-10 08:09:18,679: 11) loss=0.196 grad_norm=33.24 num_segments=256 num_words=202
2020-06-10 08:12:23,204: 12) loss=0.300 grad_norm=24.95 num_segments=256 num_words=213
2020-06-10 08:15:26,433: 13) loss=0.229 grad_norm=39.05 num_segments=256 num_words=212
2020-06-10 08:18:32,878: 14) loss=0.261 grad_norm=30.62 num_segments=256 num_words=215
2020-06-10 08:21:58,248: 15) loss=0.191 grad_norm=26.56 num_segments=256 num_words=208
2020-06-10 08:25:39,510: 16) loss=0.189 grad_norm=37.04 num_segments=256 num_words=202
2020-06-10 08:29:19,225: 17) loss=0.260 grad_norm=27.00 num_segments=256 num_words=214
2020-06-10 08:32:55,543: 18) loss=0.245 grad_norm=31.88 num_segments=256 num_words=220
2020-06-10 08:36:39,761: 19) loss=0.229 grad_norm=33.11 num_segments=256 num_words=208
2020-06-10 08:40:01,948: 20) loss=0.209 grad_norm=23.01 num_segments=256 num_words=198
2020-06-10 08:43:17,308: 21) loss=0.240 grad_norm=38.17 num_segments=256 num_words=215
2020-06-10 08:46:45,927: 22) loss=0.213 grad_norm=30.73 num_segments=256 num_words=207
2020-06-10 08:49:58,245: 23) loss=0.241 grad_norm=26.15 num_segments=256 num_words=210
2020-06-10 08:53:01,679: 24) loss=0.189 grad_norm=28.65 num_segments=256 num_words=202
2020-06-10 08:56:06,943: 25) loss=0.193 grad_norm=24.49 num_segments=256 num_words=209
2020-06-10 08:59:09,183: 26) loss=0.276 grad_norm=26.87 num_segments=256 num_words=213
2020-06-10 09:02:13,160: 27) loss=0.215 grad_norm=33.35 num_segments=256 num_words=212
2020-06-10 09:05:21,190: 28) loss=0.223 grad_norm=46.85 num_segments=256 num_words=215
2020-06-10 09:08:28,927: 29) loss=0.192 grad_norm=24.20 num_segments=256 num_words=205
2020-06-10 09:11:54,401: 30) loss=0.189 grad_norm=26.55 num_segments=256 num_words=209
2020-06-10 09:13:28,170: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-10 09:13:28,199: Using 1 GPU(s)
2020-06-10 09:13:28,199: Machine: 0 / 1
2020-06-10 09:13:28,254: Hyperparam tuning-------------------
2020-06-10 09:13:28,254: optim_lr: 0.001
2020-06-10 09:13:28,254: dropout (for both): 0.4
2020-06-10 09:13:28,254: margin: 0.4
2020-06-10 09:13:28,254: ------------------------------------
2020-06-10 09:13:28,256: Calling main function: multiview_trainer.train
2020-06-10 09:13:28,256: Using config file: train_config.json
2020-06-10 09:13:28,256: Using module at multiview_trainer.train
2020-06-10 09:13:29,295: Using module at multiview_vocab.MultiViewVocab
2020-06-10 09:13:29,343: Building vocab_data from config
2020-06-10 09:13:29,645:  >> min_count= 0
2020-06-10 09:13:29,646:  >> # words= 34323 (# removed= 0)
2020-06-10 09:13:29,646:  >> # subwords= 45
2020-06-10 09:13:29,646:     [laughter]= 1
2020-06-10 09:13:29,646:     [noise]= 2
2020-06-10 09:13:29,646:     [vocalized-noise]= 3
2020-06-10 09:13:29,646:     aa= 4
2020-06-10 09:13:29,646:     ae= 5
2020-06-10 09:13:29,646:     ah= 6
2020-06-10 09:13:29,646:     ao= 7
2020-06-10 09:13:29,646:     aw= 8
2020-06-10 09:13:29,646:     ax= 9
2020-06-10 09:13:29,646:     ay= 10
2020-06-10 09:13:29,647:     b= 11
2020-06-10 09:13:29,647:     ch= 12
2020-06-10 09:13:29,647:     d= 13
2020-06-10 09:13:29,647:     dh= 14
2020-06-10 09:13:29,647:     eh= 15
2020-06-10 09:13:29,647:     el= 16
2020-06-10 09:13:29,647:     en= 17
2020-06-10 09:13:29,647:     er= 18
2020-06-10 09:13:29,647:     ey= 19
2020-06-10 09:13:29,647:     f= 20
2020-06-10 09:13:29,647:     g= 21
2020-06-10 09:13:29,647:     hh= 22
2020-06-10 09:13:29,647:     ih= 23
2020-06-10 09:13:29,647:     iy= 24
2020-06-10 09:13:29,648:     jh= 25
2020-06-10 09:13:29,648:     k= 26
2020-06-10 09:13:29,648:     l= 27
2020-06-10 09:13:29,648:     m= 28
2020-06-10 09:13:29,648:     n= 29
2020-06-10 09:13:29,648:     ng= 30
2020-06-10 09:13:29,648:     ow= 31
2020-06-10 09:13:29,648:     oy= 32
2020-06-10 09:13:29,648:     p= 33
2020-06-10 09:13:29,648:     r= 34
2020-06-10 09:13:29,648:     s= 35
2020-06-10 09:13:29,648:     sh= 36
2020-06-10 09:13:29,648:     t= 37
2020-06-10 09:13:29,648:     th= 38
2020-06-10 09:13:29,648:     uh= 39
2020-06-10 09:13:29,649:     uw= 40
2020-06-10 09:13:29,649:     v= 41
2020-06-10 09:13:29,649:     w= 42
2020-06-10 09:13:29,649:     y= 43
2020-06-10 09:13:29,649:     z= 44
2020-06-10 09:13:29,649:     zh= 45
2020-06-10 09:13:29,665: Using module at data.batch_samplers.BatchSampler
2020-06-10 09:13:29,684: Building vocab_sampler from config
2020-06-10 09:13:29,685:  >> # examples= 34323
2020-06-10 09:13:29,685:  >> batch_size= 1000
2020-06-10 09:13:29,685:  >> shuffle= False
2020-06-10 09:13:29,692:  >> BatchSampler; 35 batches
2020-06-10 09:13:29,692: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 09:13:29,862: Building train_data from config
2020-06-10 09:13:37,574:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-10 09:13:37,577:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-10 09:13:37,577:  >> stack= False
2020-06-10 09:13:37,577:  >> seg_durs= (1, None)
2020-06-10 09:13:37,577:  >> # words= 9971 (# ignored= 0)
2020-06-10 09:13:37,577:  >> input_feat_dim= 108
2020-06-10 09:13:37,578:  >> input_num_subwords= 45
2020-06-10 09:13:37,578: Using module at data.batch_samplers.BatchSampler
2020-06-10 09:13:37,578: Building train_sampler from config
2020-06-10 09:13:37,578:  >> # examples= 9971
2020-06-10 09:13:37,579:  >> batch_size= 256
2020-06-10 09:13:37,579:  >> shuffle= True
2020-06-10 09:13:37,587:  >> BatchSampler; 39 batches
2020-06-10 09:13:37,587: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 09:13:37,588: Building dev_data from config
2020-06-10 09:13:46,328:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 09:13:46,329:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 09:13:46,329:  >> stack= False
2020-06-10 09:13:46,329:  >> seg_durs= (1, None)
2020-06-10 09:13:46,329:  >> # words= 10966 (# ignored= 0)
2020-06-10 09:13:46,329:  >> input_feat_dim= 108
2020-06-10 09:13:46,329:  >> input_num_subwords= 45
2020-06-10 09:13:46,329: Using module at data.batch_samplers.BatchSampler
2020-06-10 09:13:46,329: Building dev_sampler from config
2020-06-10 09:13:46,330:  >> # examples= 10966
2020-06-10 09:13:46,330:  >> batch_size= 256
2020-06-10 09:13:46,330:  >> shuffle= False
2020-06-10 09:13:46,332:  >> BatchSampler; 43 batches
2020-06-10 09:13:46,332: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 09:13:46,332: Building test_data from config
2020-06-10 09:13:53,881:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 09:13:53,881:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 09:13:53,881:  >> stack= False
2020-06-10 09:13:53,881:  >> seg_durs= (1, None)
2020-06-10 09:13:53,881:  >> # words= 11024 (# ignored= 0)
2020-06-10 09:13:53,881:  >> input_feat_dim= 108
2020-06-10 09:13:53,881:  >> input_num_subwords= 45
2020-06-10 09:13:53,881: Using module at data.batch_samplers.BatchSampler
2020-06-10 09:13:53,882: Building test_sampler from config
2020-06-10 09:13:53,882:  >> # examples= 11024
2020-06-10 09:13:53,882:  >> batch_size= 256
2020-06-10 09:13:53,882:  >> shuffle= False
2020-06-10 09:13:53,885:  >> BatchSampler; 44 batches
2020-06-10 09:13:53,885: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-10 09:13:53,934: Building loss from config
2020-06-10 09:13:53,934:  >> margin= 0.4
2020-06-10 09:13:53,934:  >> k= 16
2020-06-10 09:13:53,934:  >> min_k= 8
2020-06-10 09:13:53,934:  >> extra= 0
2020-06-10 09:13:53,934:  >> average= False
2020-06-10 09:13:53,935: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 09:13:53,995: Building eval from config
2020-06-10 09:13:53,996:  >> acoustic_ap= True
2020-06-10 09:13:53,996:  >> crossview_ap= True
2020-06-10 09:13:53,996:  >> full_vocab= False
2020-06-10 09:13:53,996:  >> metric= crossview_ap
2020-06-10 09:13:53,996:  >> mode= max
2020-06-10 09:13:53,996: Using module at multiview_rnn.MultiViewRNN
2020-06-10 09:13:54,019: Building net from config
2020-06-10 09:13:54,021: view1:
2020-06-10 09:13:54,022:  >> cell= GRU
2020-06-10 09:13:54,022:  >> input_size= 108
2020-06-10 09:13:54,022:  >> hidden_size= 512
2020-06-10 09:13:54,022:  >> bidirectional= True
2020-06-10 09:13:54,022:  >> num_layers= 6
2020-06-10 09:13:54,022:  >> dropout between layers= 0.4
2020-06-10 09:13:54,242: view2:
2020-06-10 09:13:54,243:  >> cell= GRU
2020-06-10 09:13:54,243:  >> input_size= 64
2020-06-10 09:13:54,243:  >> hidden_size= 512
2020-06-10 09:13:54,243:  >> bidirectional= True
2020-06-10 09:13:54,243:  >> num_layers= 2
2020-06-10 09:13:54,243:  >> dropout between layers= 0.4
2020-06-10 09:13:54,243:  >> num input embeddings= 45
2020-06-10 09:13:57,764: Using module at optim.adam.Adam
2020-06-10 09:13:57,776: Building optim from config
2020-06-10 09:13:57,776:  >> lr= 0.001
2020-06-10 09:13:57,776:  >> betas= (0.9, 0.999)
2020-06-10 09:13:57,776:  >> eps= 1e-08
2020-06-10 09:13:57,776:  >> weight_decay= 0
2020-06-10 09:13:57,776:  >> amsgrad= False
2020-06-10 09:13:57,776:  >> min_lr= 1e-07
2020-06-10 09:13:57,778: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-10 09:13:57,809: Building sched from config
2020-06-10 09:13:57,809:  >> optim= Adam
2020-06-10 09:13:57,809:  >> decay lr by 0.1
2020-06-10 09:13:57,809:  >> eval_fn= MultiViewAP
2020-06-10 09:13:57,810:  >> patience=4
2020-06-10 09:13:57,810:  >> revert=True
2020-06-10 09:13:57,854: loaded save/MultiViewDataset_IndividualWords.273.pth
2020-06-10 09:13:57,854: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-weighted
2020-06-10 09:13:59,235: loaded save/MultiViewRNN.273.pth
2020-06-10 09:13:59,235: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-weighted
2020-06-10 09:14:01,522: loaded save/Adam.273.pth
2020-06-10 09:14:01,523: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-weighted
2020-06-10 09:14:01,532: loaded save/ReduceLROnPlateau.273.pth
2020-06-10 09:14:01,532: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-weighted
2020-06-10 09:14:01,533: epoch=7.00 global_step=273 lr=0.001 start_iter=0
2020-06-10 09:14:01,533: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 09:20:43,144: 0) loss=0.137 grad_norm=17.18 num_segments=256 num_words=207
2020-06-10 09:27:00,069: 1) loss=0.165 grad_norm=23.51 num_segments=256 num_words=207
2020-06-10 09:32:51,350: 2) loss=0.193 grad_norm=30.81 num_segments=256 num_words=213
2020-06-10 09:38:18,180: 3) loss=0.200 grad_norm=26.28 num_segments=256 num_words=215
2020-06-10 09:43:13,968: 4) loss=0.185 grad_norm=23.28 num_segments=256 num_words=213
2020-06-10 09:47:49,504: 5) loss=0.203 grad_norm=35.25 num_segments=256 num_words=213
2020-06-10 09:51:52,484: 6) loss=0.176 grad_norm=22.96 num_segments=256 num_words=217
2020-06-10 09:55:26,124: 7) loss=0.206 grad_norm=28.51 num_segments=256 num_words=202
2020-06-10 09:59:01,071: 8) loss=0.240 grad_norm=23.79 num_segments=256 num_words=210
2020-06-10 10:02:35,123: 9) loss=0.257 grad_norm=22.20 num_segments=256 num_words=211
2020-06-10 10:06:11,085: 10) loss=0.241 grad_norm=32.78 num_segments=256 num_words=211
2020-06-10 10:09:45,003: 11) loss=0.193 grad_norm=26.38 num_segments=256 num_words=202
2020-06-10 10:13:23,506: 12) loss=0.284 grad_norm=28.06 num_segments=256 num_words=213
2020-06-10 10:16:58,836: 13) loss=0.236 grad_norm=40.14 num_segments=256 num_words=212
2020-06-10 10:20:36,065: 14) loss=0.258 grad_norm=28.07 num_segments=256 num_words=215
2020-06-10 10:24:09,952: 15) loss=0.188 grad_norm=27.12 num_segments=256 num_words=208
2020-06-10 10:27:44,836: 16) loss=0.200 grad_norm=34.57 num_segments=256 num_words=202
2020-06-10 10:31:24,395: 17) loss=0.241 grad_norm=29.70 num_segments=256 num_words=214
2020-06-10 10:35:05,293: 18) loss=0.241 grad_norm=29.87 num_segments=256 num_words=220
2020-06-10 10:38:41,779: 19) loss=0.208 grad_norm=36.00 num_segments=256 num_words=208
2020-06-10 10:42:20,082: 20) loss=0.234 grad_norm=30.87 num_segments=256 num_words=198
2020-06-10 10:46:00,264: 21) loss=0.252 grad_norm=37.99 num_segments=256 num_words=215
2020-06-10 10:49:39,478: 22) loss=0.214 grad_norm=41.52 num_segments=256 num_words=207
2020-06-10 10:53:14,407: 23) loss=0.227 grad_norm=40.97 num_segments=256 num_words=210
2020-06-10 10:56:48,686: 24) loss=0.190 grad_norm=28.37 num_segments=256 num_words=202
2020-06-10 11:00:23,155: 25) loss=0.212 grad_norm=29.39 num_segments=256 num_words=209
2020-06-10 11:03:59,136: 26) loss=0.276 grad_norm=29.95 num_segments=256 num_words=213
2020-06-10 11:07:34,432: 27) loss=0.213 grad_norm=28.49 num_segments=256 num_words=212
2020-06-10 11:11:14,371: 28) loss=0.221 grad_norm=41.25 num_segments=256 num_words=215
2020-06-10 11:14:47,892: 29) loss=0.191 grad_norm=26.84 num_segments=256 num_words=205
2020-06-10 11:18:26,017: 30) loss=0.220 grad_norm=26.09 num_segments=256 num_words=209
2020-06-10 11:22:05,924: 31) loss=0.253 grad_norm=28.21 num_segments=256 num_words=214
2020-06-10 11:25:45,544: 32) loss=0.214 grad_norm=25.36 num_segments=256 num_words=214
2020-06-10 11:29:17,888: 33) loss=0.179 grad_norm=25.65 num_segments=256 num_words=201
2020-06-10 11:32:56,088: 34) loss=0.242 grad_norm=32.13 num_segments=256 num_words=217
2020-06-10 11:36:39,048: 35) loss=0.213 grad_norm=25.83 num_segments=256 num_words=214
2020-06-10 11:40:13,806: 36) loss=0.195 grad_norm=25.95 num_segments=256 num_words=203
2020-06-10 11:43:47,016: 37) loss=0.178 grad_norm=34.47 num_segments=256 num_words=201
2020-06-10 11:47:02,678: 38) loss=0.304 grad_norm=28.12 num_segments=243 num_words=201
2020-06-10 11:47:02,702: epoch= 8.00
2020-06-10 11:47:02,702:  >> time to evaluate and save:
2020-06-10 11:47:03,034: saved save/MultiViewDataset_IndividualWords.312.pth
2020-06-10 11:47:03,075: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 11:47:03,168: removed save/MultiViewDataset_IndividualWords.78.pth
2020-06-10 11:47:03,168: saved MultiViewDataset_IndividualWords successfully
2020-06-10 11:47:07,001: saved save/MultiViewRNN.312.pth
2020-06-10 11:47:07,012: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 11:47:07,394: removed save/MultiViewRNN.78.pth
2020-06-10 11:47:07,394: saved MultiViewRNN successfully
2020-06-10 11:47:10,011: saved save/Adam.312.pth
2020-06-10 11:47:10,028: most_recent linked save/Adam.most_recent.pth
2020-06-10 11:47:10,066: removed save/Adam.78.pth
2020-06-10 11:47:10,066: saved Adam successfully
2020-06-10 11:47:10,069: saved save/ReduceLROnPlateau.312.pth
2020-06-10 11:47:10,087: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 11:47:10,108: saved ReduceLROnPlateau successfully
2020-06-10 11:47:10,110: saved config successfully
2020-06-10 11:48:48,975:   >> crossview_ap=0.626 (10966 x 3921 pairs)
2020-06-10 11:49:56,293:   >> acoustic_ap=0.666 (10966 choose 2 pairs)
2020-06-10 11:49:56,296: best_so_far= 0.626 at 312
2020-06-10 11:49:56,316: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 11:49:56,320: saved MultiViewDataset_IndividualWords successfully
2020-06-10 11:49:56,338: best linked save/MultiViewRNN.best.pth
2020-06-10 11:49:56,351: saved MultiViewRNN successfully
2020-06-10 11:49:56,365: best linked save/Adam.best.pth
2020-06-10 11:49:56,371: saved Adam successfully
2020-06-10 11:49:56,382: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 11:49:56,389: saved ReduceLROnPlateau successfully
2020-06-10 11:49:56,469: epoch=8.00 global_step=312 lr=0.001 start_iter=0
2020-06-10 11:49:56,469: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 11:53:30,081: 0) loss=0.187 grad_norm=20.45 num_segments=256 num_words=206
2020-06-10 11:57:07,706: 1) loss=0.251 grad_norm=35.38 num_segments=256 num_words=212
2020-06-10 12:00:44,392: 2) loss=0.195 grad_norm=24.60 num_segments=256 num_words=210
2020-06-10 12:04:22,742: 3) loss=0.236 grad_norm=31.76 num_segments=256 num_words=213
2020-06-10 12:07:57,626: 4) loss=0.193 grad_norm=27.78 num_segments=256 num_words=196
2020-06-10 12:11:34,938: 5) loss=0.169 grad_norm=25.63 num_segments=256 num_words=216
2020-06-10 12:15:11,796: 6) loss=0.181 grad_norm=26.15 num_segments=256 num_words=211
2020-06-10 12:18:49,413: 7) loss=0.185 grad_norm=28.23 num_segments=256 num_words=211
2020-06-10 12:22:25,087: 8) loss=0.159 grad_norm=22.52 num_segments=256 num_words=200
2020-06-10 12:26:01,475: 9) loss=0.203 grad_norm=25.58 num_segments=256 num_words=213
2020-06-10 12:29:37,529: 10) loss=0.216 grad_norm=29.38 num_segments=256 num_words=205
2020-06-10 12:33:13,168: 11) loss=0.203 grad_norm=24.26 num_segments=256 num_words=213
2020-06-10 12:36:50,072: 12) loss=0.172 grad_norm=24.21 num_segments=256 num_words=203
2020-06-10 12:40:28,288: 13) loss=0.232 grad_norm=26.81 num_segments=256 num_words=211
2020-06-10 12:44:06,969: 14) loss=0.204 grad_norm=22.34 num_segments=256 num_words=220
2020-06-10 12:47:43,565: 15) loss=0.171 grad_norm=19.87 num_segments=256 num_words=208
2020-06-10 12:51:19,025: 16) loss=0.197 grad_norm=28.86 num_segments=256 num_words=211
2020-06-10 12:54:54,116: 17) loss=0.254 grad_norm=39.41 num_segments=256 num_words=210
2020-06-10 12:58:29,173: 18) loss=0.186 grad_norm=24.94 num_segments=256 num_words=204
2020-06-10 13:02:04,880: 19) loss=0.184 grad_norm=21.87 num_segments=256 num_words=208
2020-06-10 13:05:36,917: 20) loss=0.186 grad_norm=33.54 num_segments=256 num_words=208
2020-06-10 13:09:11,422: 21) loss=0.219 grad_norm=25.40 num_segments=256 num_words=208
2020-06-10 13:12:46,966: 22) loss=0.213 grad_norm=38.16 num_segments=256 num_words=216
2020-06-10 13:13:44,361: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-10 13:13:44,394: Using 1 GPU(s)
2020-06-10 13:13:44,394: Machine: 0 / 1
2020-06-10 13:13:44,395: Hyperparam tuning-------------------
2020-06-10 13:13:44,395: optim_lr: 0.001
2020-06-10 13:13:44,395: dropout (for both): 0.4
2020-06-10 13:13:44,396: margin: 0.4
2020-06-10 13:13:44,396: ------------------------------------
2020-06-10 13:13:44,398: Calling main function: multiview_trainer.train
2020-06-10 13:13:44,398: Using config file: train_config.json
2020-06-10 13:13:44,398: Using module at multiview_trainer.train
2020-06-10 13:13:46,063: Using module at multiview_vocab.MultiViewVocab
2020-06-10 13:13:46,093: Building vocab_data from config
2020-06-10 13:13:46,381:  >> min_count= 0
2020-06-10 13:13:46,382:  >> # words= 34323 (# removed= 0)
2020-06-10 13:13:46,382:  >> # subwords= 45
2020-06-10 13:13:46,382:     [laughter]= 1
2020-06-10 13:13:46,382:     [noise]= 2
2020-06-10 13:13:46,382:     [vocalized-noise]= 3
2020-06-10 13:13:46,382:     aa= 4
2020-06-10 13:13:46,382:     ae= 5
2020-06-10 13:13:46,382:     ah= 6
2020-06-10 13:13:46,382:     ao= 7
2020-06-10 13:13:46,382:     aw= 8
2020-06-10 13:13:46,382:     ax= 9
2020-06-10 13:13:46,382:     ay= 10
2020-06-10 13:13:46,382:     b= 11
2020-06-10 13:13:46,383:     ch= 12
2020-06-10 13:13:46,383:     d= 13
2020-06-10 13:13:46,383:     dh= 14
2020-06-10 13:13:46,383:     eh= 15
2020-06-10 13:13:46,383:     el= 16
2020-06-10 13:13:46,383:     en= 17
2020-06-10 13:13:46,383:     er= 18
2020-06-10 13:13:46,383:     ey= 19
2020-06-10 13:13:46,383:     f= 20
2020-06-10 13:13:46,383:     g= 21
2020-06-10 13:13:46,383:     hh= 22
2020-06-10 13:13:46,383:     ih= 23
2020-06-10 13:13:46,383:     iy= 24
2020-06-10 13:13:46,383:     jh= 25
2020-06-10 13:13:46,383:     k= 26
2020-06-10 13:13:46,384:     l= 27
2020-06-10 13:13:46,384:     m= 28
2020-06-10 13:13:46,384:     n= 29
2020-06-10 13:13:46,384:     ng= 30
2020-06-10 13:13:46,384:     ow= 31
2020-06-10 13:13:46,384:     oy= 32
2020-06-10 13:13:46,384:     p= 33
2020-06-10 13:13:46,384:     r= 34
2020-06-10 13:13:46,384:     s= 35
2020-06-10 13:13:46,384:     sh= 36
2020-06-10 13:13:46,384:     t= 37
2020-06-10 13:13:46,384:     th= 38
2020-06-10 13:13:46,384:     uh= 39
2020-06-10 13:13:46,384:     uw= 40
2020-06-10 13:13:46,384:     v= 41
2020-06-10 13:13:46,385:     w= 42
2020-06-10 13:13:46,385:     y= 43
2020-06-10 13:13:46,385:     z= 44
2020-06-10 13:13:46,385:     zh= 45
2020-06-10 13:13:46,399: Using module at data.batch_samplers.BatchSampler
2020-06-10 13:13:46,415: Building vocab_sampler from config
2020-06-10 13:13:46,416:  >> # examples= 34323
2020-06-10 13:13:46,416:  >> batch_size= 1000
2020-06-10 13:13:46,416:  >> shuffle= False
2020-06-10 13:13:46,422:  >> BatchSampler; 35 batches
2020-06-10 13:13:46,422: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 13:13:46,710: Building train_data from config
2020-06-10 13:13:54,366:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-10 13:13:54,372:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-10 13:13:54,372:  >> stack= False
2020-06-10 13:13:54,372:  >> seg_durs= (1, None)
2020-06-10 13:13:54,372:  >> # words= 9971 (# ignored= 0)
2020-06-10 13:13:54,372:  >> input_feat_dim= 108
2020-06-10 13:13:54,372:  >> input_num_subwords= 45
2020-06-10 13:13:54,372: Using module at data.batch_samplers.BatchSampler
2020-06-10 13:13:54,372: Building train_sampler from config
2020-06-10 13:13:54,373:  >> # examples= 9971
2020-06-10 13:13:54,373:  >> batch_size= 256
2020-06-10 13:13:54,373:  >> shuffle= True
2020-06-10 13:13:54,381:  >> BatchSampler; 39 batches
2020-06-10 13:13:54,381: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 13:13:54,382: Building dev_data from config
2020-06-10 13:14:03,305:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 13:14:03,312:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 13:14:03,312:  >> stack= False
2020-06-10 13:14:03,312:  >> seg_durs= (1, None)
2020-06-10 13:14:03,312:  >> # words= 10966 (# ignored= 0)
2020-06-10 13:14:03,312:  >> input_feat_dim= 108
2020-06-10 13:14:03,312:  >> input_num_subwords= 45
2020-06-10 13:14:03,312: Using module at data.batch_samplers.BatchSampler
2020-06-10 13:14:03,312: Building dev_sampler from config
2020-06-10 13:14:03,313:  >> # examples= 10966
2020-06-10 13:14:03,313:  >> batch_size= 256
2020-06-10 13:14:03,313:  >> shuffle= False
2020-06-10 13:14:03,315:  >> BatchSampler; 43 batches
2020-06-10 13:14:03,315: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 13:14:03,316: Building test_data from config
2020-06-10 13:14:10,901:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 13:14:10,902:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 13:14:10,902:  >> stack= False
2020-06-10 13:14:10,902:  >> seg_durs= (1, None)
2020-06-10 13:14:10,902:  >> # words= 11024 (# ignored= 0)
2020-06-10 13:14:10,902:  >> input_feat_dim= 108
2020-06-10 13:14:10,902:  >> input_num_subwords= 45
2020-06-10 13:14:10,902: Using module at data.batch_samplers.BatchSampler
2020-06-10 13:14:10,903: Building test_sampler from config
2020-06-10 13:14:10,903:  >> # examples= 11024
2020-06-10 13:14:10,903:  >> batch_size= 256
2020-06-10 13:14:10,903:  >> shuffle= False
2020-06-10 13:14:10,905:  >> BatchSampler; 44 batches
2020-06-10 13:14:10,906: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-10 13:14:10,933: Building loss from config
2020-06-10 13:14:10,933:  >> margin= 0.4
2020-06-10 13:14:10,933:  >> k= 16
2020-06-10 13:14:10,933:  >> min_k= 8
2020-06-10 13:14:10,933:  >> extra= 0
2020-06-10 13:14:10,933:  >> average= False
2020-06-10 13:14:10,934: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 13:14:11,494: Building eval from config
2020-06-10 13:14:11,495:  >> acoustic_ap= True
2020-06-10 13:14:11,495:  >> crossview_ap= True
2020-06-10 13:14:11,495:  >> full_vocab= False
2020-06-10 13:14:11,495:  >> metric= crossview_ap
2020-06-10 13:14:11,495:  >> mode= max
2020-06-10 13:14:11,495: Using module at multiview_rnn.MultiViewRNN
2020-06-10 13:14:11,524: Building net from config
2020-06-10 13:14:11,526: view1:
2020-06-10 13:14:11,527:  >> cell= GRU
2020-06-10 13:14:11,527:  >> input_size= 108
2020-06-10 13:14:11,527:  >> hidden_size= 512
2020-06-10 13:14:11,527:  >> bidirectional= True
2020-06-10 13:14:11,527:  >> num_layers= 6
2020-06-10 13:14:11,527:  >> dropout between layers= 0.4
2020-06-10 13:14:11,743: view2:
2020-06-10 13:14:11,744:  >> cell= GRU
2020-06-10 13:14:11,744:  >> input_size= 64
2020-06-10 13:14:11,744:  >> hidden_size= 512
2020-06-10 13:14:11,744:  >> bidirectional= True
2020-06-10 13:14:11,744:  >> num_layers= 2
2020-06-10 13:14:11,744:  >> dropout between layers= 0.4
2020-06-10 13:14:11,744:  >> num input embeddings= 45
2020-06-10 13:14:15,339: Using module at optim.adam.Adam
2020-06-10 13:14:15,344: Building optim from config
2020-06-10 13:14:15,344:  >> lr= 0.001
2020-06-10 13:14:15,344:  >> betas= (0.9, 0.999)
2020-06-10 13:14:15,344:  >> eps= 1e-08
2020-06-10 13:14:15,344:  >> weight_decay= 0
2020-06-10 13:14:15,344:  >> amsgrad= False
2020-06-10 13:14:15,344:  >> min_lr= 1e-07
2020-06-10 13:14:15,346: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-10 13:14:15,353: Building sched from config
2020-06-10 13:14:15,354:  >> optim= Adam
2020-06-10 13:14:15,354:  >> decay lr by 0.1
2020-06-10 13:14:15,354:  >> eval_fn= MultiViewAP
2020-06-10 13:14:15,355:  >> patience=4
2020-06-10 13:14:15,355:  >> revert=True
2020-06-10 13:14:15,362: loaded save/MultiViewDataset_IndividualWords.312.pth
2020-06-10 13:14:15,362: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-weighted
2020-06-10 13:14:15,466: loaded save/MultiViewRNN.312.pth
2020-06-10 13:14:15,467: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-weighted
2020-06-10 13:14:15,651: loaded save/Adam.312.pth
2020-06-10 13:14:15,651: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-weighted
2020-06-10 13:14:15,661: loaded save/ReduceLROnPlateau.312.pth
2020-06-10 13:14:15,661: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-weighted
2020-06-10 13:14:15,661: epoch=8.00 global_step=312 lr=0.001 start_iter=0
2020-06-10 13:14:15,661: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 13:20:52,218: 0) loss=0.141 grad_norm=19.02 num_segments=256 num_words=206
2020-06-10 13:27:01,766: 1) loss=0.166 grad_norm=26.51 num_segments=256 num_words=212
2020-06-10 13:32:46,792: 2) loss=0.149 grad_norm=22.00 num_segments=256 num_words=210
2020-06-10 13:38:09,181: 3) loss=0.179 grad_norm=33.00 num_segments=256 num_words=213
2020-06-10 13:42:55,738: 4) loss=0.163 grad_norm=30.73 num_segments=256 num_words=196
2020-06-10 13:47:21,388: 5) loss=0.147 grad_norm=27.11 num_segments=256 num_words=216
2020-06-10 13:51:21,522: 6) loss=0.173 grad_norm=25.36 num_segments=256 num_words=211
2020-06-10 13:54:51,908: 7) loss=0.186 grad_norm=28.96 num_segments=256 num_words=211
2020-06-10 13:58:23,884: 8) loss=0.170 grad_norm=33.58 num_segments=256 num_words=200
2020-06-10 14:01:53,786: 9) loss=0.203 grad_norm=26.33 num_segments=256 num_words=213
2020-06-10 14:05:20,962: 10) loss=0.226 grad_norm=29.77 num_segments=256 num_words=205
2020-06-10 14:08:47,392: 11) loss=0.204 grad_norm=33.63 num_segments=256 num_words=213
2020-06-10 14:12:13,618: 12) loss=0.165 grad_norm=23.37 num_segments=256 num_words=203
2020-06-10 14:15:43,525: 13) loss=0.230 grad_norm=28.49 num_segments=256 num_words=211
2020-06-10 14:19:14,999: 14) loss=0.227 grad_norm=25.22 num_segments=256 num_words=220
2020-06-10 14:22:44,980: 15) loss=0.168 grad_norm=20.11 num_segments=256 num_words=208
2020-06-10 14:26:17,434: 16) loss=0.195 grad_norm=27.05 num_segments=256 num_words=211
2020-06-10 14:29:48,864: 17) loss=0.235 grad_norm=31.71 num_segments=256 num_words=210
2020-06-10 14:33:19,148: 18) loss=0.173 grad_norm=22.44 num_segments=256 num_words=204
2020-06-10 14:36:50,306: 19) loss=0.185 grad_norm=21.22 num_segments=256 num_words=208
2020-06-10 14:40:22,497: 20) loss=0.186 grad_norm=34.49 num_segments=256 num_words=208
2020-06-10 14:43:54,121: 21) loss=0.217 grad_norm=27.27 num_segments=256 num_words=208
2020-06-10 14:47:27,644: 22) loss=0.216 grad_norm=34.66 num_segments=256 num_words=216
2020-06-10 14:50:58,222: 23) loss=0.222 grad_norm=25.42 num_segments=256 num_words=204
2020-06-10 14:54:29,108: 24) loss=0.212 grad_norm=27.46 num_segments=256 num_words=213
2020-06-10 14:58:02,124: 25) loss=0.187 grad_norm=18.30 num_segments=256 num_words=210
2020-06-10 15:01:38,310: 26) loss=0.240 grad_norm=20.19 num_segments=256 num_words=224
2020-06-10 15:05:09,142: 27) loss=0.193 grad_norm=23.63 num_segments=256 num_words=213
2020-06-10 15:08:39,063: 28) loss=0.205 grad_norm=29.00 num_segments=256 num_words=204
2020-06-10 15:12:08,230: 29) loss=0.173 grad_norm=20.72 num_segments=256 num_words=203
2020-06-10 15:15:45,868: 30) loss=0.192 grad_norm=19.52 num_segments=256 num_words=222
2020-06-10 15:19:20,367: 31) loss=0.190 grad_norm=24.18 num_segments=256 num_words=216
2020-06-10 15:22:54,955: 32) loss=0.188 grad_norm=22.66 num_segments=256 num_words=202
2020-06-10 15:26:28,385: 33) loss=0.169 grad_norm=25.57 num_segments=256 num_words=205
2020-06-10 15:30:00,437: 34) loss=0.196 grad_norm=39.57 num_segments=256 num_words=210
2020-06-10 15:33:32,712: 35) loss=0.158 grad_norm=31.48 num_segments=256 num_words=209
2020-06-10 15:37:04,799: 36) loss=0.189 grad_norm=24.78 num_segments=256 num_words=207
2020-06-10 15:40:35,983: 37) loss=0.215 grad_norm=30.02 num_segments=256 num_words=205
2020-06-10 15:43:45,156: 38) loss=0.269 grad_norm=29.77 num_segments=243 num_words=211
2020-06-10 15:43:45,174: epoch= 9.00
2020-06-10 15:43:45,174:  >> time to evaluate and save:
2020-06-10 15:43:45,234: saved save/MultiViewDataset_IndividualWords.351.pth
2020-06-10 15:43:45,267: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-10 15:43:45,287: removed save/MultiViewDataset_IndividualWords.117.pth
2020-06-10 15:43:45,287: saved MultiViewDataset_IndividualWords successfully
2020-06-10 15:43:46,610: saved save/MultiViewRNN.351.pth
2020-06-10 15:43:46,620: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-10 15:43:46,673: removed save/MultiViewRNN.117.pth
2020-06-10 15:43:46,673: saved MultiViewRNN successfully
2020-06-10 15:43:49,385: saved save/Adam.351.pth
2020-06-10 15:43:49,397: most_recent linked save/Adam.most_recent.pth
2020-06-10 15:43:49,441: removed save/Adam.117.pth
2020-06-10 15:43:49,441: saved Adam successfully
2020-06-10 15:43:49,444: saved save/ReduceLROnPlateau.351.pth
2020-06-10 15:43:49,456: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-10 15:43:49,465: saved ReduceLROnPlateau successfully
2020-06-10 15:43:49,467: saved config successfully
2020-06-10 15:45:44,591:   >> crossview_ap=0.641 (10966 x 3921 pairs)
2020-06-10 15:46:58,090:   >> acoustic_ap=0.687 (10966 choose 2 pairs)
2020-06-10 15:46:58,093: best_so_far= 0.641 at 351
2020-06-10 15:46:58,130: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-10 15:46:58,133: saved MultiViewDataset_IndividualWords successfully
2020-06-10 15:46:58,156: best linked save/MultiViewRNN.best.pth
2020-06-10 15:46:58,170: saved MultiViewRNN successfully
2020-06-10 15:46:58,180: best linked save/Adam.best.pth
2020-06-10 15:46:58,187: saved Adam successfully
2020-06-10 15:46:58,196: best linked save/ReduceLROnPlateau.best.pth
2020-06-10 15:46:58,203: saved ReduceLROnPlateau successfully
2020-06-10 15:46:58,255: epoch=9.00 global_step=351 lr=0.001 start_iter=0
2020-06-10 15:46:58,255: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-10 15:50:31,354: 0) loss=0.185 grad_norm=21.05 num_segments=256 num_words=219
2020-06-10 15:54:02,855: 1) loss=0.169 grad_norm=21.86 num_segments=256 num_words=208
2020-06-10 15:57:37,557: 2) loss=0.196 grad_norm=22.17 num_segments=256 num_words=220
2020-06-10 16:01:11,426: 3) loss=0.181 grad_norm=20.38 num_segments=256 num_words=210
2020-06-10 16:04:44,816: 4) loss=0.148 grad_norm=23.94 num_segments=256 num_words=217
2020-06-10 16:08:18,097: 5) loss=0.216 grad_norm=24.37 num_segments=256 num_words=219
2020-06-10 16:11:50,884: 6) loss=0.259 grad_norm=31.23 num_segments=256 num_words=202
2020-06-10 16:15:25,451: 7) loss=0.252 grad_norm=25.47 num_segments=256 num_words=225
2020-06-10 16:18:58,813: 8) loss=0.234 grad_norm=22.70 num_segments=256 num_words=213
2020-06-10 16:22:29,663: 9) loss=0.275 grad_norm=24.32 num_segments=256 num_words=209
2020-06-10 16:26:03,962: 10) loss=0.163 grad_norm=22.25 num_segments=256 num_words=208
2020-06-10 16:29:35,047: 11) loss=0.175 grad_norm=23.49 num_segments=256 num_words=202
2020-06-10 16:33:05,652: 12) loss=0.162 grad_norm=18.96 num_segments=256 num_words=206
2020-06-10 16:36:39,029: 13) loss=0.189 grad_norm=25.25 num_segments=256 num_words=210
2020-06-10 16:40:07,994: 14) loss=0.193 grad_norm=26.17 num_segments=256 num_words=206
2020-06-10 16:43:34,966: 15) loss=0.165 grad_norm=26.18 num_segments=256 num_words=205
2020-06-10 16:47:02,306: 16) loss=0.220 grad_norm=27.89 num_segments=256 num_words=205
2020-06-10 16:50:29,197: 17) loss=0.181 grad_norm=23.90 num_segments=256 num_words=212
2020-06-10 16:54:01,743: 18) loss=0.186 grad_norm=23.81 num_segments=256 num_words=215
2020-06-10 16:57:33,000: 19) loss=0.220 grad_norm=31.01 num_segments=256 num_words=221
2020-06-10 17:00:58,096: 20) loss=0.195 grad_norm=31.64 num_segments=256 num_words=211
2020-06-10 17:04:25,566: 21) loss=0.138 grad_norm=28.54 num_segments=256 num_words=204
2020-06-10 17:07:46,854: 22) loss=0.198 grad_norm=24.46 num_segments=256 num_words=208
2020-06-10 17:11:05,288: 23) loss=0.163 grad_norm=31.31 num_segments=256 num_words=194
2020-06-10 19:54:04,197: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-10 19:54:04,261: Using 1 GPU(s)
2020-06-10 19:54:04,262: Machine: 0 / 1
2020-06-10 19:54:04,268: Hyperparam tuning-------------------
2020-06-10 19:54:04,268: optim_lr: 0.001
2020-06-10 19:54:04,268: dropout (for both): 0.4
2020-06-10 19:54:04,269: margin: 0.4
2020-06-10 19:54:04,269: ------------------------------------
2020-06-10 19:54:04,269: Calling main function: multiview_evaluator.evaluate
2020-06-10 19:54:04,269: Using config file: eval_config.json
2020-06-10 19:54:04,269: Using module at multiview_evaluator.evaluate
2020-06-10 19:54:04,308: Using module at multiview_vocab.MultiViewVocab
2020-06-10 19:54:04,315: Building vocab_data from config
2020-06-10 19:54:04,581:  >> min_count= 0
2020-06-10 19:54:04,581:  >> # words= 34323 (# removed= 0)
2020-06-10 19:54:04,581:  >> # subwords= 45
2020-06-10 19:54:04,581:     [laughter]= 1
2020-06-10 19:54:04,581:     [noise]= 2
2020-06-10 19:54:04,581:     [vocalized-noise]= 3
2020-06-10 19:54:04,581:     aa= 4
2020-06-10 19:54:04,582:     ae= 5
2020-06-10 19:54:04,582:     ah= 6
2020-06-10 19:54:04,582:     ao= 7
2020-06-10 19:54:04,582:     aw= 8
2020-06-10 19:54:04,582:     ax= 9
2020-06-10 19:54:04,582:     ay= 10
2020-06-10 19:54:04,582:     b= 11
2020-06-10 19:54:04,582:     ch= 12
2020-06-10 19:54:04,582:     d= 13
2020-06-10 19:54:04,582:     dh= 14
2020-06-10 19:54:04,582:     eh= 15
2020-06-10 19:54:04,582:     el= 16
2020-06-10 19:54:04,582:     en= 17
2020-06-10 19:54:04,582:     er= 18
2020-06-10 19:54:04,582:     ey= 19
2020-06-10 19:54:04,582:     f= 20
2020-06-10 19:54:04,582:     g= 21
2020-06-10 19:54:04,582:     hh= 22
2020-06-10 19:54:04,582:     ih= 23
2020-06-10 19:54:04,583:     iy= 24
2020-06-10 19:54:04,583:     jh= 25
2020-06-10 19:54:04,583:     k= 26
2020-06-10 19:54:04,583:     l= 27
2020-06-10 19:54:04,583:     m= 28
2020-06-10 19:54:04,583:     n= 29
2020-06-10 19:54:04,583:     ng= 30
2020-06-10 19:54:04,583:     ow= 31
2020-06-10 19:54:04,583:     oy= 32
2020-06-10 19:54:04,583:     p= 33
2020-06-10 19:54:04,583:     r= 34
2020-06-10 19:54:04,583:     s= 35
2020-06-10 19:54:04,583:     sh= 36
2020-06-10 19:54:04,583:     t= 37
2020-06-10 19:54:04,583:     th= 38
2020-06-10 19:54:04,583:     uh= 39
2020-06-10 19:54:04,583:     uw= 40
2020-06-10 19:54:04,583:     v= 41
2020-06-10 19:54:04,583:     w= 42
2020-06-10 19:54:04,583:     y= 43
2020-06-10 19:54:04,584:     z= 44
2020-06-10 19:54:04,584:     zh= 45
2020-06-10 19:54:04,598: Using module at data.batch_samplers.BatchSampler
2020-06-10 19:54:04,600: Building vocab_sampler from config
2020-06-10 19:54:04,601:  >> # examples= 34323
2020-06-10 19:54:04,601:  >> batch_size= 1000
2020-06-10 19:54:04,601:  >> shuffle= False
2020-06-10 19:54:04,609:  >> BatchSampler; 35 batches
2020-06-10 19:54:04,609: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 19:54:05,138: Building dev_data from config
2020-06-10 19:54:13,352:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 19:54:13,361:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 19:54:13,361:  >> stack= False
2020-06-10 19:54:13,361:  >> seg_durs= (1, None)
2020-06-10 19:54:13,362:  >> # words= 10966 (# ignored= 0)
2020-06-10 19:54:13,362:  >> input_feat_dim= 108
2020-06-10 19:54:13,362:  >> input_num_subwords= 45
2020-06-10 19:54:13,362: Using module at data.batch_samplers.BatchSampler
2020-06-10 19:54:13,362: Building dev_sampler from config
2020-06-10 19:54:13,363:  >> # examples= 10966
2020-06-10 19:54:13,363:  >> batch_size= 256
2020-06-10 19:54:13,363:  >> shuffle= False
2020-06-10 19:54:13,366:  >> BatchSampler; 43 batches
2020-06-10 19:54:13,366: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 19:54:13,366: Building test_data from config
2020-06-10 19:54:20,299:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 19:54:20,299:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 19:54:20,299:  >> stack= False
2020-06-10 19:54:20,299:  >> seg_durs= (1, None)
2020-06-10 19:54:20,299:  >> # words= 11024 (# ignored= 0)
2020-06-10 19:54:20,299:  >> input_feat_dim= 108
2020-06-10 19:54:20,299:  >> input_num_subwords= 45
2020-06-10 19:54:20,300: Using module at data.batch_samplers.BatchSampler
2020-06-10 19:54:20,300: Building test_sampler from config
2020-06-10 19:54:20,300:  >> # examples= 11024
2020-06-10 19:54:20,300:  >> batch_size= 256
2020-06-10 19:54:20,300:  >> shuffle= False
2020-06-10 19:54:20,303:  >> BatchSampler; 44 batches
2020-06-10 19:54:20,303: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 19:54:21,484: Building eval from config
2020-06-10 19:54:21,485:  >> acoustic_ap= True
2020-06-10 19:54:21,485:  >> crossview_ap= True
2020-06-10 19:54:21,485:  >> full_vocab= False
2020-06-10 19:54:21,485:  >> metric= crossview_ap
2020-06-10 19:54:21,485:  >> mode= max
2020-06-10 19:54:21,485: Using module at multiview_rnn.MultiViewRNN
2020-06-10 19:54:21,543: Building net from config
2020-06-10 19:54:21,544: view1:
2020-06-10 19:54:21,545:  >> cell= GRU
2020-06-10 19:54:21,546:  >> input_size= 108
2020-06-10 19:54:21,546:  >> hidden_size= 512
2020-06-10 19:54:21,546:  >> bidirectional= True
2020-06-10 19:54:21,546:  >> num_layers= 6
2020-06-10 19:54:21,546:  >> dropout between layers= 0.4
2020-06-10 19:54:21,803: view2:
2020-06-10 19:54:21,804:  >> cell= GRU
2020-06-10 19:54:21,804:  >> input_size= 64
2020-06-10 19:54:21,804:  >> hidden_size= 512
2020-06-10 19:54:21,804:  >> bidirectional= True
2020-06-10 19:54:21,804:  >> num_layers= 2
2020-06-10 19:54:21,804:  >> dropout between layers= 0.4
2020-06-10 19:54:21,804:  >> num input embeddings= 45
2020-06-10 19:54:27,130: loaded save/MultiViewRNN.351.pth
2020-06-10 19:54:27,130: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-weighted
2020-06-10 19:54:27,130: Evaluating best model on dev and test:
2020-06-10 19:54:27,131: dev score:
2020-06-10 19:55:53,426:   >> crossview_ap=0.641 (10966 x 3921 pairs)
2020-06-10 19:56:53,844:   >> acoustic_ap=0.687 (10966 choose 2 pairs)
2020-06-10 19:56:54,664: saved outputs to npz file successfully
2020-06-10 19:56:54,664: test score:
2020-06-10 19:58:11,774:   >> crossview_ap=0.673 (11024 x 3392 pairs)
2020-06-10 19:59:13,023:   >> acoustic_ap=0.755 (11024 choose 2 pairs)
2020-06-10 19:59:13,775: saved outputs to npz file successfully
2020-06-10 19:59:13,782: Hyperparam tuning-------------------
2020-06-10 19:59:13,782: optim_lr: 0.001
2020-06-10 19:59:13,782: dropout (for both): 0.4
2020-06-10 19:59:13,782: margin: 0.5
2020-06-10 19:59:13,782: ------------------------------------
2020-06-10 19:59:13,782: Calling main function: multiview_evaluator.evaluate
2020-06-10 19:59:13,782: Using config file: eval_config.json
2020-06-10 19:59:13,782: Using module at multiview_evaluator.evaluate
2020-06-10 19:59:13,783: Using module at multiview_vocab.MultiViewVocab
2020-06-10 19:59:13,783: Building vocab_data from config
2020-06-10 19:59:14,143:  >> min_count= 0
2020-06-10 19:59:14,143:  >> # words= 34323 (# removed= 0)
2020-06-10 19:59:14,143:  >> # subwords= 45
2020-06-10 19:59:14,143:     [laughter]= 1
2020-06-10 19:59:14,143:     [noise]= 2
2020-06-10 19:59:14,143:     [vocalized-noise]= 3
2020-06-10 19:59:14,143:     aa= 4
2020-06-10 19:59:14,143:     ae= 5
2020-06-10 19:59:14,143:     ah= 6
2020-06-10 19:59:14,143:     ao= 7
2020-06-10 19:59:14,143:     aw= 8
2020-06-10 19:59:14,143:     ax= 9
2020-06-10 19:59:14,143:     ay= 10
2020-06-10 19:59:14,144:     b= 11
2020-06-10 19:59:14,144:     ch= 12
2020-06-10 19:59:14,144:     d= 13
2020-06-10 19:59:14,144:     dh= 14
2020-06-10 19:59:14,144:     eh= 15
2020-06-10 19:59:14,144:     el= 16
2020-06-10 19:59:14,144:     en= 17
2020-06-10 19:59:14,144:     er= 18
2020-06-10 19:59:14,144:     ey= 19
2020-06-10 19:59:14,144:     f= 20
2020-06-10 19:59:14,144:     g= 21
2020-06-10 19:59:14,144:     hh= 22
2020-06-10 19:59:14,144:     ih= 23
2020-06-10 19:59:14,144:     iy= 24
2020-06-10 19:59:14,144:     jh= 25
2020-06-10 19:59:14,144:     k= 26
2020-06-10 19:59:14,144:     l= 27
2020-06-10 19:59:14,144:     m= 28
2020-06-10 19:59:14,144:     n= 29
2020-06-10 19:59:14,145:     ng= 30
2020-06-10 19:59:14,145:     ow= 31
2020-06-10 19:59:14,145:     oy= 32
2020-06-10 19:59:14,145:     p= 33
2020-06-10 19:59:14,145:     r= 34
2020-06-10 19:59:14,145:     s= 35
2020-06-10 19:59:14,145:     sh= 36
2020-06-10 19:59:14,145:     t= 37
2020-06-10 19:59:14,145:     th= 38
2020-06-10 19:59:14,145:     uh= 39
2020-06-10 19:59:14,145:     uw= 40
2020-06-10 19:59:14,145:     v= 41
2020-06-10 19:59:14,145:     w= 42
2020-06-10 19:59:14,145:     y= 43
2020-06-10 19:59:14,145:     z= 44
2020-06-10 19:59:14,145:     zh= 45
2020-06-10 19:59:14,158: Using module at data.batch_samplers.BatchSampler
2020-06-10 19:59:14,159: Building vocab_sampler from config
2020-06-10 19:59:14,159:  >> # examples= 34323
2020-06-10 19:59:14,159:  >> batch_size= 1000
2020-06-10 19:59:14,159:  >> shuffle= False
2020-06-10 19:59:14,167:  >> BatchSampler; 35 batches
2020-06-10 19:59:14,167: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 19:59:14,167: Building dev_data from config
2020-06-10 19:59:22,486:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 19:59:22,487:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 19:59:22,487:  >> stack= False
2020-06-10 19:59:22,487:  >> seg_durs= (1, None)
2020-06-10 19:59:22,487:  >> # words= 10966 (# ignored= 0)
2020-06-10 19:59:22,487:  >> input_feat_dim= 108
2020-06-10 19:59:22,487:  >> input_num_subwords= 45
2020-06-10 19:59:22,487: Using module at data.batch_samplers.BatchSampler
2020-06-10 19:59:22,488: Building dev_sampler from config
2020-06-10 19:59:22,488:  >> # examples= 10966
2020-06-10 19:59:22,488:  >> batch_size= 256
2020-06-10 19:59:22,488:  >> shuffle= False
2020-06-10 19:59:22,491:  >> BatchSampler; 43 batches
2020-06-10 19:59:22,492: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 19:59:22,492: Building test_data from config
2020-06-10 19:59:30,120:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 19:59:30,121:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 19:59:30,121:  >> stack= False
2020-06-10 19:59:30,121:  >> seg_durs= (1, None)
2020-06-10 19:59:30,122:  >> # words= 11024 (# ignored= 0)
2020-06-10 19:59:30,122:  >> input_feat_dim= 108
2020-06-10 19:59:30,122:  >> input_num_subwords= 45
2020-06-10 19:59:30,122: Using module at data.batch_samplers.BatchSampler
2020-06-10 19:59:30,122: Building test_sampler from config
2020-06-10 19:59:30,123:  >> # examples= 11024
2020-06-10 19:59:30,123:  >> batch_size= 256
2020-06-10 19:59:30,123:  >> shuffle= False
2020-06-10 19:59:30,125:  >> BatchSampler; 44 batches
2020-06-10 19:59:30,125: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 19:59:30,125: Building eval from config
2020-06-10 19:59:30,125:  >> acoustic_ap= True
2020-06-10 19:59:30,126:  >> crossview_ap= True
2020-06-10 19:59:30,126:  >> full_vocab= False
2020-06-10 19:59:30,126:  >> metric= crossview_ap
2020-06-10 19:59:30,126:  >> mode= max
2020-06-10 19:59:30,126: Using module at multiview_rnn.MultiViewRNN
2020-06-10 19:59:30,126: Building net from config
2020-06-10 19:59:30,127: view1:
2020-06-10 19:59:30,127:  >> cell= GRU
2020-06-10 19:59:30,127:  >> input_size= 108
2020-06-10 19:59:30,127:  >> hidden_size= 512
2020-06-10 19:59:30,127:  >> bidirectional= True
2020-06-10 19:59:30,127:  >> num_layers= 6
2020-06-10 19:59:30,127:  >> dropout between layers= 0.4
2020-06-10 19:59:30,330: view2:
2020-06-10 19:59:30,330:  >> cell= GRU
2020-06-10 19:59:30,330:  >> input_size= 64
2020-06-10 19:59:30,330:  >> hidden_size= 512
2020-06-10 19:59:30,330:  >> bidirectional= True
2020-06-10 19:59:30,330:  >> num_layers= 2
2020-06-10 19:59:30,331:  >> dropout between layers= 0.4
2020-06-10 19:59:30,331:  >> num input embeddings= 45
2020-06-10 19:59:30,518: loaded save/MultiViewRNN.351.pth
2020-06-10 19:59:30,518: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-weighted
2020-06-10 19:59:30,518: Evaluating best model on dev and test:
2020-06-10 19:59:30,518: dev score:
2020-06-10 20:00:54,832:   >> crossview_ap=0.641 (10966 x 3921 pairs)
2020-06-10 20:01:48,704:   >> acoustic_ap=0.687 (10966 choose 2 pairs)
2020-06-10 20:01:49,458: saved outputs to npz file successfully
2020-06-10 20:01:49,458: test score:
2020-06-10 20:03:04,466:   >> crossview_ap=0.673 (11024 x 3392 pairs)
2020-06-10 20:03:59,111:   >> acoustic_ap=0.755 (11024 choose 2 pairs)
2020-06-10 20:03:59,859: saved outputs to npz file successfully
2020-06-10 20:03:59,864: Hyperparam tuning-------------------
2020-06-10 20:03:59,864: optim_lr: 0.0005
2020-06-10 20:03:59,864: dropout (for both): 0.4
2020-06-10 20:03:59,864: margin: 0.4
2020-06-10 20:03:59,864: ------------------------------------
2020-06-10 20:03:59,864: Calling main function: multiview_evaluator.evaluate
2020-06-10 20:03:59,864: Using config file: eval_config.json
2020-06-10 20:03:59,864: Using module at multiview_evaluator.evaluate
2020-06-10 20:03:59,865: Using module at multiview_vocab.MultiViewVocab
2020-06-10 20:03:59,865: Building vocab_data from config
2020-06-10 20:04:00,245:  >> min_count= 0
2020-06-10 20:04:00,245:  >> # words= 34323 (# removed= 0)
2020-06-10 20:04:00,245:  >> # subwords= 45
2020-06-10 20:04:00,246:     [laughter]= 1
2020-06-10 20:04:00,246:     [noise]= 2
2020-06-10 20:04:00,246:     [vocalized-noise]= 3
2020-06-10 20:04:00,246:     aa= 4
2020-06-10 20:04:00,246:     ae= 5
2020-06-10 20:04:00,246:     ah= 6
2020-06-10 20:04:00,246:     ao= 7
2020-06-10 20:04:00,246:     aw= 8
2020-06-10 20:04:00,246:     ax= 9
2020-06-10 20:04:00,246:     ay= 10
2020-06-10 20:04:00,246:     b= 11
2020-06-10 20:04:00,246:     ch= 12
2020-06-10 20:04:00,246:     d= 13
2020-06-10 20:04:00,246:     dh= 14
2020-06-10 20:04:00,246:     eh= 15
2020-06-10 20:04:00,246:     el= 16
2020-06-10 20:04:00,246:     en= 17
2020-06-10 20:04:00,246:     er= 18
2020-06-10 20:04:00,246:     ey= 19
2020-06-10 20:04:00,247:     f= 20
2020-06-10 20:04:00,247:     g= 21
2020-06-10 20:04:00,247:     hh= 22
2020-06-10 20:04:00,247:     ih= 23
2020-06-10 20:04:00,247:     iy= 24
2020-06-10 20:04:00,247:     jh= 25
2020-06-10 20:04:00,247:     k= 26
2020-06-10 20:04:00,247:     l= 27
2020-06-10 20:04:00,247:     m= 28
2020-06-10 20:04:00,247:     n= 29
2020-06-10 20:04:00,247:     ng= 30
2020-06-10 20:04:00,247:     ow= 31
2020-06-10 20:04:00,247:     oy= 32
2020-06-10 20:04:00,247:     p= 33
2020-06-10 20:04:00,247:     r= 34
2020-06-10 20:04:00,247:     s= 35
2020-06-10 20:04:00,247:     sh= 36
2020-06-10 20:04:00,247:     t= 37
2020-06-10 20:04:00,247:     th= 38
2020-06-10 20:04:00,247:     uh= 39
2020-06-10 20:04:00,248:     uw= 40
2020-06-10 20:04:00,248:     v= 41
2020-06-10 20:04:00,248:     w= 42
2020-06-10 20:04:00,248:     y= 43
2020-06-10 20:04:00,248:     z= 44
2020-06-10 20:04:00,248:     zh= 45
2020-06-10 20:04:00,261: Using module at data.batch_samplers.BatchSampler
2020-06-10 20:04:00,261: Building vocab_sampler from config
2020-06-10 20:04:00,261:  >> # examples= 34323
2020-06-10 20:04:00,261:  >> batch_size= 1000
2020-06-10 20:04:00,261:  >> shuffle= False
2020-06-10 20:04:00,269:  >> BatchSampler; 35 batches
2020-06-10 20:04:00,270: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 20:04:00,270: Building dev_data from config
2020-06-10 20:04:07,913:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 20:04:07,914:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 20:04:07,914:  >> stack= False
2020-06-10 20:04:07,914:  >> seg_durs= (1, None)
2020-06-10 20:04:07,914:  >> # words= 10966 (# ignored= 0)
2020-06-10 20:04:07,914:  >> input_feat_dim= 108
2020-06-10 20:04:07,914:  >> input_num_subwords= 45
2020-06-10 20:04:07,915: Using module at data.batch_samplers.BatchSampler
2020-06-10 20:04:07,915: Building dev_sampler from config
2020-06-10 20:04:07,915:  >> # examples= 10966
2020-06-10 20:04:07,915:  >> batch_size= 256
2020-06-10 20:04:07,915:  >> shuffle= False
2020-06-10 20:04:07,917:  >> BatchSampler; 43 batches
2020-06-10 20:04:07,917: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 20:04:07,917: Building test_data from config
2020-06-10 20:04:14,802:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 20:04:14,803:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 20:04:14,803:  >> stack= False
2020-06-10 20:04:14,803:  >> seg_durs= (1, None)
2020-06-10 20:04:14,803:  >> # words= 11024 (# ignored= 0)
2020-06-10 20:04:14,803:  >> input_feat_dim= 108
2020-06-10 20:04:14,803:  >> input_num_subwords= 45
2020-06-10 20:04:14,803: Using module at data.batch_samplers.BatchSampler
2020-06-10 20:04:14,803: Building test_sampler from config
2020-06-10 20:04:14,804:  >> # examples= 11024
2020-06-10 20:04:14,804:  >> batch_size= 256
2020-06-10 20:04:14,804:  >> shuffle= False
2020-06-10 20:04:14,806:  >> BatchSampler; 44 batches
2020-06-10 20:04:14,806: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 20:04:14,806: Building eval from config
2020-06-10 20:04:14,806:  >> acoustic_ap= True
2020-06-10 20:04:14,806:  >> crossview_ap= True
2020-06-10 20:04:14,806:  >> full_vocab= False
2020-06-10 20:04:14,806:  >> metric= crossview_ap
2020-06-10 20:04:14,806:  >> mode= max
2020-06-10 20:04:14,806: Using module at multiview_rnn.MultiViewRNN
2020-06-10 20:04:14,806: Building net from config
2020-06-10 20:04:14,807: view1:
2020-06-10 20:04:14,808:  >> cell= GRU
2020-06-10 20:04:14,808:  >> input_size= 108
2020-06-10 20:04:14,808:  >> hidden_size= 512
2020-06-10 20:04:14,808:  >> bidirectional= True
2020-06-10 20:04:14,808:  >> num_layers= 6
2020-06-10 20:04:14,808:  >> dropout between layers= 0.4
2020-06-10 20:04:14,998: view2:
2020-06-10 20:04:14,999:  >> cell= GRU
2020-06-10 20:04:14,999:  >> input_size= 64
2020-06-10 20:04:14,999:  >> hidden_size= 512
2020-06-10 20:04:14,999:  >> bidirectional= True
2020-06-10 20:04:14,999:  >> num_layers= 2
2020-06-10 20:04:14,999:  >> dropout between layers= 0.4
2020-06-10 20:04:14,999:  >> num input embeddings= 45
2020-06-10 20:04:15,189: loaded save/MultiViewRNN.351.pth
2020-06-10 20:04:15,189: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-weighted
2020-06-10 20:04:15,189: Evaluating best model on dev and test:
2020-06-10 20:04:15,189: dev score:
2020-06-10 20:05:41,989:   >> crossview_ap=0.641 (10966 x 3921 pairs)
2020-06-10 20:06:36,251:   >> acoustic_ap=0.687 (10966 choose 2 pairs)
2020-06-10 20:06:37,005: saved outputs to npz file successfully
2020-06-10 20:06:37,005: test score:
2020-06-10 20:08:00,529:   >> crossview_ap=0.673 (11024 x 3392 pairs)
2020-06-10 20:08:54,633:   >> acoustic_ap=0.755 (11024 choose 2 pairs)
2020-06-10 20:08:55,354: saved outputs to npz file successfully
2020-06-10 20:08:55,360: Hyperparam tuning-------------------
2020-06-10 20:08:55,361: optim_lr: 0.0005
2020-06-10 20:08:55,361: dropout (for both): 0.4
2020-06-10 20:08:55,361: margin: 0.5
2020-06-10 20:08:55,361: ------------------------------------
2020-06-10 20:08:55,361: Calling main function: multiview_evaluator.evaluate
2020-06-10 20:08:55,361: Using config file: eval_config.json
2020-06-10 20:08:55,361: Using module at multiview_evaluator.evaluate
2020-06-10 20:08:55,362: Using module at multiview_vocab.MultiViewVocab
2020-06-10 20:08:55,362: Building vocab_data from config
2020-06-10 20:08:55,774:  >> min_count= 0
2020-06-10 20:08:55,774:  >> # words= 34323 (# removed= 0)
2020-06-10 20:08:55,774:  >> # subwords= 45
2020-06-10 20:08:55,774:     [laughter]= 1
2020-06-10 20:08:55,774:     [noise]= 2
2020-06-10 20:08:55,774:     [vocalized-noise]= 3
2020-06-10 20:08:55,774:     aa= 4
2020-06-10 20:08:55,775:     ae= 5
2020-06-10 20:08:55,775:     ah= 6
2020-06-10 20:08:55,775:     ao= 7
2020-06-10 20:08:55,775:     aw= 8
2020-06-10 20:08:55,775:     ax= 9
2020-06-10 20:08:55,775:     ay= 10
2020-06-10 20:08:55,775:     b= 11
2020-06-10 20:08:55,775:     ch= 12
2020-06-10 20:08:55,775:     d= 13
2020-06-10 20:08:55,775:     dh= 14
2020-06-10 20:08:55,775:     eh= 15
2020-06-10 20:08:55,775:     el= 16
2020-06-10 20:08:55,775:     en= 17
2020-06-10 20:08:55,775:     er= 18
2020-06-10 20:08:55,775:     ey= 19
2020-06-10 20:08:55,775:     f= 20
2020-06-10 20:08:55,775:     g= 21
2020-06-10 20:08:55,776:     hh= 22
2020-06-10 20:08:55,776:     ih= 23
2020-06-10 20:08:55,776:     iy= 24
2020-06-10 20:08:55,776:     jh= 25
2020-06-10 20:08:55,776:     k= 26
2020-06-10 20:08:55,776:     l= 27
2020-06-10 20:08:55,776:     m= 28
2020-06-10 20:08:55,776:     n= 29
2020-06-10 20:08:55,776:     ng= 30
2020-06-10 20:08:55,776:     ow= 31
2020-06-10 20:08:55,776:     oy= 32
2020-06-10 20:08:55,776:     p= 33
2020-06-10 20:08:55,776:     r= 34
2020-06-10 20:08:55,776:     s= 35
2020-06-10 20:08:55,776:     sh= 36
2020-06-10 20:08:55,776:     t= 37
2020-06-10 20:08:55,776:     th= 38
2020-06-10 20:08:55,776:     uh= 39
2020-06-10 20:08:55,777:     uw= 40
2020-06-10 20:08:55,777:     v= 41
2020-06-10 20:08:55,777:     w= 42
2020-06-10 20:08:55,777:     y= 43
2020-06-10 20:08:55,777:     z= 44
2020-06-10 20:08:55,777:     zh= 45
2020-06-10 20:08:55,791: Using module at data.batch_samplers.BatchSampler
2020-06-10 20:08:55,791: Building vocab_sampler from config
2020-06-10 20:08:55,791:  >> # examples= 34323
2020-06-10 20:08:55,791:  >> batch_size= 1000
2020-06-10 20:08:55,791:  >> shuffle= False
2020-06-10 20:08:55,800:  >> BatchSampler; 35 batches
2020-06-10 20:08:55,800: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 20:08:55,800: Building dev_data from config
2020-06-10 20:09:03,791:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-10 20:09:03,816:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-10 20:09:03,816:  >> stack= False
2020-06-10 20:09:03,816:  >> seg_durs= (1, None)
2020-06-10 20:09:03,816:  >> # words= 10966 (# ignored= 0)
2020-06-10 20:09:03,816:  >> input_feat_dim= 108
2020-06-10 20:09:03,816:  >> input_num_subwords= 45
2020-06-10 20:09:03,816: Using module at data.batch_samplers.BatchSampler
2020-06-10 20:09:03,817: Building dev_sampler from config
2020-06-10 20:09:03,817:  >> # examples= 10966
2020-06-10 20:09:03,817:  >> batch_size= 256
2020-06-10 20:09:03,817:  >> shuffle= False
2020-06-10 20:09:03,822:  >> BatchSampler; 43 batches
2020-06-10 20:09:03,822: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-10 20:09:03,822: Building test_data from config
2020-06-10 20:09:10,346:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-10 20:09:10,361:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-10 20:09:10,361:  >> stack= False
2020-06-10 20:09:10,361:  >> seg_durs= (1, None)
2020-06-10 20:09:10,361:  >> # words= 11024 (# ignored= 0)
2020-06-10 20:09:10,361:  >> input_feat_dim= 108
2020-06-10 20:09:10,362:  >> input_num_subwords= 45
2020-06-10 20:09:10,362: Using module at data.batch_samplers.BatchSampler
2020-06-10 20:09:10,362: Building test_sampler from config
2020-06-10 20:09:10,362:  >> # examples= 11024
2020-06-10 20:09:10,362:  >> batch_size= 256
2020-06-10 20:09:10,362:  >> shuffle= False
2020-06-10 20:09:10,366:  >> BatchSampler; 44 batches
2020-06-10 20:09:10,366: Using module at metric.multiview_ap.MultiViewAP
2020-06-10 20:09:10,367: Building eval from config
2020-06-10 20:09:10,367:  >> acoustic_ap= True
2020-06-10 20:09:10,367:  >> crossview_ap= True
2020-06-10 20:09:10,367:  >> full_vocab= False
2020-06-10 20:09:10,367:  >> metric= crossview_ap
2020-06-10 20:09:10,367:  >> mode= max
2020-06-10 20:09:10,367: Using module at multiview_rnn.MultiViewRNN
2020-06-10 20:09:10,367: Building net from config
2020-06-10 20:09:10,368: view1:
2020-06-10 20:09:10,369:  >> cell= GRU
2020-06-10 20:09:10,369:  >> input_size= 108
2020-06-10 20:09:10,369:  >> hidden_size= 512
2020-06-10 20:09:10,369:  >> bidirectional= True
2020-06-10 20:09:10,369:  >> num_layers= 6
2020-06-10 20:09:10,369:  >> dropout between layers= 0.4
2020-06-10 20:09:10,623: view2:
2020-06-10 20:09:10,624:  >> cell= GRU
2020-06-10 20:09:10,624:  >> input_size= 64
2020-06-10 20:09:10,624:  >> hidden_size= 512
2020-06-10 20:09:10,624:  >> bidirectional= True
2020-06-10 20:09:10,624:  >> num_layers= 2
2020-06-10 20:09:10,624:  >> dropout between layers= 0.4
2020-06-10 20:09:10,624:  >> num input embeddings= 45
2020-06-10 20:09:10,819: loaded save/MultiViewRNN.351.pth
2020-06-10 20:09:10,820: note: relative to /share/data/lang/users/ttic_31110/ruolinzheng/obj0-phones-weighted
2020-06-10 20:09:10,820: Evaluating best model on dev and test:
2020-06-10 20:09:10,820: dev score:
2020-06-10 20:10:37,909:   >> crossview_ap=0.641 (10966 x 3921 pairs)
2020-06-10 20:11:31,860:   >> acoustic_ap=0.687 (10966 choose 2 pairs)
2020-06-10 20:11:32,638: saved outputs to npz file successfully
2020-06-10 20:11:32,639: test score:
2020-06-10 20:12:51,465:   >> crossview_ap=0.673 (11024 x 3392 pairs)
2020-06-10 20:13:45,596:   >> acoustic_ap=0.755 (11024 choose 2 pairs)
2020-06-10 20:13:46,299: saved outputs to npz file successfully
