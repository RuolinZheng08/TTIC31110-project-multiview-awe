2020-06-07 14:51:50,080: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-07 14:51:50,559: Using 1 GPU(s)
2020-06-07 14:51:50,560: Machine: 0 / 1
2020-06-07 14:51:50,586: Hyperparam tuning-------------------
2020-06-07 14:51:50,586: optim_lr: 0.001
2020-06-07 14:51:50,586: dropout (for both): 0.4
2020-06-07 14:51:50,586: margin: 0.4
2020-06-07 14:51:50,586: ------------------------------------
2020-06-07 14:51:50,648: Calling main function: multiview_trainer.train
2020-06-07 14:51:50,648: Using config file: train_config.json
2020-06-07 14:51:50,648: Using module at multiview_trainer.train
2020-06-07 14:52:01,681: Using module at multiview_vocab.MultiViewVocab
2020-06-07 14:52:01,762: Building vocab_data from config
2020-06-07 14:52:02,159:  >> min_count= 0
2020-06-07 14:52:02,160:  >> # words= 34323 (# removed= 0)
2020-06-07 14:52:02,160:  >> # subwords= 45
2020-06-07 14:52:02,160:     [laughter]= 1
2020-06-07 14:52:02,160:     [noise]= 2
2020-06-07 14:52:02,160:     [vocalized-noise]= 3
2020-06-07 14:52:02,160:     aa= 4
2020-06-07 14:52:02,160:     ae= 5
2020-06-07 14:52:02,161:     ah= 6
2020-06-07 14:52:02,161:     ao= 7
2020-06-07 14:52:02,161:     aw= 8
2020-06-07 14:52:02,161:     ax= 9
2020-06-07 14:52:02,161:     ay= 10
2020-06-07 14:52:02,161:     b= 11
2020-06-07 14:52:02,161:     ch= 12
2020-06-07 14:52:02,161:     d= 13
2020-06-07 14:52:02,161:     dh= 14
2020-06-07 14:52:02,161:     eh= 15
2020-06-07 14:52:02,162:     el= 16
2020-06-07 14:52:02,162:     en= 17
2020-06-07 14:52:02,162:     er= 18
2020-06-07 14:52:02,162:     ey= 19
2020-06-07 14:52:02,162:     f= 20
2020-06-07 14:52:02,162:     g= 21
2020-06-07 14:52:02,162:     hh= 22
2020-06-07 14:52:02,162:     ih= 23
2020-06-07 14:52:02,162:     iy= 24
2020-06-07 14:52:02,162:     jh= 25
2020-06-07 14:52:02,163:     k= 26
2020-06-07 14:52:02,163:     l= 27
2020-06-07 14:52:02,163:     m= 28
2020-06-07 14:52:02,163:     n= 29
2020-06-07 14:52:02,163:     ng= 30
2020-06-07 14:52:02,163:     ow= 31
2020-06-07 14:52:02,163:     oy= 32
2020-06-07 14:52:02,163:     p= 33
2020-06-07 14:52:02,163:     r= 34
2020-06-07 14:52:02,164:     s= 35
2020-06-07 14:52:02,164:     sh= 36
2020-06-07 14:52:02,164:     t= 37
2020-06-07 14:52:02,164:     th= 38
2020-06-07 14:52:02,164:     uh= 39
2020-06-07 14:52:02,164:     uw= 40
2020-06-07 14:52:02,164:     v= 41
2020-06-07 14:52:02,164:     w= 42
2020-06-07 14:52:02,164:     y= 43
2020-06-07 14:52:02,164:     z= 44
2020-06-07 14:52:02,165:     zh= 45
2020-06-07 14:52:02,182: Using module at data.batch_samplers.BatchSampler
2020-06-07 14:52:02,204: Building vocab_sampler from config
2020-06-07 14:52:02,204:  >> # examples= 34323
2020-06-07 14:52:02,204:  >> batch_size= 1000
2020-06-07 14:52:02,205:  >> shuffle= False
2020-06-07 14:52:02,214:  >> BatchSampler; 35 batches
2020-06-07 14:52:02,214: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 14:52:06,521: Building train_data from config
2020-06-07 14:52:15,435:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-07 14:52:15,437:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-07 14:52:15,437:  >> stack= False
2020-06-07 14:52:15,437:  >> seg_durs= (1, None)
2020-06-07 14:52:15,437:  >> # words= 9971 (# ignored= 0)
2020-06-07 14:52:15,437:  >> input_feat_dim= 108
2020-06-07 14:52:15,437:  >> input_num_subwords= 45
2020-06-07 14:52:15,437: Using module at data.batch_samplers.BatchSampler
2020-06-07 14:52:15,438: Building train_sampler from config
2020-06-07 14:52:15,438:  >> # examples= 9971
2020-06-07 14:52:15,438:  >> batch_size= 256
2020-06-07 14:52:15,438:  >> shuffle= True
2020-06-07 14:52:15,448:  >> BatchSampler; 39 batches
2020-06-07 14:52:15,448: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 14:52:15,448: Building dev_data from config
2020-06-07 14:52:25,625:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-07 14:52:25,626:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-07 14:52:25,626:  >> stack= False
2020-06-07 14:52:25,626:  >> seg_durs= (1, None)
2020-06-07 14:52:25,626:  >> # words= 10966 (# ignored= 0)
2020-06-07 14:52:25,626:  >> input_feat_dim= 108
2020-06-07 14:52:25,626:  >> input_num_subwords= 45
2020-06-07 14:52:25,627: Using module at data.batch_samplers.BatchSampler
2020-06-07 14:52:25,627: Building dev_sampler from config
2020-06-07 14:52:25,627:  >> # examples= 10966
2020-06-07 14:52:25,628:  >> batch_size= 256
2020-06-07 14:52:25,628:  >> shuffle= False
2020-06-07 14:52:25,630:  >> BatchSampler; 43 batches
2020-06-07 14:52:25,630: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 14:52:25,630: Building test_data from config
2020-06-07 14:52:34,492:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-07 14:52:34,494:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-07 14:52:34,494:  >> stack= False
2020-06-07 14:52:34,494:  >> seg_durs= (1, None)
2020-06-07 14:52:34,494:  >> # words= 11024 (# ignored= 0)
2020-06-07 14:52:34,494:  >> input_feat_dim= 108
2020-06-07 14:52:34,494:  >> input_num_subwords= 45
2020-06-07 14:52:34,495: Using module at data.batch_samplers.BatchSampler
2020-06-07 14:52:34,495: Building test_sampler from config
2020-06-07 14:52:34,495:  >> # examples= 11024
2020-06-07 14:52:34,495:  >> batch_size= 256
2020-06-07 14:52:34,496:  >> shuffle= False
2020-06-07 14:52:34,498:  >> BatchSampler; 44 batches
2020-06-07 14:52:34,498: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-07 14:52:34,943: Building loss from config
2020-06-07 14:52:34,944:  >> margin= 0.4
2020-06-07 14:52:34,944:  >> k= 16
2020-06-07 14:52:34,944:  >> min_k= 8
2020-06-07 14:52:34,945:  >> extra= 0
2020-06-07 14:52:34,945:  >> average= False
2020-06-07 14:52:34,945: Using module at metric.multiview_ap.MultiViewAP
2020-06-07 14:52:36,481: Building eval from config
2020-06-07 14:52:36,481:  >> acoustic_ap= True
2020-06-07 14:52:36,482:  >> crossview_ap= True
2020-06-07 14:52:36,482:  >> full_vocab= False
2020-06-07 14:52:36,482:  >> metric= crossview_ap
2020-06-07 14:52:36,482:  >> mode= max
2020-06-07 14:52:36,482: Using module at multiview_rnn.MultiViewRNN
2020-06-07 14:52:36,712: Building net from config
2020-06-07 14:52:36,714: view1:
2020-06-07 14:52:36,716:  >> cell= GRU
2020-06-07 14:52:36,716:  >> input_size= 108
2020-06-07 14:52:36,716:  >> hidden_size= 512
2020-06-07 14:52:36,717:  >> bidirectional= True
2020-06-07 14:52:36,717:  >> num_layers= 6
2020-06-07 14:52:36,717:  >> dropout between layers= 0.4
2020-06-07 14:52:37,070: view2:
2020-06-07 14:52:37,071:  >> cell= GRU
2020-06-07 14:52:37,071:  >> input_size= 64
2020-06-07 14:52:37,071:  >> hidden_size= 512
2020-06-07 14:52:37,071:  >> bidirectional= True
2020-06-07 14:52:37,071:  >> num_layers= 2
2020-06-07 14:52:37,071:  >> dropout between layers= 0.4
2020-06-07 14:52:37,072:  >> num input embeddings= 45
2020-06-07 14:52:46,571: Using module at optim.adam.Adam
2020-06-07 14:52:46,625: Building optim from config
2020-06-07 14:52:46,625:  >> lr= 0.001
2020-06-07 14:52:46,626:  >> betas= (0.9, 0.999)
2020-06-07 14:52:46,626:  >> eps= 1e-08
2020-06-07 14:52:46,626:  >> weight_decay= 0
2020-06-07 14:52:46,626:  >> amsgrad= False
2020-06-07 14:52:46,626:  >> min_lr= 1e-07
2020-06-07 14:52:46,628: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-07 14:52:46,816: Building sched from config
2020-06-07 14:52:46,817:  >> optim= Adam
2020-06-07 14:52:46,817:  >> decay lr by 0.1
2020-06-07 14:52:46,817:  >> eval_fn= MultiViewAP
2020-06-07 14:52:46,819:  >> patience=4
2020-06-07 14:52:46,819:  >> revert=True
2020-06-07 14:52:46,820: epoch=0.00 global_step=0 lr=0.001 start_iter=0
2020-06-07 14:52:46,820: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 14:54:54,783: 0) loss=0.504 grad_norm=51.17 num_segments=256 num_words=204
2020-06-07 14:56:51,081: 1) loss=0.493 grad_norm=46.04 num_segments=256 num_words=211
2020-06-07 14:58:40,531: 2) loss=0.515 grad_norm=68.04 num_segments=256 num_words=202
2020-06-07 15:00:20,822: 3) loss=0.476 grad_norm=43.04 num_segments=256 num_words=218
2020-06-07 15:01:53,548: 4) loss=0.484 grad_norm=55.96 num_segments=256 num_words=204
2020-06-07 15:03:17,363: 5) loss=0.473 grad_norm=67.83 num_segments=256 num_words=194
2020-06-07 15:04:32,174: 6) loss=0.474 grad_norm=59.91 num_segments=256 num_words=218
2020-06-07 15:05:38,856: 7) loss=0.469 grad_norm=53.25 num_segments=256 num_words=207
2020-06-07 15:06:47,009: 8) loss=0.479 grad_norm=48.21 num_segments=256 num_words=207
2020-06-07 15:07:54,066: 9) loss=0.471 grad_norm=41.84 num_segments=256 num_words=217
2020-06-07 15:09:00,053: 10) loss=0.465 grad_norm=43.66 num_segments=256 num_words=218
2020-06-07 15:10:06,203: 11) loss=0.461 grad_norm=41.29 num_segments=256 num_words=208
2020-06-07 15:11:13,337: 12) loss=0.459 grad_norm=40.71 num_segments=256 num_words=223
2020-06-07 15:12:20,630: 13) loss=0.457 grad_norm=36.59 num_segments=256 num_words=211
2020-06-07 15:13:28,414: 14) loss=0.447 grad_norm=38.86 num_segments=256 num_words=216
2020-06-07 15:14:35,263: 15) loss=0.446 grad_norm=46.62 num_segments=256 num_words=198
2020-06-07 15:15:43,212: 16) loss=0.442 grad_norm=46.69 num_segments=256 num_words=209
2020-06-07 15:16:50,876: 17) loss=0.464 grad_norm=44.51 num_segments=256 num_words=210
2020-06-07 15:17:58,490: 18) loss=0.441 grad_norm=42.60 num_segments=256 num_words=209
2020-06-07 15:19:03,638: 19) loss=0.436 grad_norm=35.04 num_segments=256 num_words=210
2020-06-07 15:20:09,853: 20) loss=0.429 grad_norm=33.68 num_segments=256 num_words=212
2020-06-07 15:21:15,810: 21) loss=0.431 grad_norm=31.84 num_segments=256 num_words=216
2020-06-07 15:22:21,968: 22) loss=0.504 grad_norm=45.62 num_segments=256 num_words=209
2020-06-07 15:23:28,176: 23) loss=0.427 grad_norm=34.84 num_segments=256 num_words=220
2020-06-07 15:24:36,029: 24) loss=0.422 grad_norm=34.55 num_segments=256 num_words=202
2020-06-07 15:25:44,014: 25) loss=0.417 grad_norm=33.62 num_segments=256 num_words=207
2020-06-07 15:26:51,335: 26) loss=0.418 grad_norm=37.06 num_segments=256 num_words=209
2020-06-07 15:27:58,813: 27) loss=0.407 grad_norm=38.44 num_segments=256 num_words=204
2020-06-07 15:29:06,508: 28) loss=0.413 grad_norm=33.93 num_segments=256 num_words=216
2020-06-07 15:30:13,916: 29) loss=0.435 grad_norm=40.27 num_segments=256 num_words=207
2020-06-07 15:31:20,333: 30) loss=0.425 grad_norm=33.14 num_segments=256 num_words=220
2020-06-07 15:32:27,919: 31) loss=0.427 grad_norm=38.03 num_segments=256 num_words=212
2020-06-07 15:33:34,609: 32) loss=0.394 grad_norm=43.05 num_segments=256 num_words=210
2020-06-07 15:34:41,782: 33) loss=0.402 grad_norm=43.81 num_segments=256 num_words=202
2020-06-07 15:35:48,832: 34) loss=0.395 grad_norm=48.80 num_segments=256 num_words=213
2020-06-07 15:36:55,278: 35) loss=0.393 grad_norm=45.94 num_segments=256 num_words=205
2020-06-07 15:38:00,520: 36) loss=0.398 grad_norm=57.03 num_segments=256 num_words=208
2020-06-07 15:39:06,041: 37) loss=0.401 grad_norm=54.53 num_segments=256 num_words=209
2020-06-07 15:40:05,059: 38) loss=0.399 grad_norm=44.88 num_segments=243 num_words=211
2020-06-07 15:40:05,078: epoch= 1.00
2020-06-07 15:40:05,078:  >> time to evaluate and save:
2020-06-07 15:40:05,153: saved save/MultiViewDataset_IndividualWords.39.pth
2020-06-07 15:40:05,155: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 15:40:05,157: saved MultiViewDataset_IndividualWords successfully
2020-06-07 15:40:07,476: saved save/MultiViewRNN.39.pth
2020-06-07 15:40:07,478: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 15:40:07,480: saved MultiViewRNN successfully
2020-06-07 15:40:11,695: saved save/Adam.39.pth
2020-06-07 15:40:11,698: most_recent linked save/Adam.most_recent.pth
2020-06-07 15:40:11,701: saved Adam successfully
2020-06-07 15:40:11,745: saved save/ReduceLROnPlateau.39.pth
2020-06-07 15:40:11,747: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 15:40:11,750: saved ReduceLROnPlateau successfully
2020-06-07 15:40:11,753: saved config successfully
2020-06-07 15:41:58,638:   >> crossview_ap=0.051 (10966 x 3921 pairs)
2020-06-07 15:43:05,221:   >> acoustic_ap=0.087 (10966 choose 2 pairs)
2020-06-07 15:43:05,224: best_so_far= 0.051 at 39
2020-06-07 15:43:05,228: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 15:43:05,230: saved MultiViewDataset_IndividualWords successfully
2020-06-07 15:43:05,231: best linked save/MultiViewRNN.best.pth
2020-06-07 15:43:05,233: saved MultiViewRNN successfully
2020-06-07 15:43:05,234: best linked save/Adam.best.pth
2020-06-07 15:43:05,236: saved Adam successfully
2020-06-07 15:43:05,237: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 15:43:05,239: saved ReduceLROnPlateau successfully
2020-06-07 15:43:05,268: epoch=1.00 global_step=39 lr=0.001 start_iter=0
2020-06-07 15:43:05,268: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 15:44:12,150: 0) loss=0.389 grad_norm=50.08 num_segments=256 num_words=218
2020-06-07 15:45:18,448: 1) loss=0.387 grad_norm=69.39 num_segments=256 num_words=212
2020-06-07 15:46:26,071: 2) loss=0.399 grad_norm=54.32 num_segments=256 num_words=209
2020-06-07 15:47:33,932: 3) loss=0.385 grad_norm=45.42 num_segments=256 num_words=211
2020-06-07 15:48:40,783: 4) loss=0.395 grad_norm=48.30 num_segments=256 num_words=215
2020-06-07 15:49:47,068: 5) loss=0.388 grad_norm=40.79 num_segments=256 num_words=213
2020-06-07 15:50:52,817: 6) loss=0.381 grad_norm=44.25 num_segments=256 num_words=216
2020-06-07 15:51:59,532: 7) loss=0.366 grad_norm=40.89 num_segments=256 num_words=203
2020-06-07 15:53:06,176: 8) loss=0.372 grad_norm=30.65 num_segments=256 num_words=218
2020-06-07 15:54:12,783: 9) loss=0.399 grad_norm=33.47 num_segments=256 num_words=212
2020-06-07 15:55:20,197: 10) loss=0.378 grad_norm=40.00 num_segments=256 num_words=208
2020-06-07 15:56:26,525: 11) loss=0.375 grad_norm=65.44 num_segments=256 num_words=213
2020-06-07 15:57:32,086: 12) loss=0.365 grad_norm=44.74 num_segments=256 num_words=218
2020-06-07 15:58:37,597: 13) loss=0.366 grad_norm=39.19 num_segments=256 num_words=208
2020-06-07 15:59:43,064: 14) loss=0.359 grad_norm=36.16 num_segments=256 num_words=213
2020-06-07 16:00:48,557: 15) loss=0.366 grad_norm=50.07 num_segments=256 num_words=200
2020-06-07 16:01:54,481: 16) loss=0.350 grad_norm=40.09 num_segments=256 num_words=208
2020-06-07 16:02:59,619: 17) loss=0.360 grad_norm=45.41 num_segments=256 num_words=210
2020-06-07 16:04:04,972: 18) loss=0.349 grad_norm=48.12 num_segments=256 num_words=200
2020-06-07 16:05:11,907: 19) loss=0.442 grad_norm=51.48 num_segments=256 num_words=221
2020-06-07 16:06:18,831: 20) loss=0.358 grad_norm=39.66 num_segments=256 num_words=209
2020-06-07 16:07:26,339: 21) loss=0.338 grad_norm=34.62 num_segments=256 num_words=203
2020-06-07 16:08:32,654: 22) loss=0.335 grad_norm=36.02 num_segments=256 num_words=210
2020-06-07 16:09:39,336: 23) loss=0.369 grad_norm=32.11 num_segments=256 num_words=222
2020-06-07 16:10:47,233: 24) loss=0.336 grad_norm=31.52 num_segments=256 num_words=215
2020-06-07 16:11:55,080: 25) loss=0.342 grad_norm=38.56 num_segments=256 num_words=205
2020-06-07 16:13:02,838: 26) loss=0.349 grad_norm=30.62 num_segments=256 num_words=215
2020-06-07 16:14:10,258: 27) loss=0.358 grad_norm=52.36 num_segments=256 num_words=213
2020-06-07 16:15:16,891: 28) loss=0.351 grad_norm=54.25 num_segments=256 num_words=214
2020-06-07 16:16:24,419: 29) loss=0.331 grad_norm=50.73 num_segments=256 num_words=205
2020-06-07 16:17:31,078: 30) loss=0.358 grad_norm=46.15 num_segments=256 num_words=209
2020-06-07 16:18:37,847: 31) loss=0.333 grad_norm=47.66 num_segments=256 num_words=209
2020-06-07 16:19:45,505: 32) loss=0.362 grad_norm=43.05 num_segments=256 num_words=200
2020-06-07 16:20:51,114: 33) loss=0.318 grad_norm=58.36 num_segments=256 num_words=201
2020-06-07 16:21:56,746: 34) loss=0.326 grad_norm=46.79 num_segments=256 num_words=211
2020-06-07 16:23:02,064: 35) loss=0.339 grad_norm=32.31 num_segments=256 num_words=206
2020-06-07 16:24:07,596: 36) loss=0.327 grad_norm=40.25 num_segments=256 num_words=210
2020-06-07 16:25:14,313: 37) loss=0.331 grad_norm=46.09 num_segments=256 num_words=204
2020-06-07 16:26:14,473: 38) loss=0.320 grad_norm=40.87 num_segments=243 num_words=196
2020-06-07 16:26:14,491: epoch= 2.00
2020-06-07 16:26:14,491:  >> time to evaluate and save:
2020-06-07 16:26:14,547: saved save/MultiViewDataset_IndividualWords.78.pth
2020-06-07 16:26:14,550: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 16:26:14,552: saved MultiViewDataset_IndividualWords successfully
2020-06-07 16:26:16,706: saved save/MultiViewRNN.78.pth
2020-06-07 16:26:16,708: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 16:26:16,717: saved MultiViewRNN successfully
2020-06-07 16:26:21,097: saved save/Adam.78.pth
2020-06-07 16:26:21,099: most_recent linked save/Adam.most_recent.pth
2020-06-07 16:26:21,107: saved Adam successfully
2020-06-07 16:26:21,139: saved save/ReduceLROnPlateau.78.pth
2020-06-07 16:26:21,144: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 16:26:21,147: saved ReduceLROnPlateau successfully
2020-06-07 16:26:21,212: saved config successfully
2020-06-07 16:28:02,471:   >> crossview_ap=0.164 (10966 x 3921 pairs)
2020-06-07 16:29:09,111:   >> acoustic_ap=0.202 (10966 choose 2 pairs)
2020-06-07 16:29:09,115: best_so_far= 0.164 at 78
2020-06-07 16:29:09,132: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 16:29:09,134: saved MultiViewDataset_IndividualWords successfully
2020-06-07 16:29:09,136: best linked save/MultiViewRNN.best.pth
2020-06-07 16:29:09,141: saved MultiViewRNN successfully
2020-06-07 16:29:09,143: best linked save/Adam.best.pth
2020-06-07 16:29:09,148: saved Adam successfully
2020-06-07 16:29:09,150: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 16:29:09,152: saved ReduceLROnPlateau successfully
2020-06-07 16:29:09,201: epoch=2.00 global_step=78 lr=0.001 start_iter=0
2020-06-07 16:29:09,201: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 16:30:16,984: 0) loss=0.316 grad_norm=42.28 num_segments=256 num_words=199
2020-06-07 16:31:23,018: 1) loss=0.311 grad_norm=35.99 num_segments=256 num_words=217
2020-06-07 16:32:30,815: 2) loss=0.314 grad_norm=56.78 num_segments=256 num_words=208
2020-06-07 16:33:36,863: 3) loss=0.304 grad_norm=54.98 num_segments=256 num_words=209
2020-06-07 16:34:42,216: 4) loss=0.315 grad_norm=34.99 num_segments=256 num_words=210
2020-06-07 16:35:47,721: 5) loss=0.311 grad_norm=33.60 num_segments=256 num_words=208
2020-06-07 16:36:53,417: 6) loss=0.320 grad_norm=47.92 num_segments=256 num_words=212
2020-06-07 16:37:59,383: 7) loss=0.313 grad_norm=36.49 num_segments=256 num_words=218
2020-06-07 16:39:06,034: 8) loss=0.308 grad_norm=37.15 num_segments=256 num_words=210
2020-06-07 16:40:13,953: 9) loss=0.307 grad_norm=29.12 num_segments=256 num_words=217
2020-06-07 16:41:19,937: 10) loss=0.295 grad_norm=38.32 num_segments=256 num_words=208
2020-06-07 16:42:26,120: 11) loss=0.290 grad_norm=42.39 num_segments=256 num_words=197
2020-06-07 16:43:32,218: 12) loss=0.304 grad_norm=45.72 num_segments=256 num_words=219
2020-06-07 16:44:37,914: 13) loss=0.293 grad_norm=49.06 num_segments=256 num_words=200
2020-06-07 16:45:44,676: 14) loss=0.300 grad_norm=45.90 num_segments=256 num_words=212
2020-06-07 16:46:51,996: 15) loss=0.298 grad_norm=41.77 num_segments=256 num_words=211
2020-06-07 16:47:58,943: 16) loss=0.310 grad_norm=37.00 num_segments=256 num_words=209
2020-06-07 16:49:05,756: 17) loss=0.402 grad_norm=37.58 num_segments=256 num_words=218
2020-06-07 16:50:13,470: 18) loss=0.302 grad_norm=40.83 num_segments=256 num_words=214
2020-06-07 16:51:20,817: 19) loss=0.300 grad_norm=39.58 num_segments=256 num_words=206
2020-06-07 16:52:28,266: 20) loss=0.284 grad_norm=31.02 num_segments=256 num_words=209
2020-06-07 16:53:34,585: 21) loss=0.290 grad_norm=40.07 num_segments=256 num_words=212
2020-06-07 16:54:39,976: 22) loss=0.288 grad_norm=52.05 num_segments=256 num_words=212
2020-06-07 16:55:46,802: 23) loss=0.282 grad_norm=31.76 num_segments=256 num_words=217
2020-06-07 16:56:52,820: 24) loss=0.290 grad_norm=33.39 num_segments=256 num_words=214
2020-06-07 16:57:59,527: 25) loss=0.283 grad_norm=40.24 num_segments=256 num_words=227
2020-06-07 16:59:04,925: 26) loss=0.296 grad_norm=29.32 num_segments=256 num_words=202
2020-06-07 17:00:10,197: 27) loss=0.280 grad_norm=34.31 num_segments=256 num_words=206
2020-06-07 17:01:15,664: 28) loss=0.278 grad_norm=28.98 num_segments=256 num_words=210
2020-06-07 17:02:22,440: 29) loss=0.270 grad_norm=35.61 num_segments=256 num_words=206
2020-06-07 17:03:30,368: 30) loss=0.282 grad_norm=34.56 num_segments=256 num_words=210
2020-06-07 17:04:38,716: 31) loss=0.303 grad_norm=31.96 num_segments=256 num_words=219
2020-06-07 17:05:44,633: 32) loss=0.275 grad_norm=34.85 num_segments=256 num_words=216
2020-06-07 17:06:52,316: 33) loss=0.274 grad_norm=43.78 num_segments=256 num_words=221
2020-06-07 17:07:58,984: 34) loss=0.269 grad_norm=27.52 num_segments=256 num_words=199
2020-06-07 17:09:04,465: 35) loss=0.267 grad_norm=37.08 num_segments=256 num_words=206
2020-06-07 17:10:10,178: 36) loss=0.279 grad_norm=39.36 num_segments=256 num_words=210
2020-06-07 17:11:15,783: 37) loss=0.293 grad_norm=33.72 num_segments=256 num_words=212
2020-06-07 17:12:14,798: 38) loss=0.284 grad_norm=38.49 num_segments=243 num_words=200
2020-06-07 17:12:14,817: epoch= 3.00
2020-06-07 17:12:14,817:  >> time to evaluate and save:
2020-06-07 17:12:14,883: saved save/MultiViewDataset_IndividualWords.117.pth
2020-06-07 17:12:14,886: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 17:12:14,888: saved MultiViewDataset_IndividualWords successfully
2020-06-07 17:12:17,184: saved save/MultiViewRNN.117.pth
2020-06-07 17:12:17,187: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 17:12:17,196: saved MultiViewRNN successfully
2020-06-07 17:12:21,217: saved save/Adam.117.pth
2020-06-07 17:12:21,220: most_recent linked save/Adam.most_recent.pth
2020-06-07 17:12:21,228: saved Adam successfully
2020-06-07 17:12:21,271: saved save/ReduceLROnPlateau.117.pth
2020-06-07 17:12:21,276: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 17:12:21,279: saved ReduceLROnPlateau successfully
2020-06-07 17:12:21,344: saved config successfully
2020-06-07 17:14:03,015:   >> crossview_ap=0.316 (10966 x 3921 pairs)
2020-06-07 17:15:09,463:   >> acoustic_ap=0.322 (10966 choose 2 pairs)
2020-06-07 17:15:09,467: best_so_far= 0.316 at 117
2020-06-07 17:15:09,473: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 17:15:09,475: saved MultiViewDataset_IndividualWords successfully
2020-06-07 17:15:09,477: best linked save/MultiViewRNN.best.pth
2020-06-07 17:15:09,484: saved MultiViewRNN successfully
2020-06-07 17:15:09,486: best linked save/Adam.best.pth
2020-06-07 17:15:09,492: saved Adam successfully
2020-06-07 17:15:09,494: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 17:15:09,496: saved ReduceLROnPlateau successfully
2020-06-07 17:15:09,547: epoch=3.00 global_step=117 lr=0.001 start_iter=0
2020-06-07 17:15:09,547: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 17:16:17,712: 0) loss=0.261 grad_norm=46.78 num_segments=256 num_words=203
2020-06-07 17:17:26,356: 1) loss=0.279 grad_norm=46.74 num_segments=256 num_words=215
2020-06-07 17:18:33,313: 2) loss=0.278 grad_norm=33.57 num_segments=256 num_words=209
2020-06-07 17:19:41,164: 3) loss=0.256 grad_norm=52.76 num_segments=256 num_words=209
2020-06-07 17:20:47,120: 4) loss=0.257 grad_norm=44.60 num_segments=256 num_words=209
2020-06-07 17:21:53,118: 5) loss=0.282 grad_norm=34.87 num_segments=256 num_words=210
2020-06-07 17:22:59,001: 6) loss=0.279 grad_norm=42.07 num_segments=256 num_words=207
2020-06-07 17:24:06,540: 7) loss=0.264 grad_norm=38.74 num_segments=256 num_words=223
2020-06-07 17:25:13,668: 8) loss=0.252 grad_norm=35.80 num_segments=256 num_words=212
2020-06-07 17:26:20,444: 9) loss=0.254 grad_norm=36.40 num_segments=256 num_words=214
2020-06-07 17:27:27,531: 10) loss=0.245 grad_norm=46.67 num_segments=256 num_words=212
2020-06-07 17:28:34,523: 11) loss=0.235 grad_norm=32.97 num_segments=256 num_words=211
2020-06-07 17:29:41,288: 12) loss=0.258 grad_norm=30.97 num_segments=256 num_words=206
2020-06-07 17:30:47,410: 13) loss=0.251 grad_norm=39.39 num_segments=256 num_words=219
2020-06-07 17:31:53,026: 14) loss=0.236 grad_norm=38.78 num_segments=256 num_words=212
2020-06-07 17:32:59,270: 15) loss=0.238 grad_norm=36.11 num_segments=256 num_words=205
2020-06-07 17:34:04,969: 16) loss=0.253 grad_norm=41.17 num_segments=256 num_words=211
2020-06-07 17:35:10,790: 17) loss=0.264 grad_norm=36.95 num_segments=256 num_words=210
2020-06-07 17:36:16,921: 18) loss=0.241 grad_norm=39.37 num_segments=256 num_words=218
2020-06-07 17:37:23,146: 19) loss=0.237 grad_norm=43.57 num_segments=256 num_words=207
2020-06-07 17:38:30,503: 20) loss=0.242 grad_norm=36.99 num_segments=256 num_words=208
2020-06-07 17:39:37,294: 21) loss=0.246 grad_norm=27.75 num_segments=256 num_words=213
2020-06-07 17:40:44,264: 22) loss=0.267 grad_norm=34.30 num_segments=256 num_words=207
2020-06-07 17:41:50,811: 23) loss=0.237 grad_norm=47.65 num_segments=256 num_words=214
2020-06-07 17:42:57,680: 24) loss=0.240 grad_norm=39.65 num_segments=256 num_words=212
2020-06-07 17:44:04,878: 25) loss=0.244 grad_norm=46.80 num_segments=256 num_words=212
2020-06-07 17:45:11,898: 26) loss=0.244 grad_norm=42.89 num_segments=256 num_words=210
2020-06-07 17:46:18,775: 27) loss=0.319 grad_norm=32.85 num_segments=256 num_words=209
2020-06-07 17:47:25,806: 28) loss=0.224 grad_norm=38.41 num_segments=256 num_words=213
2020-06-07 17:48:32,938: 29) loss=0.246 grad_norm=56.11 num_segments=256 num_words=218
2020-06-07 17:49:39,719: 30) loss=0.232 grad_norm=38.47 num_segments=256 num_words=199
2020-06-07 17:50:46,712: 31) loss=0.221 grad_norm=33.35 num_segments=256 num_words=202
2020-06-07 17:51:53,384: 32) loss=0.232 grad_norm=36.25 num_segments=256 num_words=210
2020-06-07 17:53:00,385: 33) loss=0.213 grad_norm=26.25 num_segments=256 num_words=213
2020-06-07 17:54:07,550: 34) loss=0.223 grad_norm=38.01 num_segments=256 num_words=208
2020-06-07 17:55:14,593: 35) loss=0.213 grad_norm=35.95 num_segments=256 num_words=203
2020-06-07 17:56:21,527: 36) loss=0.315 grad_norm=34.42 num_segments=256 num_words=213
2020-06-07 17:57:29,003: 37) loss=0.210 grad_norm=46.29 num_segments=256 num_words=195
2020-06-07 17:58:28,816: 38) loss=0.211 grad_norm=30.55 num_segments=243 num_words=203
2020-06-07 17:58:28,835: epoch= 4.00
2020-06-07 17:58:28,835:  >> time to evaluate and save:
2020-06-07 17:58:28,926: saved save/MultiViewDataset_IndividualWords.156.pth
2020-06-07 17:58:28,929: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 17:58:28,932: saved MultiViewDataset_IndividualWords successfully
2020-06-07 17:58:31,185: saved save/MultiViewRNN.156.pth
2020-06-07 17:58:34,710: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 17:58:34,720: saved MultiViewRNN successfully
2020-06-07 17:58:40,217: saved save/Adam.156.pth
2020-06-07 17:58:40,221: most_recent linked save/Adam.most_recent.pth
2020-06-07 17:58:40,229: saved Adam successfully
2020-06-07 17:58:40,281: saved save/ReduceLROnPlateau.156.pth
2020-06-07 17:58:40,330: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 17:58:40,333: saved ReduceLROnPlateau successfully
2020-06-07 17:58:40,337: saved config successfully
2020-06-07 18:00:23,767:   >> crossview_ap=0.448 (10966 x 3921 pairs)
2020-06-07 18:01:30,464:   >> acoustic_ap=0.465 (10966 choose 2 pairs)
2020-06-07 18:01:30,468: best_so_far= 0.448 at 156
2020-06-07 18:01:30,482: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 18:01:30,485: saved MultiViewDataset_IndividualWords successfully
2020-06-07 18:01:30,487: best linked save/MultiViewRNN.best.pth
2020-06-07 18:01:30,498: saved MultiViewRNN successfully
2020-06-07 18:01:30,500: best linked save/Adam.best.pth
2020-06-07 18:01:30,510: saved Adam successfully
2020-06-07 18:01:30,511: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 18:01:30,514: saved ReduceLROnPlateau successfully
2020-06-07 18:01:30,563: epoch=4.00 global_step=156 lr=0.001 start_iter=0
2020-06-07 18:01:30,563: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 18:02:37,500: 0) loss=0.213 grad_norm=32.51 num_segments=256 num_words=204
2020-06-07 18:03:44,307: 1) loss=0.226 grad_norm=28.38 num_segments=256 num_words=215
2020-06-07 18:04:52,139: 2) loss=0.238 grad_norm=43.91 num_segments=256 num_words=214
2020-06-07 18:06:00,192: 3) loss=0.216 grad_norm=28.91 num_segments=256 num_words=203
2020-06-07 18:07:07,298: 4) loss=0.204 grad_norm=29.15 num_segments=256 num_words=216
2020-06-07 18:08:14,094: 5) loss=0.226 grad_norm=51.24 num_segments=256 num_words=212
2020-06-07 18:09:21,216: 6) loss=0.211 grad_norm=38.68 num_segments=256 num_words=206
2020-06-07 18:10:27,149: 7) loss=0.198 grad_norm=35.81 num_segments=256 num_words=205
2020-06-07 18:11:34,812: 8) loss=0.208 grad_norm=28.27 num_segments=256 num_words=213
2020-06-07 18:12:41,931: 9) loss=0.227 grad_norm=35.61 num_segments=256 num_words=219
2020-06-07 18:13:48,839: 10) loss=0.210 grad_norm=33.93 num_segments=256 num_words=217
2020-06-07 18:14:54,737: 11) loss=0.202 grad_norm=29.44 num_segments=256 num_words=214
2020-06-07 18:16:01,445: 12) loss=0.202 grad_norm=32.39 num_segments=256 num_words=207
2020-06-07 18:17:07,834: 13) loss=0.199 grad_norm=25.69 num_segments=256 num_words=210
2020-06-07 18:18:15,290: 14) loss=0.206 grad_norm=33.84 num_segments=256 num_words=204
2020-06-07 18:19:22,621: 15) loss=0.201 grad_norm=27.81 num_segments=256 num_words=211
2020-06-07 18:20:29,228: 16) loss=0.194 grad_norm=30.96 num_segments=256 num_words=201
2020-06-07 18:21:35,875: 17) loss=0.209 grad_norm=28.35 num_segments=256 num_words=210
2020-06-07 18:22:42,999: 18) loss=0.200 grad_norm=32.76 num_segments=256 num_words=217
2020-06-07 18:23:49,717: 19) loss=0.198 grad_norm=29.79 num_segments=256 num_words=212
2020-06-07 18:24:56,871: 20) loss=0.174 grad_norm=28.37 num_segments=256 num_words=194
2020-06-07 18:26:03,905: 21) loss=0.185 grad_norm=37.10 num_segments=256 num_words=203
2020-06-07 18:27:11,781: 22) loss=0.218 grad_norm=42.42 num_segments=256 num_words=219
2020-06-07 18:28:17,766: 23) loss=0.193 grad_norm=26.62 num_segments=256 num_words=207
2020-06-07 18:29:23,581: 24) loss=0.196 grad_norm=24.38 num_segments=256 num_words=196
2020-06-07 18:30:29,958: 25) loss=0.199 grad_norm=26.11 num_segments=256 num_words=220
2020-06-07 18:31:36,042: 26) loss=0.218 grad_norm=27.51 num_segments=256 num_words=213
2020-06-07 18:32:42,951: 27) loss=0.187 grad_norm=34.33 num_segments=256 num_words=214
2020-06-07 18:33:50,486: 28) loss=0.187 grad_norm=27.05 num_segments=256 num_words=207
2020-06-07 18:34:57,005: 29) loss=0.226 grad_norm=33.53 num_segments=256 num_words=210
2020-06-07 18:36:03,475: 30) loss=0.207 grad_norm=24.98 num_segments=256 num_words=208
2020-06-07 18:37:10,934: 31) loss=0.236 grad_norm=47.17 num_segments=256 num_words=216
2020-06-07 18:38:17,313: 32) loss=0.193 grad_norm=32.85 num_segments=256 num_words=202
2020-06-07 18:39:23,809: 33) loss=0.243 grad_norm=47.02 num_segments=256 num_words=220
2020-06-07 18:40:30,804: 34) loss=0.188 grad_norm=40.82 num_segments=256 num_words=218
2020-06-07 18:41:36,806: 35) loss=0.198 grad_norm=32.90 num_segments=256 num_words=213
2020-06-07 18:42:43,690: 36) loss=0.186 grad_norm=45.35 num_segments=256 num_words=205
2020-06-07 18:43:50,852: 37) loss=0.189 grad_norm=34.40 num_segments=256 num_words=204
2020-06-07 18:44:52,691: 38) loss=0.206 grad_norm=27.47 num_segments=243 num_words=206
2020-06-07 18:44:52,711: epoch= 5.00
2020-06-07 18:44:52,711:  >> time to evaluate and save:
2020-06-07 18:44:52,824: saved save/MultiViewDataset_IndividualWords.195.pth
2020-06-07 18:44:52,880: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 18:44:52,895: saved MultiViewDataset_IndividualWords successfully
2020-06-07 18:44:55,085: saved save/MultiViewRNN.195.pth
2020-06-07 18:44:55,087: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 18:44:55,097: saved MultiViewRNN successfully
2020-06-07 18:44:59,555: saved save/Adam.195.pth
2020-06-07 18:44:59,559: most_recent linked save/Adam.most_recent.pth
2020-06-07 18:44:59,567: saved Adam successfully
2020-06-07 18:44:59,603: saved save/ReduceLROnPlateau.195.pth
2020-06-07 18:44:59,609: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 18:44:59,613: saved ReduceLROnPlateau successfully
2020-06-07 18:44:59,677: saved config successfully
2020-06-07 18:46:42,372:   >> crossview_ap=0.525 (10966 x 3921 pairs)
2020-06-07 18:47:48,814:   >> acoustic_ap=0.533 (10966 choose 2 pairs)
2020-06-07 18:47:48,818: best_so_far= 0.525 at 195
2020-06-07 18:47:48,831: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 18:47:48,834: saved MultiViewDataset_IndividualWords successfully
2020-06-07 18:47:48,836: best linked save/MultiViewRNN.best.pth
2020-06-07 18:47:48,848: saved MultiViewRNN successfully
2020-06-07 18:47:48,850: best linked save/Adam.best.pth
2020-06-07 18:47:48,860: saved Adam successfully
2020-06-07 18:47:48,862: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 18:47:48,865: saved ReduceLROnPlateau successfully
2020-06-07 18:47:48,987: epoch=5.00 global_step=195 lr=0.001 start_iter=0
2020-06-07 18:47:48,987: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 18:48:58,321: 0) loss=0.177 grad_norm=27.83 num_segments=256 num_words=208
2020-06-07 18:50:04,408: 1) loss=0.187 grad_norm=36.95 num_segments=256 num_words=212
2020-06-07 18:51:11,153: 2) loss=0.162 grad_norm=52.16 num_segments=256 num_words=209
2020-06-07 19:49:41,186: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-07 19:49:41,218: Using 1 GPU(s)
2020-06-07 19:49:41,219: Machine: 0 / 1
2020-06-07 19:49:41,240: Hyperparam tuning-------------------
2020-06-07 19:49:41,240: optim_lr: 0.001
2020-06-07 19:49:41,240: dropout (for both): 0.4
2020-06-07 19:49:41,240: margin: 0.4
2020-06-07 19:49:41,240: ------------------------------------
2020-06-07 19:49:41,242: Calling main function: multiview_trainer.train
2020-06-07 19:49:41,242: Using config file: train_config.json
2020-06-07 19:49:41,242: Using module at multiview_trainer.train
2020-06-07 19:49:41,662: Using module at multiview_vocab.MultiViewVocab
2020-06-07 19:49:41,810: Building vocab_data from config
2020-06-07 19:49:42,039:  >> min_count= 0
2020-06-07 19:49:42,040:  >> # words= 34323 (# removed= 0)
2020-06-07 19:49:42,040:  >> # subwords= 45
2020-06-07 19:49:42,040:     [laughter]= 1
2020-06-07 19:49:42,040:     [noise]= 2
2020-06-07 19:49:42,040:     [vocalized-noise]= 3
2020-06-07 19:49:42,040:     aa= 4
2020-06-07 19:49:42,040:     ae= 5
2020-06-07 19:49:42,040:     ah= 6
2020-06-07 19:49:42,040:     ao= 7
2020-06-07 19:49:42,040:     aw= 8
2020-06-07 19:49:42,040:     ax= 9
2020-06-07 19:49:42,040:     ay= 10
2020-06-07 19:49:42,041:     b= 11
2020-06-07 19:49:42,041:     ch= 12
2020-06-07 19:49:42,041:     d= 13
2020-06-07 19:49:42,041:     dh= 14
2020-06-07 19:49:42,041:     eh= 15
2020-06-07 19:49:42,041:     el= 16
2020-06-07 19:49:42,041:     en= 17
2020-06-07 19:49:42,041:     er= 18
2020-06-07 19:49:42,041:     ey= 19
2020-06-07 19:49:42,041:     f= 20
2020-06-07 19:49:42,041:     g= 21
2020-06-07 19:49:42,041:     hh= 22
2020-06-07 19:49:42,041:     ih= 23
2020-06-07 19:49:42,041:     iy= 24
2020-06-07 19:49:42,041:     jh= 25
2020-06-07 19:49:42,041:     k= 26
2020-06-07 19:49:42,042:     l= 27
2020-06-07 19:49:42,042:     m= 28
2020-06-07 19:49:42,042:     n= 29
2020-06-07 19:49:42,042:     ng= 30
2020-06-07 19:49:42,042:     ow= 31
2020-06-07 19:49:42,042:     oy= 32
2020-06-07 19:49:42,042:     p= 33
2020-06-07 19:49:42,042:     r= 34
2020-06-07 19:49:42,042:     s= 35
2020-06-07 19:49:42,042:     sh= 36
2020-06-07 19:49:42,042:     t= 37
2020-06-07 19:49:42,042:     th= 38
2020-06-07 19:49:42,042:     uh= 39
2020-06-07 19:49:42,042:     uw= 40
2020-06-07 19:49:42,042:     v= 41
2020-06-07 19:49:42,043:     w= 42
2020-06-07 19:49:42,043:     y= 43
2020-06-07 19:49:42,043:     z= 44
2020-06-07 19:49:42,043:     zh= 45
2020-06-07 19:49:42,054: Using module at data.batch_samplers.BatchSampler
2020-06-07 19:49:42,071: Building vocab_sampler from config
2020-06-07 19:49:42,072:  >> # examples= 34323
2020-06-07 19:49:42,072:  >> batch_size= 1000
2020-06-07 19:49:42,072:  >> shuffle= False
2020-06-07 19:49:42,078:  >> BatchSampler; 35 batches
2020-06-07 19:49:42,078: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 19:49:42,245: Building train_data from config
2020-06-07 19:49:49,738:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-07 19:49:49,739:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-07 19:49:49,739:  >> stack= False
2020-06-07 19:49:49,739:  >> seg_durs= (1, None)
2020-06-07 19:49:49,739:  >> # words= 9971 (# ignored= 0)
2020-06-07 19:49:49,739:  >> input_feat_dim= 108
2020-06-07 19:49:49,740:  >> input_num_subwords= 45
2020-06-07 19:49:49,740: Using module at data.batch_samplers.BatchSampler
2020-06-07 19:49:49,740: Building train_sampler from config
2020-06-07 19:49:49,741:  >> # examples= 9971
2020-06-07 19:49:49,741:  >> batch_size= 256
2020-06-07 19:49:49,741:  >> shuffle= True
2020-06-07 19:49:49,748:  >> BatchSampler; 39 batches
2020-06-07 19:49:49,748: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 19:49:49,748: Building dev_data from config
2020-06-07 19:49:58,389:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-07 19:49:58,390:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-07 19:49:58,390:  >> stack= False
2020-06-07 19:49:58,390:  >> seg_durs= (1, None)
2020-06-07 19:49:58,390:  >> # words= 10966 (# ignored= 0)
2020-06-07 19:49:58,390:  >> input_feat_dim= 108
2020-06-07 19:49:58,390:  >> input_num_subwords= 45
2020-06-07 19:49:58,390: Using module at data.batch_samplers.BatchSampler
2020-06-07 19:49:58,390: Building dev_sampler from config
2020-06-07 19:49:58,391:  >> # examples= 10966
2020-06-07 19:49:58,391:  >> batch_size= 256
2020-06-07 19:49:58,391:  >> shuffle= False
2020-06-07 19:49:58,393:  >> BatchSampler; 43 batches
2020-06-07 19:49:58,393: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-07 19:49:58,393: Building test_data from config
2020-06-07 19:50:05,832:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-07 19:50:05,833:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-07 19:50:05,833:  >> stack= False
2020-06-07 19:50:05,833:  >> seg_durs= (1, None)
2020-06-07 19:50:05,833:  >> # words= 11024 (# ignored= 0)
2020-06-07 19:50:05,833:  >> input_feat_dim= 108
2020-06-07 19:50:05,833:  >> input_num_subwords= 45
2020-06-07 19:50:05,833: Using module at data.batch_samplers.BatchSampler
2020-06-07 19:50:05,833: Building test_sampler from config
2020-06-07 19:50:05,834:  >> # examples= 11024
2020-06-07 19:50:05,834:  >> batch_size= 256
2020-06-07 19:50:05,834:  >> shuffle= False
2020-06-07 19:50:05,836:  >> BatchSampler; 44 batches
2020-06-07 19:50:05,836: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-07 19:50:05,950: Building loss from config
2020-06-07 19:50:05,951:  >> margin= 0.4
2020-06-07 19:50:05,951:  >> k= 16
2020-06-07 19:50:05,951:  >> min_k= 8
2020-06-07 19:50:05,951:  >> extra= 0
2020-06-07 19:50:05,951:  >> average= False
2020-06-07 19:50:05,951: Using module at metric.multiview_ap.MultiViewAP
2020-06-07 19:50:06,056: Building eval from config
2020-06-07 19:50:06,057:  >> acoustic_ap= True
2020-06-07 19:50:06,057:  >> crossview_ap= True
2020-06-07 19:50:06,057:  >> full_vocab= False
2020-06-07 19:50:06,057:  >> metric= crossview_ap
2020-06-07 19:50:06,057:  >> mode= max
2020-06-07 19:50:06,057: Using module at multiview_rnn.MultiViewRNN
2020-06-07 19:50:06,238: Building net from config
2020-06-07 19:50:06,239: view1:
2020-06-07 19:50:06,240:  >> cell= GRU
2020-06-07 19:50:06,240:  >> input_size= 108
2020-06-07 19:50:06,240:  >> hidden_size= 512
2020-06-07 19:50:06,240:  >> bidirectional= True
2020-06-07 19:50:06,240:  >> num_layers= 6
2020-06-07 19:50:06,240:  >> dropout between layers= 0.4
2020-06-07 19:50:06,454: view2:
2020-06-07 19:50:06,455:  >> cell= GRU
2020-06-07 19:50:06,455:  >> input_size= 64
2020-06-07 19:50:06,455:  >> hidden_size= 512
2020-06-07 19:50:06,455:  >> bidirectional= True
2020-06-07 19:50:06,455:  >> num_layers= 2
2020-06-07 19:50:06,455:  >> dropout between layers= 0.4
2020-06-07 19:50:06,455:  >> num input embeddings= 45
2020-06-07 19:50:09,841: Using module at optim.adam.Adam
2020-06-07 19:50:09,926: Building optim from config
2020-06-07 19:50:09,927:  >> lr= 0.001
2020-06-07 19:50:09,927:  >> betas= (0.9, 0.999)
2020-06-07 19:50:09,927:  >> eps= 1e-08
2020-06-07 19:50:09,927:  >> weight_decay= 0
2020-06-07 19:50:09,927:  >> amsgrad= False
2020-06-07 19:50:09,927:  >> min_lr= 1e-07
2020-06-07 19:50:09,929: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-07 19:50:10,153: Building sched from config
2020-06-07 19:50:10,153:  >> optim= Adam
2020-06-07 19:50:10,153:  >> decay lr by 0.1
2020-06-07 19:50:10,154:  >> eval_fn= MultiViewAP
2020-06-07 19:50:10,154:  >> patience=4
2020-06-07 19:50:10,154:  >> revert=True
2020-06-07 19:50:10,220: loaded save/MultiViewDataset_IndividualWords.195.pth
2020-06-07 19:50:10,220: note: relative to /home-nfs/ruolinzheng/obj0-phones-edit
2020-06-07 19:50:11,876: loaded save/MultiViewRNN.195.pth
2020-06-07 19:50:11,877: note: relative to /home-nfs/ruolinzheng/obj0-phones-edit
2020-06-07 19:50:15,016: loaded save/Adam.195.pth
2020-06-07 19:50:15,017: note: relative to /home-nfs/ruolinzheng/obj0-phones-edit
2020-06-07 19:50:15,042: loaded save/ReduceLROnPlateau.195.pth
2020-06-07 19:50:15,042: note: relative to /home-nfs/ruolinzheng/obj0-phones-edit
2020-06-07 19:50:15,042: epoch=5.00 global_step=195 lr=0.001 start_iter=0
2020-06-07 19:50:15,042: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 19:52:01,976: 0) loss=0.115 grad_norm=25.90 num_segments=256 num_words=208
2020-06-07 19:53:39,868: 1) loss=0.126 grad_norm=33.30 num_segments=256 num_words=212
2020-06-07 19:55:10,884: 2) loss=0.118 grad_norm=46.73 num_segments=256 num_words=209
2020-06-07 19:56:35,094: 3) loss=0.139 grad_norm=42.56 num_segments=256 num_words=206
2020-06-07 19:57:51,930: 4) loss=0.153 grad_norm=28.41 num_segments=256 num_words=209
2020-06-07 19:59:02,222: 5) loss=0.159 grad_norm=29.52 num_segments=256 num_words=214
2020-06-07 20:00:05,355: 6) loss=0.168 grad_norm=30.39 num_segments=256 num_words=209
2020-06-07 20:01:01,921: 7) loss=0.158 grad_norm=26.14 num_segments=256 num_words=212
2020-06-07 20:01:58,420: 8) loss=0.166 grad_norm=28.31 num_segments=256 num_words=198
2020-06-07 20:02:54,678: 9) loss=0.181 grad_norm=36.60 num_segments=256 num_words=210
2020-06-07 20:03:50,653: 10) loss=0.159 grad_norm=32.27 num_segments=256 num_words=205
2020-06-07 20:04:47,396: 11) loss=0.167 grad_norm=23.66 num_segments=256 num_words=217
2020-06-07 20:05:43,567: 12) loss=0.188 grad_norm=36.92 num_segments=256 num_words=221
2020-06-07 20:06:40,056: 13) loss=0.171 grad_norm=28.45 num_segments=256 num_words=212
2020-06-07 20:07:36,865: 14) loss=0.179 grad_norm=27.56 num_segments=256 num_words=207
2020-06-07 20:08:33,231: 15) loss=0.165 grad_norm=34.45 num_segments=256 num_words=205
2020-06-07 20:09:29,382: 16) loss=0.171 grad_norm=28.65 num_segments=256 num_words=210
2020-06-07 20:10:26,433: 17) loss=0.177 grad_norm=31.98 num_segments=256 num_words=203
2020-06-07 20:11:23,311: 18) loss=0.164 grad_norm=26.36 num_segments=256 num_words=206
2020-06-07 20:12:19,956: 19) loss=0.176 grad_norm=35.08 num_segments=256 num_words=211
2020-06-07 20:13:16,831: 20) loss=0.201 grad_norm=37.35 num_segments=256 num_words=209
2020-06-07 20:14:13,142: 21) loss=0.180 grad_norm=24.94 num_segments=256 num_words=202
2020-06-07 20:15:09,685: 22) loss=0.177 grad_norm=29.68 num_segments=256 num_words=210
2020-06-07 20:16:06,246: 23) loss=0.257 grad_norm=28.40 num_segments=256 num_words=216
2020-06-07 20:17:02,791: 24) loss=0.170 grad_norm=26.82 num_segments=256 num_words=206
2020-06-07 20:17:59,128: 25) loss=0.174 grad_norm=31.81 num_segments=256 num_words=216
2020-06-07 20:18:55,776: 26) loss=0.169 grad_norm=27.96 num_segments=256 num_words=210
2020-06-07 20:19:52,381: 27) loss=0.163 grad_norm=33.02 num_segments=256 num_words=208
2020-06-07 20:20:49,028: 28) loss=0.171 grad_norm=39.78 num_segments=256 num_words=210
2020-06-07 20:21:45,413: 29) loss=0.172 grad_norm=29.74 num_segments=256 num_words=213
2020-06-07 20:22:41,112: 30) loss=0.184 grad_norm=47.07 num_segments=256 num_words=212
2020-06-07 20:23:37,669: 31) loss=0.171 grad_norm=38.04 num_segments=256 num_words=209
2020-06-07 20:24:33,833: 32) loss=0.176 grad_norm=35.77 num_segments=256 num_words=219
2020-06-07 20:25:30,547: 33) loss=0.245 grad_norm=44.82 num_segments=256 num_words=203
2020-06-07 20:26:27,284: 34) loss=0.185 grad_norm=29.32 num_segments=256 num_words=215
2020-06-07 20:27:23,719: 35) loss=0.173 grad_norm=28.43 num_segments=256 num_words=214
2020-06-07 20:28:20,334: 36) loss=0.194 grad_norm=31.45 num_segments=256 num_words=212
2020-06-07 20:29:17,205: 37) loss=0.184 grad_norm=30.41 num_segments=256 num_words=208
2020-06-07 20:30:08,243: 38) loss=0.162 grad_norm=22.04 num_segments=243 num_words=205
2020-06-07 20:30:08,259: epoch= 6.00
2020-06-07 20:30:08,260:  >> time to evaluate and save:
2020-06-07 20:30:08,293: saved save/MultiViewDataset_IndividualWords.234.pth
2020-06-07 20:30:08,295: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 20:30:08,299: saved MultiViewDataset_IndividualWords successfully
2020-06-07 20:30:10,480: saved save/MultiViewRNN.234.pth
2020-06-07 20:30:10,481: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 20:30:11,101: saved MultiViewRNN successfully
2020-06-07 20:30:15,319: saved save/Adam.234.pth
2020-06-07 20:30:15,321: most_recent linked save/Adam.most_recent.pth
2020-06-07 20:30:15,851: saved Adam successfully
2020-06-07 20:30:15,853: saved save/ReduceLROnPlateau.234.pth
2020-06-07 20:30:15,872: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 20:30:15,876: saved ReduceLROnPlateau successfully
2020-06-07 20:30:15,880: saved config successfully
2020-06-07 20:31:45,913:   >> crossview_ap=0.583 (10966 x 3921 pairs)
2020-06-07 20:32:45,097:   >> acoustic_ap=0.597 (10966 choose 2 pairs)
2020-06-07 20:32:45,100: best_so_far= 0.583 at 234
2020-06-07 20:32:45,122: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 20:32:45,124: saved MultiViewDataset_IndividualWords successfully
2020-06-07 20:32:45,126: best linked save/MultiViewRNN.best.pth
2020-06-07 20:32:45,134: saved MultiViewRNN successfully
2020-06-07 20:32:45,135: best linked save/Adam.best.pth
2020-06-07 20:32:45,144: saved Adam successfully
2020-06-07 20:32:45,145: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 20:32:45,148: saved ReduceLROnPlateau successfully
2020-06-07 20:32:45,174: epoch=6.00 global_step=234 lr=0.001 start_iter=0
2020-06-07 20:32:45,174: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 20:33:42,383: 0) loss=0.145 grad_norm=41.20 num_segments=256 num_words=210
2020-06-07 20:34:38,937: 1) loss=0.154 grad_norm=30.82 num_segments=256 num_words=211
2020-06-07 20:35:35,655: 2) loss=0.176 grad_norm=25.72 num_segments=256 num_words=206
2020-06-07 20:36:32,234: 3) loss=0.176 grad_norm=32.30 num_segments=256 num_words=217
2020-06-07 20:37:29,219: 4) loss=0.153 grad_norm=47.23 num_segments=256 num_words=216
2020-06-07 20:38:26,128: 5) loss=0.153 grad_norm=30.00 num_segments=256 num_words=209
2020-06-07 20:39:22,266: 6) loss=0.156 grad_norm=27.41 num_segments=256 num_words=214
2020-06-07 20:40:18,733: 7) loss=0.151 grad_norm=37.69 num_segments=256 num_words=209
2020-06-07 20:41:15,527: 8) loss=0.157 grad_norm=24.25 num_segments=256 num_words=210
2020-06-07 20:42:11,789: 9) loss=0.162 grad_norm=31.00 num_segments=256 num_words=214
2020-06-07 20:43:08,451: 10) loss=0.146 grad_norm=28.36 num_segments=256 num_words=202
2020-06-07 20:44:05,160: 11) loss=0.138 grad_norm=22.58 num_segments=256 num_words=207
2020-06-07 20:45:01,625: 12) loss=0.147 grad_norm=20.37 num_segments=256 num_words=208
2020-06-07 20:45:58,162: 13) loss=0.148 grad_norm=29.01 num_segments=256 num_words=213
2020-06-07 20:46:54,806: 14) loss=0.140 grad_norm=23.86 num_segments=256 num_words=206
2020-06-07 20:47:51,080: 15) loss=0.146 grad_norm=28.99 num_segments=256 num_words=215
2020-06-07 20:48:46,842: 16) loss=0.150 grad_norm=36.81 num_segments=256 num_words=211
2020-06-07 20:49:42,415: 17) loss=0.151 grad_norm=34.12 num_segments=256 num_words=214
2020-06-07 20:50:37,984: 18) loss=0.170 grad_norm=27.49 num_segments=256 num_words=212
2020-06-07 20:51:33,557: 19) loss=0.168 grad_norm=29.87 num_segments=256 num_words=202
2020-06-07 20:52:27,855: 20) loss=0.170 grad_norm=28.52 num_segments=256 num_words=213
2020-06-07 20:53:22,457: 21) loss=0.137 grad_norm=22.54 num_segments=256 num_words=207
2020-06-07 20:54:18,886: 22) loss=0.142 grad_norm=26.70 num_segments=256 num_words=209
2020-06-07 20:55:15,385: 23) loss=0.154 grad_norm=31.49 num_segments=256 num_words=207
2020-06-07 20:56:12,017: 24) loss=0.165 grad_norm=34.37 num_segments=256 num_words=209
2020-06-07 20:57:08,843: 25) loss=0.139 grad_norm=29.02 num_segments=256 num_words=203
2020-06-07 20:58:04,843: 26) loss=0.140 grad_norm=30.68 num_segments=256 num_words=208
2020-06-07 20:59:01,479: 27) loss=0.150 grad_norm=24.76 num_segments=256 num_words=210
2020-06-07 20:59:57,719: 28) loss=0.130 grad_norm=25.15 num_segments=256 num_words=200
2020-06-07 21:00:54,528: 29) loss=0.154 grad_norm=36.39 num_segments=256 num_words=204
2020-06-07 21:01:50,803: 30) loss=0.143 grad_norm=32.40 num_segments=256 num_words=208
2020-06-07 21:02:47,265: 31) loss=0.153 grad_norm=28.62 num_segments=256 num_words=215
2020-06-07 21:03:43,902: 32) loss=0.164 grad_norm=27.55 num_segments=256 num_words=214
2020-06-07 21:04:40,452: 33) loss=0.157 grad_norm=32.18 num_segments=256 num_words=215
2020-06-07 21:05:36,919: 34) loss=0.151 grad_norm=28.27 num_segments=256 num_words=212
2020-06-07 21:06:33,546: 35) loss=0.142 grad_norm=32.91 num_segments=256 num_words=203
2020-06-07 21:07:29,952: 36) loss=0.171 grad_norm=28.08 num_segments=256 num_words=217
2020-06-07 21:08:26,674: 37) loss=0.159 grad_norm=28.58 num_segments=256 num_words=206
2020-06-07 21:09:16,808: 38) loss=0.146 grad_norm=27.50 num_segments=243 num_words=200
2020-06-07 21:09:16,828: epoch= 7.00
2020-06-07 21:09:16,828:  >> time to evaluate and save:
2020-06-07 21:09:16,986: saved save/MultiViewDataset_IndividualWords.273.pth
2020-06-07 21:09:16,988: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 21:09:17,000: removed save/MultiViewDataset_IndividualWords.39.pth
2020-06-07 21:09:17,000: saved MultiViewDataset_IndividualWords successfully
2020-06-07 21:09:19,165: saved save/MultiViewRNN.273.pth
2020-06-07 21:09:19,167: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 21:09:19,329: removed save/MultiViewRNN.39.pth
2020-06-07 21:09:19,330: saved MultiViewRNN successfully
2020-06-07 21:09:23,668: saved save/Adam.273.pth
2020-06-07 21:09:23,705: most_recent linked save/Adam.most_recent.pth
2020-06-07 21:09:23,840: removed save/Adam.39.pth
2020-06-07 21:09:23,840: saved Adam successfully
2020-06-07 21:09:23,913: saved save/ReduceLROnPlateau.273.pth
2020-06-07 21:09:23,915: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 21:09:23,918: saved ReduceLROnPlateau successfully
2020-06-07 21:09:23,921: saved config successfully
2020-06-07 21:10:44,816:   >> crossview_ap=0.587 (10966 x 3921 pairs)
2020-06-07 21:11:46,105:   >> acoustic_ap=0.600 (10966 choose 2 pairs)
2020-06-07 21:11:46,107: best_so_far= 0.587 at 273
2020-06-07 21:11:46,110: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 21:11:46,113: saved MultiViewDataset_IndividualWords successfully
2020-06-07 21:11:46,114: best linked save/MultiViewRNN.best.pth
2020-06-07 21:11:46,122: saved MultiViewRNN successfully
2020-06-07 21:11:46,124: best linked save/Adam.best.pth
2020-06-07 21:11:46,126: saved Adam successfully
2020-06-07 21:11:46,127: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 21:11:46,138: removed save/ReduceLROnPlateau.39.pth
2020-06-07 21:11:46,138: saved ReduceLROnPlateau successfully
2020-06-07 21:11:46,189: epoch=7.00 global_step=273 lr=0.001 start_iter=0
2020-06-07 21:11:46,189: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 21:12:42,591: 0) loss=0.131 grad_norm=25.28 num_segments=256 num_words=202
2020-06-07 21:13:36,822: 1) loss=0.136 grad_norm=23.45 num_segments=256 num_words=217
2020-06-07 21:14:30,879: 2) loss=0.131 grad_norm=19.72 num_segments=256 num_words=212
2020-06-07 21:15:26,699: 3) loss=0.134 grad_norm=35.46 num_segments=256 num_words=211
2020-06-07 21:16:20,841: 4) loss=0.137 grad_norm=28.18 num_segments=256 num_words=207
2020-06-07 21:17:15,204: 5) loss=0.138 grad_norm=27.67 num_segments=256 num_words=208
2020-06-07 21:18:07,918: 6) loss=0.125 grad_norm=26.12 num_segments=256 num_words=208
2020-06-07 21:19:01,584: 7) loss=0.122 grad_norm=31.39 num_segments=256 num_words=207
2020-06-07 21:19:54,369: 8) loss=0.129 grad_norm=21.67 num_segments=256 num_words=218
2020-06-07 21:20:47,742: 9) loss=0.134 grad_norm=37.50 num_segments=256 num_words=215
2020-06-07 21:21:41,086: 10) loss=0.136 grad_norm=35.71 num_segments=256 num_words=207
2020-06-07 21:22:34,284: 11) loss=0.143 grad_norm=24.27 num_segments=256 num_words=210
2020-06-07 21:23:27,419: 12) loss=0.128 grad_norm=30.66 num_segments=256 num_words=217
2020-06-07 21:24:20,872: 13) loss=0.138 grad_norm=32.13 num_segments=256 num_words=209
2020-06-07 21:25:13,845: 14) loss=0.131 grad_norm=29.93 num_segments=256 num_words=209
2020-06-07 21:26:06,538: 15) loss=0.138 grad_norm=40.48 num_segments=256 num_words=218
2020-06-07 21:26:59,586: 16) loss=0.121 grad_norm=27.39 num_segments=256 num_words=205
2020-06-07 21:27:52,363: 17) loss=0.130 grad_norm=24.59 num_segments=256 num_words=213
2020-06-07 21:28:45,582: 18) loss=0.126 grad_norm=24.60 num_segments=256 num_words=214
2020-06-07 21:29:39,004: 19) loss=0.134 grad_norm=36.13 num_segments=256 num_words=208
2020-06-07 21:30:32,450: 20) loss=0.200 grad_norm=27.53 num_segments=256 num_words=206
2020-06-07 21:31:26,062: 21) loss=0.144 grad_norm=26.93 num_segments=256 num_words=211
2020-06-07 21:32:19,343: 22) loss=0.131 grad_norm=26.04 num_segments=256 num_words=206
2020-06-07 21:33:12,835: 23) loss=0.143 grad_norm=29.25 num_segments=256 num_words=214
2020-06-07 21:34:06,745: 24) loss=0.157 grad_norm=30.22 num_segments=256 num_words=221
2020-06-07 21:35:00,134: 25) loss=0.202 grad_norm=20.57 num_segments=256 num_words=207
2020-06-07 21:35:53,277: 26) loss=0.137 grad_norm=30.08 num_segments=256 num_words=207
2020-06-07 21:36:46,609: 27) loss=0.136 grad_norm=28.10 num_segments=256 num_words=216
2020-06-07 21:37:39,322: 28) loss=0.135 grad_norm=23.40 num_segments=256 num_words=225
2020-06-07 21:38:32,535: 29) loss=0.141 grad_norm=25.59 num_segments=256 num_words=210
2020-06-07 21:39:25,783: 30) loss=0.124 grad_norm=27.26 num_segments=256 num_words=213
2020-06-07 21:40:18,522: 31) loss=0.130 grad_norm=33.40 num_segments=256 num_words=219
2020-06-07 21:41:12,099: 32) loss=0.136 grad_norm=20.72 num_segments=256 num_words=204
2020-06-07 21:42:05,271: 33) loss=0.127 grad_norm=24.97 num_segments=256 num_words=199
2020-06-07 21:42:58,121: 34) loss=0.149 grad_norm=27.05 num_segments=256 num_words=216
2020-06-07 21:43:52,103: 35) loss=0.125 grad_norm=21.59 num_segments=256 num_words=212
2020-06-07 21:44:45,418: 36) loss=0.126 grad_norm=28.51 num_segments=256 num_words=211
2020-06-07 21:45:38,856: 37) loss=0.136 grad_norm=30.25 num_segments=256 num_words=221
2020-06-07 21:46:26,763: 38) loss=0.139 grad_norm=29.88 num_segments=243 num_words=211
2020-06-07 21:46:26,778: epoch= 8.00
2020-06-07 21:46:26,778:  >> time to evaluate and save:
2020-06-07 21:46:26,868: saved save/MultiViewDataset_IndividualWords.312.pth
2020-06-07 21:46:26,870: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 21:46:26,881: removed save/MultiViewDataset_IndividualWords.78.pth
2020-06-07 21:46:26,881: saved MultiViewDataset_IndividualWords successfully
2020-06-07 21:46:29,067: saved save/MultiViewRNN.312.pth
2020-06-07 21:46:29,069: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 21:46:29,163: removed save/MultiViewRNN.78.pth
2020-06-07 21:46:29,163: saved MultiViewRNN successfully
2020-06-07 21:46:32,876: saved save/Adam.312.pth
2020-06-07 21:46:32,879: most_recent linked save/Adam.most_recent.pth
2020-06-07 21:46:32,946: removed save/Adam.78.pth
2020-06-07 21:46:32,946: saved Adam successfully
2020-06-07 21:46:32,996: saved save/ReduceLROnPlateau.312.pth
2020-06-07 21:46:33,019: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 21:46:33,023: removed save/ReduceLROnPlateau.78.pth
2020-06-07 21:46:33,024: saved ReduceLROnPlateau successfully
2020-06-07 21:46:33,026: saved config successfully
2020-06-07 21:47:54,011:   >> crossview_ap=0.613 (10966 x 3921 pairs)
2020-06-07 21:48:47,712:   >> acoustic_ap=0.624 (10966 choose 2 pairs)
2020-06-07 21:48:47,717: best_so_far= 0.613 at 312
2020-06-07 21:48:47,721: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 21:48:47,723: saved MultiViewDataset_IndividualWords successfully
2020-06-07 21:48:47,724: best linked save/MultiViewRNN.best.pth
2020-06-07 21:48:47,734: saved MultiViewRNN successfully
2020-06-07 21:48:47,736: best linked save/Adam.best.pth
2020-06-07 21:48:47,740: saved Adam successfully
2020-06-07 21:48:47,741: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 21:48:47,743: saved ReduceLROnPlateau successfully
2020-06-07 21:48:47,786: epoch=8.00 global_step=312 lr=0.001 start_iter=0
2020-06-07 21:48:47,787: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 21:49:42,265: 0) loss=0.129 grad_norm=23.67 num_segments=256 num_words=208
2020-06-07 21:50:35,703: 1) loss=0.113 grad_norm=20.07 num_segments=256 num_words=208
2020-06-07 21:51:28,788: 2) loss=0.128 grad_norm=26.99 num_segments=256 num_words=213
2020-06-07 21:52:23,317: 3) loss=0.139 grad_norm=17.52 num_segments=256 num_words=208
2020-06-07 21:53:16,512: 4) loss=0.125 grad_norm=31.19 num_segments=256 num_words=205
2020-06-07 21:54:10,797: 5) loss=0.128 grad_norm=23.81 num_segments=256 num_words=213
2020-06-07 21:55:03,716: 6) loss=0.141 grad_norm=22.73 num_segments=256 num_words=218
2020-06-07 21:55:56,616: 7) loss=0.134 grad_norm=21.76 num_segments=256 num_words=205
2020-06-07 21:56:50,127: 8) loss=0.109 grad_norm=24.31 num_segments=256 num_words=206
2020-06-07 21:57:43,592: 9) loss=0.119 grad_norm=27.43 num_segments=256 num_words=219
2020-06-07 21:58:37,222: 10) loss=0.112 grad_norm=22.56 num_segments=256 num_words=205
2020-06-07 21:59:30,368: 11) loss=0.127 grad_norm=34.59 num_segments=256 num_words=199
2020-06-07 22:00:23,583: 12) loss=0.153 grad_norm=33.58 num_segments=256 num_words=214
2020-06-07 22:01:16,898: 13) loss=0.126 grad_norm=25.98 num_segments=256 num_words=210
2020-06-07 22:02:10,416: 14) loss=0.117 grad_norm=28.23 num_segments=256 num_words=198
2020-06-07 22:03:03,721: 15) loss=0.124 grad_norm=27.11 num_segments=256 num_words=216
2020-06-07 22:03:57,227: 16) loss=0.125 grad_norm=26.74 num_segments=256 num_words=215
2020-06-07 22:04:50,729: 17) loss=0.143 grad_norm=22.39 num_segments=256 num_words=217
2020-06-07 22:05:44,131: 18) loss=0.122 grad_norm=22.69 num_segments=256 num_words=215
2020-06-07 22:06:37,789: 19) loss=0.122 grad_norm=21.49 num_segments=256 num_words=214
2020-06-07 22:07:30,798: 20) loss=0.187 grad_norm=22.99 num_segments=256 num_words=210
2020-06-07 22:08:23,683: 21) loss=0.159 grad_norm=26.35 num_segments=256 num_words=217
2020-06-07 22:09:16,961: 22) loss=0.121 grad_norm=22.63 num_segments=256 num_words=219
2020-06-07 22:10:10,582: 23) loss=0.138 grad_norm=28.70 num_segments=256 num_words=204
2020-06-07 22:11:03,404: 24) loss=0.158 grad_norm=28.90 num_segments=256 num_words=219
2020-06-07 22:11:56,657: 25) loss=0.134 grad_norm=21.70 num_segments=256 num_words=213
2020-06-07 22:12:50,115: 26) loss=0.125 grad_norm=30.18 num_segments=256 num_words=203
2020-06-07 22:13:43,774: 27) loss=0.138 grad_norm=23.27 num_segments=256 num_words=208
2020-06-07 22:14:37,190: 28) loss=0.119 grad_norm=33.24 num_segments=256 num_words=211
2020-06-07 22:15:30,416: 29) loss=0.122 grad_norm=17.45 num_segments=256 num_words=214
2020-06-07 22:16:23,687: 30) loss=0.122 grad_norm=23.54 num_segments=256 num_words=204
2020-06-07 22:17:17,153: 31) loss=0.118 grad_norm=29.65 num_segments=256 num_words=204
2020-06-07 22:18:10,244: 32) loss=0.126 grad_norm=22.85 num_segments=256 num_words=202
2020-06-07 22:19:03,933: 33) loss=0.115 grad_norm=22.17 num_segments=256 num_words=214
2020-06-07 22:19:57,183: 34) loss=0.137 grad_norm=38.90 num_segments=256 num_words=208
2020-06-07 22:20:50,678: 35) loss=0.200 grad_norm=26.99 num_segments=256 num_words=214
2020-06-07 22:21:43,814: 36) loss=0.118 grad_norm=41.60 num_segments=256 num_words=205
2020-06-07 22:22:36,736: 37) loss=0.108 grad_norm=28.90 num_segments=256 num_words=207
2020-06-07 22:23:24,965: 38) loss=0.210 grad_norm=33.34 num_segments=243 num_words=210
2020-06-07 22:23:24,981: epoch= 9.00
2020-06-07 22:23:24,981:  >> time to evaluate and save:
2020-06-07 22:23:25,431: saved save/MultiViewDataset_IndividualWords.351.pth
2020-06-07 22:23:25,433: most_recent linked save/MultiViewDataset_IndividualWords.most_recent.pth
2020-06-07 22:23:25,503: removed save/MultiViewDataset_IndividualWords.117.pth
2020-06-07 22:23:25,503: saved MultiViewDataset_IndividualWords successfully
2020-06-07 22:23:27,737: saved save/MultiViewRNN.351.pth
2020-06-07 22:23:27,739: most_recent linked save/MultiViewRNN.most_recent.pth
2020-06-07 22:23:27,905: removed save/MultiViewRNN.117.pth
2020-06-07 22:23:27,905: saved MultiViewRNN successfully
2020-06-07 22:23:33,070: saved save/Adam.351.pth
2020-06-07 22:23:33,073: most_recent linked save/Adam.most_recent.pth
2020-06-07 22:23:33,290: removed save/Adam.117.pth
2020-06-07 22:23:33,291: saved Adam successfully
2020-06-07 22:23:33,357: saved save/ReduceLROnPlateau.351.pth
2020-06-07 22:23:33,358: most_recent linked save/ReduceLROnPlateau.most_recent.pth
2020-06-07 22:23:33,366: removed save/ReduceLROnPlateau.117.pth
2020-06-07 22:23:33,366: saved ReduceLROnPlateau successfully
2020-06-07 22:23:33,397: saved config successfully
2020-06-07 22:24:58,035:   >> crossview_ap=0.636 (10966 x 3921 pairs)
2020-06-07 22:25:51,589:   >> acoustic_ap=0.677 (10966 choose 2 pairs)
2020-06-07 22:25:51,595: best_so_far= 0.636 at 351
2020-06-07 22:25:51,599: best linked save/MultiViewDataset_IndividualWords.best.pth
2020-06-07 22:25:51,601: saved MultiViewDataset_IndividualWords successfully
2020-06-07 22:25:51,603: best linked save/MultiViewRNN.best.pth
2020-06-07 22:25:51,613: saved MultiViewRNN successfully
2020-06-07 22:25:51,615: best linked save/Adam.best.pth
2020-06-07 22:25:51,620: saved Adam successfully
2020-06-07 22:25:51,622: best linked save/ReduceLROnPlateau.best.pth
2020-06-07 22:25:51,626: saved ReduceLROnPlateau successfully
2020-06-07 22:25:51,664: epoch=9.00 global_step=351 lr=0.001 start_iter=0
2020-06-07 22:25:51,664: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-07 22:26:45,163: 0) loss=0.145 grad_norm=25.54 num_segments=256 num_words=223
2020-06-07 22:27:38,406: 1) loss=0.114 grad_norm=28.11 num_segments=256 num_words=198
2020-06-07 22:28:31,225: 2) loss=0.118 grad_norm=22.88 num_segments=256 num_words=209
2020-06-07 22:29:24,439: 3) loss=0.118 grad_norm=39.21 num_segments=256 num_words=217
2020-06-07 22:30:18,069: 4) loss=0.105 grad_norm=21.88 num_segments=256 num_words=207
2020-06-07 22:31:11,314: 5) loss=0.108 grad_norm=16.04 num_segments=256 num_words=209
2020-06-07 22:32:04,686: 6) loss=0.115 grad_norm=20.53 num_segments=256 num_words=213
2020-06-07 22:32:57,343: 7) loss=0.128 grad_norm=29.18 num_segments=256 num_words=209
2020-06-07 22:33:50,636: 8) loss=0.119 grad_norm=17.77 num_segments=256 num_words=213
2020-06-07 22:34:44,211: 9) loss=0.131 grad_norm=27.82 num_segments=256 num_words=212
2020-06-07 22:35:37,712: 10) loss=0.119 grad_norm=23.80 num_segments=256 num_words=202
2020-06-07 22:36:31,301: 11) loss=0.108 grad_norm=18.70 num_segments=256 num_words=215
2020-06-07 22:37:24,195: 12) loss=0.115 grad_norm=22.62 num_segments=256 num_words=220
2020-06-07 22:38:17,393: 13) loss=0.114 grad_norm=29.54 num_segments=256 num_words=211
2020-06-07 22:39:10,983: 14) loss=0.108 grad_norm=17.74 num_segments=256 num_words=204
2020-06-07 22:40:04,381: 15) loss=0.113 grad_norm=19.73 num_segments=256 num_words=208
2020-06-07 22:40:56,892: 16) loss=0.115 grad_norm=23.49 num_segments=256 num_words=209
2020-06-07 22:41:50,076: 17) loss=0.100 grad_norm=25.71 num_segments=256 num_words=212
2020-06-07 22:42:43,445: 18) loss=0.113 grad_norm=24.91 num_segments=256 num_words=211
2020-06-07 22:43:36,930: 19) loss=0.126 grad_norm=28.06 num_segments=256 num_words=204
2020-06-07 22:44:30,067: 20) loss=0.183 grad_norm=29.03 num_segments=256 num_words=201
2020-06-07 22:45:23,225: 21) loss=0.121 grad_norm=16.13 num_segments=256 num_words=211
2020-06-07 22:46:16,257: 22) loss=0.123 grad_norm=21.23 num_segments=256 num_words=208
2020-06-07 22:47:09,087: 23) loss=0.105 grad_norm=17.16 num_segments=256 num_words=197
2020-06-07 22:48:01,850: 24) loss=0.107 grad_norm=21.27 num_segments=256 num_words=213
2020-06-07 22:48:55,556: 25) loss=0.112 grad_norm=16.84 num_segments=256 num_words=204
2020-06-07 22:49:48,968: 26) loss=0.111 grad_norm=19.98 num_segments=256 num_words=211
2020-06-07 22:50:42,420: 27) loss=0.108 grad_norm=30.10 num_segments=256 num_words=203
2020-06-07 22:51:35,393: 28) loss=0.102 grad_norm=25.77 num_segments=256 num_words=202
2020-06-07 22:52:27,778: 29) loss=0.111 grad_norm=30.07 num_segments=256 num_words=218
2020-06-07 22:53:20,683: 30) loss=0.123 grad_norm=22.56 num_segments=256 num_words=209
2020-06-07 22:54:14,018: 31) loss=0.108 grad_norm=19.09 num_segments=256 num_words=212
2020-06-07 22:55:07,968: 32) loss=0.109 grad_norm=19.80 num_segments=256 num_words=214
2020-06-07 22:56:02,298: 33) loss=0.127 grad_norm=24.75 num_segments=256 num_words=202
2020-06-07 22:56:55,825: 34) loss=0.125 grad_norm=21.30 num_segments=256 num_words=206
2020-06-08 18:31:19,163: 

Start >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
2020-06-08 18:31:19,170: Using CPU
2020-06-08 18:31:19,171: Machine: 0 / 1
2020-06-08 18:31:19,172: Hyperparam tuning-------------------
2020-06-08 18:31:19,172: optim_lr: 0.001
2020-06-08 18:31:19,172: dropout (for both): 0.4
2020-06-08 18:31:19,172: margin: 0.4
2020-06-08 18:31:19,172: ------------------------------------
2020-06-08 18:31:19,285: Calling main function: multiview_trainer.train
2020-06-08 18:31:19,286: Using config file: train_config.json
2020-06-08 18:31:19,286: Using module at multiview_trainer.train
2020-06-08 18:31:31,109: Using module at multiview_vocab.MultiViewVocab
2020-06-08 18:31:31,128: Building vocab_data from config
2020-06-08 18:31:31,533:  >> min_count= 0
2020-06-08 18:31:31,534:  >> # words= 34323 (# removed= 0)
2020-06-08 18:31:31,534:  >> # subwords= 45
2020-06-08 18:31:31,534:     [laughter]= 1
2020-06-08 18:31:31,534:     [noise]= 2
2020-06-08 18:31:31,534:     [vocalized-noise]= 3
2020-06-08 18:31:31,534:     aa= 4
2020-06-08 18:31:31,534:     ae= 5
2020-06-08 18:31:31,534:     ah= 6
2020-06-08 18:31:31,535:     ao= 7
2020-06-08 18:31:31,535:     aw= 8
2020-06-08 18:31:31,535:     ax= 9
2020-06-08 18:31:31,535:     ay= 10
2020-06-08 18:31:31,535:     b= 11
2020-06-08 18:31:31,535:     ch= 12
2020-06-08 18:31:31,535:     d= 13
2020-06-08 18:31:31,535:     dh= 14
2020-06-08 18:31:31,535:     eh= 15
2020-06-08 18:31:31,536:     el= 16
2020-06-08 18:31:31,536:     en= 17
2020-06-08 18:31:31,536:     er= 18
2020-06-08 18:31:31,536:     ey= 19
2020-06-08 18:31:31,536:     f= 20
2020-06-08 18:31:31,536:     g= 21
2020-06-08 18:31:31,536:     hh= 22
2020-06-08 18:31:31,536:     ih= 23
2020-06-08 18:31:31,536:     iy= 24
2020-06-08 18:31:31,536:     jh= 25
2020-06-08 18:31:31,536:     k= 26
2020-06-08 18:31:31,537:     l= 27
2020-06-08 18:31:31,537:     m= 28
2020-06-08 18:31:31,537:     n= 29
2020-06-08 18:31:31,537:     ng= 30
2020-06-08 18:31:31,537:     ow= 31
2020-06-08 18:31:31,537:     oy= 32
2020-06-08 18:31:31,537:     p= 33
2020-06-08 18:31:31,537:     r= 34
2020-06-08 18:31:31,537:     s= 35
2020-06-08 18:31:31,537:     sh= 36
2020-06-08 18:31:31,538:     t= 37
2020-06-08 18:31:31,538:     th= 38
2020-06-08 18:31:31,538:     uh= 39
2020-06-08 18:31:31,538:     uw= 40
2020-06-08 18:31:31,538:     v= 41
2020-06-08 18:31:31,538:     w= 42
2020-06-08 18:31:31,538:     y= 43
2020-06-08 18:31:31,538:     z= 44
2020-06-08 18:31:31,538:     zh= 45
2020-06-08 18:31:31,555: Using module at data.batch_samplers.BatchSampler
2020-06-08 18:31:31,561: Building vocab_sampler from config
2020-06-08 18:31:31,561:  >> # examples= 34323
2020-06-08 18:31:31,562:  >> batch_size= 1000
2020-06-08 18:31:31,562:  >> shuffle= False
2020-06-08 18:31:31,571:  >> BatchSampler; 35 batches
2020-06-08 18:31:31,571: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 18:31:34,860: Building train_data from config
2020-06-08 18:31:46,022:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.train.hdf5
2020-06-08 18:31:46,023:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.train.hdf5
2020-06-08 18:31:46,023:  >> stack= False
2020-06-08 18:31:46,023:  >> seg_durs= (1, None)
2020-06-08 18:31:46,023:  >> # words= 9971 (# ignored= 0)
2020-06-08 18:31:46,023:  >> input_feat_dim= 108
2020-06-08 18:31:46,023:  >> input_num_subwords= 45
2020-06-08 18:31:46,023: Using module at data.batch_samplers.BatchSampler
2020-06-08 18:31:46,023: Building train_sampler from config
2020-06-08 18:31:46,024:  >> # examples= 9971
2020-06-08 18:31:46,024:  >> batch_size= 256
2020-06-08 18:31:46,024:  >> shuffle= True
2020-06-08 18:31:46,036:  >> BatchSampler; 39 batches
2020-06-08 18:31:46,036: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 18:31:46,036: Building dev_data from config
2020-06-08 18:31:57,416:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.dev.hdf5
2020-06-08 18:31:57,416:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.dev.hdf5
2020-06-08 18:31:57,416:  >> stack= False
2020-06-08 18:31:57,416:  >> seg_durs= (1, None)
2020-06-08 18:31:57,416:  >> # words= 10966 (# ignored= 0)
2020-06-08 18:31:57,416:  >> input_feat_dim= 108
2020-06-08 18:31:57,417:  >> input_num_subwords= 45
2020-06-08 18:31:57,417: Using module at data.batch_samplers.BatchSampler
2020-06-08 18:31:57,417: Building dev_sampler from config
2020-06-08 18:31:57,417:  >> # examples= 10966
2020-06-08 18:31:57,418:  >> batch_size= 256
2020-06-08 18:31:57,418:  >> shuffle= False
2020-06-08 18:31:57,421:  >> BatchSampler; 43 batches
2020-06-08 18:31:57,421: Using module at multiview_dataset.MultiViewDataset_IndividualWords
2020-06-08 18:31:57,421: Building test_data from config
2020-06-08 18:32:07,340:  >> feats: loading /share/data/speech/spsettle/Data/swb300/wdp/fbank.test.hdf5
2020-06-08 18:32:07,341:  >> align: loading /share/data/speech/spsettle/Data/swb300/wdp/align-small.test.hdf5
2020-06-08 18:32:07,341:  >> stack= False
2020-06-08 18:32:07,341:  >> seg_durs= (1, None)
2020-06-08 18:32:07,341:  >> # words= 11024 (# ignored= 0)
2020-06-08 18:32:07,341:  >> input_feat_dim= 108
2020-06-08 18:32:07,341:  >> input_num_subwords= 45
2020-06-08 18:32:07,341: Using module at data.batch_samplers.BatchSampler
2020-06-08 18:32:07,341: Building test_sampler from config
2020-06-08 18:32:07,342:  >> # examples= 11024
2020-06-08 18:32:07,342:  >> batch_size= 256
2020-06-08 18:32:07,342:  >> shuffle= False
2020-06-08 18:32:07,345:  >> BatchSampler; 44 batches
2020-06-08 18:32:07,345: Using module at loss.multiview_triplet_loss.MultiViewTripletLoss
2020-06-08 18:32:07,544: Building loss from config
2020-06-08 18:32:07,545:  >> margin= 0.4
2020-06-08 18:32:07,545:  >> k= 16
2020-06-08 18:32:07,545:  >> min_k= 8
2020-06-08 18:32:07,545:  >> extra= 0
2020-06-08 18:32:07,546:  >> average= False
2020-06-08 18:32:07,546: Using module at metric.multiview_ap.MultiViewAP
2020-06-08 18:32:09,483: Building eval from config
2020-06-08 18:32:09,484:  >> acoustic_ap= True
2020-06-08 18:32:09,484:  >> crossview_ap= True
2020-06-08 18:32:09,484:  >> full_vocab= False
2020-06-08 18:32:09,484:  >> metric= crossview_ap
2020-06-08 18:32:09,484:  >> mode= max
2020-06-08 18:32:09,484: Using module at multiview_rnn.MultiViewRNN
2020-06-08 18:32:09,524: Building net from config
2020-06-08 18:32:09,525: view1:
2020-06-08 18:32:09,527:  >> cell= GRU
2020-06-08 18:32:09,527:  >> input_size= 108
2020-06-08 18:32:09,527:  >> hidden_size= 512
2020-06-08 18:32:09,527:  >> bidirectional= True
2020-06-08 18:32:09,527:  >> num_layers= 6
2020-06-08 18:32:09,527:  >> dropout between layers= 0.4
2020-06-08 18:32:09,838: view2:
2020-06-08 18:32:09,839:  >> cell= GRU
2020-06-08 18:32:09,839:  >> input_size= 64
2020-06-08 18:32:09,839:  >> hidden_size= 512
2020-06-08 18:32:09,839:  >> bidirectional= True
2020-06-08 18:32:09,839:  >> num_layers= 2
2020-06-08 18:32:09,839:  >> dropout between layers= 0.4
2020-06-08 18:32:09,840:  >> num input embeddings= 45
2020-06-08 18:32:09,927: Using module at optim.adam.Adam
2020-06-08 18:32:09,938: Building optim from config
2020-06-08 18:32:09,938:  >> lr= 0.001
2020-06-08 18:32:09,939:  >> betas= (0.9, 0.999)
2020-06-08 18:32:09,939:  >> eps= 1e-08
2020-06-08 18:32:09,939:  >> weight_decay= 0
2020-06-08 18:32:09,939:  >> amsgrad= False
2020-06-08 18:32:09,939:  >> min_lr= 1e-07
2020-06-08 18:32:09,941: Using module at sched.reduce_lr_on_plateau.ReduceLROnPlateau
2020-06-08 18:32:09,965: Building sched from config
2020-06-08 18:32:09,965:  >> optim= Adam
2020-06-08 18:32:09,965:  >> decay lr by 0.1
2020-06-08 18:32:09,965:  >> eval_fn= MultiViewAP
2020-06-08 18:32:09,967:  >> patience=4
2020-06-08 18:32:09,967:  >> revert=True
2020-06-08 18:32:09,967: epoch=0.00 global_step=0 lr=0.001 start_iter=0
2020-06-08 18:32:09,967: Iterating MultiViewDataset_IndividualWords (start_iter= 0)
2020-06-08 18:32:58,510:  >> margin_max= 0.5
2020-06-08 18:32:58,520:  >> threshold_max= 9
